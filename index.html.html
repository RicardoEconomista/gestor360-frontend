<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üíº Gestor Financeiro 360¬∞ | Diagn√≥stico Completo 80 Perguntas</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script>

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üîó INTEGRA√á√ÉO COM BACKEND - GESTOR 360¬∞
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// URL do backend (pode mudar quando fizer deploy)
const BACKEND_URL = 'https://gestor360-backend.vercel.app';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO PRINCIPAL: Chamar Backend
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function chamarBackend(endpoint, dados) {
    try {
        console.log(`üåê Chamando backend: ${BACKEND_URL}${endpoint}`);
        console.log('üì§ Enviando dados:', dados);
        
        // Fazer requisi√ß√£o
        const resposta = await fetch(`${BACKEND_URL}${endpoint}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(dados)
        });
        
        // Verificar se deu erro HTTP
        if (!resposta.ok) {
            throw new Error(`Erro HTTP: ${resposta.status}`);
        }
        
        // Converter resposta para JSON
        const resultado = await resposta.json();
        
        console.log('üì• Resposta do backend:', resultado);
        
        return resultado;
        
    } catch (erro) {
        console.error('‚ùå Erro ao chamar backend:', erro);
        
        // Verificar se backend est√° offline
        if (erro.message.includes('Failed to fetch')) {
            alert('‚ö†Ô∏è Backend n√£o est√° respondendo!\n\nVerifique se o servidor est√° rodando:\n1. Abra o terminal\n2. Entre na pasta gestor360-simples\n3. Digite: npm start');
            return null;
        }
        
        // Outro tipo de erro
        alert('‚ùå Erro ao processar: ' + erro.message);
        return null;
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO: Verificar se Backend est√° Online
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function verificarBackend() {
    try {
        const resposta = await fetch(`${BACKEND_URL}/health`, {
            method: 'GET'
        });
        
        if (resposta.ok) {
            const dados = await resposta.json();
            console.log('‚úÖ Backend online:', dados);
            return true;
        }
        
        return false;
        
    } catch (erro) {
        console.error('‚ùå Backend offline:', erro);
        return false;
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NOVA FUN√á√ÉO: Calcular Pontua√ß√£o (via Backend)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function calcularPontuacaoBackend(respostas, config) {
    console.log('üßÆ Calculando pontua√ß√£o via BACKEND...');
    
    // Preparar dados para enviar
    const dados = {
        respostas: respostas,
        config: config,
        relevanciaPerguntas: RELEVANCIA_PERGUNTAS  // Enviar relev√¢ncia tamb√©m
    };
    
    // Chamar backend
    const resultado = await chamarBackend('/calcular', dados);
    
    if (!resultado || !resultado.sucesso) {
        console.error('‚ùå Backend n√£o retornou pontua√ß√£o v√°lida');
        return null;
    }
    
    console.log('‚úÖ Pontua√ß√£o calculada pelo backend:', resultado.pontuacao);
    
    return resultado.pontuacao;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NOVA FUN√á√ÉO: Calcular Perdas (via Backend)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function calcularPerdasBackend(faturamentoAnual, pontuacao) {
    console.log('üí∞ Calculando perdas via BACKEND...');
    
    // Preparar dados
    const dados = {
        faturamentoAnual: faturamentoAnual,
        pontuacao: pontuacao
    };
    
    // Chamar backend
    const resultado = await chamarBackend('/perdas', dados);
    
    if (!resultado || !resultado.sucesso) {
        console.error('‚ùå Backend n√£o retornou perdas v√°lidas');
        return null;
    }
    
    console.log('‚úÖ Perdas calculadas pelo backend:', resultado.perdas);
    
    return resultado.perdas;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO: Diagn√≥stico Completo (Pontua√ß√£o + Perdas de uma vez)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function diagnosticoCompletoBackend(respostas, config, faturamentoAnual) {
    console.log('üéØ Calculando diagn√≥stico COMPLETO via BACKEND...');
    
    // Preparar dados
    const dados = {
        respostas: respostas,
        config: config,
        relevanciaPerguntas: RELEVANCIA_PERGUNTAS,
        faturamentoAnual: faturamentoAnual
    };
    
    // Chamar backend (rota que calcula tudo de uma vez)
    const resultado = await chamarBackend('/completo', dados);
    
    if (!resultado || !resultado.sucesso) {
        console.error('‚ùå Backend n√£o retornou diagn√≥stico v√°lido');
        return null;
    }
    
    console.log('‚úÖ Diagn√≥stico completo do backend:', resultado);
    
    return {
        pontuacao: resultado.pontuacao,
        perdas: resultado.perdas
    };
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AUTO-VERIFICA√á√ÉO: Verificar backend ao carregar p√°gina
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

window.addEventListener('DOMContentLoaded', async () => {
    console.log('üîç Verificando status do backend...');
    
    const online = await verificarBackend();
    
    if (online) {
        console.log('‚úÖ Backend est√° ONLINE e pronto!');
    } else {
        console.warn('‚ö†Ô∏è Backend OFFLINE! Funcionalidades de c√°lculo n√£o estar√£o dispon√≠veis.');
        console.warn('üí° Inicie o servidor: npm start');
    }
});


</script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <!-- jsPDF para gera√ß√£o de PDFs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.6.0/jspdf.plugin.autotable.min.js"></script>
    <!-- html2canvas para capturar gr√°ficos como imagem -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Intro.js para Tour Guiado - Biblioteca est√°vel e confi√°vel -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/introjs.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/intro.min.js"></script>
    
    <script>
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // SISTEMA ADAPTATIVO - METADADOS COMPLETOS (SETOR + PORTE)
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    // Handler global de erros para debug
    window.onerror = function(msg, url, lineNo, columnNo, error) {
        console.error('‚ùå ERRO JAVASCRIPT:');
        console.error('Mensagem:', msg);
        console.error('Linha:', lineNo);
        console.error('Coluna:', columnNo);
        console.error('Erro:', error);
        return false;
    };
    
    console.log('‚úÖ Sistema de diagn√≥stico carregando...');

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // STORAGE MULTI-EMPRESA - DEFINIDO NO IN√çCIO
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function getEmpresaKey(baseKey) {
    const empresaAtiva = localStorage.getItem('empresa_ativa');
    if (!empresaAtiva) {
        console.warn('‚ö†Ô∏è Nenhuma empresa ativa!');
        return baseKey; // fallback
    }
    return baseKey + '_' + empresaAtiva;
}

// Wrapper para localStorage que automaticamente usa keys isoladas
const StorageEmpresa = {
    getItem: function(key) {
        const empresaKey = getEmpresaKey(key);
        return localStorage.getItem(empresaKey);
    },
    
    setItem: function(key, value) {
        const empresaKey = getEmpresaKey(key);
        localStorage.setItem(empresaKey, value);
    },
    
    removeItem: function(key) {
        const empresaKey = getEmpresaKey(key);
        localStorage.removeItem(empresaKey);
    }
};

    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // üéØ CAMADA 2: RELEV√ÇNCIA POR SETOR E PORTE
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    // METADADOS DE RELEV√ÇNCIA - Cada pergunta tem relev√¢ncia por setor e porte
    const RELEVANCIA_PERGUNTAS = {        // TESOURARIA (10 perguntas)
        't1': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        't2': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        't3': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        't4': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        't5': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        't9': { comercio: 0.7, servicos: 1.0, industria: 0.9, micro: 0.3, pequena: 0.7, media: 1.0 }, // Confer√™ncia peri√≥dica - menos para micro
        't10': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        't11': { comercio: 0.8, servicos: 1.0, industria: 1.0, micro: 0.3, pequena: 0.8, media: 1.0 }, // An√°lise de taxas - avan√ßado
        't13': { comercio: 0.9, servicos: 1.0, industria: 1.0, micro: 0.8, pequena: 1.0, media: 1.0 },
        't14': { comercio: 0.6, servicos: 0.9, industria: 1.0, micro: 0.2, pequena: 0.6, media: 1.0 }, // Sistema integrado - avan√ßado
        // RESULTADOS & DRE (10 perguntas)
        'r1': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'r2': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'r3': { comercio: 0.7, servicos: 1.0, industria: 1.0, micro: 0.3, pequena: 0.7, media: 1.0 }, // EBITDA - avan√ßado
        'r4': { comercio: 0.6, servicos: 0.9, industria: 1.0, micro: 0.2, pequena: 0.6, media: 1.0 }, // Margem operacional - avan√ßado
        'r5': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 0.9, pequena: 1.0, media: 1.0 },
        'r7': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 0.9, pequena: 1.0, media: 1.0 },
        'r9': { comercio: 0.6, servicos: 0.9, industria: 1.0, micro: 0.2, pequena: 0.6, media: 1.0 }, // Break-even
        'r11': { comercio: 0.7, servicos: 1.0, industria: 1.0, micro: 0.3, pequena: 0.7, media: 1.0 }, // Proje√ß√µes financeiras
        'r13': { comercio: 0.9, servicos: 1.0, industria: 1.0, micro: 0.7, pequena: 1.0, media: 1.0 },
        'r14': { comercio: 0.8, servicos: 1.0, industria: 1.0, micro: 0.6, pequena: 0.9, media: 1.0 },
        // FLUXO DE CAIXA (10 perguntas)
        'f1': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'f2': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'f3': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'f4': { comercio: 0.6, servicos: 0.9, industria: 1.0, micro: 0.2, pequena: 0.7, media: 1.0 }, // PMR - mais relevante ind√∫stria
        'f5': { comercio: 0.7, servicos: 0.8, industria: 1.0, micro: 0.3, pequena: 0.7, media: 1.0 }, // PMP
        'f6': { comercio: 0.6, servicos: 0.8, industria: 1.0, micro: 0.2, pequena: 0.6, media: 1.0 }, // Ciclo financeiro
        'f7': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'f9': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 0.9, pequena: 1.0, media: 1.0 },
        'f13': { comercio: 1.0, servicos: 0.8, industria: 0.9, micro: 0.9, pequena: 1.0, media: 1.0 },
        'f15': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 0.8, pequena: 1.0, media: 1.0 },
        // OR√áAMENTO (10 perguntas)
        'o1': { comercio: 0.6, servicos: 0.8, industria: 1.0, micro: 0.2, pequena: 0.6, media: 1.0 }, // Or√ßamento anual - avan√ßado
        'o2': { comercio: 0.6, servicos: 0.8, industria: 1.0, micro: 0.2, pequena: 0.6, media: 1.0 }, // Or√ßamento por √°rea
        'o3': { comercio: 0.7, servicos: 0.9, industria: 1.0, micro: 0.3, pequena: 0.7, media: 1.0 }, // Real x Or√ßado
        'o4': { comercio: 0.5, servicos: 0.7, industria: 0.9, micro: 0.1, pequena: 0.4, media: 0.9 }, // Or√ßamento base zero - muito avan√ßado
        'o5': { comercio: 0.9, servicos: 1.0, industria: 1.0, micro: 0.7, pequena: 1.0, media: 1.0 },
        'o6': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 0.9, pequena: 1.0, media: 1.0 },
        'o7': { comercio: 1.0, servicos: 0.9, industria: 1.0, micro: 0.9, pequena: 1.0, media: 1.0 },
        'o9': { comercio: 0.6, servicos: 0.9, industria: 0.8, micro: 0.2, pequena: 0.5, media: 0.9 }, // An√°lise de sensibilidade
        'o10': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 0.8, pequena: 1.0, media: 1.0 },
        'o14': { comercio: 0.5, servicos: 0.8, industria: 0.9, micro: 0.1, pequena: 0.4, media: 0.9 }, // Cen√°rios e simula√ß√µes
        // INVESTIMENTOS (10 perguntas)
        'i1': { comercio: 0.8, servicos: 0.9, industria: 1.0, micro: 0.7, pequena: 0.9, media: 1.0 },
        'i2': { comercio: 0.5, servicos: 0.7, industria: 0.9, micro: 0.1, pequena: 0.4, media: 0.9 }, // An√°lise de viabilidade - avan√ßado
        'i3': { comercio: 0.7, servicos: 0.8, industria: 1.0, micro: 0.5, pequena: 0.8, media: 1.0 },
        'i4': { comercio: 0.8, servicos: 0.9, industria: 1.0, micro: 0.6, pequena: 0.9, media: 1.0 },
        'i5': { comercio: 0.6, servicos: 0.8, industria: 1.0, micro: 0.2, pequena: 0.6, media: 1.0 }, // Payback
        'i6': { comercio: 0.5, servicos: 0.7, industria: 0.9, micro: 0.1, pequena: 0.4, media: 0.9 }, // VPL/TIR - avan√ßado
        'i9': { comercio: 0.6, servicos: 0.8, industria: 1.0, micro: 0.2, pequena: 0.5, media: 0.9 }, // Investimento tecnol√≥gico
        'i11': { comercio: 0.8, servicos: 0.9, industria: 1.0, micro: 0.6, pequena: 0.9, media: 1.0 },
        'i13': { comercio: 0.9, servicos: 1.0, industria: 1.0, micro: 0.7, pequena: 1.0, media: 1.0 },
        'i14': { comercio: 0.6, servicos: 0.8, industria: 1.0, micro: 0.2, pequena: 0.5, media: 0.9 }, // Investimento ESG
        // RISCOS (10 perguntas)
        'g1': { comercio: 0.4, servicos: 0.8, industria: 0.9, micro: 0.1, pequena: 0.3, media: 0.9 }, // Mapeamento riscos - avan√ßado
        'g2': { comercio: 0.5, servicos: 0.9, industria: 1.0, micro: 0.1, pequena: 0.4, media: 0.9 }, // Cl√°usulas reequil√≠brio - muito espec√≠fico servi√ßos
        'g3': { comercio: 0.4, servicos: 0.8, industria: 0.9, micro: 0.1, pequena: 0.3, media: 0.9 }, // Hedging - avan√ßado
        'g5': { comercio: 0.7, servicos: 0.9, industria: 1.0, micro: 0.5, pequena: 0.8, media: 1.0 },
        'g6': { comercio: 0.5, servicos: 0.8, industria: 0.9, micro: 0.2, pequena: 0.4, media: 0.9 }, // Derivativos
        'g9': { comercio: 0.7, servicos: 0.9, industria: 1.0, micro: 0.5, pequena: 0.8, media: 1.0 },
        'g10': { comercio: 0.8, servicos: 0.9, industria: 1.0, micro: 0.6, pequena: 0.9, media: 1.0 },
        'g11': { comercio: 0.7, servicos: 0.9, industria: 1.0, micro: 0.5, pequena: 0.8, media: 1.0 },
        'g12': { comercio: 0.8, servicos: 0.9, industria: 1.0, micro: 0.6, pequena: 0.9, media: 1.0 },
        'g14': { comercio: 0.5, servicos: 0.8, industria: 0.9, micro: 0.1, pequena: 0.4, media: 0.9 }, // Auditoria
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // INDICADORES FINANCEIROS (IF1-IF15) - NOVAS PERGUNTAS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'if1': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'if2': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'if3': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'if4': { comercio: 0.9, servicos: 1.0, industria: 1.0, micro: 0.7, pequena: 1.0, media: 1.0 },
        'if5': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'if6': { comercio: 1.0, servicos: 1.0, industria: 0.9, micro: 0.9, pequena: 1.0, media: 1.0 },
        'if7': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'if8': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'if11': { comercio: 0.9, servicos: 0.9, industria: 1.0, micro: 0.8, pequena: 1.0, media: 1.0 },
        'if14': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // PLANEJAMENTO TRIBUT√ÅRIO (PT1-PT15) - NOVAS PERGUNTAS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        'pt1': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'pt2': { comercio: 0.7, servicos: 0.8, industria: 0.9, micro: 0.4, pequena: 0.7, media: 1.0 },
        'pt3': { comercio: 0.7, servicos: 0.8, industria: 0.9, micro: 0.4, pequena: 0.7, media: 1.0 },
        'pt4': { comercio: 0.6, servicos: 0.7, industria: 0.8, micro: 0.3, pequena: 0.6, media: 1.0 },
        'pt5': { comercio: 0.8, servicos: 0.9, industria: 1.0, micro: 0.6, pequena: 0.8, media: 1.0 },
        'pt6': { comercio: 0.7, servicos: 0.8, industria: 0.9, micro: 0.5, pequena: 0.7, media: 1.0 },
        'pt8': { comercio: 0.8, servicos: 0.9, industria: 1.0, micro: 0.6, pequena: 0.8, media: 1.0 },
        'pt10': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 1.0, pequena: 1.0, media: 1.0 },
        'pt12': { comercio: 0.8, servicos: 0.9, industria: 1.0, micro: 0.6, pequena: 0.8, media: 1.0 },
        'pt14': { comercio: 1.0, servicos: 1.0, industria: 1.0, micro: 0.9, pequena: 1.0, media: 1.0 },
    };
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // üéØ FUN√á√ÉO INTELIGENTE: Considera SETOR + PORTE
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    function mostrarPergunta(idPergunta, porte, setor) {
        const rel = RELEVANCIA_PERGUNTAS[idPergunta];
        if (!rel) return true; // Se n√£o tem metadados, mostra por padr√£o
        
        // Pegar relev√¢ncia por porte e setor
        const relPorte = rel[porte] || 1.0;
        const relSetor = rel[setor] || 1.0;
        
        // Calcular relev√¢ncia combinada (m√©dia ponderada: 60% porte, 40% setor)
        const relevanciaFinal = (relPorte * 0.6) + (relSetor * 0.4);
        
        // REGRA: Mostra se relev√¢ncia >= 0.5 (50%)
        // Isso significa: perguntas muito pouco relevantes n√£o aparecem
        const mostra = relevanciaFinal >= 0.5;
        
        // Debug (apenas primeiras 3 perguntas de cada tipo)
        if (['t1','r1','f1','o1','i1','g1'].includes(idPergunta)) {
            console.log(`üìã ${idPergunta}: porte=${relPorte.toFixed(2)} setor=${relSetor.toFixed(2)} ‚Üí final=${relevanciaFinal.toFixed(2)} ‚Üí ${mostra ? '‚úÖ' : '‚ùå'}`);
        }
        
        return mostra;
    }
    
    // Armazenar configura√ß√£o
    let CONFIG_DIAGNOSTICO = {
        porte: 'media',
        setor: 'comercio'
    };
    </script>
    <style>
        :root{--primary:#0066FF;--secondary:#00C853;--accent:#1976d2;--gold:#ffa726;--success:#00C853;--warning:#f57c00;--danger:#d32f2f;--info:#0288d1;--bg:#fff;--card:#fff;--text:#202124;--text-light:#5f6368;--border:#e8eaed;--shadow:0 2px 8px rgba(0,0,0,0.08)}
        [data-theme="dark"]{--bg:#16213e;--card:#1e2738;--text:#e8e8e8;--text-light:#a0a0a0;--border:#2d3748;--shadow:0 4px 20px rgba(0,0,0,0.3)}
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);transition:all .3s}
        .sidebar{width:280px;position:fixed;height:100vh;background:linear-gradient(180deg,var(--primary),var(--secondary));overflow-y:auto;z-index:1000;box-shadow:4px 0 30px rgba(0,0,0,0.15)}
        .brand{padding:24px 20px;border-bottom:1px solid rgba(255,255,255,0.1)}
        .brand h1{font-family:'Playfair Display',serif;color:white;font-size:1.3em;margin-bottom:8px}
        .brand-tag{background:var(--gold);color:var(--primary);padding:4px 12px;border-radius:16px;font-size:0.7em;font-weight:700;display:inline-block}
        .nav-item{padding:12px 20px;color:rgba(255,255,255,0.7);cursor:pointer;display:flex;align-items:center;gap:12px;border-left:3px solid transparent;transition:all .3s}
        .nav-item:hover,.nav-item.active{background:rgba(255,255,255,0.1);color:white;border-left-color:var(--gold)}
        .nav-badge{margin-left:auto;background:var(--gold);color:var(--primary);padding:2px 8px;border-radius:12px;font-size:0.75em;font-weight:700}
        .main{margin-left:280px;min-height:100vh}
        .header{background:var(--card);padding:20px 32px;display:flex;justify-content:space-between;align-items:center;box-shadow:var(--shadow);position:sticky;top:0;z-index:100}
        .title{font-family:'Playfair Display',serif;font-size:1.5em;font-weight:700;color:var(--primary)}
        .btn{background:linear-gradient(135deg,var(--success),#1b5e20);color:white;padding:12px 24px;border:none;border-radius:8px;font-weight:700;cursor:pointer;transition:all .3s}
        .btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(46,125,50,0.4)}
        .content{padding:32px;max-width:1400px;margin:0 auto}
        .card{background:var(--card);border-radius:16px;padding:32px;margin-bottom:24px;box-shadow:var(--shadow);border:1px solid var(--border)}
        .card-header{display:flex;align-items:center;gap:16px;margin-bottom:24px;padding-bottom:16px;border-bottom:2px solid var(--border)}
        .card-icon{width:48px;height:48px;background:linear-gradient(135deg,var(--accent),#42a5f5);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.5em;color:white}
        .card-title{font-family:'Playfair Display',serif;font-size:1.4em;font-weight:700}
        .pergunta{background:var(--card);border:2px solid var(--border);border-radius:12px;padding:24px;margin-bottom:24px;transition:all .3s}
        .pergunta.respondida{border-color:var(--success);background:linear-gradient(135deg,rgba(0,200,83,0.05),transparent)}
        .pergunta-num{background:linear-gradient(135deg,var(--accent),#42a5f5);color:white;padding:6px 14px;border-radius:20px;font-size:0.85em;font-weight:700;display:inline-block;margin-bottom:12px}
        .pergunta-texto{font-size:1.15em;font-weight:600;margin-bottom:20px;line-height:1.5}
        .opcoes{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:20px}
        .opcao{background:var(--card);border:2px solid var(--border);border-radius:8px;padding:16px;cursor:pointer;transition:all .3s;position:relative;overflow:hidden}
        .opcao::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%}
        .opcao.n1::before{background:#d32f2f}.opcao.n2::before{background:#f57c00}.opcao.n3::before{background:#2e7d32}.opcao.n4::before{background:#1976d2}
        .opcao:hover{transform:translateX(4px);box-shadow:var(--shadow)}
        .opcao.selecionada{border-width:3px;transform:translateX(4px);box-shadow:0 4px 12px rgba(0,0,0,0.15)!important}
        .opcao.n1.selecionada{border-color:#d32f2f!important;background:rgba(211,47,47,0.1)!important}
        .opcao.n2.selecionada{border-color:#f57c00!important;background:rgba(245,124,0,0.1)!important}
        .opcao.n3.selecionada{border-color:#2e7d32!important;background:rgba(46,125,50,0.1)!important}
        .opcao.n4.selecionada{border-color:#1976d2!important;background:rgba(25,118,210,0.1)!important}
        .opcao-header{display:flex;align-items:center;gap:10px;margin-bottom:10px}
        .opcao-emoji{font-size:1.5em}
        .opcao-nivel{font-weight:700;font-size:0.85em;text-transform:uppercase}
        .opcao-pts{margin-left:auto;background:var(--border);padding:3px 10px;border-radius:12px;font-size:0.8em;font-weight:700}
        .opcao-desc{font-size:0.9em;line-height:1.5;color:var(--text-light);margin-bottom:12px}
        .feedback{margin-top:16px;padding:16px 20px;border-radius:8px;border-left:4px solid;animation:slideIn 0.4s}
        @keyframes slideIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
        .feedback.critico{background:rgba(211,47,47,0.1);border-left-color:#d32f2f}
        .feedback.basico{background:rgba(245,124,0,0.1);border-left-color:#f57c00}
        .feedback.estruturado{background:rgba(46,125,50,0.1);border-left-color:#2e7d32}
        .feedback.otimizado{background:rgba(25,118,210,0.1);border-left-color:#1976d2}
        .feedback-titulo{font-weight:700;margin-bottom:8px;font-size:0.95em}
        .feedback-acao{font-size:0.9em;line-height:1.6;font-weight:600}
        .progress{background:var(--card);border-radius:12px;padding:20px;margin-bottom:24px;box-shadow:var(--shadow)}
        .progress-header{display:flex;justify-content:space-between;margin-bottom:12px;font-weight:600}
        .progress-bar-bg{height:12px;background:var(--border);border-radius:6px;overflow:hidden}
        .progress-bar-fill{height:100%;background:linear-gradient(90deg,var(--success),var(--accent));border-radius:6px;transition:width .5s}
        .alert{padding:16px 20px;border-radius:8px;margin-bottom:24px;display:flex;gap:12px;border-left:4px solid}
        .alert.info{background:rgba(2,136,209,0.1);border-left-color:var(--info);color:var(--info)}
        .alert.success{background:rgba(0,200,83,0.1);border-left-color:var(--success);color:var(--success)}
        .section{display:none;animation:fadeIn .4s}.section.active{display:block}
        #ajuda{margin-left:280px;padding:40px}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        .form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}
        .form-group{display:flex;flex-direction:column;gap:8px}
        .form-label{font-weight:600;font-size:0.9em}
        .form-input,.form-select{padding:12px 16px;border:1px solid var(--border);border-radius:8px;font-family:inherit;background:var(--card);color:var(--text)}
        .fab{position:fixed;bottom:24px;right:24px;width:56px;height:56px;background:linear-gradient(135deg,var(--accent),#42a5f5);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5em;color:white;border:none;cursor:pointer;box-shadow:0 4px 16px rgba(0,0,0,0.2);z-index:999;transition:all .3s}
        .fab:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(0,0,0,0.3)}
        .celebration{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;padding:48px;border-radius:24px;box-shadow:0 20px 60px rgba(0,0,0,0.4);text-align:center;z-index:10000;display:none;max-width:500px}
        [data-theme="dark"] .celebration{background:var(--card)}
        .celebration.show{display:block;animation:popIn 0.6s}
        @keyframes popIn{from{transform:translate(-50%,-50%) scale(0.7);opacity:0}to{transform:translate(-50%,-50%) scale(1);opacity:1}}
        .score-hero{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border-radius:20px;padding:48px;text-align:center;margin-bottom:32px;box-shadow:0 10px 40px rgba(102,126,234,0.4);position:relative;overflow:hidden}
        .score-hero::before{content:'';position:absolute;top:-50%;right:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,0.1) 0%,transparent 70%);animation:pulse 3s ease-in-out infinite}
        @keyframes pulse{0%,100%{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:0.8}}
        .score-number{font-size:5em;font-weight:900;margin:20px 0;text-shadow:0 4px 20px rgba(0,0,0,0.3);font-family:'Playfair Display',serif}
        .score-label{font-size:1.3em;opacity:0.95;font-weight:600;text-transform:uppercase;letter-spacing:2px}
        .score-status{display:inline-block;padding:12px 32px;background:rgba(255,255,255,0.2);border-radius:50px;margin-top:16px;font-size:1.1em;font-weight:700;backdrop-filter:blur(10px)}
        .metrics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:32px}
        .metric-card{background:var(--card);border-radius:16px;padding:24px;text-align:center;border:2px solid var(--border);transition:all 0.3s;position:relative;overflow:hidden}
        .metric-card::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;transition:width 0.3s}
        .metric-card.atual::before{background:var(--accent)}
        .metric-card.benchmark::before{background:var(--success)}
        .metric-card.meta::before{background:var(--gold)}
        .metric-card:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(0,0,0,0.15);border-color:var(--accent)}
        .metric-value{font-size:2.8em;font-weight:800;margin:8px 0;font-family:'Playfair Display',serif}
        .metric-label{font-size:0.9em;color:var(--text-light);font-weight:600;text-transform:uppercase;letter-spacing:1px}
        .metric-subtitle{font-size:0.85em;color:var(--text-light);margin-top:8px}
        .chart-container{background:var(--card);border-radius:16px;padding:32px;margin-bottom:24px;box-shadow:var(--shadow);border:1px solid var(--border)}
        .chart-wrapper{position:relative;height:400px}
        .chart-title{font-size:1.3em;font-weight:700;margin-bottom:24px;color:var(--text);font-family:'Playfair Display',serif}
        .comparison-bars{display:flex;flex-direction:column;gap:20px}
        .comparison-item{background:var(--bg);padding:20px;border-radius:12px;border:1px solid var(--border)}
        .comparison-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
        .comparison-name{font-weight:700;font-size:1.05em}
        .comparison-bar-bg{height:32px;background:var(--border);border-radius:16px;overflow:hidden;position:relative}
        .comparison-bar-fill{height:100%;display:flex;align-items:center;padding:0 16px;color:white;font-weight:700;font-size:0.9em;transition:width 0.8s ease;border-radius:16px}
        .bar-seu{background:linear-gradient(90deg,#667eea,#764ba2)}
        .bar-benchmark{background:linear-gradient(90deg,#00c853,#64dd17)}
        .bar-meta{background:linear-gradient(90deg,#ffa726,#ff6f00)}
        .legend{display:flex;gap:24px;justify-content:center;flex-wrap:wrap;margin-top:24px;padding-top:24px;border-top:2px solid var(--border)}
        .legend-item{display:flex;align-items:center;gap:8px;font-size:0.9em;font-weight:600}
        .legend-color{width:16px;height:16px;border-radius:4px}
        .status-badge{display:inline-block;padding:8px 20px;border-radius:20px;font-size:0.85em;font-weight:700;text-transform:uppercase;letter-spacing:1px}
        .status-critico{background:rgba(211,47,47,0.15);color:#d32f2f;border:2px solid #d32f2f}
        .status-atencao{background:rgba(245,124,0,0.15);color:#f57c00;border:2px solid #f57c00}
        .status-bom{background:rgba(0,200,83,0.15);color:#00c853;border:2px solid #00c853}
        .status-excelente{background:rgba(25,118,210,0.15);color:#1976d2;border:2px solid #1976d2}
        .setor-selector{background:var(--card);border:2px solid var(--border);border-radius:16px;padding:24px;margin-bottom:24px;box-shadow:var(--shadow)}
        .setor-selector-title{font-size:1.1em;font-weight:700;margin-bottom:16px;color:var(--text);display:flex;align-items:center;gap:8px}
        .setor-options{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
        .setor-option{background:var(--bg);border:3px solid var(--border);border-radius:12px;padding:16px 20px;cursor:pointer;transition:all 0.3s;text-align:center;position:relative}
        .setor-option:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.1);border-color:var(--accent)}
        .setor-option.active{border-color:var(--accent);background:linear-gradient(135deg,rgba(102,126,234,0.1),rgba(118,75,162,0.1));box-shadow:0 4px 16px rgba(102,126,234,0.3)}
        .setor-option-name{font-weight:700;font-size:1.05em;margin-bottom:8px}
        .setor-option-bench{font-size:0.85em;color:var(--text-light)}
        .setor-option-badge{position:absolute;top:-10px;right:-10px;background:var(--accent);color:white;border-radius:50%;width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:1em;font-weight:700;box-shadow:0 2px 8px rgba(0,0,0,0.2)}
        .setor-atual-badge{background:linear-gradient(135deg,var(--accent),#764ba2);color:white;padding:8px 20px;border-radius:20px;font-size:0.9em;font-weight:700;display:inline-flex;align-items:center;gap:8px;box-shadow:0 2px 8px rgba(102,126,234,0.3)}

        /* ============================================
           REGRAS DE QUEBRA DE P√ÅGINA PARA PDF
           ============================================ */
        @media print {
            /* Evitar quebras dentro de cards e se√ß√µes */
            .card,
            .pergunta,
            .metric-card,
            .comparison-item {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            /* Se√ß√µes principais n√£o devem quebrar */
            [id^="secao-"] {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            /* Cabe√ßalhos n√£o devem ficar separados do conte√∫do */
            h1, h2, h3, h4, h5, h6 {
                page-break-after: avoid !important;
                break-after: avoid !important;
            }
            
            /* Campos de observa√ß√µes */
            textarea,
            [id^="obs-secao-"] {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            /* A√ß√µes de ROI */
            div[style*="border:2px solid var(--border)"] {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            /* Gr√°ficos e visualiza√ß√µes */
            .chart-container,
            .chart-wrapper,
            svg {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            /* Tabelas e grids */
            table,
            .form-grid,
            .metrics-grid {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
        }
        
        /* Regras adicionais para html2pdf */
        .card {
            page-break-inside: avoid;
            break-inside: avoid;
        }
        
        .card h2 {
            page-break-after: avoid;
            break-after: avoid;
        }
        
        /* Garantir que blocos de ROI n√£o quebrem */
        div[style*="border-radius:12px"][style*="padding:20px"] {
            page-break-inside: avoid !important;
            break-inside: avoid !important;
        }

        /* PROPOSTA COMERCIAL - CSS */

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SPRINT 5 - PACOTES E COMBOS
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

.pacotes-section {
    margin-bottom: 48px;
    padding: 32px;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    border-radius: 20px;
}

.pacotes-header {
    text-align: center;
    margin-bottom: 40px;
}

.pacotes-header h2 {
    font-size: 2em;
    color: #2c3e50;
    margin-bottom: 12px;
}

.pacotes-header p {
    font-size: 1.1em;
    color: #7f8c8d;
}

.pacotes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 24px;
    margin-bottom: 24px;
}

.pacote-card {
    background: white;
    border-radius: 16px;
    padding: 28px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    position: relative;
    border: 2px solid transparent;
}

.pacote-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 40px rgba(0,0,0,0.15);
    border-color: #667eea;
}

.pacote-destaque {
    border: 3px solid #667eea;
    box-shadow: 0 8px 30px rgba(102, 126, 234, 0.25);
}

.pacote-destaque:hover {
    box-shadow: 0 16px 50px rgba(102, 126, 234, 0.35);
}

.pacote-premium {
    border: 3px solid #ffd700;
    background: linear-gradient(135deg, #ffffff 0%, #fff9e6 100%);
    box-shadow: 0 8px 30px rgba(255, 215, 0, 0.3);
}

.pacote-premium:hover {
    box-shadow: 0 16px 50px rgba(255, 215, 0, 0.4);
}

.pacote-badge {
    display: inline-block;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 0.85em;
    font-weight: 700;
    margin-bottom: 16px;
    letter-spacing: 0.5px;
}

.pacote-badge-destaque {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    animation: pulse 2s ease-in-out infinite;
}

.pacote-badge-premium {
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
    color: #333;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.pacote-card h3 {
    font-size: 1.6em;
    color: #2c3e50;
    margin-bottom: 8px;
}

.pacote-desc {
    color: #7f8c8d;
    font-size: 0.95em;
    margin-bottom: 20px;
    line-height: 1.5;
}

.pacote-info {
    background: #f8f9fa;
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 20px;
}

.pacote-produtos {
    font-weight: 600;
    color: #667eea;
    margin-bottom: 12px;
    font-size: 0.95em;
}

.pacote-lista {
    font-size: 0.9em;
    color: #555;
    line-height: 1.8;
}

.pacote-preco {
    margin: 24px 0;
    padding: 20px;
    background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
    border-radius: 12px;
    text-align: center;
}

.preco-original {
    font-size: 0.9em;
    color: #95a5a6;
    text-decoration: line-through;
    margin-bottom: 8px;
}

.preco-desconto {
    font-size: 1.8em;
    font-weight: 800;
    color: #27ae60;
    margin-bottom: 8px;
}

.economia {
    font-size: 1em;
    color: #e74c3c;
    font-weight: 600;
}

.btn-selecionar-pacote {
    width: 100%;
    padding: 16px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 1.05em;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.btn-selecionar-pacote:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
}

.btn-selecionar-pacote:active {
    transform: translateY(0);
}

.btn-destaque {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.btn-destaque:hover {
    box-shadow: 0 8px 25px rgba(245, 87, 108, 0.4);
}

.btn-premium {
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
    color: #333;
}

.btn-premium:hover {
    box-shadow: 0 8px 25px rgba(255, 215, 0, 0.5);
}

.pacotes-footer {
    text-align: center;
    padding: 20px;
    background: white;
    border-radius: 12px;
    color: #7f8c8d;
}

.produtos-divider {
    text-align: center;
    margin: 48px 0 32px 0;
    padding: 24px;
    border-top: 2px solid #e0e0e0;
    border-bottom: 2px solid #e0e0e0;
}

.produtos-divider h2 {
    font-size: 1.8em;
    color: #2c3e50;
    margin-bottom: 8px;
}

.produtos-divider p {
    color: #7f8c8d;
    font-size: 1em;
}

/* Badge de pacote selecionado nos produtos */
.produto-em-pacote {
    border: 3px solid #667eea !important;
    background: linear-gradient(135deg, #ffffff 0%, #f0f4ff 100%);
    position: relative;
}

.produto-em-pacote::before {
    content: 'üéÅ PACOTE';
    position: absolute;
    top: 12px;
    right: 12px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.75em;
    font-weight: 700;
    z-index: 10;
}

/* Anima√ß√£o de sele√ß√£o de pacote */
@keyframes pacoteSelecionado {
    0%, 100% { transform: scale(1); border-color: #667eea; }
    50% { transform: scale(1.02); border-color: #764ba2; }
}

.pacote-card.selecionado {
    animation: pacoteSelecionado 0.6s ease;
    border-color: #27ae60;
    background: linear-gradient(135deg, #ffffff 0%, #e8f5e9 100%);
}

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f7fa;
            color: #333;
        }
        
        /* Layout Principal */
        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 40px 20px;
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 32px;
        }
        
        .main-content {
            min-width: 0;
        }
        
        /* Header da Proposta */
        .proposta-header {
            text-align: center;
            margin-bottom: 48px;
            padding: 40px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            color: white;
            grid-column: 1 / -1;
        }
        
        .proposta-header h1 {
            font-size: 2.5em;
            margin: 0 0 12px 0;
            font-weight: 800;
        }
        
        .proposta-header p {
            font-size: 1.2em;
            opacity: 0.95;
        }
        
        /* Card de Resumo do Diagn√≥stico */
        .diagnostico-resumo {
            background: white;
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid #e0e0e0;
            grid-column: 1 / -1;
        }
        
        .diagnostico-resumo h2 {
            margin: 0 0 24px 0;
            color: #1976d2;
            font-size: 1.8em;
        }
        
        .scores-categorias {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }
        
        .score-categoria-item {
            background: #f8f9fa;
            padding: 12px 16px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid #ddd;
        }
        
        .score-categoria-item.critico {
            border-left-color: #d32f2f;
            background: #ffebee;
        }
        
        .score-categoria-item.basico {
            border-left-color: #f57c00;
            background: #fff3e0;
        }
        
        .score-categoria-item.organizado {
            border-left-color: #2e7d32;
            background: #e8f5e9;
        }
        
        .score-categoria-label {
            font-weight: 600;
            font-size: 0.95em;
        }
        
        .score-categoria-valor {
            font-weight: 700;
            font-size: 1.1em;
        }
        
        /* Preview Lateral STICKY */
        .preview-sidebar {
            position: sticky;
            top: 20px;
            height: fit-content;
            background: white;
            border-radius: 20px;
            padding: 28px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
            border: 3px solid #667eea;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }
        
        .preview-sidebar::-webkit-scrollbar {
            width: 8px;
        }
        
        .preview-sidebar::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 4px;
        }
        
        .preview-sidebar::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 4px;
        }
        
        .preview-header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 20px;
        }
        
        .preview-header h3 {
            font-size: 1.5em;
            color: #667eea;
            margin-bottom: 8px;
        }
        
        .preview-contador {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9em;
        }
        
        .preview-produtos {
            max-height: 280px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding-right: 8px;
        }
        
        .preview-produtos::-webkit-scrollbar {
            width: 6px;
        }
        
        .preview-produtos::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 3px;
        }
        
        .preview-produtos::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 3px;
        }
        
        .preview-produto-item {
            padding: 12px;
            margin-bottom: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .preview-produto-nome {
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
            font-size: 0.95em;
        }
        
        .preview-produto-valor {
            display: flex;
            justify-content: space-between;
            font-size: 0.85em;
            color: #666;
            margin-bottom: 4px;
        }
        
        .preview-totais {
            padding: 20px 0;
            border-top: 2px solid #f0f0f0;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 20px;
        }
        
        .preview-total-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.95em;
        }
        
        .preview-total-item.destaque {
            font-size: 1.3em;
            font-weight: 700;
            color: #667eea;
            padding-top: 12px;
            margin-top: 12px;
            border-top: 2px dashed #667eea;
        }
        
        .preview-roi {
            background: linear-gradient(135deg, #00c853 0%, #00bfa5 100%);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }
        
        .preview-roi h4 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        
        .preview-roi-value {
            font-size: 2.2em;
            font-weight: 800;
        }
        
        .preview-roi-subtitle {
            font-size: 0.85em;
            opacity: 0.9;
            margin-top: 4px;
        }
        
        .preview-acoes {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .btn-preview {
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-preview-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-preview-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-preview-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }
        
        .btn-preview-secondary:hover {
            background: #f8f9ff;
        }
        
        /* Produtos Section */
        .produtos-section {
            margin-bottom: 48px;
        }
        
        .produtos-section-title {
            font-size: 2em;
            margin: 0 0 24px 0;
            color: #333;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .nivel-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.5em;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .nivel-fundacao {
            background: linear-gradient(135deg, #42a5f5, #1976d2);
            color: white;
        }
        
        .nivel-intermediario {
            background: linear-gradient(135deg, #ffa726, #f57c00);
            color: white;
        }
        
        .nivel-avancado {
            background: linear-gradient(135deg, #ab47bc, #8e24aa);
            color: white;
        }
        
        .nivel-acompanhamento {
            background: linear-gradient(135deg, #66bb6a, #43a047);
            color: white;
        }
        
        .produtos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(500px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }
        
        /* Card de Produto */
        .produto-card {
            background: white;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .produto-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }
        
        .produto-card.selecionado {
            border-color: #667eea;
            background: linear-gradient(135deg, #f8f9ff 0%, white 50%);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.2);
        }
        
        .produto-recomendado::before {
            content: "üí° RECOMENDADO";
            position: absolute;
            top: 12px;
            right: 12px;
            background: #ff9800;
            color: white;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: 700;
            letter-spacing: 0.5px;
            z-index: 10;
        }
        
        .produto-bloqueado {
            opacity: 0.6;
            background: #fafafa;
            cursor: not-allowed;
        }
        
        .produto-bloqueado::after {
            content: "üîí BLOQUEADO";
            position: absolute;
            top: 12px;
            right: 12px;
            background: #757575;
            color: white;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: 700;
            z-index: 10;
        }
        
        .produto-bloqueado .produto-checkbox {
            pointer-events: none;
            cursor: not-allowed;
        }
        
        .produto-bloqueado .campo-editavel-input {
            pointer-events: none;
            background: #f5f5f5;
        }
        
        /* Checkbox */
        .produto-checkbox-container {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .produto-checkbox {
            width: 28px;
            height: 28px;
            cursor: pointer;
            margin-top: 4px;
            flex-shrink: 0;
        }
        
        .produto-header {
            flex: 1;
        }
        
        .produto-titulo {
            font-size: 1.3em;
            font-weight: 700;
            color: #333;
            margin: 0 0 8px 0;
        }
        
        .produto-score {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
            margin-bottom: 12px;
        }
        
        .produto-score-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 700;
        }
        
        .score-critico { 
            background: #ffebee;
            color: #d32f2f; 
        }
        .score-basico { 
            background: #fff3e0;
            color: #f57c00; 
        }
        .score-organizado { 
            background: #e8f5e9;
            color: #2e7d32; 
        }
        
        .produto-descricao {
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 0.95em;
        }
        
        /* Campos Edit√°veis */
        .produto-campos-editaveis {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px dashed #dee2e6;
        }
        
        .campo-editavel {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .campo-editavel-label {
            font-size: 0.85em;
            color: #666;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .campo-editavel-input {
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            color: #333;
            transition: all 0.3s ease;
        }
        
        .campo-editavel-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
        }
        
        .campo-editavel-sugestao {
            font-size: 0.75em;
            color: #999;
            font-style: italic;
        }
        
        /* Perdas/Ganhos por Produto */
        .produto-impacto {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-left: 4px solid #66bb6a;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }
        
        .produto-impacto.perdas {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border-left-color: #ef5350;
        }
        
        .produto-impacto h4 {
            margin: 0 0 8px 0;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .produto-impacto-valor {
            font-size: 1.4em;
            font-weight: 800;
            margin-bottom: 8px;
        }
        
        .produto-impacto-lista {
            font-size: 0.85em;
            margin: 0;
            padding-left: 20px;
        }
        
        .produto-impacto-lista li {
            margin-bottom: 4px;
        }
        
        /* Entreg√°veis */
        .produto-entregaveis {
            background: #f0f7ff;
            border-left: 4px solid #2196f3;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }
        
        .produto-entregaveis h4 {
            margin: 0 0 12px 0;
            color: #1976d2;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .produto-entregaveis ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .produto-entregaveis li {
            margin-bottom: 6px;
            color: #555;
            line-height: 1.5;
            font-size: 0.9em;
        }
        
        /* ROI Box - NOVO! */
        .produto-roi-box {
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cc 100%);
            border: 2px solid #ffc107;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.2);
        }
        
        .produto-roi-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
        }
        
        .produto-roi-icon {
            font-size: 1.8em;
        }
        
        .produto-roi-title {
            font-weight: 700;
            font-size: 1em;
            color: #f57c00;
            letter-spacing: 0.5px;
        }
        
        .produto-roi-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .produto-roi-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        }
        
        .produto-roi-label {
            font-size: 0.8em;
            color: #666;
            margin-bottom: 6px;
            font-weight: 500;
        }
        
        .produto-roi-valor {
            font-size: 1.3em;
            font-weight: 700;
        }
        
        .produto-roi-beneficios {
            background: white;
            padding: 14px;
            border-radius: 8px;
            margin-bottom: 12px;
        }
        
        .produto-roi-beneficios-title {
            font-weight: 700;
            color: #555;
            margin-bottom: 10px;
            font-size: 0.9em;
        }
        
        .produto-roi-beneficio {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 0;
            gap: 12px;
            font-size: 0.85em;
        }
        
        .produto-roi-beneficio-texto {
            color: #555;
            flex: 1;
        }
        
        .produto-roi-beneficio-valor {
            color: #2e7d32;
            font-weight: 700;
            white-space: nowrap;
        }
        
        .produto-roi-destaque {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.95em;
            line-height: 1.4;
        }
        
        .produto-roi-destaque strong {
            font-size: 1.2em;
        }
        
        @media (max-width: 768px) {
            .produto-roi-grid {
                grid-template-columns: 1fr;
            }
            
            .produto-roi-beneficio {
                flex-direction: column;
                align-items: flex-start;
                gap: 4px;
            }
        }
        
        /* Pr√©-requisitos */
        .produto-prerequisitos {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 0.9em;
            margin-bottom: 16px;
        }
        
        .produto-prerequisitos strong {
            color: #f57c00;
        }
        
        .produto-prerequisitos-lista {
            margin: 8px 0 0 0;
            padding-left: 20px;
            color: #666;
        }
        
        /* Expertise */
        .produto-expertise {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: #f5f5f5;
            border-radius: 8px;
            font-size: 0.9em;
            margin-bottom: 16px;
        }
        
        .expertise-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.85em;
        }
        
        .expertise-basica {
            background: #c8e6c9;
            color: #2e7d32;
        }
        
        .expertise-intermediaria {
            background: #ffe082;
            color: #f57c00;
        }
        
        .expertise-avancada {
            background: #f8bbd0;
            color: #c2185b;
        }
        
        /* Alerta de Bloqueio */
        .alerta-bloqueio {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 32px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 10000;
            max-width: 500px;
            width: 90%;
            display: none;
        }
        
        .alerta-bloqueio.show {
            display: block;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -40%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }
        
        .alerta-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 9999;
            display: none;
        }
        
        .alerta-overlay.show {
            display: block;
        }
        
        /* Responsivo */
        @media (max-width: 1400px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .preview-sidebar {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                border-radius: 20px 20px 0 0;
                max-height: 50vh;
                z-index: 1000;
            }
        }
        
        @media (max-width: 768px) {
            .produtos-grid {
                grid-template-columns: 1fr;
            }
            
            .produto-campos-editaveis {
                grid-template-columns: 1fr;
            }
        }
    
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SPRINT 9: HIST√ìRICO E TEMPLATES - CSS
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SPRINT 9: HIST√ìRICO E TEMPLATES - CSS
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

/* Container do Hist√≥rico */
.historico-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
}

/* Header do Hist√≥rico */
.historico-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 40px;
    border-radius: 20px;
    color: white;
    margin-bottom: 30px;
    box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
}

.historico-header h1 {
    margin: 0 0 10px 0;
    font-size: 2.5em;
    font-weight: 900;
}

.historico-header p {
    margin: 0;
    opacity: 0.9;
    font-size: 1.1em;
}

/* Barra de A√ß√µes */
.historico-actions {
    display: flex;
    gap: 15px;
    margin-bottom: 30px;
    flex-wrap: wrap;
    align-items: center;
}

.historico-search {
    flex: 1;
    min-width: 300px;
}

.historico-search input {
    width: 100%;
    padding: 14px 20px;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    font-size: 1em;
    transition: all 0.3s;
}

.historico-search input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.historico-filters {
    display: flex;
    gap: 10px;
}

.filter-btn {
    padding: 12px 24px;
    background: white;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s;
    font-weight: 600;
    color: #333;
}

.filter-btn:hover {
    border-color: #667eea;
    color: #667eea;
}

.filter-btn.active {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-color: transparent;
}

/* Grid de Propostas */
.propostas-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 25px;
    margin-bottom: 30px;
}

/* Card de Proposta */
.proposta-card {
    background: white;
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    transition: all 0.3s;
    border: 2px solid transparent;
    position: relative;
    overflow: hidden;
}

.proposta-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #667eea, #764ba2);
}

.proposta-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    border-color: #667eea;
}

.proposta-card.template {
    border-color: #f39c12;
}

.proposta-card.template::before {
    background: linear-gradient(90deg, #f39c12, #e67e22);
}

/* Header do Card */
.proposta-card-header {
    display: flex;
    justify-content: space-between;
    align-items: start;
    margin-bottom: 16px;
}

.proposta-card-title {
    flex: 1;
}

.proposta-card-title h3 {
    margin: 0 0 4px 0;
    font-size: 1.3em;
    color: #2c3e50;
    font-weight: 700;
}

.proposta-card-subtitle {
    font-size: 0.9em;
    color: #7f8c8d;
    margin: 0;
}

.proposta-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.75em;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.proposta-badge.template {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    color: white;
}

.proposta-badge.proposta {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

/* Body do Card */
.proposta-card-body {
    margin-bottom: 16px;
}

.proposta-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 16px;
}

.proposta-info-item {
    background: #f8f9fa;
    padding: 12px;
    border-radius: 8px;
}

.proposta-info-label {
    font-size: 0.75em;
    color: #7f8c8d;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 4px;
    font-weight: 600;
}

.proposta-info-value {
    font-size: 1.1em;
    font-weight: 700;
    color: #2c3e50;
}

.proposta-info-value.valor {
    color: #27ae60;
}

.proposta-produtos {
    margin-top: 12px;
}

.proposta-produtos-label {
    font-size: 0.85em;
    color: #7f8c8d;
    margin-bottom: 8px;
}

.proposta-produtos-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.produto-tag {
    padding: 4px 10px;
    background: #e3f2fd;
    color: #1976d2;
    border-radius: 12px;
    font-size: 0.75em;
    font-weight: 600;
}

/* Footer do Card */
.proposta-card-footer {
    display: flex;
    gap: 8px;
    padding-top: 16px;
    border-top: 1px solid #ecf0f1;
}

.proposta-btn {
    flex: 1;
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.9em;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
}

.proposta-btn-primary {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.proposta-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.proposta-btn-secondary {
    background: #ecf0f1;
    color: #34495e;
}

.proposta-btn-secondary:hover {
    background: #bdc3c7;
}

.proposta-btn-danger {
    background: #fee;
    color: #e74c3c;
}

.proposta-btn-danger:hover {
    background: #e74c3c;
    color: white;
}

/* Modal de Salvar */
.modal-salvar {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    z-index: 10000;
    align-items: center;
    justify-content: center;
}

.modal-salvar.show {
    display: flex;
}

.modal-content {
    background: white;
    border-radius: 20px;
    padding: 40px;
    max-width: 500px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: slideUp 0.3s ease;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-header {
    margin-bottom: 24px;
}

.modal-header h2 {
    margin: 0 0 8px 0;
    font-size: 1.8em;
    color: #2c3e50;
}

.modal-header p {
    margin: 0;
    color: #7f8c8d;
}

.modal-body {
    margin-bottom: 24px;
}

.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #2c3e50;
}

.form-label .required {
    color: #e74c3c;
}

.form-input,
.form-select,
.form-textarea {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    font-size: 1em;
    font-family: inherit;
    transition: all 0.3s;
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.form-textarea {
    resize: vertical;
    min-height: 80px;
}

.modal-footer {
    display: flex;
    gap: 12px;
}

.modal-btn {
    flex: 1;
    padding: 14px 24px;
    border: none;
    border-radius: 10px;
    font-weight: 700;
    font-size: 1em;
    cursor: pointer;
    transition: all 0.3s;
}

.modal-btn-primary {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.modal-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
}

.modal-btn-secondary {
    background: #ecf0f1;
    color: #34495e;
}

.modal-btn-secondary:hover {
    background: #bdc3c7;
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 80px 20px;
}

.empty-state-icon {
    font-size: 5em;
    margin-bottom: 20px;
    opacity: 0.3;
}

.empty-state h3 {
    font-size: 1.5em;
    color: #2c3e50;
    margin-bottom: 10px;
}

.empty-state p {
    color: #7f8c8d;
    margin-bottom: 24px;
}

/* Templates Pr√©-definidos */
.templates-section {
    margin-top: 40px;
}

.templates-header {
    margin-bottom: 24px;
}

.templates-header h2 {
    font-size: 1.8em;
    color: #2c3e50;
    margin-bottom: 8px;
}

.templates-header p {
    color: #7f8c8d;
}

/* Responsivo */
@media (max-width: 768px) {
    .propostas-grid {
        grid-template-columns: 1fr;
    }
    
    .historico-actions {
        flex-direction: column;
    }
    
    .historico-search {
        min-width: 100%;
    }
    
    .proposta-info {
        grid-template-columns: 1fr;
    }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   TOUR GUIADO - BOT√ÉO
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

/* Bot√£o "Ver Tour Novamente" */
.btn-tour {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.95em;
    margin: 8px 0;
}

.btn-tour:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn-tour:active {
    transform: translateY(0);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   TOUR ULTRA IMPACTANTE - TOOLTIP CENTRALIZADO + SETA ANIMADA
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

/* Overlay mais escuro e dram√°tico */
.introjs-overlay {
    background-color: rgba(0, 0, 0, 0.92) !important;
    animation: fadeIn 0.5s ease !important;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* TOOLTIP SEMPRE CENTRALIZADO NO MEIO DA TELA */
.introjs-tooltip {
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) scale(1) !important;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    border: 3px solid rgba(255, 255, 255, 0.3) !important;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7), 0 0 100px rgba(102, 126, 234, 0.5) !important;
    border-radius: 20px !important;
    padding: 32px !important;
    max-width: 600px !important;
    min-width: 500px !important;
    animation: tooltipAppear 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) !important;
    z-index: 999999999 !important;
}

@keyframes tooltipAppear {
    0% {
        transform: translate(-50%, -50%) scale(0.5);
        opacity: 0;
    }
    100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
    }
}

/* Remover setas do Intro.js (vamos criar a nossa) */
.introjs-arrow {
    display: none !important;
}

.introjs-tooltip-title {
    color: white !important;
    font-size: 2em !important;
    font-weight: 800 !important;
    margin-bottom: 20px !important;
    text-align: center !important;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3) !important;
    line-height: 1.2 !important;
}

.introjs-tooltiptext {
    color: rgba(255, 255, 255, 0.98) !important;
    font-size: 1.15em !important;
    line-height: 1.8 !important;
    margin-bottom: 24px !important;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2) !important;
}

.introjs-tooltiptext h3 {
    color: white !important;
    margin-top: 16px !important;
    margin-bottom: 12px !important;
    font-size: 1.4em !important;
}

.introjs-tooltiptext ul {
    margin: 12px 0 !important;
    padding-left: 24px !important;
}

.introjs-tooltiptext li {
    margin: 8px 0 !important;
}

/* Bot√µes maiores e mais impactantes */
.introjs-button {
    background: rgba(255, 255, 255, 0.25) !important;
    color: white !important;
    border: 2px solid rgba(255, 255, 255, 0.5) !important;
    padding: 14px 28px !important;
    border-radius: 10px !important;
    font-weight: 700 !important;
    font-size: 1.05em !important;
    cursor: pointer !important;
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55) !important;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3) !important;
}

.introjs-button:hover {
    background: rgba(255, 255, 255, 0.4) !important;
    transform: translateY(-3px) scale(1.05) !important;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3) !important;
}

.introjs-nextbutton {
    background: white !important;
    color: #667eea !important;
    border-color: white !important;
    font-weight: 800 !important;
}

.introjs-nextbutton:hover {
    background: #f0f0f0 !important;
    color: #764ba2 !important;
    transform: translateY(-3px) scale(1.08) !important;
}

.introjs-skipbutton {
    background: rgba(255, 255, 255, 0.1) !important;
    color: rgba(255, 255, 255, 0.9) !important;
    border: 2px solid rgba(255, 255, 255, 0.3) !important;
}

/* Progress bar mais vis√≠vel */
.introjs-progress {
    background: rgba(255, 255, 255, 0.3) !important;
    height: 8px !important;
    border-radius: 10px !important;
    margin: 20px 0 !important;
}

.introjs-progressbar {
    background: white !important;
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.8) !important;
    border-radius: 10px !important;
}

/* ELEMENTO DESTACADO COM EFEITO DRAM√ÅTICO */
.introjs-helperLayer {
    background: transparent !important;
    border: 5px solid #667eea !important;
    box-shadow: 
        0 0 0 9999px rgba(0, 0, 0, 0.92),
        0 0 30px 10px rgba(102, 126, 234, 0.8),
        inset 0 0 30px rgba(102, 126, 234, 0.3) !important;
    border-radius: 12px !important;
    animation: elementPulse 2s ease-in-out infinite !important;
}

@keyframes elementPulse {
    0%, 100% {
        box-shadow: 
            0 0 0 9999px rgba(0, 0, 0, 0.92),
            0 0 30px 10px rgba(102, 126, 234, 0.8),
            inset 0 0 30px rgba(102, 126, 234, 0.3);
        border-color: #667eea;
    }
    50% {
        box-shadow: 
            0 0 0 9999px rgba(0, 0, 0, 0.92),
            0 0 50px 20px rgba(118, 75, 162, 1),
            inset 0 0 50px rgba(118, 75, 162, 0.5);
        border-color: #764ba2;
    }
}

/* SETA GIGANTE ANIMADA APONTANDO PARA O ELEMENTO */
.introjs-helperLayer::before {
    content: '‚Üì';
    position: absolute;
    top: -80px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 5em;
    color: #667eea;
    text-shadow: 
        0 0 20px rgba(102, 126, 234, 1),
        0 0 40px rgba(102, 126, 234, 0.8),
        0 0 60px rgba(102, 126, 234, 0.6);
    animation: arrowBounce 1.5s ease-in-out infinite;
    z-index: 999999998;
    font-weight: 900;
    filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.5));
}

@keyframes arrowBounce {
    0%, 100% {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
    }
    50% {
        transform: translateX(-50%) translateY(-20px);
        opacity: 0.7;
    }
}

/* Caso o elemento esteja na parte inferior */
.introjs-helperLayer.introjs-bottom::before {
    content: '‚Üë';
    top: auto;
    bottom: -80px;
    animation: arrowBounceUp 1.5s ease-in-out infinite;
}

@keyframes arrowBounceUp {
    0%, 100% {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
    }
    50% {
        transform: translateX(-50%) translateY(20px);
        opacity: 0.7;
    }
}

/* Responsivo */
@media (max-width: 768px) {
    .introjs-tooltip {
        max-width: 90% !important;
        min-width: 90% !important;
        padding: 24px !important;
    }
    
    .introjs-tooltip-title {
        font-size: 1.6em !important;
    }
    
    .introjs-tooltiptext {
        font-size: 1em !important;
    }
    
    .introjs-helperLayer::before {
        font-size: 3.5em !important;
        top: -60px !important;
    }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SISTEMA DE SUPORTE MULTICANAL
   Footer + Bot√£o Flutuante + Modal de Feedback
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   FOOTER FIXO COM 4 CANAIS
   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

.footer-suporte {
    position: fixed;
    bottom: 0;
    left: 280px;
    right: 0;
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border-top: 2px solid var(--accent);
    padding: 16px 32px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 24px;
    z-index: 900;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
}

.footer-canal {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 20px;
    border-radius: 12px;
    text-decoration: none;
    color: white;
    font-weight: 600;
    font-size: 0.95em;
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    cursor: pointer;
    border: 2px solid transparent;
}

.footer-canal:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
}

.footer-canal.whatsapp {
    background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
}

.footer-canal.whatsapp:hover {
    border-color: #25D366;
    box-shadow: 0 6px 20px rgba(37, 211, 102, 0.5);
}

.footer-canal.email {
    background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
}

.footer-canal.email:hover {
    border-color: #3b82f6;
    box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
}

.footer-canal.ajuda {
    background: linear-gradient(135deg, #f97316 0%, #c2410c 100%);
}

.footer-canal.ajuda:hover {
    border-color: #f97316;
    box-shadow: 0 6px 20px rgba(249, 115, 22, 0.5);
}

.footer-canal.feedback {
    background: linear-gradient(135deg, #a855f7 0%, #7e22ce 100%);
}

.footer-canal.feedback:hover {
    border-color: #a855f7;
    box-shadow: 0 6px 20px rgba(168, 85, 247, 0.5);
}

.footer-canal-icon {
    font-size: 1.3em;
}

.footer-canal-text {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}

.footer-canal-title {
    font-weight: 700;
    font-size: 1em;
}

.footer-canal-subtitle {
    font-size: 0.75em;
    opacity: 0.9;
    margin-top: 2px;
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   BOT√ÉO FLUTUANTE "PRECISA DE AJUDA?"
   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

.btn-ajuda-flutuante {
    position: fixed;
    bottom: 90px;
    right: 32px;
    z-index: 999;
}

.btn-ajuda-principal {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 16px 24px;
    border-radius: 50px;
    font-weight: 700;
    font-size: 1em;
    border: none;
    cursor: pointer;
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    animation: pulseBotao 2s ease-in-out infinite;
}

@keyframes pulseBotao {
    0%, 100% {
        transform: scale(1);
        box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
    }
    50% {
        transform: scale(1.05);
        box-shadow: 0 12px 32px rgba(102, 126, 234, 0.6);
    }
}

.btn-ajuda-principal:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 12px 32px rgba(102, 126, 234, 0.6);
    animation: none;
}

.btn-ajuda-icon {
    font-size: 1.4em;
}

.menu-ajuda-expandido {
    position: absolute;
    bottom: 70px;
    right: 0;
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border-radius: 16px;
    padding: 16px;
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
    min-width: 280px;
    display: none;
    flex-direction: column;
    gap: 10px;
    border: 2px solid var(--accent);
}

.menu-ajuda-expandido.ativo {
    display: flex;
    animation: expandeMenu 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes expandeMenu {
    from {
        opacity: 0;
        transform: translateY(20px) scale(0.8);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.menu-ajuda-item {
    padding: 14px 18px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
    color: white;
    font-weight: 600;
    font-size: 0.95em;
    transition: all 0.3s ease;
    cursor: pointer;
}

.menu-ajuda-item:hover {
    transform: translateX(5px);
}

.menu-ajuda-item.whatsapp {
    background: linear-gradient(135deg, rgba(37, 211, 102, 0.2), rgba(18, 140, 126, 0.2));
    border-left: 4px solid #25D366;
}

.menu-ajuda-item.whatsapp:hover {
    background: linear-gradient(135deg, rgba(37, 211, 102, 0.3), rgba(18, 140, 126, 0.3));
}

.menu-ajuda-item.email {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(30, 64, 175, 0.2));
    border-left: 4px solid #3b82f6;
}

.menu-ajuda-item.email:hover {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(30, 64, 175, 0.3));
}

.menu-ajuda-item.ajuda {
    background: linear-gradient(135deg, rgba(249, 115, 22, 0.2), rgba(194, 65, 12, 0.2));
    border-left: 4px solid #f97316;
}

.menu-ajuda-item.ajuda:hover {
    background: linear-gradient(135deg, rgba(249, 115, 22, 0.3), rgba(194, 65, 12, 0.3));
}

.menu-ajuda-item.feedback {
    background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(126, 34, 206, 0.2));
    border-left: 4px solid #a855f7;
}

.menu-ajuda-item.feedback:hover {
    background: linear-gradient(135deg, rgba(168, 85, 247, 0.3), rgba(126, 34, 206, 0.3));
}

.menu-ajuda-icon {
    font-size: 1.5em;
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   MODAL DE FEEDBACK/SUGEST√ïES
   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

.modal-feedback-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    animation: fadeIn 0.3s ease;
}

.modal-feedback-overlay.ativo {
    display: flex;
}

.modal-feedback {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border-radius: 20px;
    padding: 32px;
    max-width: 600px;
    width: 90%;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    border: 2px solid var(--accent);
    animation: slideUp 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    max-height: 90vh;
    overflow-y: auto;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(50px) scale(0.9);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.modal-feedback-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
}

.modal-feedback-title {
    font-size: 1.8em;
    font-weight: 700;
    color: white;
    display: flex;
    align-items: center;
    gap: 12px;
}

.modal-feedback-close {
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: white;
    font-size: 1.5em;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.modal-feedback-close:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: rotate(90deg);
}

.modal-feedback-body {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.form-group-feedback {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.form-group-feedback label {
    color: white;
    font-weight: 600;
    font-size: 0.95em;
}

.form-group-feedback input,
.form-group-feedback select,
.form-group-feedback textarea {
    padding: 12px 16px;
    border-radius: 10px;
    border: 2px solid rgba(255, 255, 255, 0.1);
    background: rgba(255, 255, 255, 0.05);
    color: white;
    font-size: 1em;
    font-family: inherit;
    transition: all 0.3s ease;
}

.form-group-feedback input:focus,
.form-group-feedback select:focus,
.form-group-feedback textarea:focus {
    outline: none;
    border-color: var(--accent);
    background: rgba(255, 255, 255, 0.08);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
}

.form-group-feedback textarea {
    min-height: 120px;
    resize: vertical;
}

.form-group-feedback select option {
    background: #1e293b;
    color: white;
}

.modal-feedback-actions {
    display: flex;
    gap: 12px;
    margin-top: 24px;
}

.btn-feedback {
    flex: 1;
    padding: 14px 24px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 1em;
    border: none;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.btn-feedback-enviar {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

.btn-feedback-enviar:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.5);
}

.btn-feedback-cancelar {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border: 2px solid rgba(255, 255, 255, 0.2);
}

.btn-feedback-cancelar:hover {
    background: rgba(255, 255, 255, 0.15);
}

/* Scrollbar do modal */
.modal-feedback::-webkit-scrollbar {
    width: 8px;
}

.modal-feedback::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
}

.modal-feedback::-webkit-scrollbar-thumb {
    background: rgba(102, 126, 234, 0.5);
    border-radius: 10px;
}

.modal-feedback::-webkit-scrollbar-thumb:hover {
    background: rgba(102, 126, 234, 0.7);
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   RESPONSIVO
   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

@media (max-width: 1024px) {
    .footer-suporte {
        left: 0;
        flex-wrap: wrap;
        padding: 12px 16px;
        gap: 12px;
    }
    
    .footer-canal {
        flex: 1;
        min-width: calc(50% - 8px);
        justify-content: center;
    }
    
    .btn-ajuda-flutuante {
        bottom: 140px;
    }
}

@media (max-width: 768px) {
    .footer-canal-subtitle {
        display: none;
    }
    
    .footer-canal {
        padding: 10px 14px;
        font-size: 0.85em;
    }
    
    .btn-ajuda-principal {
        padding: 14px 20px;
        font-size: 0.9em;
    }
    
    .modal-feedback {
        padding: 24px;
        width: 95%;
    }
}
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CENTRAL DE AJUDA - CSS
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   BUSCA
   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

    background: #5568d3;
}
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CENTRAL DE AJUDA - CSS
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

/* Container principal da busca */
.ajuda-busca-container {
    margin-bottom: 32px;
}

.ajuda-busca {
    position: relative;
    max-width: 600px;
    margin: 0 auto;
}

.ajuda-busca-icon {
    position: absolute;
    left: 16px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.2em;
    color: var(--text-light);
}

.ajuda-busca input {
    width: 100%;
    padding: 14px 20px 14px 50px;
    border: 2px solid var(--border);
    border-radius: 12px;
    font-size: 1em;
    background: var(--card);
    color: var(--text);
    transition: all 0.3s ease;
}

.ajuda-busca input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.ajuda-busca-resultados {
    position: absolute;
    top: calc(100% + 8px);
    left: 0;
    right: 0;
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: 12px;
    max-height: 400px;
    overflow-y: auto;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    z-index: 1000;
}

.ajuda-busca-resultado-item {
    padding: 16px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: all 0.2s ease;
}

.ajuda-busca-resultado-item:last-child {
    border-bottom: none;
}

.ajuda-busca-resultado-item:hover {
    background: rgba(102, 126, 234, 0.05);
}

.ajuda-busca-resultado-titulo {
    font-weight: 600;
    color: var(--accent);
    margin-bottom: 4px;
}

.ajuda-busca-resultado-categoria {
    font-size: 0.85em;
    color: var(--text-light);
    margin-bottom: 8px;
}

.ajuda-busca-resultado-preview {
    font-size: 0.9em;
    color: var(--text);
    line-height: 1.5;
}

/* Navega√ß√£o de categorias */
.ajuda-nav {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 16px;
    margin-bottom: 32px;
}

.ajuda-nav-item {
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: 12px;
    padding: 20px 16px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
}

.ajuda-nav-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.2);
    border-color: var(--accent);
}

.ajuda-nav-item.ativo {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), transparent);
    border-color: var(--accent);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
}

.ajuda-nav-icon {
    font-size: 2em;
}

.ajuda-nav-titulo {
    font-weight: 600;
    font-size: 0.95em;
    color: var(--text);
}

.ajuda-nav-badge {
    display: inline-block;
    background: var(--accent);
    color: white;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.75em;
    font-weight: 700;
}

/* Grid de conte√∫do */
.ajuda-conteudo {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 24px;
}

/* Cards de artigos */
.ajuda-card {
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.ajuda-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    border-color: var(--accent);
}

.ajuda-card-icone {
    font-size: 2.5em;
    text-align: center;
}

.ajuda-card-titulo {
    font-size: 1.1em;
    font-weight: 700;
    color: var(--text);
    text-align: center;
}

.ajuda-card-descricao {
    font-size: 0.9em;
    color: var(--text-light);
    line-height: 1.6;
    text-align: center;
}

.ajuda-card-categoria {
    font-size: 0.8em;
    color: var(--accent);
    text-align: center;
    font-weight: 600;
}

.ajuda-card-footer {
    margin-top: auto;
    padding-top: 12px;
    border-top: 1px solid var(--border);
    text-align: center;
    font-size: 0.9em;
    color: var(--accent);
    font-weight: 600;
}

/* Modal de leitura */
.ajuda-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(4px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    padding: 20px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.ajuda-modal-overlay.ativo {
    opacity: 1;
    visibility: visible;
}

.ajuda-modal {
    background: var(--card);
    border-radius: 16px;
    width: 100%;
    max-width: 800px;
    max-height: 90vh;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    transform: translateY(40px);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.ajuda-modal-overlay.ativo .ajuda-modal {
    transform: translateY(0);
}

.ajuda-modal-header {
    padding: 24px;
    border-bottom: 2px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 16px;
}

.ajuda-modal-titulo {
    font-size: 1.5em;
    font-weight: 700;
    color: var(--text);
    display: flex;
    align-items: center;
    gap: 12px;
}

.ajuda-modal-close {
    background: none;
    border: none;
    font-size: 2em;
    color: var(--text-light);
    cursor: pointer;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    transition: all 0.2s ease;
}

.ajuda-modal-close:hover {
    background: rgba(255, 0, 0, 0.1);
    color: #e74c3c;
    transform: rotate(90deg);
}

.ajuda-modal-body {
    padding: 32px;
    overflow-y: auto;
    max-height: calc(90vh - 100px);
}

.ajuda-modal-body::-webkit-scrollbar {
    width: 8px;
}

.ajuda-modal-body::-webkit-scrollbar-track {
    background: var(--bg);
}

.ajuda-modal-body::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 4px;
}

.ajuda-modal-conteudo {
    line-height: 1.8;
    color: var(--text);
}

.ajuda-modal-conteudo h3 {
    font-size: 1.4em;
    margin: 24px 0 16px 0;
    color: var(--accent);
}

.ajuda-modal-conteudo h4 {
    font-size: 1.1em;
    margin: 20px 0 12px 0;
    color: var(--text);
}

.ajuda-modal-conteudo p {
    margin-bottom: 16px;
}

.ajuda-modal-conteudo ul,
.ajuda-modal-conteudo ol {
    margin: 16px 0;
    padding-left: 28px;
}

.ajuda-modal-conteudo li {
    margin-bottom: 8px;
}

.ajuda-modal-conteudo code {
    background: rgba(102, 126, 234, 0.1);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    font-size: 0.9em;
}

.ajuda-modal-conteudo .destaque {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), transparent);
    border-left: 4px solid var(--accent);
    padding: 16px;
    margin: 20px 0;
    border-radius: 8px;
}

.ajuda-modal-conteudo table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
}

.ajuda-modal-conteudo th,
.ajuda-modal-conteudo td {
    border: 1px solid var(--border);
    padding: 12px;
    text-align: left;
}

.ajuda-modal-conteudo th {
    background: rgba(102, 126, 234, 0.1);
    font-weight: 600;
}

/* Gloss√°rio */
.glossario-container {
    display: grid;
    gap: 16px;
}

.glossario-item {
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    transition: all 0.2s ease;
}

.glossario-item:hover {
    border-color: var(--accent);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
}

.glossario-termo {
    font-size: 1.2em;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 8px;
}

.glossario-definicao {
    color: var(--text);
    line-height: 1.6;
    margin-bottom: 12px;
}

.glossario-exemplo {
    font-size: 0.9em;
    color: var(--text-light);
    font-style: italic;
    padding-left: 16px;
    border-left: 3px solid var(--accent);
}

/* FAQ */
.faq-container {
    display: grid;
    gap: 16px;
}

.faq-item {
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.2s ease;
}

.faq-item.aberto {
    border-color: var(--accent);
}

.faq-pergunta {
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 16px;
    font-weight: 600;
    font-size: 1.05em;
    color: var(--text);
    cursor: pointer;
    transition: all 0.2s ease;
}

.faq-pergunta:hover {
    background: rgba(102, 126, 234, 0.05);
}

.faq-icone {
    font-size: 1.2em;
    transition: transform 0.3s ease;
    flex-shrink: 0;
}

.faq-item.aberto .faq-icone {
    transform: rotate(180deg);
}

.faq-resposta {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.faq-item.aberto .faq-resposta {
    max-height: 1000px;
}

.faq-resposta-conteudo {
    padding: 0 20px 20px 20px;
    color: var(--text);
    line-height: 1.7;
}

/* Responsivo */
@media (max-width: 1024px) {
    .ajuda-nav {
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    }
    
    .ajuda-conteudo {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    }
}

@media (max-width: 768px) {
    .ajuda-nav {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .ajuda-conteudo {
        grid-template-columns: 1fr;
    }
    
    .ajuda-modal {
        margin: 10px;
    }
}
</style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <aside class="sidebar">
        <div class="brand">
            <h1>üíº Gestor Financeiro 360¬∞</h1>
            <span class="brand-tag">PREMIUM</span>
        </div>
        <nav>
            <div class="nav-item active" onclick="irPara('inicio')"><span>üè¢</span><span>Dados da Empresa</span></div>
            <div class="nav-item" onclick="irPara('dashboard-empresas')" style="background:linear-gradient(135deg, rgba(25,118,210,0.15), transparent);border-left:4px solid var(--accent);font-weight:700">
            <span>üìä</span>
            <span>Dashboard Empresas</span>
        </div>
        
        <div style="padding:12px 20px;margin:12px 0;border-top:1px solid var(--border);border-bottom:1px solid var(--border)">
            <div style="font-size:0.75em;color:var(--text-light);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">DIAGN√ìSTICO</div>
        </div>
        
        <div class="nav-item" onclick="irPara('tesouraria')"><span>üí∞</span><span>Tesouraria</span><span class="nav-badge" id="badge-tesouraria">0/15</span></div>
            <div class="nav-item" onclick="irPara('resultados')"><span>üìà</span><span>Resultados & DRE</span><span class="nav-badge" id="badge-resultados">0/15</span></div>
            <div class="nav-item" onclick="irPara('fluxo')"><span>üíµ</span><span>Fluxo de Caixa</span><span class="nav-badge" id="badge-fluxo">0/15</span></div>
            <div class="nav-item" onclick="irPara('orcamento')"><span>üìä</span><span>Or√ßamento</span><span class="nav-badge" id="badge-orcamento">0/15</span></div>
            <div class="nav-item" onclick="irPara('investimentos')"><span>üöÄ</span><span>Investimentos</span><span class="nav-badge" id="badge-investimentos">0/15</span></div>
            <div class="nav-item" onclick="irPara('riscos')"><span>üõ°Ô∏è</span><span>Riscos Financeiros</span><span class="nav-badge" id="badge-riscos">0/15</span></div>
            <div class="nav-item" onclick="irPara('indicadores')"><span>üî¢</span><span>Indicadores Financeiros</span><span class="nav-badge" id="badge-indicadores">0/15</span></div>
            <div class="nav-item" onclick="irPara('tributario')"><span>üìú</span><span>Planejamento Tribut√°rio</span><span class="nav-badge" id="badge-tributario">0/15</span></div>
            
            <div style="padding:12px 20px;margin:12px 0;border-top:1px solid var(--border);border-bottom:1px solid var(--border)">
                <div style="font-size:0.75em;color:var(--text-light);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">AN√ÅLISE</div>
            </div>
            
            <div class="nav-item" onclick="irPara('historico-diagnosticos')"><span>üìÖ</span><span>Hist√≥rico de Diagn√≥sticos</span></div>
            <div class="nav-item" onclick="irPara('scoring')"><span>üéØ</span><span>Score & Dashboard</span></div>
            <div class="nav-item" onclick="irPara('swot')"><span>üìä</span><span>An√°lise SWOT</span></div>
            <div class="nav-item" onclick="irPara('calculadora')"><span>üí∞</span><span>Perdas & Ganhos</span></div>
            <div class="nav-item" onclick="irPara('analise-riscos')"><span>üõ°Ô∏è</span><span>Mapa de Riscos</span></div>
            <div class="nav-item" onclick="irPara('plano')"><span>üìã</span><span>Plano de A√ß√£o</span></div>
            <div class="nav-item" onclick="irPara('okrs')"><span>üéØ</span><span>OKRs Estrat√©gicos</span></div>
            <div class="nav-item" onclick="irPara('resumo')"><span>üìÑ</span><span>Relat√≥rio Executivo</span></div>
            <div class="nav-item" onclick="irPara('proposta-comercial')"><span>üíº</span><span>Proposta Comercial</span></div>
        <div class="nav-item" onclick="irPara('historico-propostas'); inicializarHistorico();"><span>üìö</span><span>Hist√≥rico de Propostas</span></div>
        <div class="nav-item" onclick="irPara('ajuda')"><span>üìö</span><span>Central de Ajuda</span></div>
        <div class="nav-item" onclick="irPara('ebook')"><span>üìñ</span><span>Ebook Premium</span></div>
        <!-- Bot√£o Ver Tour Novamente -->
        <div style="padding:20px;margin-top:20px;border-top:1px solid var(--border)">
            <button class="btn-tour" onclick="verTourNovamente()" style="width:100%;display:flex;align-items:center;justify-content:center;gap:8px">
                <span style="font-size:1.2em">üéØ</span>
                <span>Ver Tour Novamente</span>
            </button>
            <div style="font-size:0.75em;color:var(--text-light);text-align:center;margin-top:8px">
                Revisitar o guia de introdu√ß√£o
            </div>
        </div>
        
        </nav>
    </aside>
    
    <main class="main">
        <header class="header">
            <h2 class="title">Diagn√≥stico <span id="page-name" style="color:var(--accent)">Inicial</span></h2>
            <div style="display:flex;gap:12px">
                <button class="btn-secondary" onclick="irPara('dashboard-empresas')" style="display:flex;align-items:center;gap:6px">üìä Empresas</button>
                <button style="width:40px;height:40px;border-radius:8px;border:1px solid var(--border);background:var(--card);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.2em" onclick="toggleTema()">üåì</button>
                <button class="btn" onclick="salvarProgresso()">üíæ Salvar</button>
            </div>
        </header>
        <div class="content">
            <div class="progress">
                <div class="progress-header"><span>Progresso do Diagn√≥stico</span><span id="progress-txt" style="color:var(--accent);font-weight:700">0% (0/75)</span></div>
                <div class="progress-bar-bg"><div class="progress-bar-fill" id="progress-bar" style="width:0%"></div></div>
            </div>
            
            
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- DASHBOARD DE EMPRESAS (MULTI-EMPRESAS) -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section id="dashboard-empresas" class="section active">
            <div style="max-width:1400px;margin:0 auto;padding:40px 20px">
                
                <!-- Header -->
                <div style="text-align:center;margin-bottom:48px">
                    <h1 style="font-size:2.5em;margin-bottom:12px;background:linear-gradient(135deg, var(--accent), #00bcd4);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text">
                        üìä Gerenciador de Empresas
                    </h1>
                    <p style="color:var(--text-light);font-size:1.1em">
                        Gerencie at√© 50 empresas e seus diagn√≥sticos financeiros
                    </p>
                </div>
                
                <!-- Barra de a√ß√µes -->
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;gap:16px;flex-wrap:wrap">
                    <div style="display:flex;gap:12px;flex-wrap:wrap">
                        <button onclick="abrirModalNovaEmpresa()" class="btn-primary" style="display:flex;align-items:center;gap:8px">
                            <span style="font-size:1.2em">‚ûï</span>
                            Nova Empresa
                        </button>
                        <button onclick="importarEmpresas()" class="btn-secondary" style="display:flex;align-items:center;gap:8px">
                            üì• Importar
                        </button>
                        <button onclick="exportarEmpresas()" class="btn-secondary" style="display:flex;align-items:center;gap:8px">
                            üì§ Exportar
                        </button>
                    </div>
                    
                    <div style="position:relative;flex:1;max-width:400px">
                        <input type="text" id="busca-empresa" placeholder="üîç Buscar empresa..." 
                               onkeyup="filtrarEmpresas()"
                               style="width:100%;padding:12px 16px;border:2px solid var(--border);border-radius:12px;font-size:1em;background:var(--card-bg)">
                    </div>
                </div>
                
                <!-- Contador e estat√≠sticas -->
                <div style="background:linear-gradient(135deg, rgba(25,118,210,0.1), transparent);border:2px solid var(--accent);border-radius:16px;padding:20px;margin-bottom:32px">
                    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:20px">
                        <div>
                            <div style="font-size:2em;font-weight:700;color:var(--accent)" id="total-empresas">0</div>
                            <div style="color:var(--text-light)">Empresas cadastradas</div>
                        </div>
                        <div>
                            <div style="font-size:1.5em;font-weight:700" id="limite-empresas">0/50</div>
                            <div style="color:var(--text-light)">Limite dispon√≠vel</div>
                        </div>
                        <div>
                            <div style="font-size:1.5em;font-weight:700;color:#00c853" id="empresas-ativas">0</div>
                            <div style="color:var(--text-light)">Com diagn√≥sticos</div>
                        </div>
                    </div>
                </div>
                
                <!-- Lista de empresas (cards) -->
                <div id="lista-empresas" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:24px">
                    <!-- Cards ser√£o inseridos aqui via JavaScript -->
                </div>
                
                <!-- Mensagem quando vazio -->
                <div id="msg-vazia" style="display:none;text-align:center;padding:60px 20px">
                    <div style="font-size:4em;margin-bottom:16px;opacity:0.3">üìä</div>
                    <h3 style="margin-bottom:12px;color:var(--text-light)">Nenhuma empresa cadastrada</h3>
                    <p style="color:var(--text-light);margin-bottom:24px">Clique em "Nova Empresa" para come√ßar</p>
                    <button onclick="abrirModalNovaEmpresa()" class="btn-primary">
                        ‚ûï Cadastrar Primeira Empresa
                    </button>
                </div>
                
            </div>
        </section>
        
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- MODAL - NOVA/EDITAR EMPRESA -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="modal-empresa" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:10000;align-items:center;justify-content:center">
            <div style="background:var(--card-bg);border-radius:20px;max-width:600px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,0.3)">
                
                <!-- Header -->
                <div style="padding:24px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center">
                    <h2 style="margin:0;font-size:1.5em" id="modal-empresa-titulo">‚ûï Nova Empresa</h2>
                    <button onclick="fecharModalEmpresa()" style="background:none;border:none;font-size:1.5em;cursor:pointer;padding:8px">‚úï</button>
                </div>
                
                <!-- Formul√°rio -->
                <div style="padding:24px">
                    <form id="form-empresa" onsubmit="salvarEmpresa(event)">
                        <input type="hidden" id="empresa-id-edit">
                        
                        <div class="form-group">
                            <label class="form-label">Nome da Empresa *</label>
                            <input type="text" class="form-input" id="empresa-nome" required 
                                   placeholder="Ex: ABC Comercial Ltda">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Respons√°vel *</label>
                            <input type="text" class="form-input" id="empresa-responsavel" required 
                                   placeholder="Ex: Jo√£o Silva">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Setor de Atua√ß√£o</label>
                            <select class="form-select" id="empresa-setor">
                                <option value="">Selecione...</option>
                                <option value="comercio">üè™ Com√©rcio (Varejo/Atacado)</option>
                                <option value="servicos">üõ†Ô∏è Servi√ßos (Profissional/T√©cnico)</option>
                                <option value="industria">üè≠ Ind√∫stria (Manufatura/Produ√ß√£o)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Porte da Empresa</label>
                            <select class="form-select" id="empresa-porte">
                                <option value="">Selecione...</option>
                                <option value="micro">üìå Microempresa (at√© R$ 360k/ano)</option>
                                <option value="pequena">üìä Pequena Empresa (at√© R$ 4,8M/ano)</option>
                                <option value="media">üè¢ M√©dia Empresa (at√© R$ 300M/ano)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Faturamento Mensal Aproximado</label>
                            <input type="text" class="form-input" id="empresa-faturamento" 
                                   placeholder="Ex: R$ 100.000">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Cidade/Estado</label>
                            <input type="text" class="form-input" id="empresa-cidade" 
                                   placeholder="Ex: S√£o Paulo, SP">
                        </div>
                        
                        <div style="display:flex;gap:12px;margin-top:32px">
                            <button type="submit" class="btn-primary" style="flex:1">
                                üíæ Salvar Empresa
                            </button>
                            <button type="button" onclick="fecharModalEmpresa()" class="btn-secondary">
                                Cancelar
                            </button>
                        </div>
                    </form>
                </div>
                
            </div>
        </div>
        
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- TELA DE HIST√ìRICO DE DIAGN√ìSTICOS -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="historico-diagnosticos" class="section">
    <div style="max-width:1400px;margin:0 auto;padding:40px 20px">
        
        <!-- Header com info da empresa -->
        <div style="background:linear-gradient(135deg, rgba(25,118,210,0.1), transparent);border:2px solid var(--accent);border-radius:16px;padding:24px;margin-bottom:32px">
            <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:16px">
                <div>
                    <h1 style="margin:0 0 8px 0;font-size:2em;color:var(--accent)">
                        üìä Hist√≥rico de Diagn√≥sticos
                    </h1>
                    <div id="historico-empresa-nome" style="color:var(--text-light);font-size:1.1em">
                        Carregando...
                    </div>
                </div>
                <button onclick="voltarDashboard()" class="btn-secondary" style="display:flex;align-items:center;gap:8px">
                    <span>üè¢</span>
                    <span>Trocar Empresa</span>
                </button>
            </div>
        </div>
        
        <!-- Barra de a√ß√µes -->
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;gap:16px;flex-wrap:wrap">
            <button onclick="criarNovoDiagnostico()" class="btn-primary" style="display:flex;align-items:center;gap:8px;font-size:1.05em">
                <span style="font-size:1.2em">‚ûï</span>
                Novo Diagn√≥stico
            </button>
            
            <div style="display:flex;gap:12px;align-items:center">
                <div id="contador-diagnosticos" style="color:var(--text-light);font-weight:600">
                    0 diagn√≥sticos
                </div>
                <button onclick="exportarHistorico()" class="btn-secondary">
                    üì§ Exportar Hist√≥rico
                </button>
            </div>
        </div>
        
        <!-- Lista de diagn√≥sticos -->
        <div id="lista-diagnosticos">
            <!-- Ser√° preenchido via JavaScript -->
        </div>
        
        <!-- Mensagem quando vazio -->
        <div id="msg-vazia-historico" style="display:none;text-align:center;padding:60px 20px">
            <div style="font-size:4em;margin-bottom:16px;opacity:0.3">üìä</div>
            <h3 style="margin-bottom:12px;color:var(--text-light)">Nenhum diagn√≥stico realizado</h3>
            <p style="color:var(--text-light);margin-bottom:24px">Clique em "Novo Diagn√≥stico" para come√ßar</p>
            <button onclick="criarNovoDiagnostico()" class="btn-primary">
                ‚ûï Criar Primeiro Diagn√≥stico
            </button>
        </div>
        
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- MODAL - NOVO DIAGN√ìSTICO -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="modal-novo-diagnostico" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:10000;align-items:center;justify-content:center">
    <div style="background:var(--card-bg);border-radius:20px;max-width:500px;width:90%;box-shadow:0 20px 60px rgba(0,0,0,0.3)">
        
        <div style="padding:24px;border-bottom:1px solid var(--border)">
            <h2 style="margin:0;font-size:1.5em">‚ûï Novo Diagn√≥stico</h2>
        </div>
        
        <div style="padding:24px">
            <form id="form-novo-diagnostico" onsubmit="salvarNovoDiagnostico(event)">
                <div class="form-group">
                    <label class="form-label">Nome do Diagn√≥stico *</label>
                    <input type="text" class="form-input" id="nome-diagnostico" required 
                           placeholder="Ex: Diagn√≥stico Q1 2025">
                    <small style="color:var(--text-light);font-size:0.85em;margin-top:4px;display:block">
                        Escolha um nome que ajude a identificar este diagn√≥stico futuramente
                    </small>
                </div>
                
                <div style="display:flex;gap:12px;margin-top:24px">
                    <button type="submit" class="btn-primary" style="flex:1">
                        üöÄ Criar e Iniciar
                    </button>
                    <button type="button" onclick="fecharModalNovoDiagnostico()" class="btn-secondary">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
        
    </div>
</div>


<section id="inicio" class="section">
                
                <!-- Header da Empresa Ativa -->
                <div id="empresa-ativa-header" style="background:linear-gradient(135deg, rgba(25,118,210,0.1), transparent);border:2px solid var(--accent);border-radius:16px;padding:20px 24px;margin-bottom:24px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:16px">
                    <div style="flex:1">
                        <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px;text-transform:uppercase;letter-spacing:1px">Empresa Selecionada</div>
                        <h2 id="empresa-ativa-nome" style="margin:0;font-size:1.5em;color:var(--accent)">-</h2>
                        <div id="empresa-ativa-info" style="color:var(--text-light);font-size:0.9em;margin-top:4px">-</div>
                    </div>
                    <button onclick="voltarDashboard()" class="btn-primary" style="display:flex;align-items:center;gap:8px;font-weight:700;padding:12px 24px">
                        <span>üè¢</span>
                        <span>Trocar Empresa</span>
                    </button>
                </div>
                
                <div class="card">
                    <div class="card-header"><div class="card-icon">üè¢</div><div><h3 class="card-title">Dados da Empresa</h3><p style="color:var(--text-light);margin-top:4px">Informa√ß√µes para diagn√≥stico personalizado</p></div></div>
                    
                    <div class="alert info"><span style="font-size:1.5em">üí°</span><div><div style="font-weight:700;margin-bottom:4px">Diagn√≥stico Inteligente e Adaptativo</div><p style="font-size:0.9em;line-height:1.5;opacity:0.9">O sistema adapta as perguntas ao seu PORTE e SETOR, garantindo relev√¢ncia m√°xima. Tempo estimado: 20-40min conforme o porte.</p></div></div>
                    
                    <form id="form-dados" onsubmit="event.preventDefault();iniciarDiagnostico()">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Nome da Empresa *</label>
                                <input type="text" class="form-input" id="nome-empresa" placeholder="Ex: Empresa ABC Ltda" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Respons√°vel *</label>
                                <input type="text" class="form-input" id="responsavel" placeholder="Ex: Jo√£o Silva" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Setor de Atua√ß√£o *</label>
                                <select class="form-select" id="setor" required onchange="atualizarInfoPorte()">
                                    <option value="">Selecione...</option>
                                    <option value="comercio">üè™ Com√©rcio (Varejo/Atacado)</option>
                                    <option value="servicos">üõ†Ô∏è Servi√ßos (Consultoria, TI, etc)</option>
                                    <option value="industria">üè≠ Ind√∫stria (Manufatura/Produ√ß√£o)</option>
                                </select>
                                <small style="color:var(--text-light);font-size:0.85em;margin-top:4px;display:block">O diagn√≥stico priorizar√° perguntas relevantes ao seu setor</small>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Porte da Empresa *</label>
                                <select class="form-select" id="porte" required onchange="atualizarInfoPorte()">
                                    <option value="">Selecione...</option>
                                    <option value="micro">üìå Microempresa (at√© R$ 360k/ano)</option>
                                    <option value="pequena">üìä Pequena Empresa (at√© R$ 4,8M/ano)</option>
                                    <option value="media">üè¢ M√©dia Empresa (at√© R$ 300M/ano)</option>
                                </select>
                                <small id="info-porte" style="color:var(--accent);font-size:0.85em;margin-top:4px;display:block;font-weight:600"></small>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Faturamento Mensal Aproximado</label>
                                <input type="text" class="form-input" id="faturamento" placeholder="Ex: R$ 100.000">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Cidade/Estado</label>
                                <input type="text" class="form-input" id="cidade" placeholder="Ex: S√£o Paulo, SP">
                            </div>
                        </div>
                        
                        <!-- Info Box Adaptativo -->
                        <div id="info-diagnostico" style="background:linear-gradient(135deg, rgba(25,118,210,0.1), transparent);border:2px solid var(--accent);border-radius:12px;padding:20px;margin-top:24px;display:none">
                            <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
                                <span style="font-size:2em">üéØ</span>
                                <div>
                                    <div style="font-weight:700;font-size:1.1em;color:var(--accent)" id="titulo-diagnostico"></div>
                                    <div style="color:var(--text-light);font-size:0.9em;margin-top:4px" id="subtitulo-diagnostico"></div>
                                </div>
                            </div>
                            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:16px">
                                <div style="background:var(--card);padding:12px;border-radius:8px;border-left:3px solid var(--accent)">
                                    <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">Perguntas</div>
                                    <div style="font-size:1.3em;font-weight:700;color:var(--accent)" id="info-perguntas">-</div>
                                </div>
                                <div style="background:var(--card);padding:12px;border-radius:8px;border-left:3px solid var(--success)">
                                    <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">Tempo Estimado</div>
                                    <div style="font-size:1.3em;font-weight:700;color:var(--success)" id="info-tempo">-</div>
                                </div>
                                <div style="background:var(--card);padding:12px;border-radius:8px;border-left:3px solid var(--gold)">
                                    <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">Foco</div>
                                    <div style="font-size:1.3em;font-weight:700;color:var(--gold)" id="info-foco">-</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top:32px;text-align:right">
                            <button type="submit" class="btn" style="padding:16px 48px;font-size:1.1em">Iniciar Diagn√≥stico Adaptativo üöÄ</button>
                        </div>
                    </form>
                </div>
            </section>
            
            <section id="tesouraria" class="section"><div id="area-tesouraria"></div></section>
            <section id="resultados" class="section"><div id="area-resultados"></div></section>
            <section id="fluxo" class="section"><div id="area-fluxo"></div></section>
            <section id="orcamento" class="section"><div id="area-orcamento"></div></section>
            <section id="investimentos" class="section"><div id="area-investimentos"></div></section>
            <section id="riscos" class="section"><div id="area-riscos"></div></section>
            <section id="indicadores" class="section"><div id="area-indicadores"></div></section>
            <section id="tributario" class="section"><div id="area-tributario"></div></section>
            <section id="scoring" class="section"><div id="area-scoring"></div></section>
            <section id="swot" class="section"><div id="area-swot"></div></section>
            <section id="calculadora" class="section"><div id="area-calculadora"></div></section>
            <section id="analise-riscos" class="section"><div id="area-analise-riscos"></div></section>
            <section id="plano" class="section"><div id="area-plano"></div></section>
            <section id="okrs" class="section"><div id="area-okrs"></div></section>
            <section id="resumo" class="section"><div id="area-resumo"></div></section>
            <section id="proposta-comercial" class="section">
<div class="container">
    
    <!-- Header -->
    <div class="proposta-header">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <div>
                <h1 style="margin: 0;">üíº Proposta Comercial Inteligente</h1>
                <p style="margin: 8px 0 0 0;">Sistema completo com 11 produtos + integra√ß√£o com diagn√≥stico + bloqueio de pr√©-requisitos</p>
            </div>
            <div style="display: flex; gap: 12px;">
                <button type="button" 
                        onclick="abrirModalSalvar()" 
                        style="background: linear-gradient(135deg, #27ae60 0%, #229954 100%); 
                               color: white; 
                               border: none; 
                               padding: 16px 32px; 
                               border-radius: 12px; 
                               font-size: 16px; 
                               font-weight: 700; 
                               cursor: pointer; 
                               box-shadow: 0 4px 15px rgba(39, 174, 96, 0.4);
                               transition: all 0.3s;
                               white-space: nowrap;"
                        onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(39, 174, 96, 0.6)';"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(39, 174, 96, 0.4)';">
                    üíæ Salvar Proposta
                </button>
                <button type="button"
                        onclick="gerarPDFProposta()" 
                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                               color: white; 
                               border: none; 
                               padding: 16px 32px; 
                               border-radius: 12px; 
                               font-size: 16px; 
                               font-weight: 700; 
                               cursor: pointer; 
                               box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                               transition: all 0.3s;
                               white-space: nowrap;"
                        onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.6)';"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)';">
                    üìÑ Gerar Proposta em PDF
                </button>
            </div>
        </div>
    </div>
    
    <!-- Resumo do Diagn√≥stico -->
    <div class="diagnostico-resumo">
        <h2>üìä Resumo do Diagn√≥stico - <span id="empresa-nome">Carregando...</span></h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; margin-bottom: 24px;">
            <div style="background: linear-gradient(135deg, #ffebee, #ffcdd2); padding: 20px; border-radius: 12px; text-align: center; border: 2px solid #ef5350;">
                <div style="color: #c62828; font-size: 0.9em; margin-bottom: 8px; font-weight: 600;">üí∏ Perdas Identificadas</div>
                <div style="font-size: 2em; font-weight: 800; color: #d32f2f;" id="perdas-totais">R$ 0/ano</div>
            </div>
            <div style="background: linear-gradient(135deg, #e8f5e9, #c8e6c9); padding: 20px; border-radius: 12px; text-align: center; border: 2px solid #66bb6a;">
                <div style="color: #2e7d32; font-size: 0.9em; margin-bottom: 8px; font-weight: 600;">üí∞ Ganhos Potenciais</div>
                <div style="font-size: 2em; font-weight: 800; color: #2e7d32;" id="ganhos-totais">R$ 0/ano</div>
            </div>
            <div style="background: linear-gradient(135deg, #e3f2fd, #bbdefb); padding: 20px; border-radius: 12px; text-align: center; border: 2px solid #42a5f5;">
                <div style="color: #1565c0; font-size: 0.9em; margin-bottom: 8px; font-weight: 600;">üìä Score Geral</div>
                <div style="font-size: 2em; font-weight: 800; color: #1976d2;" id="score-geral">0/100</div>
            </div>
        </div>
        
        <h3 style="margin: 24px 0 12px 0; color: #555; font-size: 1.1em;">Scores por Categoria:</h3>
        <div class="scores-categorias" id="scores-categorias">
            <!-- Preenchido via JavaScript -->
        </div>
        
        <div id="categorias-criticas" style="display: none; margin-top: 24px; padding: 16px; background: #ffebee; border-left: 4px solid #f44336; border-radius: 8px;">
            <strong style="color: #c62828;">üéØ Categorias CR√çTICAS que requerem aten√ß√£o urgente:</strong>
            <p style="margin: 8px 0 0 0; color: #d32f2f; font-weight: 600;" id="lista-criticas"></p>
        </div>
    </div>
    
    <!-- Conte√∫do Principal -->
    <div class="main-content" id="produtos-container">
        <!-- Produtos ser√£o inseridos via JavaScript -->
    </div>
    

                
                <!-- PACOTES PRONTOS (com valores edit√°veis) -->
                <div class="pacotes-section">
                    <div class="pacotes-header">
                        <h2>üéÅ Ou Escolha um Pacote Pronto</h2>
                        <p>Economize at√© 25% selecionando um de nossos pacotes pr√©-configurados (valores personaliz√°veis)</p>
                    </div>
                    
                    <div class="pacotes-grid">
                        <!-- Pacote Funda√ß√£o -->
                        <div class="pacote-card" data-pacote="fundacao">
                            <div class="pacote-badge">üèóÔ∏è B√ÅSICO</div>
                            <h3>Funda√ß√£o Financeira</h3>
                            <p class="pacote-desc">Base essencial para estrutura√ß√£o financeira</p>
                            
                            <div class="pacote-info">
                                <div class="pacote-produtos">3 produtos (N√≠vel 1)</div>
                                <div class="pacote-lista">
                                    ‚úì Tesouraria<br>
                                    ‚úì Fluxo de Caixa<br>
                                    ‚úì DRE Gerencial
                                </div>
                            </div>
                            
                            <div class="pacote-preco">
                                <div class="preco-original">De: R$ <span class="valor-original-fundacao">15.000</span></div>
                                <div class="preco-desconto">Sugerido: R$ <span class="valor-desconto-fundacao">13.500</span></div>
                                <div class="economia">üí∞ Economize <span class="economia-fundacao">10%</span></div>
                                
                                <div class="campo-editavel" style="margin-top: 16px;">
                                    <label class="campo-editavel-label" style="color: #667eea;">üíµ Seu Valor (R$)</label>
                                    <input type="number" 
                                           class="campo-editavel-input" 
                                           id="valor-pacote-fundacao" 
                                           value="13500" 
                                           min="0" 
                                           step="100" 
                                           style="text-align: center; font-weight: 700;">
                                </div>
                            </div>
                            
                            <button class="btn-selecionar-pacote" onclick="selecionarPacote('fundacao')">
                                Selecionar Pacote
                            </button>
                        </div>
                        
                        <!-- Pacote Crescimento -->
                        <div class="pacote-card pacote-destaque" data-pacote="crescimento">
                            <div class="pacote-badge pacote-badge-destaque">üöÄ POPULAR</div>
                            <h3>Crescimento Estruturado</h3>
                            <p class="pacote-desc">Para empresas em expans√£o acelerada</p>
                            
                            <div class="pacote-info">
                                <div class="pacote-produtos">6 produtos (N√≠veis 1+2)</div>
                                <div class="pacote-lista">
                                    ‚úì Base Funda√ß√£o (3)<br>
                                    ‚úì + Or√ßamento Anual<br>
                                    ‚úì + Gest√£o de Custos<br>
                                    ‚úì + Investimentos
                                </div>
                            </div>
                            
                            <div class="pacote-preco">
                                <div class="preco-original">De: R$ <span class="valor-original-crescimento">35.000</span></div>
                                <div class="preco-desconto">Sugerido: R$ <span class="valor-desconto-crescimento">29.750</span></div>
                                <div class="economia">üí∞ Economize <span class="economia-crescimento">15%</span></div>
                                
                                <div class="campo-editavel" style="margin-top: 16px;">
                                    <label class="campo-editavel-label" style="color: #667eea;">üíµ Seu Valor (R$)</label>
                                    <input type="number" 
                                           class="campo-editavel-input" 
                                           id="valor-pacote-crescimento" 
                                           value="29750" 
                                           min="0" 
                                           step="100" 
                                           style="text-align: center; font-weight: 700;">
                                </div>
                            </div>
                            
                            <button class="btn-selecionar-pacote btn-destaque" onclick="selecionarPacote('crescimento')">
                                Selecionar Pacote
                            </button>
                        </div>
                        
                        <!-- Pacote Excel√™ncia -->
                        <div class="pacote-card" data-pacote="excelencia">
                            <div class="pacote-badge">‚≠ê AVAN√áADO</div>
                            <h3>Excel√™ncia Operacional</h3>
                            <p class="pacote-desc">Gest√£o financeira de classe mundial</p>
                            
                            <div class="pacote-info">
                                <div class="pacote-produtos">9 produtos (N√≠veis 1+2+3)</div>
                                <div class="pacote-lista">
                                    ‚úì Base Crescimento (6)<br>
                                    ‚úì + Dashboard KPIs<br>
                                    ‚úì + Gest√£o de Riscos<br>
                                    ‚úì + Planej. Tribut√°rio
                                </div>
                            </div>
                            
                            <div class="pacote-preco">
                                <div class="preco-original">De: R$ <span class="valor-original-excelencia">62.000</span></div>
                                <div class="preco-desconto">Sugerido: R$ <span class="valor-desconto-excelencia">49.600</span></div>
                                <div class="economia">üí∞ Economize <span class="economia-excelencia">20%</span></div>
                                
                                <div class="campo-editavel" style="margin-top: 16px;">
                                    <label class="campo-editavel-label" style="color: #667eea;">üíµ Seu Valor (R$)</label>
                                    <input type="number" 
                                           class="campo-editavel-input" 
                                           id="valor-pacote-excelencia" 
                                           value="49600" 
                                           min="0" 
                                           step="100" 
                                           style="text-align: center; font-weight: 700;">
                                </div>
                            </div>
                            
                            <button class="btn-selecionar-pacote" onclick="selecionarPacote('excelencia')">
                                Selecionar Pacote
                            </button>
                        </div>
                        
                        <!-- Pacote Premium -->
                        <div class="pacote-card pacote-premium" data-pacote="premium">
                            <div class="pacote-badge pacote-badge-premium">üëë VIP</div>
                            <h3>Premium Completo</h3>
                            <p class="pacote-desc">Transforma√ß√£o financeira total + acompanhamento</p>
                            
                            <div class="pacote-info">
                                <div class="pacote-produtos">11 produtos (Todos + Recorrentes)</div>
                                <div class="pacote-lista">
                                    ‚úì Base Excel√™ncia (9)<br>
                                    ‚úì + Plano de A√ß√£o PRO<br>
                                    ‚úì + Consultoria Mensal<br>
                                    <span style="color:#ffd700">‚òÖ Acompanhamento cont√≠nuo</span>
                                </div>
                            </div>
                            
                            <div class="pacote-preco">
                                <div class="preco-original">De: R$ <span class="valor-original-premium">80.000</span></div>
                                <div class="preco-desconto">Sugerido: R$ <span class="valor-desconto-premium">60.000</span></div>
                                <div class="economia">üí∞ Economize <span class="economia-premium">25%</span></div>
                                
                                <div class="campo-editavel" style="margin-top: 16px;">
                                    <label class="campo-editavel-label" style="color: #667eea;">üíµ Seu Valor (R$)</label>
                                    <input type="number" 
                                           class="campo-editavel-input" 
                                           id="valor-pacote-premium" 
                                           value="60000" 
                                           min="0" 
                                           step="100" 
                                           style="text-align: center; font-weight: 700;">
                                </div>
                            </div>
                            
                            <button class="btn-selecionar-pacote btn-premium" onclick="selecionarPacote('premium')">
                                Selecionar Pacote
                            </button>
                        </div>
                    </div>
                    
                    <div class="pacotes-footer">
                        <p>üí° <strong>Dica:</strong> Selecione o pacote e customize os valores conforme sua necessidade!</p>
                    </div>
                </div>
                

    <!-- Preview Sidebar (STICKY) -->
    <div class="preview-sidebar">
        <div class="preview-header">
            <h3>üìã Proposta em Constru√ß√£o</h3>
            <span class="preview-contador" id="contador-produtos">0 produtos selecionados</span>
        </div>
        
        <div class="preview-produtos" id="preview-produtos-lista">
            <div style="text-align: center; padding: 40px 20px; color: #999;">
                <div style="font-size: 3em; margin-bottom: 12px;">üõí</div>
                <p>Nenhum produto selecionado</p>
                <p style="font-size: 0.85em; margin-top: 8px;">Marque os checkboxes acima</p>
            </div>
        </div>
        
        <div class="preview-totais">
            <div class="preview-total-item">
                <span>üíµ One-time:</span>
                <strong id="total-onetime">R$ 0</strong>
            </div>
            <div class="preview-total-item">
                <span>üîÑ Recorrente/m√™s:</span>
                <strong id="total-recorrente">R$ 0/m√™s</strong>
            </div>
            <div class="preview-total-item">
                <span>üìÖ 12 meses:</span>
                <strong id="total-12meses">R$ 0</strong>
            </div>
            <div class="preview-total-item destaque">
                <span>TOTAL GERAL:</span>
                <strong id="total-geral">R$ 0</strong>
            </div>
        </div>
        
        <div class="preview-roi">
            <h4>‚è±Ô∏è ROI PROJETADO</h4>
            <div class="preview-roi-value" id="roi-value">0%</div>
            <div class="preview-roi-subtitle">em <span id="roi-meses">12</span> meses</div>
        </div>
        
        <div class="preview-acoes">
            <button class="btn-preview btn-preview-primary" onclick="gerarPDFProposta()">
                üìÑ Gerar PDF da Proposta
            </button>
            <button class="btn-preview btn-preview-secondary" onclick="salvarRascunho()">
                üíæ Salvar Rascunho
            </button>
        </div>
    </div>
    
</div>

<!-- Overlay e Alerta de Bloqueio -->
<div class="alerta-overlay" id="alerta-overlay" onclick="fecharAlertaBloqueio()"></div>
<div class="alerta-bloqueio" id="alerta-bloqueio">
    <div style="text-align: center; margin-bottom: 24px;">
        <div style="font-size: 4em; margin-bottom: 12px;">üîí</div>
        <h3 style="color: #d32f2f; margin-bottom: 12px;">Produto Bloqueado</h3>
        <p style="color: #666; line-height: 1.6;" id="alerta-mensagem"></p>
    </div>
    <div id="alerta-acoes" style="display: flex; gap: 12px;">
        <button onclick="marcarPreRequisitos()" style="flex: 1; padding: 14px; background: #667eea; color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer;">
            ‚úÖ Marcar Pr√©-requisitos
        </button>
        <button onclick="fecharAlertaBloqueio()" style="flex: 1; padding: 14px; background: #f5f5f5; color: #666; border: none; border-radius: 10px; font-weight: 700; cursor: pointer;">
            Cancelar
        </button>
    </div>
            </section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     CENTRAL DE AJUDA - COMPLETA E LIMPA
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<section id="ajuda" class="section">
    <div class="section-header">
        <h2>üìö Central de Ajuda</h2>
        <p>Tudo o que voc√™ precisa saber para dominar a gest√£o financeira</p>
    </div>

    <!-- BUSCA -->
    <div class="ajuda-busca-container">
        <div class="ajuda-busca">
            <span class="ajuda-busca-icon">üîç</span>
            <input type="text" 
                   id="ajuda-busca-input" 
                   placeholder="Buscar artigos, tutoriais, gloss√°rio..." 
                   onkeyup="buscarAjuda(this.value)">
        </div>
        <div id="ajuda-busca-resultados" class="ajuda-busca-resultados" style="display:none"></div>
    </div>

    <!-- NAVEGA√á√ÉO -->
    <div class="ajuda-nav">
        <button class="ajuda-nav-item ativo" data-categoria="todas">
            <div class="ajuda-nav-icon">üè†</div>
            <div class="ajuda-nav-titulo">Todas</div>
            <span class="ajuda-nav-badge" id="badge-todas">35</span>
        </button>
        <button class="ajuda-nav-item" data-categoria="comecando">
            <div class="ajuda-nav-icon">üöÄ</div>
            <div class="ajuda-nav-titulo">Come√ßando</div>
            <span class="ajuda-nav-badge" id="badge-comecando">4</span>
        </button>
        <button class="ajuda-nav-item" data-categoria="categorias">
            <div class="ajuda-nav-icon">üìä</div>
            <div class="ajuda-nav-titulo">Categorias</div>
            <span class="ajuda-nav-badge" id="badge-categorias">8</span>
        </button>
        <button class="ajuda-nav-item" data-categoria="calculadora">
            <div class="ajuda-nav-icon">üí∞</div>
            <div class="ajuda-nav-titulo">Calculadora</div>
            <span class="ajuda-nav-badge" id="badge-calculadora">4</span>
        </button>
        <button class="ajuda-nav-item" data-categoria="plano">
            <div class="ajuda-nav-icon">üéØ</div>
            <div class="ajuda-nav-titulo">Plano de A√ß√£o</div>
            <span class="ajuda-nav-badge" id="badge-plano">4</span>
        </button>
        <button class="ajuda-nav-item" data-categoria="glossario">
            <div class="ajuda-nav-icon">üìñ</div>
            <div class="ajuda-nav-titulo">Gloss√°rio</div>
            <span class="ajuda-nav-badge" id="badge-glossario">50</span>
        </button>
        <button class="ajuda-nav-item" data-categoria="faq">
            <div class="ajuda-nav-icon">‚ùì</div>
            <div class="ajuda-nav-titulo">FAQ</div>
            <span class="ajuda-nav-badge" id="badge-faq">15</span>
        </button>
    </div>

    <!-- CONTE√öDO -->
    <div id="ajuda-conteudo" class="ajuda-conteudo"></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     EBOOK PREMIUM - GUIA DEFINITIVO
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<section id="ebook" class="section">
    <div class="ebook-header">
        <h1>üìñ Ebook Premium</h1>
        <p>Guia Definitivo da Gest√£o Financeira 360¬∞ para PMEs</p>
        <p class="ebook-subtitle">Transforme a gest√£o financeira da sua empresa com metodologia Big 4</p>
    </div>
    
    <!-- PROGRESSO -->
    <div class="ebook-progresso-card">
        <h3>üìä Progresso do Ebook</h3>
        <div class="progress-bar-ebook">
            <div class="progress-fill-ebook" style="width: 100%;">
                <span style="font-weight:bold;color:white">100%</span>
            </div>
        </div>
        <p style="text-align:center;margin-top:15px;color:#666">
            <strong>8 de 8 cap√≠tulos completos</strong> ‚Ä¢ √öltima atualiza√ß√£o: 05/02/2026
        </p>
    </div>
    
    <!-- LISTA DE CAP√çTULOS -->
    <div class="ebook-capitulos-grid">
        <!-- Cap√≠tulo 1 - COMPLETO -->
        <div class="capitulo-card capitulo-completo">
            <div class="capitulo-status">‚úÖ</div>
            <div class="capitulo-conteudo">
                <h4>CAP√çTULO 1: Tesouraria</h4>
                <p class="capitulo-desc">A Base de Tudo</p>
                <ul class="capitulo-features">
                    <li>‚úì 8 se√ß√µes completas</li>
                    <li>‚úì Caso pr√°tico: economizou R$ 200k/ano</li>
                    <li>‚úì Checklist de implementa√ß√£o</li>
                    <li>‚úì 5 pilares fundamentais</li>
                </ul>
            </div>
        </div>
        
        <!-- Cap√≠tulo 2 - COMPLETO -->
        <div class="capitulo-card capitulo-completo">
            <div class="capitulo-status">‚úÖ</div>
            <div class="capitulo-conteudo">
                <h4>CAP√çTULO 2: Resultados & DRE</h4>
                <p class="capitulo-desc">A Verdade Sobre Lucratividade</p>
                <ul class="capitulo-features">
                    <li>‚úì 7 se√ß√µes detalhadas</li>
                    <li>‚úì Caso pr√°tico: dobrou margem l√≠quida</li>
                    <li>‚úì Margens por setor de refer√™ncia</li>
                    <li>‚úì Indicadores de rentabilidade</li>
                </ul>
            </div>
        </div>
        
        <!-- Cap√≠tulos 3-8 - EM DESENVOLVIMENTO -->
        <div class="capitulo-card capitulo-completo">
            <div class="capitulo-status">‚úÖ</div>
            <div class="capitulo-conteudo">
                <h4>CAP√çTULO 3: Fluxo de Caixa</h4>
                <p class="capitulo-desc">8 se√ß√µes detalhadas</p>
            </div>
        </div>
        
        <div class="capitulo-card capitulo-completo">
            <div class="capitulo-status">‚úÖ</div>
            <div class="capitulo-conteudo">
                <h4>CAP√çTULO 4: Or√ßamento & Precifica√ß√£o</h4>
                <p class="capitulo-desc">8 se√ß√µes detalhadas</p>
            </div>
        </div>
        
        <div class="capitulo-card capitulo-completo">
            <div class="capitulo-status">‚úÖ</div>
            <div class="capitulo-conteudo">
                <h4>CAP√çTULO 5: Investimentos</h4>
                <p class="capitulo-desc">8 se√ß√µes detalhadas</p>
            </div>
        </div>
        
        <div class="capitulo-card capitulo-completo">
            <div class="capitulo-status">‚úÖ</div>
            <div class="capitulo-conteudo">
                <h4>CAP√çTULO 6: Gest√£o de Riscos</h4>
                <p class="capitulo-desc">8 se√ß√µes detalhadas</p>
            </div>
        </div>
        
        <div class="capitulo-card capitulo-completo">
            <div class="capitulo-status">‚úÖ</div>
            <div class="capitulo-conteudo">
                <h4>CAP√çTULO 7: Indicadores Financeiros</h4>
                <p class="capitulo-desc">8 se√ß√µes detalhadas</p>
            </div>
        </div>
        
        <div class="capitulo-card capitulo-completo">
            <div class="capitulo-status">‚úÖ</div>
            <div class="capitulo-conteudo">
                <h4>CAP√çTULO 8: Planejamento Tribut√°rio</h4>
                <p class="capitulo-desc">8 se√ß√µes detalhadas</p>
            </div>
        </div>
    </div>
    
    <!-- DOWNLOADS -->
    <div class="ebook-downloads-section">
        <h3>üì• Download do Ebook Completo</h3>
        <p style="text-align:center;color:#666;margin-bottom:30px;">
            Todo conte√∫do dos 8 cap√≠tulos em um √∫nico PDF profissional!
        </p>
        
        <div style="max-width:500px;margin:0 auto;">
            <div class="download-card download-disponivel download-destaque" style="margin-bottom:0;">
                <div class="download-badge">COMPLETO!</div>
                <div class="download-icon" style="font-size:4em;">üìï</div>
                <h4 style="font-size:1.5em;margin-bottom:10px;">Ebook Completo</h4>
                <p style="font-size:1.1em;margin-bottom:15px;">Todos os 8 cap√≠tulos</p>
                <div class="download-info" style="font-size:1.1em;margin-bottom:20px;">
                    <span><strong>~25-30 p√°ginas</strong></span> ‚Ä¢ <span><strong>Qualidade Big 4</strong></span>
                </div>
                <div style="background:#fff;padding:15px;border-radius:10px;margin-bottom:20px;">
                    <p style="font-size:0.95em;color:#555;margin:0;line-height:1.6;">
                        ‚úÖ Cap√≠tulo 1: Tesouraria (Base de Tudo)<br>
                        ‚úÖ Cap√≠tulo 2: Resultados & DRE<br>
                        ‚úÖ Cap√≠tulo 3: Fluxo de Caixa<br>
                        ‚úÖ Cap√≠tulo 4: Or√ßamento Empresarial<br>
                        ‚úÖ Cap√≠tulo 5: Investimentos<br>
                        ‚úÖ Cap√≠tulo 6: Riscos Financeiros<br>
                        ‚úÖ Cap√≠tulo 7: Indicadores Financeiros<br>
                        ‚úÖ Cap√≠tulo 8: Planejamento Tribut√°rio<br>
                        <br>
                        üíé Casos reais com ROI<br>
                        üíé Checklists acion√°veis<br>
                        üíé Planos de evolu√ß√£o passo a passo
                    </p>
                </div>
                <button onclick="baixarEbook()" class="btn-download-ebook btn-download-destaque" style="font-size:1.2em;padding:18px 45px;">
                    üì• Baixar Ebook Completo Agora
                </button>
            </div>
        </div>
        
        <p style="text-align:center;color:#999;margin-top:30px;font-size:0.9em;">
            üí° <strong>Dica:</strong> O PDF ser√° gerado automaticamente quando voc√™ clicar no bot√£o acima!
        </p>
    </div>
    
    <!-- DESTAQUES -->
    <div class="ebook-destaques-box">
        <h3>üíé O que voc√™ encontrar√°:</h3>
        <div class="destaques-grid">
            <div class="destaque-item">
                <span class="destaque-icon">‚úÖ</span>
                <span>8 cap√≠tulos completos ‚úÖ</span>
            </div>
            <div class="destaque-item">
                <span class="destaque-icon">‚úÖ</span>
                <span>Casos pr√°ticos com ROI quantificado</span>
            </div>
            <div class="destaque-item">
                <span class="destaque-icon">‚úÖ</span>
                <span>Checklists de implementa√ß√£o prontos</span>
            </div>
            <div class="destaque-item">
                <span class="destaque-icon">‚úÖ</span>
                <span>Tabelas e ferramentas profissionais</span>
            </div>
            <div class="destaque-item">
                <span class="destaque-icon">‚úÖ</span>
                <span>Metodologia Big 4 adaptada para PMEs</span>
            </div>
            <div class="destaque-item">
                <span class="destaque-icon">‚úÖ</span>
                <span>~25-30 p√°ginas de conte√∫do premium</span>
            </div>
        </div>
    </div>
    
    <!-- CTA -->
    <div class="ebook-cta-box">
        <div class="cta-icon">üéØ</div>
        <h3>Quer Implementar o que Aprendeu?</h3>
        <p>Nosso diagn√≥stico gratuito identifica quais cap√≠tulos s√£o mais urgentes para sua empresa</p>
        <button onclick="irPara('diagnostico')" class="btn-cta-ebook">
            üéØ Fazer Diagn√≥stico Gratuito Agora
        </button>
    </div>
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     CONTE√öDO COMPLETO DO E-BOOK - PARA GERA√á√ÉO DE PDF
     Esta se√ß√£o fica oculta na tela mas √© usada pelo html2pdf
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div id="ebook-conteudo-completo" style="display:none;">

<!-- CAP√çTULO 3: FLUXO DE CAIXA -->
<div class="ebook-capitulo" id="cap3-fluxo-caixa">
    <div class="ebook-capa-capitulo">
        <h1>üíµ CAP√çTULO 3</h1>
        <h2>FLUXO DE CAIXA</h2>
        <h3>O Cora√ß√£o Financeiro da Empresa</h3>
    </div>

    <div class="ebook-introducao">
        <h3>üéØ Introdu√ß√£o</h3>
        
        <p><strong>O que √© Fluxo de Caixa:</strong> O fluxo de caixa √© o registro e a proje√ß√£o de todas as entradas e sa√≠das de dinheiro da empresa em um determinado per√≠odo. Mais do que um simples controle, √© o instrumento que permite enxergar o futuro financeiro do neg√≥cio, antecipar problemas e aproveitar oportunidades.</p>

        <p><strong>Por que √© cr√≠tico:</strong> Enquanto o lucro no DRE pode ser positivo, a falta de caixa pode quebrar uma empresa. 60% das PMEs que fecham t√™m lucro no papel, mas n√£o conseguem pagar suas contas por falta de gest√£o adequada do fluxo de caixa. √â a diferen√ßa entre estar no azul e estar com dinheiro no banco.</p>

        <p><strong>Impacto no neg√≥cio:</strong> Empresas sem gest√£o de fluxo de caixa perdem em m√©dia 8-15% do faturamento anual em juros de emerg√™ncia, perda de descontos, e oportunidades desperdi√ßadas. Por outro lado, uma gest√£o otimizada pode liberar 5-12% do faturamento que estava "preso" em m√° administra√ß√£o.</p>
    </div>

    <div class="ebook-niveis">
        <h3>üìä N√≠veis de Maturidade</h3>

        <!-- N√çVEL CR√çTICO -->
        <div class="ebook-nivel nivel-critico">
            <h4>üî¥ N√çVEL 0-2: CR√çTICO - "Apagando Inc√™ndios"</h4>
            
            <p><strong>Caracter√≠sticas:</strong></p>
            <ul>
                <li>‚Ä¢ N√£o tem controle formal de entradas e sa√≠das</li>
                <li>‚Ä¢ Descobre que n√£o tem dinheiro quando vai pagar contas</li>
                <li>‚Ä¢ Usa frequentemente cheque especial ou empr√©stimos emergenciais</li>
                <li>‚Ä¢ N√£o sabe quanto vai ter em caixa nos pr√≥ximos 7 dias</li>
                <li>‚Ä¢ Mistura dinheiro pessoal com da empresa regularmente</li>
            </ul>

            <p><strong>Riscos espec√≠ficos:</strong></p>
            <ul>
                <li>‚Ä¢ <strong>Insolv√™ncia s√∫bita:</strong> Empresa quebra mesmo lucrando</li>
                <li>‚Ä¢ <strong>Juros exponenciais:</strong> R$ 20-50k/ano em juros desnecess√°rios</li>
                <li>‚Ä¢ <strong>Perda de credibilidade:</strong> Atrasos prejudicam relacionamentos</li>
                <li>‚Ä¢ <strong>Decis√µes precipitadas:</strong> Vende com desconto excessivo por necessidade</li>
                <li>‚Ä¢ <strong>Stress extremo:</strong> Gestor vive ansioso com dinheiro</li>
            </ul>

            <p><strong>Impacto financeiro:</strong> Perdas de <strong>8-15% do faturamento anual</strong> em juros, multas, descontos perdidos e oportunidades desperdi√ßadas.</p>

            <div class="ebook-alerta">
                <p>‚ö†Ô∏è <strong>ALERTA:</strong> Neste n√≠vel, a empresa est√° a um imprevisto de dist√¢ncia da insolv√™ncia. Uma venda grande n√£o paga ou uma despesa inesperada pode levar √† fal√™ncia mesmo com lucro no papel.</p>
            </div>
        </div>

        <!-- N√çVEL B√ÅSICO -->
        <div class="ebook-nivel nivel-basico">
            <h4>üü† N√çVEL 3-4: B√ÅSICO - "Controle M√≠nimo"</h4>
            
            <p><strong>Caracter√≠sticas:</strong></p>
            <ul>
                <li>‚Ä¢ Tem planilha b√°sica de controle (manual)</li>
                <li>‚Ä¢ Registra entradas e sa√≠das, mas com atraso de dias</li>
                <li>‚Ä¢ Consegue projetar 7-15 dias no futuro</li>
                <li>‚Ä¢ Revisa o fluxo mensalmente (n√£o semanalmente)</li>
                <li>‚Ä¢ Ainda usa cr√©dito emergencial, mas menos frequente</li>
            </ul>

            <p><strong>Limita√ß√µes:</strong></p>
            <ul>
                <li>‚Ä¢ <strong>Vis√£o curta:</strong> Proje√ß√£o de apenas 15 dias impede planejamento</li>
                <li>‚Ä¢ <strong>Dados desatualizados:</strong> Decis√µes baseadas em informa√ß√£o antiga</li>
                <li>‚Ä¢ <strong>Trabalho manual:</strong> Gasta 3-5 horas/semana atualizando planilhas</li>
                <li>‚Ä¢ <strong>Erros frequentes:</strong> Digita√ß√£o manual gera inconsist√™ncias</li>
                <li>‚Ä¢ <strong>Sem cen√°rios:</strong> N√£o prev√™ situa√ß√µes adversas</li>
            </ul>

            <p><strong>Perdas evit√°veis:</strong> <strong>4-7% do faturamento</strong> em juros desnecess√°rios, falta de planejamento para negocia√ß√µes, e erros de previs√£o.</p>

            <div class="ebook-insight">
                <p>üí° <strong>INSIGHT:</strong> Empresas neste n√≠vel sobrevivem, mas n√£o prosperam. A falta de vis√£o de m√©dio prazo (30-60 dias) impede aproveitar descontos √† vista e negociar melhores condi√ß√µes com fornecedores.</p>
            </div>
        </div>

        <!-- N√çVEL ESTRUTURADO -->
        <div class="ebook-nivel nivel-estruturado">
            <h4>üü° N√çVEL 5-7: ESTRUTURADO - "Gest√£o Profissional"</h4>
            
            <p><strong>Caracter√≠sticas:</strong></p>
            <ul>
                <li>‚Ä¢ Sistema automatizado integrado com banco</li>
                <li>‚Ä¢ Proje√ß√£o de 30-60 dias com boa precis√£o</li>
                <li>‚Ä¢ An√°lise semanal do fluxo realizado vs projetado</li>
                <li>‚Ä¢ Categoriza√ß√£o clara de entradas e sa√≠das</li>
                <li>‚Ä¢ Raramente usa cr√©dito emergencial</li>
            </ul>

            <p><strong>Benef√≠cios alcan√ßados:</strong></p>
            <ul>
                <li>‚Ä¢ <strong>Previsibilidade:</strong> Sabe exatamente quando ter√° problemas de caixa</li>
                <li>‚Ä¢ <strong>Negocia√ß√£o melhor:</strong> Consegue descontos de 3-8% √† vista</li>
                <li>‚Ä¢ <strong>Investimentos planejados:</strong> Aloca recursos sem comprometer opera√ß√£o</li>
                <li>‚Ä¢ <strong>Redu√ß√£o de juros:</strong> Elimina 80-90% dos juros emergenciais</li>
                <li>‚Ä¢ <strong>Tempo economizado:</strong> Sistema autom√°tico poupa 10+ horas/m√™s</li>
            </ul>

            <p><strong>Ganhos t√≠picos:</strong> <strong>2-4% do faturamento</strong> em economia de juros, descontos obtidos, e otimiza√ß√£o de capital de giro.</p>

            <div class="ebook-destaque">
                <p>‚≠ê <strong>DESTAQUE:</strong> Este √© o n√≠vel m√≠nimo para uma gest√£o profissional. Empresas estruturadas conseguem crescer de forma sustent√°vel porque t√™m visibilidade suficiente para planejar investimentos sem comprometer a opera√ß√£o.</p>
            </div>
        </div>

        <!-- N√çVEL OTIMIZADO -->
        <div class="ebook-nivel nivel-otimizado">
            <h4>üü¢ N√çVEL 8-10: OTIMIZADO - "Excel√™ncia Financeira"</h4>
            
            <p><strong>Caracter√≠sticas:</strong></p>
            <ul>
                <li>‚Ä¢ Proje√ß√£o de 90-180 dias com m√∫ltiplos cen√°rios</li>
                <li>‚Ä¢ Dashboard em tempo real com alertas autom√°ticos</li>
                <li>‚Ä¢ Integra√ß√£o total com ERP, bancos e fornecedores</li>
                <li>‚Ä¢ An√°lise di√°ria automatizada com KPIs avan√ßados</li>
                <li>‚Ä¢ Zero uso de cr√©dito caro; apenas planejado e negociado</li>
            </ul>

            <p><strong>Excel√™ncia operacional:</strong></p>
            <ul>
                <li>‚Ä¢ <strong>Vis√£o estrat√©gica:</strong> Projeta 6 meses no futuro com confian√ßa</li>
                <li>‚Ä¢ <strong>Otimiza√ß√£o de capital:</strong> Todo recurso ocioso √© aplicado</li>
                <li>‚Ä¢ <strong>Antecipa√ß√£o perfeita:</strong> Nunca √© pego de surpresa</li>
                <li>‚Ä¢ <strong>Negocia√ß√£o superior:</strong> Consegue 8-15% de desconto √† vista</li>
                <li>‚Ä¢ <strong>Cr√©dito estrat√©gico:</strong> Usa apenas quando ROI > custo</li>
            </ul>

            <p><strong>M√°ximo potencial:</strong> <strong>5-8% do faturamento</strong> em ganhos totais (economia de juros, descontos obtidos, rendimento de aplica√ß√µes, e capital de giro otimizado).</p>

            <div class="ebook-benchmark">
                <p>üèÜ <strong>BENCHMARK:</strong> Empresas neste n√≠vel operam como as Big 4 recomendam. T√™m o controle financeiro de grandes corpora√ß√µes, adaptado √† realidade de PMEs. √â o padr√£o-ouro da gest√£o de fluxo de caixa.</p>
            </div>
        </div>
    </div>

    <div class="ebook-evolucao">
        <h3>üöÄ Plano de Evolu√ß√£o</h3>

        <div class="evolucao-fase">
            <h4>FASE 1: Do Cr√≠tico para B√°sico (30-60 dias)</h4>
            
            <p><strong>Objetivo:</strong> Ter controle m√≠nimo e visibilidade de 15 dias</p>

            <p><strong>A√ß√µes pr√°ticas:</strong></p>
            <ol>
                <li><strong>Semana 1-2: Criar planilha de controle</strong>
                    <ul>
                        <li>‚Ä¢ Template com: Data | Descri√ß√£o | Entrada | Sa√≠da | Saldo</li>
                        <li>‚Ä¢ Incluir todas contas banc√°rias da empresa</li>
                        <li>‚Ä¢ Registrar saldo inicial de cada conta</li>
                    </ul>
                </li>
                <li><strong>Semana 3-4: Implementar rotina di√°ria</strong>
                    <ul>
                        <li>‚Ä¢ Definir hor√°rio fixo para atualizar (ex: 17h)</li>
                        <li>‚Ä¢ Lan√ßar todas movimenta√ß√µes do dia</li>
                        <li>‚Ä¢ Conciliar com extratos banc√°rios</li>
                    </ul>
                </li>
                <li><strong>Semana 5-6: Projetar 15 dias</strong>
                    <ul>
                        <li>‚Ä¢ Listar todas contas a pagar nos pr√≥ximos 15 dias</li>
                        <li>‚Ä¢ Estimar recebimentos esperados (realista!)</li>
                        <li>‚Ä¢ Identificar gaps de caixa antecipadamente</li>
                    </ul>
                </li>
                <li><strong>Semana 7-8: Estabelecer reserva de emerg√™ncia</strong>
                    <ul>
                        <li>‚Ä¢ Meta: 5-10 dias de despesas operacionais</li>
                        <li>‚Ä¢ Separar conta espec√≠fica para emerg√™ncias</li>
                        <li>‚Ä¢ N√£o usar para despesas correntes</li>
                    </ul>
                </li>
            </ol>

            <p><strong>Investimento:</strong> R$ 0 (interno) | <strong>Economia esperada:</strong> R$ 2-5k/m√™s</p>
        </div>

        <div class="evolucao-fase">
            <h4>FASE 2: Do B√°sico para Estruturado (60-90 dias)</h4>
            
            <p><strong>Objetivo:</strong> Automatizar e ter visibilidade de 30-60 dias</p>

            <p><strong>A√ß√µes pr√°ticas:</strong></p>
            <ol>
                <li><strong>M√™s 1: Escolher e implementar sistema</strong>
                    <ul>
                        <li>‚Ä¢ Op√ß√µes: Conta Azul, Omie, Nibo, Bling (R$ 50-200/m√™s)</li>
                        <li>‚Ä¢ Integrar com bancos (API ou OFX)</li>
                        <li>‚Ä¢ Migrar hist√≥rico dos √∫ltimos 3 meses</li>
                    </ul>
                </li>
                <li><strong>M√™s 2: Categorizar e estruturar</strong>
                    <ul>
                        <li>‚Ä¢ Criar plano de contas claro (Operacional, Investimento, Financeiro)</li>
                        <li>‚Ä¢ Categorizar 100% das movimenta√ß√µes</li>
                        <li>‚Ä¢ Configurar centros de custo se necess√°rio</li>
                    </ul>
                </li>
                <li><strong>M√™s 3: Expandir proje√ß√£o</strong>
                    <ul>
                        <li>‚Ä¢ Projetar 60 dias no futuro</li>
                        <li>‚Ä¢ Incluir todas despesas fixas e vari√°veis previstas</li>
                        <li>‚Ä¢ Revisar semanalmente realizado vs projetado</li>
                        <li>‚Ä¢ Ajustar proje√ß√µes baseado na precis√£o</li>
                    </ul>
                </li>
                <li><strong>M√™s 3: Estabelecer pol√≠ticas</strong>
                    <ul>
                        <li>‚Ä¢ Pol√≠tica de recebimentos (prazos aceitos, antecipa√ß√£o)</li>
                        <li>‚Ä¢ Pol√≠tica de pagamentos (sempre negociar prazo/desconto)</li>
                        <li>‚Ä¢ Limite de caixa m√≠nimo (nunca abaixo de X dias)</li>
                    </ul>
                </li>
            </ol>

            <p><strong>Investimento:</strong> R$ 1.500-3.000 | <strong>Economia esperada:</strong> R$ 5-12k/m√™s</p>
        </div>

        <div class="evolucao-fase">
            <h4>FASE 3: Do Estruturado para Otimizado (90-120 dias)</h4>
            
            <p><strong>Objetivo:</strong> Excel√™ncia operacional com proje√ß√£o 90-180 dias</p>

            <p><strong>A√ß√µes pr√°ticas:</strong></p>
            <ol>
                <li><strong>M√™s 1: Implementar cen√°rios m√∫ltiplos</strong>
                    <ul>
                        <li>‚Ä¢ Cen√°rio pessimista (vendas 20% abaixo)</li>
                        <li>‚Ä¢ Cen√°rio realista (base atual)</li>
                        <li>‚Ä¢ Cen√°rio otimista (vendas 20% acima)</li>
                        <li>‚Ä¢ Plano de a√ß√£o para cada cen√°rio</li>
                    </ul>
                </li>
                <li><strong>M√™s 2: Integra√ß√£o total</strong>
                    <ul>
                        <li>‚Ä¢ Integrar sistema de vendas com fluxo de caixa</li>
                        <li>‚Ä¢ Integrar sistema de compras/estoque</li>
                        <li>‚Ä¢ API com principais fornecedores (boletos autom√°ticos)</li>
                        <li>‚Ä¢ Dashboard executivo em tempo real</li>
                    </ul>
                </li>
                <li><strong>M√™s 3: KPIs avan√ßados</strong>
                    <ul>
                        <li>‚Ä¢ Ciclo de caixa (PMR + PME - PMP)</li>
                        <li>‚Ä¢ Capital de giro necess√°rio</li>
                        <li>‚Ä¢ Rendimento de caixa ocioso</li>
                        <li>‚Ä¢ Custo de oportunidade de recebimentos</li>
                    </ul>
                </li>
                <li><strong>M√™s 4: Otimiza√ß√£o cont√≠nua</strong>
                    <ul>
                        <li>‚Ä¢ Aplica√ß√µes autom√°ticas de caixa ocioso</li>
                        <li>‚Ä¢ Negocia√ß√£o estrat√©gica com fornecedores</li>
                        <li>‚Ä¢ Pol√≠tica de antecipa√ß√£o de receb√≠veis (quando faz sentido)</li>
                        <li>‚Ä¢ Revis√£o mensal de pol√≠ticas financeiras</li>
                    </ul>
                </li>
            </ol>

            <p><strong>Investimento:</strong> R$ 3.000-8.000 | <strong>Economia esperada:</strong> R$ 8-20k/m√™s</p>
        </div>
    </div>

    <div class="ebook-caso">
        <h3>üíº Caso Real: Com√©rcio Varejista - R$ 800k/m√™s</h3>

        <div class="caso-empresa">
            <p><strong>Empresa:</strong> Loja de materiais de constru√ß√£o</p>
            <p><strong>Faturamento:</strong> R$ 800.000/m√™s</p>
            <p><strong>Funcion√°rios:</strong> 18</p>
            <p><strong>Tempo de mercado:</strong> 12 anos</p>
        </div>

        <div class="caso-situacao">
            <h4>üìâ Situa√ß√£o Inicial (Score: 2/10 - Cr√≠tico)</h4>
            <ul>
                <li>‚Ä¢ Usava cheque especial TODO m√™s (m√©dia R$ 85.000)</li>
                <li>‚Ä¢ Juros mensais: R$ 6.800 (8% a.m.)</li>
                <li>‚Ä¢ N√£o sabia quanto teria em caixa na pr√≥xima semana</li>
                <li>‚Ä¢ Perdia descontos √† vista de at√© 8%</li>
                <li>‚Ä¢ Atrasava pagamentos frequentemente</li>
                <li>‚Ä¢ Stress constante dos s√≥cios</li>
            </ul>
            <p><strong>Perda anual estimada:</strong> R$ 120.000 (15% do lucro)</p>
        </div>

        <div class="caso-solucao">
            <h4>üîß Solu√ß√£o Implementada</h4>
            <p><strong>Fase 1 (m√™s 1-2): Estrutura√ß√£o b√°sica</strong></p>
            <ul>
                <li>‚Ä¢ Implementou planilha de controle di√°rio</li>
                <li>‚Ä¢ Categorizou todas despesas e receitas</li>
                <li>‚Ä¢ Criou proje√ß√£o de 30 dias</li>
            </ul>

            <p><strong>Fase 2 (m√™s 3-4): Automatiza√ß√£o</strong></p>
            <ul>
                <li>‚Ä¢ Contratou sistema Omie (R$ 180/m√™s)</li>
                <li>‚Ä¢ Integrou com 3 bancos via API</li>
                <li>‚Ä¢ Expandiu proje√ß√£o para 60 dias</li>
            </ul>

            <p><strong>Fase 3 (m√™s 5-6): Otimiza√ß√£o</strong></p>
            <ul>
                <li>‚Ä¢ Renegociou prazos com 15 fornecedores principais</li>
                <li>‚Ä¢ Implementou pol√≠tica de descontos √† vista</li>
                <li>‚Ä¢ Criou reserva de emerg√™ncia de 15 dias</li>
            </ul>
        </div>

        <div class="caso-resultados">
            <h4>üìà Resultados Alcan√ßados (6 meses)</h4>
            
            <p><strong>Score Final: 8/10 (Otimizado)</strong></p>

            <table class="resultado-table">
                <tr>
                    <th>M√©trica</th>
                    <th>Antes</th>
                    <th>Depois</th>
                    <th>Ganho</th>
                </tr>
                <tr>
                    <td>Uso de cheque especial</td>
                    <td>R$ 85k/m√™s</td>
                    <td>R$ 0</td>
                    <td>100%</td>
                </tr>
                <tr>
                    <td>Juros mensais</td>
                    <td>R$ 6.800</td>
                    <td>R$ 0</td>
                    <td>R$ 81.600/ano</td>
                </tr>
                <tr>
                    <td>Descontos obtidos</td>
                    <td>0%</td>
                    <td>6% m√©dio</td>
                    <td>R$ 42.000/ano</td>
                </tr>
                <tr>
                    <td>Rendimento de aplica√ß√µes</td>
                    <td>R$ 0</td>
                    <td>R$ 1.200/m√™s</td>
                    <td>R$ 14.400/ano</td>
                </tr>
                <tr>
                    <td><strong>TOTAL ANUAL</strong></td>
                    <td></td>
                    <td></td>
                    <td><strong>R$ 138.000</strong></td>
                </tr>
            </table>

            <p><strong>ROI da implementa√ß√£o:</strong></p>
            <ul>
                <li>‚Ä¢ Investimento total: R$ 4.200</li>
                <li>‚Ä¢ Retorno anual: R$ 138.000</li>
                <li>‚Ä¢ ROI: <strong>3.286%</strong></li>
                <li>‚Ä¢ Payback: <strong>11 dias</strong></li>
            </ul>

            <p><strong>Benef√≠cios intang√≠veis:</strong></p>
            <ul>
                <li>‚Ä¢ ‚úÖ Fim do stress financeiro dos s√≥cios</li>
                <li>‚Ä¢ ‚úÖ Credibilidade recuperada com fornecedores</li>
                <li>‚Ä¢ ‚úÖ Conseguiu financiar expans√£o sem juros altos</li>
                <li>‚Ä¢ ‚úÖ Tempo economizado: 12 horas/m√™s</li>
            </ul>
        </div>

        <div class="caso-depoimento">
            <p><em>"Antes viv√≠amos no sufoco. N√£o sab√≠amos se teria dinheiro para pagar na sexta-feira. Hoje temos visibilidade de 90 dias e at√© conseguimos aplicar o caixa excedente. Economizamos R$ 138 mil no primeiro ano e eliminamos 100% dos juros. Foi a melhor decis√£o que tomamos."</em></p>
            <p><strong>‚Äî Carlos Mendes, S√≥cio-Diretor</strong></p>
        </div>
    </div>

    <div class="ebook-checklist">
        <h3>‚úÖ Checklist Pr√°tico: Primeiros Passos</h3>

        <div class="checklist-urgente">
            <h4>üî¥ URGENTE (Semana 1)</h4>
            <ul>
                <li>‚òê Criar planilha de controle com saldo de todas contas</li>
                <li>‚òê Registrar todas movimenta√ß√µes dos √∫ltimos 7 dias</li>
                <li>‚òê Listar contas a pagar nos pr√≥ximos 15 dias</li>
                <li>‚òê Identificar se haver√° gap de caixa</li>
            </ul>
        </div>

        <div class="checklist-importante">
            <h4>üü† IMPORTANTE (Semana 2-4)</h4>
            <ul>
                <li>‚òê Implementar rotina di√°ria de atualiza√ß√£o (17h)</li>
                <li>‚òê Categorizar 100% das movimenta√ß√µes</li>
                <li>‚òê Expandir proje√ß√£o para 30 dias</li>
                <li>‚òê Criar reserva de emerg√™ncia (meta: 5 dias de opera√ß√£o)</li>
                <li>‚òê Definir pol√≠tica de recebimentos e pagamentos</li>
            </ul>
        </div>

        <div class="checklist-estrategico">
            <h4>üü° ESTRAT√âGICO (M√™s 2-3)</h4>
            <ul>
                <li>‚òê Pesquisar sistemas automatizados (Conta Azul, Omie, Nibo)</li>
                <li>‚òê Integrar sistema com bancos</li>
                <li>‚òê Renegociar prazos com principais fornecedores</li>
                <li>‚òê Implementar pol√≠tica de descontos √† vista</li>
                <li>‚òê Criar dashboard executivo</li>
            </ul>
        </div>
    </div>

    <div class="ebook-ferramentas">
        <h3>üõ†Ô∏è Ferramentas Recomendadas</h3>

        <div class="ferramenta-box">
            <h4>N√≠vel B√°sico (R$ 0-50/m√™s)</h4>
            <ul>
                <li>‚Ä¢ <strong>Planilha Google Sheets:</strong> Template gratuito, acess√≠vel de qualquer lugar</li>
                <li>‚Ä¢ <strong>Excel:</strong> Para quem prefere trabalhar offline</li>
                <li>‚Ä¢ <strong>Conta Azul Start:</strong> R$ 42/m√™s, b√°sico mas funcional</li>
            </ul>
        </div>

        <div class="ferramenta-box">
            <h4>N√≠vel Estruturado (R$ 50-200/m√™s)</h4>
            <ul>
                <li>‚Ä¢ <strong>Omie:</strong> R$ 99-180/m√™s, √≥tima rela√ß√£o custo-benef√≠cio</li>
                <li>‚Ä¢ <strong>Nibo:</strong> R$ 89/m√™s, interface simples</li>
                <li>‚Ä¢ <strong>Bling:</strong> R$ 60/m√™s, bom para e-commerce</li>
            </ul>
        </div>

        <div class="ferramenta-box">
            <h4>N√≠vel Otimizado (R$ 200+/m√™s)</h4>
            <ul>
                <li>‚Ä¢ <strong>Conta Azul Pro:</strong> R$ 200+/m√™s, recursos avan√ßados</li>
                <li>‚Ä¢ <strong>SAP Business One:</strong> R$ 300+/m√™s, para empresas maiores</li>
                <li>‚Ä¢ <strong>Totvs Protheus:</strong> R$ 400+/m√™s, integra√ß√£o total</li>
            </ul>
        </div>
    </div>

    <div class="ebook-conclusao-capitulo">
        <h3>üéØ Conclus√£o do Cap√≠tulo</h3>
        <p>O fluxo de caixa √© o cora√ß√£o financeiro da empresa. Sem ele funcionando bem, n√£o importa o quanto voc√™ vende ou lucra ‚Äî a empresa pode quebrar. A boa not√≠cia √© que evoluir do n√≠vel cr√≠tico para o estruturado √© relativamente r√°pido (2-4 meses) e o ROI √© imediato.</p>

        <p>Empresas que dominam o fluxo de caixa dormem tranquilas, pagam em dia, aproveitam descontos, e crescem de forma sustent√°vel. √â uma das transforma√ß√µes com maior impacto positivo na gest√£o financeira.</p>

        <p><strong>Pr√≥ximo passo:</strong> Avalie seu n√≠vel atual de maturidade em fluxo de caixa e comece hoje mesmo a implementar as a√ß√µes da Fase 1. Em 60 dias voc√™ j√° ver√° resultados significativos.</p>
    </div>
</div>

<!-- Fim do Cap√≠tulo 3 -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     CONTE√öDO COMPLETO DO E-BOOK - CAP√çTULOS 4 A 8
     Vers√£o OTIMIZADA: Profissional, conciso, acion√°vel
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<!-- CAP√çTULO 4: OR√áAMENTO EMPRESARIAL -->
<div class="ebook-capitulo" id="cap4-orcamento">
    <div class="ebook-capa-capitulo">
        <h1>üéØ CAP√çTULO 4</h1>
        <h2>OR√áAMENTO EMPRESARIAL</h2>
        <h3>O GPS do Futuro Financeiro</h3>
    </div>

    <div class="ebook-intro-rapida">
        <p><strong>O que √©:</strong> O or√ßamento empresarial √© o planejamento financeiro que define metas de receitas, custos e lucros para o per√≠odo futuro (geralmente 12 meses). √â o mapa que mostra onde voc√™ quer chegar.</p>
        
        <p><strong>Por que importa:</strong> Sem or√ßamento, a empresa navega √†s cegas. 70% das PMEs que quebram n√£o tinham or√ßamento estruturado. Com or√ßamento, voc√™ controla gastos, mede performance e toma decis√µes baseadas em dados, n√£o em achismo.</p>
    </div>

    <div class="ebook-niveis-resumido">
        <h3>üìä N√≠veis de Maturidade</h3>

        <div class="nivel-card critico">
            <h4>üî¥ CR√çTICO (0-2): "No Escuro"</h4>
            <p>Sem or√ßamento formal. Gastos decididos no impulso. N√£o sabe se m√™s foi bom/ruim at√© contador entregar DRE 3 meses depois.</p>
            <p><strong>Impacto:</strong> Perdas de 10-20% do faturamento em gastos desnecess√°rios e decis√µes erradas.</p>
        </div>

        <div class="nivel-card basico">
            <h4>üü† B√ÅSICO (3-4): "Tentando Controlar"</h4>
            <p>Or√ßamento anual simples ("ano passado +10%"). Revis√£o trimestral. Acompanhamento b√°sico Real vs Or√ßado.</p>
            <p><strong>Impacto:</strong> Ainda perde 5-8% do faturamento por falta de detalhamento e ajustes.</p>
        </div>

        <div class="nivel-card estruturado">
            <h4>üü° ESTRUTURADO (5-7): "Sob Controle"</h4>
            <p>Or√ßamento detalhado mensal por centro de custo. An√°lise mensal de varia√ß√µes. Reuni√£o de resultados. Revis√£o trimestral.</p>
            <p><strong>Ganho:</strong> Economia de 3-5% do faturamento em corte de gastos e melhor aloca√ß√£o.</p>
        </div>

        <div class="nivel-card otimizado">
            <h4>üü¢ OTIMIZADO (8-10): "Excel√™ncia"</h4>
            <p>Or√ßamento rolling (sempre 12 meses √† frente). M√∫ltiplos cen√°rios. Forecast mensal atualizado. Dashboard em tempo real. KPIs semanais.</p>
            <p><strong>Ganho:</strong> 5-10% do faturamento em otimiza√ß√£o total e crescimento mais lucrativo.</p>
        </div>
    </div>

    <div class="evolucao-rapida">
        <h3>üöÄ Como Evoluir</h3>
        
        <div class="fase-box">
            <h4>Cr√≠tico ‚Üí B√°sico (60 dias)</h4>
            <ol>
                <li>Mapear todas receitas e despesas do ano passado</li>
                <li>Criar or√ßamento anual simples (planilha)</li>
                <li>Definir meta de faturamento e margem</li>
                <li>Acompanhar mensalmente: Real vs Or√ßado</li>
            </ol>
            <p><strong>Resultado:</strong> Visibilidade de para onde o dinheiro vai.</p>
        </div>

        <div class="fase-box">
            <h4>B√°sico ‚Üí Estruturado (90 dias)</h4>
            <ol>
                <li>Detalhar or√ßamento m√™s a m√™s</li>
                <li>Criar centros de custo (Comercial, Opera√ß√£o, Admin)</li>
                <li>Implementar reuni√£o mensal de resultados</li>
                <li>Analisar varia√ß√µes e corrigir rota</li>
            </ol>
            <p><strong>Resultado:</strong> Controle granular e capacidade de agir r√°pido.</p>
        </div>

        <div class="fase-box">
            <h4>Estruturado ‚Üí Otimizado (120 dias)</h4>
            <ol>
                <li>Implementar or√ßamento rolling</li>
                <li>Criar 3 cen√°rios (pessimista/base/otimista)</li>
                <li>Atualizar forecast mensalmente</li>
                <li>Dashboard executivo em tempo real</li>
            </ol>
            <p><strong>Resultado:</strong> Agilidade estrat√©gica e decis√µes precisas.</p>
        </div>
    </div>

    <div class="caso-box">
        <h3>üíº Caso: Ind√∫stria de Alimentos - R$ 2MM/m√™s</h3>
        <p><strong>Situa√ß√£o inicial:</strong> Sem or√ßamento. Descobriu preju√≠zo de R$ 400k 4 meses depois. Margem caiu de 12% para 3%.</p>
        <p><strong>A√ß√£o:</strong> Implementou or√ßamento estruturado em 6 meses.</p>
        <p><strong>Resultado:</strong> Cortou R$ 180k/ano em gastos desnecess√°rios. Margem recuperada para 9%. Lucro anual: R$ 1,44MM.</p>
        <p><strong>ROI:</strong> Investimento R$ 15k ‚Üí Retorno R$ 1,44MM = <strong>9.600% ROI</strong></p>
    </div>

    <div class="checklist-rapido">
        <h3>‚úÖ Checklist A√ß√£o Imediata</h3>
        <ul>
            <li>‚òê Mapear receitas e despesas dos √∫ltimos 12 meses</li>
            <li>‚òê Definir meta de faturamento para pr√≥ximos 12 meses</li>
            <li>‚òê Definir meta de margem l√≠quida</li>
            <li>‚òê Criar planilha de acompanhamento mensal</li>
            <li>‚òê Agendar reuni√£o mensal de resultados</li>
        </ul>
    </div>
</div>

<!-- CAP√çTULO 5: INVESTIMENTOS -->
<div class="ebook-capitulo" id="cap5-investimentos">
    <div class="ebook-capa-capitulo">
        <h1>üöÄ CAP√çTULO 5</h1>
        <h2>GEST√ÉO DE INVESTIMENTOS</h2>
        <h3>Crescer com Intelig√™ncia</h3>
    </div>

    <div class="ebook-intro-rapida">
        <p><strong>O que √©:</strong> Gest√£o de investimentos empresariais √© o processo de avaliar, priorizar e acompanhar investimentos em ativos, projetos e expans√µes que aumentar√£o a capacidade produtiva ou competitiva da empresa.</p>
        
        <p><strong>Por que importa:</strong> 40% dos investimentos em PMEs destroem valor em vez de criar. Investir certo diferencia crescimento saud√°vel de crescimento que quebra a empresa. Cada real mal investido √© preju√≠zo duplo: perdeu o dinheiro E perdeu a oportunidade de investir certo.</p>
    </div>

    <div class="ebook-niveis-resumido">
        <h3>üìä N√≠veis de Maturidade</h3>

        <div class="nivel-card critico">
            <h4>üî¥ CR√çTICO (0-2): "Impulso e F√©"</h4>
            <p>Investe no impulso sem an√°lise. N√£o calcula ROI. N√£o acompanha resultados. Investe "quando sobra dinheiro" sem crit√©rio.</p>
            <p><strong>Impacto:</strong> 40-60% dos investimentos n√£o geram retorno esperado. Muito dinheiro queimado.</p>
        </div>

        <div class="nivel-card basico">
            <h4>üü† B√ÅSICO (3-4): "An√°lise Simples"</h4>
            <p>Faz c√°lculo b√°sico de payback. Compara 2-3 op√ß√µes. Mas n√£o considera todos custos ocultos. Acompanhamento informal dos resultados.</p>
            <p><strong>Impacto:</strong> 20-30% dos investimentos ficam abaixo do esperado. Melhor que impulso, mas ainda arriscado.</p>
        </div>

        <div class="nivel-card estruturado">
            <h4>üü° ESTRUTURADO (5-7): "Decis√µes Embasadas"</h4>
            <p>An√°lise completa: Payback, TIR, VPL, ROI. Considera cen√°rios. Prioriza√ß√£o clara. Acompanhamento trimestral dos investimentos.</p>
            <p><strong>Ganho:</strong> 80-90% dos investimentos atingem ou superam expectativas. Crescimento sustent√°vel.</p>
        </div>

        <div class="nivel-card otimizado">
            <h4>üü¢ OTIMIZADO (8-10): "Portf√≥lio Estrat√©gico"</h4>
            <p>Portf√≥lio balanceado de investimentos. An√°lise de risco/retorno. Business case completo para cada projeto. Governan√ßa estruturada. KPIs em tempo real.</p>
            <p><strong>Ganho:</strong> 95%+ dos investimentos superam expectativas. M√°xima efici√™ncia de capital.</p>
        </div>
    </div>

    <div class="evolucao-rapida">
        <h3>üöÄ Como Evoluir</h3>
        
        <div class="fase-box">
            <h4>Cr√≠tico ‚Üí B√°sico (30 dias)</h4>
            <ol>
                <li>Criar template de an√°lise de investimento</li>
                <li>Calcular payback de todo investimento > R$ 10k</li>
                <li>Listar todos investimentos feitos no √∫ltimo ano</li>
                <li>Avaliar quais deram certo e quais n√£o</li>
            </ol>
        </div>

        <div class="fase-box">
            <h4>B√°sico ‚Üí Estruturado (90 dias)</h4>
            <ol>
                <li>Implementar an√°lise TIR e VPL</li>
                <li>Definir taxa m√≠nima de atratividade (TMA)</li>
                <li>Criar sistema de prioriza√ß√£o (scoring)</li>
                <li>Acompanhar KPIs trimestrais de cada investimento</li>
            </ol>
        </div>

        <div class="fase-box">
            <h4>Estruturado ‚Üí Otimizado (120 dias)</h4>
            <ol>
                <li>Criar portf√≥lio balanceado (r√°pido/m√©dio/longo prazo)</li>
                <li>Implementar business case completo</li>
                <li>Definir governan√ßa (quem aprova o qu√™)</li>
                <li>Dashboard de acompanhamento em tempo real</li>
            </ol>
        </div>
    </div>

    <div class="caso-box">
        <h3>üíº Caso: Rede de Cafeterias - R$ 600k/m√™s</h3>
        <p><strong>Situa√ß√£o inicial:</strong> Abriu 3 lojas em 8 meses sem an√°lise. 2 delas d√£o preju√≠zo. R$ 450k investidos, retorno negativo.</p>
        <p><strong>A√ß√£o:</strong> Implementou an√°lise estruturada. Fechou 1 loja. Otimizou outra. Expandiu apenas ap√≥s validar modelo.</p>
        <p><strong>Resultado:</strong> Pr√≥ximas 4 lojas: todas lucrativas em 6 meses. ROI m√©dio de 180%. Economia de R$ 300k em expans√µes mal planejadas evitadas.</p>
        <p><strong>Li√ß√£o:</strong> Crescer devagar com an√°lise > crescer r√°pido sem crit√©rio.</p>
    </div>

    <div class="checklist-rapido">
        <h3>‚úÖ Checklist de An√°lise de Investimento</h3>
        <ul>
            <li>‚òê Qual o investimento total? (incluir TODOS custos)</li>
            <li>‚òê Qual o retorno esperado? (mensal/anual)</li>
            <li>‚òê Qual o payback? (quanto tempo para recuperar)</li>
            <li>‚òê Qual o ROI%? (retorno sobre investimento)</li>
            <li>‚òê Quais os riscos? (cen√°rio pessimista)</li>
            <li>‚òê Tem alternativa melhor? (comparar op√ß√µes)</li>
            <li>‚òê Como vai acompanhar resultados? (KPIs)</li>
        </ul>
    </div>
</div>

<!-- CAP√çTULO 6: RISCOS FINANCEIROS -->
<div class="ebook-capitulo" id="cap6-riscos">
    <div class="ebook-capa-capitulo">
        <h1>üõ°Ô∏è CAP√çTULO 6</h1>
        <h2>GEST√ÉO DE RISCOS FINANCEIROS</h2>
        <h3>Blindar Antes de Sofrer</h3>
    </div>

    <div class="ebook-intro-rapida">
        <p><strong>O que √©:</strong> Gest√£o de riscos financeiros √© identificar, avaliar e mitigar amea√ßas que podem comprometer a sa√∫de financeira da empresa: inadimpl√™ncia, concentra√ß√£o de clientes, depend√™ncia de fornecedores, varia√ß√£o cambial, aumento de custos, etc.</p>
        
        <p><strong>Por que importa:</strong> 80% das empresas que quebram foram pegas de surpresa por um risco n√£o gerenciado. N√£o √© quest√£o de SE o risco vai se materializar, mas QUANDO. Empresas preparadas sobrevivem crises; despreparadas, quebram.</p>
    </div>

    <div class="ebook-niveis-resumido">
        <h3>üìä N√≠veis de Maturidade</h3>

        <div class="nivel-card critico">
            <h4>üî¥ CR√çTICO (0-2): "Desprotegido"</h4>
            <p>N√£o identifica riscos. Reage quando problema acontece. Sem plano B. Concentra√ß√£o extrema (1 cliente = 70% faturamento). Sem reservas.</p>
            <p><strong>Impacto:</strong> Alta vulnerabilidade. Um evento adverso pode quebrar a empresa.</p>
        </div>

        <div class="nivel-card basico">
            <h4>üü† B√ÅSICO (3-4): "Reativos"</h4>
            <p>Identifica riscos principais mas n√£o age preventivamente. Reserva financeira informal. Reage r√°pido quando problema surge.</p>
            <p><strong>Impacto:</strong> Sobrevive crises m√©dias. Sofre muito em crises grandes.</p>
        </div>

        <div class="nivel-card estruturado">
            <h4>üü° ESTRUTURADO (5-7): "Preparados"</h4>
            <p>Mapa de riscos formal. Planos de conting√™ncia. Reserva de emerg√™ncia estruturada (3-6 meses). Diversifica√ß√£o de clientes/fornecedores. Seguros adequados.</p>
            <p><strong>Ganho:</strong> Sobrevive 95% das crises. Aproveita oportunidades que crises trazem.</p>
        </div>

        <div class="nivel-card otimizado">
            <h4>üü¢ OTIMIZADO (8-10): "Blindados"</h4>
            <p>Gest√£o proativa de riscos. Monitoramento cont√≠nuo. Simula√ß√µes de cen√°rios adversos. Hedge cambial quando necess√°rio. Plano B para tudo. Comit√™ de riscos.</p>
            <p><strong>Ganho:</strong> Praticamente imune a crises. Cresce durante turbul√™ncias enquanto concorrentes sofrem.</p>
        </div>
    </div>

    <div class="evolucao-rapida">
        <h3>üöÄ Como Evoluir</h3>
        
        <div class="fase-box">
            <h4>Cr√≠tico ‚Üí B√°sico (60 dias)</h4>
            <ol>
                <li>Listar TOP 10 riscos da empresa</li>
                <li>Para cada risco: probabilidade (alta/m√©dia/baixa) e impacto (alto/m√©dio/baixo)</li>
                <li>Criar fundo de emerg√™ncia (meta: 1 m√™s de despesas)</li>
                <li>Revisar seguros (empresarial, inc√™ndio, responsabilidade)</li>
            </ol>
        </div>

        <div class="fase-box">
            <h4>B√°sico ‚Üí Estruturado (90 dias)</h4>
            <ol>
                <li>Criar mapa de riscos formal (matriz probabilidade x impacto)</li>
                <li>Desenvolver plano de conting√™ncia para TOP 5 riscos</li>
                <li>Aumentar reserva para 3-6 meses</li>
                <li>Diversificar: nenhum cliente > 20% faturamento</li>
            </ol>
        </div>

        <div class="fase-box">
            <h4>Estruturado ‚Üí Otimizado (120 dias)</h4>
            <ol>
                <li>Implementar monitoramento cont√≠nuo de indicadores</li>
                <li>Realizar simula√ß√µes trimestrais de cen√°rios adversos</li>
                <li>Criar comit√™ de riscos (reuni√£o mensal)</li>
                <li>Implementar hedge cambial se exposto a varia√ß√£o</li>
            </ol>
        </div>
    </div>

    <div class="caso-box">
        <h3>üíº Caso: Distribuidora - R$ 1,5MM/m√™s</h3>
        <p><strong>Situa√ß√£o inicial:</strong> 65% do faturamento de 1 √∫nico cliente. Sem reservas. Cliente cancelou contrato de repente. Empresa quase quebrou.</p>
        <p><strong>A√ß√£o:</strong> Reconstruiu com gest√£o de riscos: diversificou clientes (m√°x 15% cada), criou reserva de 6 meses, fez seguros adequados.</p>
        <p><strong>Resultado:</strong> 2 anos depois, perdeu cliente de 12% do faturamento. Nem sentiu. Reserva cobriu enquanto repunha receita. Continuou crescendo.</p>
        <p><strong>Investimento em gest√£o de riscos:</strong> R$ 120k (reserva + seguros). <strong>Valor preservado:</strong> R$ 1,5MM (empresa n√£o quebrou).</p>
    </div>

    <div class="checklist-rapido">
        <h3>‚úÖ Checklist TOP 10 Riscos</h3>
        <ul>
            <li>‚òê Concentra√ß√£o de clientes (algum > 20%?)</li>
            <li>‚òê Concentra√ß√£o de fornecedores</li>
            <li>‚òê Inadimpl√™ncia (% da receita)</li>
            <li>‚òê Sazonalidade extrema</li>
            <li>‚òê Depend√™ncia de pessoas-chave</li>
            <li>‚òê Exposi√ß√£o cambial (se importa/exporta)</li>
            <li>‚òê Mudan√ßas regulat√≥rias no setor</li>
            <li>‚òê Novos concorrentes disruptivos</li>
            <li>‚òê Aumento brusco de custos</li>
            <li>‚òê Reserva de emerg√™ncia (quantos meses?)</li>
        </ul>
    </div>
</div>

<!-- CAP√çTULO 7: INDICADORES FINANCEIROS -->
<div class="ebook-capitulo" id="cap7-indicadores">
    <div class="ebook-capa-capitulo">
        <h1>üî¢ CAP√çTULO 7</h1>
        <h2>INDICADORES FINANCEIROS</h2>
        <h3>O Painel de Controle do Neg√≥cio</h3>
    </div>

    <div class="ebook-intro-rapida">
        <p><strong>O que √©:</strong> Indicadores financeiros (KPIs) s√£o m√©tricas que medem a sa√∫de e performance financeira da empresa: liquidez, rentabilidade, endividamento, efici√™ncia operacional, etc. S√£o os "sinais vitais" do neg√≥cio.</p>
        
        <p><strong>Por que importa:</strong> "O que n√£o √© medido, n√£o √© gerenciado" (Peter Drucker). Sem indicadores, voc√™ dirige no escuro. Com indicadores certos, identifica problemas antes de virarem crises e oportunidades antes dos concorrentes.</p>
    </div>

    <div class="indicadores-essenciais">
        <h3>üìä Indicadores Essenciais por Categoria</h3>

        <div class="categoria-indicadores">
            <h4>üí∞ LIQUIDEZ (Capacidade de pagar contas)</h4>
            <ul>
                <li><strong>Liquidez Corrente:</strong> Ativo Circulante / Passivo Circulante ‚Üí ideal > 1,5</li>
                <li><strong>Liquidez Seca:</strong> (AC - Estoque) / PC ‚Üí ideal > 1,0</li>
                <li><strong>Capital de Giro:</strong> AC - PC ‚Üí quanto sobra ap√≥s pagar tudo</li>
            </ul>
        </div>

        <div class="categoria-indicadores">
            <h4>üìà RENTABILIDADE (Quanto est√° ganhando)</h4>
            <ul>
                <li><strong>Margem Bruta:</strong> (Receita - CMV) / Receita ‚Üí m√≠nimo 30-40%</li>
                <li><strong>Margem Operacional:</strong> EBITDA / Receita ‚Üí ideal 15-25%</li>
                <li><strong>Margem L√≠quida:</strong> Lucro L√≠quido / Receita ‚Üí ideal 8-15%</li>
                <li><strong>ROE:</strong> Lucro L√≠quido / Patrim√¥nio L√≠quido ‚Üí ideal > 20%</li>
            </ul>
        </div>

        <div class="categoria-indicadores">
            <h4>üí≥ ENDIVIDAMENTO (N√≠vel de d√≠vidas)</h4>
            <ul>
                <li><strong>Endividamento Geral:</strong> Passivo Total / Ativo Total ‚Üí ideal < 50%</li>
                <li><strong>Composi√ß√£o do Endividamento:</strong> PC / Passivo Total ‚Üí ideal < 40%</li>
                <li><strong>Cobertura de Juros:</strong> EBITDA / Juros ‚Üí ideal > 3x</li>
            </ul>
        </div>

        <div class="categoria-indicadores">
            <h4>‚ö° EFICI√äNCIA OPERACIONAL</h4>
            <ul>
                <li><strong>Prazo M√©dio Recebimento (PMR):</strong> (Contas a Receber / Receita) x 30 ‚Üí ideal < 45 dias</li>
                <li><strong>Prazo M√©dio Pagamento (PMP):</strong> (Fornecedores / Compras) x 30 ‚Üí ideal > PMR</li>
                <li><strong>Ciclo de Caixa:</strong> PMR + PME - PMP ‚Üí quanto menor, melhor</li>
                <li><strong>Giro de Estoque:</strong> CMV / Estoque M√©dio ‚Üí quanto maior, melhor</li>
            </ul>
        </div>
    </div>

    <div class="ebook-niveis-resumido">
        <h3>üìä N√≠veis de Maturidade</h3>

        <div class="nivel-card critico">
            <h4>üî¥ CR√çTICO (0-2): "Cego"</h4>
            <p>N√£o acompanha nenhum indicador. Decis√µes baseadas em "feeling". S√≥ sabe se foi bem quando contador entrega DRE meses depois.</p>
        </div>

        <div class="nivel-card basico">
            <h4>üü† B√ÅSICO (3-4): "Vista Turva"</h4>
            <p>Acompanha 2-3 indicadores b√°sicos (faturamento, margem). Calcula manualmente. Revis√£o mensal.</p>
        </div>

        <div class="nivel-card estruturado">
            <h4>üü° ESTRUTURADO (5-7): "Painel Completo"</h4>
            <p>Dashboard com 10-15 indicadores essenciais. Atualiza√ß√£o semanal. An√°lise de tend√™ncias. Compara√ß√£o com metas.</p>
        </div>

        <div class="nivel-card otimizado">
            <h4>üü¢ OTIMIZADO (8-10): "Tempo Real"</h4>
            <p>Dashboard em tempo real. 20+ KPIs segmentados. Alertas autom√°ticos. Benchmarking com mercado. An√°lise preditiva.</p>
        </div>
    </div>

    <div class="caso-box">
        <h3>üíº Caso: E-commerce de Moda - R$ 1,2MM/m√™s</h3>
        <p><strong>Situa√ß√£o inicial:</strong> Faturava bem mas sempre sem caixa. N√£o entendia por qu√™. Margem bruta parecia boa (45%).</p>
        <p><strong>A√ß√£o:</strong> Implementou dashboard de indicadores. Descobriu: Prazo M√©dio Recebimento = 68 dias. Prazo M√©dio Pagamento = 28 dias. Ciclo de caixa = 65 dias!</p>
        <p><strong>Solu√ß√£o:</strong> Reduziu PMR para 42 dias (cashback para pagamento √† vista). Negociou PMP para 45 dias. Novo ciclo de caixa: 22 dias.</p>
        <p><strong>Resultado:</strong> Liberou R$ 180k de capital de giro que estava preso. Eliminou necessidade de cheque especial. Economia anual: R$ 85k.</p>
    </div>

    <div class="checklist-rapido">
        <h3>‚úÖ Dashboard M√≠nimo (Atualizar Semanalmente)</h3>
        <ul>
            <li>‚òê Faturamento do m√™s (vs meta)</li>
            <li>‚òê Margem bruta %</li>
            <li>‚òê Margem l√≠quida %</li>
            <li>‚òê Liquidez corrente</li>
            <li>‚òê Dias de caixa dispon√≠vel</li>
            <li>‚òê Inadimpl√™ncia %</li>
            <li>‚òê Ticket m√©dio</li>
            <li>‚òê Custo de aquisi√ß√£o de cliente (CAC)</li>
        </ul>
    </div>
</div>

<!-- CAP√çTULO 8: PLANEJAMENTO TRIBUT√ÅRIO -->
<div class="ebook-capitulo" id="cap8-tributario">
    <div class="ebook-capa-capitulo">
        <h1>üìú CAP√çTULO 8</h1>
        <h2>PLANEJAMENTO TRIBUT√ÅRIO</h2>
        <h3>Pagar Menos, Legalmente</h3>
    </div>

    <div class="ebook-intro-rapida">
        <p><strong>O que √©:</strong> Planejamento tribut√°rio √© o estudo legal para reduzir a carga de impostos da empresa, escolhendo o regime mais vantajoso (Simples, Lucro Presumido, Lucro Real) e aproveitando benef√≠cios fiscais permitidos.</p>
        
        <p><strong>Por que importa:</strong> Impostos podem representar 15-35% do faturamento. A diferen√ßa entre regimes pode significar R$ 50-200k/ano economizados. N√£o √© sonega√ß√£o, √© intelig√™ncia fiscal dentro da lei. 60% das PMEs pagam mais impostos do que deveriam por estar no regime errado.</p>
    </div>

    <div class="comparacao-regimes">
        <h3>‚öñÔ∏è Compara√ß√£o de Regimes Tribut√°rios</h3>

        <div class="regime-box">
            <h4>üü¢ SIMPLES NACIONAL</h4>
            <p><strong>Para quem:</strong> Faturamento at√© R$ 4,8MM/ano</p>
            <p><strong>Al√≠quota:</strong> 4-16% sobre faturamento (depende atividade e faixa)</p>
            <p><strong>Vantagens:</strong> Simplicidade, menos burocracia, √∫nico boleto</p>
            <p><strong>Desvantagens:</strong> Pode ser mais caro em margens altas, limita√ß√µes em alguns setores</p>
            <p><strong>Ideal para:</strong> Servi√ßos, com√©rcio pequeno, margem < 30%</p>
        </div>

        <div class="regime-box">
            <h4>üü° LUCRO PRESUMIDO</h4>
            <p><strong>Para quem:</strong> Faturamento at√© R$ 78MM/ano</p>
            <p><strong>Al√≠quota:</strong> ~13-16% (IR+CSLL sobre presun√ß√£o + PIS/COFINS/ISS)</p>
            <p><strong>Vantagens:</strong> Vantajoso em margens altas (> 32%), menos controles</p>
            <p><strong>Desvantagens:</strong> Presume lucro independente se teve</p>
            <p><strong>Ideal para:</strong> Servi√ßos profissionais, margens > 32%</p>
        </div>

        <div class="regime-box">
            <h4>üî¥ LUCRO REAL</h4>
            <p><strong>Para quem:</strong> Faturamento > R$ 78MM/ano ou preju√≠zo fiscal</p>
            <p><strong>Al√≠quota:</strong> Vari√°vel - tributa lucro real</p>
            <p><strong>Vantagens:</strong> Justo (paga sobre lucro real), pode compensar preju√≠zos</p>
            <p><strong>Desvantagens:</strong> Burocracia intensa, controles rigorosos</p>
            <p><strong>Ideal para:</strong> Grandes empresas, margens baixas, preju√≠zos</p>
        </div>
    </div>

    <div class="ebook-niveis-resumido">
        <h3>üìä N√≠veis de Maturidade</h3>

        <div class="nivel-card critico">
            <h4>üî¥ CR√çTICO (0-2): "No Regime Errado"</h4>
            <p>Nunca revisou regime tribut√°rio. Est√° no Simples mas pagaria menos no Presumido (ou vice-versa). N√£o aproveita benef√≠cios legais. Paga 20-40% mais impostos que deveria.</p>
        </div>

        <div class="nivel-card basico">
            <h4>üü† B√ÅSICO (3-4): "Regime Certo, Gest√£o B√°sica"</h4>
            <p>Fez an√°lise uma vez e escolheu regime adequado. Mas n√£o revisa anualmente. N√£o aproveita todas possibilidades legais. Paga 10-15% a mais que poderia.</p>
        </div>

        <div class="nivel-card estruturado">
            <h4>üü° ESTRUTURADO (5-7): "Otimizado"</h4>
            <p>Revisa regime anualmente. Aproveita incentivos fiscais dispon√≠veis. Planejamento de distribui√ß√£o de lucros otimizado. Economia de 8-20% vs n√£o planejar.</p>
        </div>

        <div class="nivel-card otimizado">
            <h4>üü¢ OTIMIZADO (8-10): "M√°xima Efici√™ncia"</h4>
            <p>Estrutura societ√°ria otimizada. Holdings quando faz sentido. Reestrutura√ß√£o de atividades. Aproveitamento m√°ximo de benef√≠cios. Economia de 15-35% vs n√£o planejar.</p>
        </div>
    </div>

    <div class="evolucao-rapida">
        <h3>üöÄ Como Evoluir</h3>
        
        <div class="fase-box">
            <h4>Cr√≠tico ‚Üí B√°sico (30 dias)</h4>
            <ol>
                <li>Simular 3 regimes com seu contador</li>
                <li>Calcular carga tribut√°ria efetiva atual</li>
                <li>Identificar potencial economia trocando regime</li>
                <li>Fazer mudan√ßa se economia > 10%</li>
            </ol>
        </div>

        <div class="fase-box">
            <h4>B√°sico ‚Üí Estruturado (90 dias)</h4>
            <ol>
                <li>Agenda revis√£o anual autom√°tica (todo novembro)</li>
                <li>Mapear incentivos fiscais do seu setor/regi√£o</li>
                <li>Otimizar distribui√ß√£o de lucros (pr√≥-labore vs dividendos)</li>
                <li>Segregar atividades se tributadas diferente</li>
            </ol>
        </div>

        <div class="fase-box">
            <h4>Estruturado ‚Üí Otimizado (180 dias)</h4>
            <ol>
                <li>Avaliar cria√ß√£o de holding (se faz sentido)</li>
                <li>Reestruturar societ√°ria otimizando impostos</li>
                <li>Aproveitar cr√©ditos fiscais (PIS/COFINS)</li>
                <li>Consultoria tribut√°ria especializada</li>
            </ol>
        </div>
    </div>

    <div class="caso-box">
        <h3>üíº Caso: Consultoria de TI - R$ 180k/m√™s</h3>
        <p><strong>Situa√ß√£o inicial:</strong> Simples Nacional, anexo III, al√≠quota 11,2%. Pagava R$ 20.160/m√™s = R$ 242k/ano em impostos.</p>
        <p><strong>An√°lise:</strong> Margem l√≠quida de 45% (muito alta). Lucro Presumido seria mais vantajoso.</p>
        <p><strong>Mudan√ßa:</strong> Migrou para Lucro Presumido. Nova carga: 13,33% = R$ 24k/m√™s = R$ 288k/ano.</p>
        <p><strong>Espera a√≠... aumentou?!</strong> N√ÉO! Conseguiu se enquadrar em al√≠quota menor de 11,33% = R$ 20,4k/m√™s = R$ 245k/ano.</p>
        <p><strong>Mas a√≠ n√£o economizou...</strong> VERDADE! Mas revisando melhor descobriu que 30% da receita era revenda de software (margem 8%). Separou essa atividade.</p>
        <p><strong>Resultado final:</strong> Consultoria (70%): Lucro Presumido. Revenda (30%): Simples. Carga total: R$ 195k/ano. <strong>Economia: R$ 47k/ano (19%)</strong></p>
        <p><strong>Investimento:</strong> R$ 3.500 (consultoria especializada). <strong>ROI: 1.243%</strong></p>
    </div>

    <div class="checklist-rapido">
        <h3>‚úÖ Checklist de An√°lise Tribut√°ria</h3>
        <ul>
            <li>‚òê Qual seu regime atual?</li>
            <li>‚òê Qual sua carga tribut√°ria efetiva? (%)</li>
            <li>‚òê √öltima vez que revisou o regime? (ano)</li>
            <li>‚òê J√° simulou outros regimes este ano?</li>
            <li>‚òê Conhece os incentivos fiscais do seu setor?</li>
            <li>‚òê Distribui√ß√£o lucros est√° otimizada?</li>
            <li>‚òê Tem atividades que poderiam ser segregadas?</li>
            <li>‚òê Seu contador √© proativo ou reativo?</li>
        </ul>
    </div>

    <div class="alerta-importante">
        <h3>‚ö†Ô∏è ATEN√á√ÉO: Nova Reforma Tribut√°ria</h3>
        <p>A Reforma Tribut√°ria (IBS + CBS) est√° sendo implementada gradualmente at√© 2033. As regras est√£o mudando!</p>
        <p><strong>O que fazer:</strong> Revisar planejamento tribut√°rio ANUALMENTE com seu contador. As estrat√©gias que funcionam hoje podem n√£o funcionar amanh√£.</p>
        <p><strong>Oportunidade:</strong> A transi√ß√£o gera oportunidades. Empresas atentas podem economizar muito nos pr√≥ximos anos.</p>
    </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     FIM DO CONTE√öDO DOS CAP√çTULOS 4 A 8
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
</section>

<style>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ESTILOS DA SE√á√ÉO EBOOK PREMIUM
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

#ebook {
    padding: 40px;
    max-width: 1400px;
    margin: 0 auto;
    background: #F5F7FA;
}

.ebook-header {
    text-align: center;
    padding: 40px 30px;
    background: linear-gradient(135deg, #1976D2 0%, #2196F3 100%);
    color: white;
    border-radius: 20px;
    margin-bottom: 40px;
    box-shadow: 0 10px 30px rgba(25, 118, 210, 0.3);
}

.ebook-header h1 { font-size: 2.5em; margin-bottom: 15px; font-weight: 700; }
.ebook-header p { font-size: 1.2em; opacity: 0.95; margin-bottom: 8px; }
.ebook-subtitle { font-size: 1em !important; opacity: 0.85 !important; }

.ebook-progresso-card {
    background: white;
    padding: 35px;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    margin-bottom: 40px;
}

.ebook-progresso-card h3 { color: #1976D2; margin-bottom: 25px; font-size: 1.5em; text-align: center; }

.progress-bar-ebook {
    width: 100%;
    height: 40px;
    background: #E0E0E0;
    border-radius: 20px;
    overflow: hidden;
    position: relative;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
}

.progress-fill-ebook {
    height: 100%;
    background: linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    font-size: 1.1em;
    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.4);
}

.ebook-capitulos-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 25px;
    margin-bottom: 50px;
}

.capitulo-card {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    display: flex;
    gap: 20px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.capitulo-card::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 5px;
    transition: width 0.3s ease;
}

.capitulo-card.capitulo-completo::before { background: linear-gradient(180deg, #4CAF50, #8BC34A); }
.capitulo-card.capitulo-completo::before { background: linear-gradient(180deg, #FFC107, #FFB300); }
.capitulo-card:hover { transform: translateY(-8px); box-shadow: 0 15px 35px rgba(0,0,0,0.15); }
.capitulo-card.capitulo-completo:hover::before { width: 8px; }
.capitulo-card.capitulo-completo { opacity: 0.7; }

.capitulo-status { font-size: 3em; line-height: 1; flex-shrink: 0; }
.capitulo-conteudo h4 { color: #1976D2; margin-bottom: 8px; font-size: 1.2em; }
.capitulo-desc { color: #666; font-size: 0.95em; margin-bottom: 15px; }
.capitulo-features { list-style: none; padding: 0; margin: 0; }
.capitulo-features li { padding: 6px 0; color: #555; font-size: 0.9em; }

.ebook-downloads-section {
    background: white;
    padding: 40px;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    margin-bottom: 40px;
}

.ebook-downloads-section h3 { color: #1976D2; margin-bottom: 30px; font-size: 1.8em; text-align: center; }

.downloads-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
}

.download-card {
    background: #F8F9FA;
    padding: 30px;
    border-radius: 15px;
    text-align: center;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
}

.download-card.download-disponivel { background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); }
.download-card.download-destaque { background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%); box-shadow: 0 8px 20px rgba(255, 193, 7, 0.3); }
.download-card:hover:not(.download-pendente) { transform: translateY(-10px) scale(1.02); box-shadow: 0 15px 35px rgba(0,0,0,0.2); }
.download-card.download-pendente { opacity: 0.5; cursor: not-allowed; }

.download-badge {
    position: absolute;
    top: 15px;
    right: 15px;
    background: #FF5722;
    color: white;
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.75em;
    font-weight: bold;
    animation: pulse 2s infinite;
}

.download-icon { font-size: 3.5em; margin-bottom: 15px; }
.download-card h4 { color: #1976D2; margin-bottom: 10px; font-size: 1.3em; }
.download-card p { color: #555; margin-bottom: 12px; font-weight: 500; }
.download-info { color: #777; font-size: 0.9em; margin: 15px 0 20px 0; }

.btn-download-ebook {
    display: inline-block;
    padding: 14px 35px;
    background: #1976D2;
    color: white;
    text-decoration: none;
    border-radius: 10px;
    font-weight: 700;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1em;
}

.btn-download-ebook:hover:not(:disabled) { background: #1565C0; transform: scale(1.05); box-shadow: 0 5px 15px rgba(21, 101, 192, 0.4); }
.btn-download-ebook.btn-download-destaque { background: linear-gradient(135deg, #FF9800, #F57C00); box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3); }
.btn-download-ebook.btn-download-destaque:hover { background: linear-gradient(135deg, #F57C00, #E65100); }
.btn-download-ebook:disabled { background: #BDBDBD; cursor: not-allowed; transform: none; }

.ebook-destaques-box {
    background: linear-gradient(135deg, #FFF9C4 0%, #FFF59D 100%);
    padding: 40px;
    border-radius: 15px;
    margin-bottom: 40px;
    box-shadow: 0 5px 15px rgba(255, 193, 7, 0.2);
}

.ebook-destaques-box h3 { color: #F57F17; margin-bottom: 30px; font-size: 1.8em; text-align: center; }

.destaques-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.destaque-item {
    background: white;
    padding: 20px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 15px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    transition: transform 0.3s ease;
}

.destaque-item:hover { transform: translateX(8px); }
.destaque-icon { font-size: 1.8em; flex-shrink: 0; }
.destaque-item span:last-child { font-weight: 500; color: #333; font-size: 0.95em; }

.ebook-cta-box {
    background: linear-gradient(135deg, #FF9800 0%, #FF5722 100%);
    color: white;
    padding: 50px 40px;
    border-radius: 15px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(255, 87, 34, 0.3);
}

.cta-icon { font-size: 4em; margin-bottom: 20px; }
.ebook-cta-box h3 { font-size: 2em; margin-bottom: 15px; font-weight: 700; }
.ebook-cta-box p { font-size: 1.2em; margin-bottom: 30px; opacity: 0.95; }

.btn-cta-ebook {
    padding: 18px 45px;
    background: white;
    color: #FF5722;
    border: none;
    border-radius: 12px;
    font-size: 1.1em;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.btn-cta-ebook:hover { transform: scale(1.1) translateY(-3px); box-shadow: 0 10px 25px rgba(0,0,0,0.3); }

@media (max-width: 968px) {
    .ebook-capitulos-grid { grid-template-columns: 1fr; }
    .downloads-grid { grid-template-columns: 1fr; }
    .destaques-grid { grid-template-columns: 1fr; }
    .capitulo-card { flex-direction: column; text-align: center; }
    .capitulo-status { margin-bottom: 15px; }
}

@media (max-width: 768px) {
    #ebook { padding: 20px; }
    .ebook-header h1 { font-size: 1.8em; }
    .ebook-header p { font-size: 1em; }
}
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ESTILOS PARA GERA√á√ÉO DO PDF DO E-BOOK
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

/* Container oculto que ser√° usado para gerar PDF */
#ebook-conteudo-completo {
    display: none;
    font-family: 'Arial', 'Helvetica', sans-serif;
    line-height: 1.6;
    color: #333;
}

/* Quando for gerar PDF, mostrar */
.gerando-pdf #ebook-conteudo-completo {
    display: block !important;
}

/* Capa de cada cap√≠tulo */
.ebook-capa-capitulo {
    page-break-before: always;
    text-align: center;
    padding: 80px 40px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    margin-bottom: 40px;
}

.ebook-capa-capitulo h1 {
    font-size: 48px;
    margin-bottom: 20px;
    font-weight: 700;
}

.ebook-capa-capitulo h2 {
    font-size: 36px;
    margin-bottom: 15px;
    font-weight: 600;
}

.ebook-capa-capitulo h3 {
    font-size: 20px;
    font-weight: 400;
    opacity: 0.9;
}

/* Cap√≠tulos */
.ebook-capitulo {
    padding: 40px;
    max-width: 800px;
    margin: 0 auto;
}

.ebook-capitulo h3 {
    color: #1976D2;
    font-size: 24px;
    margin: 30px 0 15px 0;
    border-bottom: 2px solid #1976D2;
    padding-bottom: 8px;
}

.ebook-capitulo h4 {
    color: #333;
    font-size: 18px;
    margin: 20px 0 10px 0;
    font-weight: 600;
}

.ebook-capitulo p {
    margin: 12px 0;
    text-align: justify;
}

.ebook-capitulo ul, .ebook-capitulo ol {
    margin: 15px 0;
    padding-left: 30px;
}

.ebook-capitulo li {
    margin: 8px 0;
}

/* Introdu√ß√£o r√°pida */
.ebook-intro-rapida {
    background: #E3F2FD;
    padding: 25px;
    border-radius: 10px;
    border-left: 5px solid #1976D2;
    margin: 25px 0;
}

/* Cards de n√≠veis */
.ebook-niveis-resumido {
    margin: 30px 0;
}

.nivel-card {
    padding: 20px;
    margin: 15px 0;
    border-radius: 10px;
    border-left: 5px solid #999;
}

.nivel-card.critico {
    background: #FFEBEE;
    border-left-color: #F44336;
}

.nivel-card.basico {
    background: #FFF3E0;
    border-left-color: #FF9800;
}

.nivel-card.estruturado {
    background: #FFF9C4;
    border-left-color: #FFC107;
}

.nivel-card.otimizado {
    background: #E8F5E9;
    border-left-color: #4CAF50;
}

.nivel-card h4 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 18px;
}

/* Fases de evolu√ß√£o */
.evolucao-rapida {
    margin: 30px 0;
}

.fase-box {
    background: #F5F5F5;
    padding: 20px;
    margin: 15px 0;
    border-radius: 8px;
    border-left: 4px solid #667eea;
}

.fase-box h4 {
    color: #667eea;
    margin-top: 0;
}

.fase-box ol {
    margin: 15px 0;
}

/* Caso real */
.caso-box {
    background: #E8EAF6;
    padding: 25px;
    margin: 30px 0;
    border-radius: 10px;
    border: 2px solid #3F51B5;
}

.caso-box h3 {
    color: #3F51B5;
    border-bottom: 2px solid #3F51B5;
}

/* Checklist */
.checklist-rapido {
    background: #E0F7FA;
    padding: 25px;
    margin: 30px 0;
    border-radius: 10px;
}

.checklist-rapido h3 {
    color: #00796B;
    border-bottom: 2px solid #00796B;
}

.checklist-rapido ul {
    list-style: none;
    padding-left: 0;
}

.checklist-rapido li {
    padding: 8px 0;
    padding-left: 30px;
    position: relative;
}

.checklist-rapido li:before {
    content: "‚òê";
    position: absolute;
    left: 0;
    font-size: 18px;
    color: #00796B;
}

/* Destaques e alertas */
.ebook-destaque {
    background: #FFF9C4;
    padding: 15px 20px;
    margin: 20px 0;
    border-radius: 8px;
    border-left: 5px solid #FBC02D;
    font-weight: 600;
    font-size: 16px;
    text-align: center;
}

.ebook-alerta {
    background: #FFEBEE;
    padding: 15px 20px;
    margin: 20px 0;
    border-radius: 8px;
    border-left: 5px solid #F44336;
}

.alerta-importante {
    background: #FFE0B2;
    padding: 25px;
    margin: 30px 0;
    border-radius: 10px;
    border: 3px solid #FF9800;
}

/* Tabelas */
.resultado-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
}

.resultado-table th, .resultado-table td {
    border: 1px solid #ddd;
    padding: 12px;
    text-align: left;
}

.resultado-table th {
    background: #1976D2;
    color: white;
    font-weight: 600;
}

.resultado-table tr:nth-child(even) {
    background: #f9f9f9;
}

/* Boxes especiais */
.indicadores-essenciais {
    margin: 30px 0;
}

.categoria-indicadores {
    background: #F5F5F5;
    padding: 20px;
    margin: 15px 0;
    border-radius: 8px;
    border-left: 4px solid #00796B;
}

.comparacao-regimes {
    margin: 30px 0;
}

.regime-box {
    background: #F5F5F5;
    padding: 20px;
    margin: 15px 0;
    border-radius: 8px;
    border-left: 4px solid #1976D2;
}

/* Quebras de p√°gina para PDF */
.ebook-capitulo {
    page-break-after: always;
}

.caso-box {
    page-break-inside: avoid;
}

.nivel-card {
    page-break-inside: avoid;
}

/* Impress√£o/PDF */
@media print {
    .ebook-capitulo {
        padding: 20px;
    }
    
    .ebook-capa-capitulo {
        padding: 60px 20px;
    }
}
</style>


<!-- MODAL DE LEITURA -->
<div id="ajuda-modal-overlay" class="ajuda-modal-overlay" onclick="if(event.target===this) fecharArtigoModal()">
    <div class="ajuda-modal">
        <div class="ajuda-modal-header">
            <div class="ajuda-modal-titulo" id="modal-titulo"></div>
            <button class="ajuda-modal-close" onclick="fecharArtigoModal()">√ó</button>
        </div>
        <div class="ajuda-modal-body">
            <div class="ajuda-modal-conteudo" id="modal-conteudo"></div>
        </div>
    </div>
</div>
            
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                 SPRINT 9: HIST√ìRICO E TEMPLATES
                 ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            
            <section id="historico-propostas" class="section">
                <div class="historico-container">
                    
                    <!-- Header -->
                    <div class="historico-header">
                        <h1>üìö Hist√≥rico de Propostas</h1>
                        <p>Gerencie, reutilize e compare suas propostas comerciais salvas</p>
                    </div>
                    
                    <!-- Barra de A√ß√µes -->
                    <div class="historico-actions">
                        <div class="historico-search">
                            <input type="text" 
                                   id="busca-proposta" 
                                   placeholder="üîç Buscar por nome ou empresa..."
                                   onkeyup="buscarPropostas()">
                        </div>
                        
                        <div class="historico-filters">
                            <button class="filter-btn active" onclick="filtrarPor('todas')" data-filter="todas">
                                Todas
                            </button>
                            <button class="filter-btn" onclick="filtrarPor('propostas')" data-filter="propostas">
                                Propostas
                            </button>
                            <button class="filter-btn" onclick="filtrarPor('templates')" data-filter="templates">
                                Templates
                            </button>
                        </div>
                        
                        <button class="filter-btn" onclick="ordenarPropostas()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none;">
                            ‚¨ÜÔ∏è‚¨áÔ∏è Ordenar
                        </button>
                    </div>
                    
                    <!-- Grid de Propostas -->
                    <div id="propostas-grid" class="propostas-grid">
                        <!-- Cards ser√£o inseridos aqui via JavaScript -->
                    </div>
                    
                    <!-- Empty State -->
                    <div id="empty-state" class="empty-state" style="display: none;">
                        <div class="empty-state-icon">üìã</div>
                        <h3>Nenhuma proposta salva ainda</h3>
                        <p>V√° para a aba "Proposta Comercial" e clique em "Salvar Proposta" para come√ßar!</p>
                    </div>
                    
                    <!-- Templates Pr√©-definidos -->
                    <div class="templates-section">
                        <div class="templates-header">
                            <h2>‚≠ê Templates Prontos para Usar</h2>
                            <p>Modelos pr√©-configurados para acelerar sua cria√ß√£o de propostas</p>
                        </div>
                        
                        <div id="templates-predefinidos" class="propostas-grid">
                            <!-- Templates pr√©-definidos ser√£o inseridos aqui -->
                        </div>
                    </div>
                    
                </div>
            </section>
            
            <!-- Modal de Salvar Proposta -->
            <div id="modal-salvar-proposta" class="modal-salvar">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>üíæ Salvar Proposta</h2>
                        <p>Guarde esta configura√ß√£o para reutilizar depois</p>
                    </div>
                    
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="form-label">
                                Nome da Proposta <span class="required">*</span>
                            </label>
                            <input type="text" 
                                   id="nome-proposta" 
                                   class="form-input" 
                                   placeholder="Ex: Proposta Cliente X - Pacote Funda√ß√£o"
                                   required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                Tipo
                            </label>
                            <select id="tipo-proposta" class="form-select">
                                <option value="proposta">Proposta para Cliente</option>
                                <option value="template">Template Reutiliz√°vel</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                Observa√ß√µes (opcional)
                            </label>
                            <textarea id="obs-proposta" 
                                      class="form-textarea" 
                                      placeholder="Anota√ß√µes sobre esta proposta..."></textarea>
                        </div>
                        
                        <!-- Resumo -->
                        <div style="background: #f8f9fa; padding: 16px; border-radius: 10px; margin-top: 20px;">
                            <div style="font-weight: 600; margin-bottom: 8px; color: #2c3e50;">üìä Resumo da Proposta:</div>
                            <div style="font-size: 0.9em; color: #7f8c8d;">
                                <div id="resumo-produtos"></div>
                                <div id="resumo-valor" style="margin-top: 8px; font-weight: 700; color: #27ae60;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="modal-btn modal-btn-secondary" onclick="fecharModalSalvar()">
                            Cancelar
                        </button>
                        <button type="button" class="modal-btn modal-btn-primary" onclick="event.preventDefault(); event.stopPropagation(); salvarPropostaAgora(); return false;">
                            üíæ Salvar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <button class="fab" onclick="salvarProgresso()" title="Salvar">üíæ</button>
    
    <!-- Backdrop -->
    <div class="celebration-backdrop" id="celebration-backdrop" onclick="fecharCelebracao()" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);z-index:9999"></div>
    
    <!-- Modal -->
    <div class="celebration" id="celebration">
        <!-- Bot√£o Fechar -->
        <button onclick="fecharCelebracao()" style="position:absolute;top:16px;right:16px;background:transparent;border:none;font-size:1.5em;cursor:pointer;color:var(--text-light);width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all 0.3s" onmouseover="this.style.background='rgba(0,0,0,0.1)'" onmouseout="this.style.background='transparent'">√ó</button>
        
        <div style="font-size:5em;margin-bottom:20px">üéâüéäüèÜ</div>
        <h2 style="font-size:2.2em;color:var(--primary);margin-bottom:16px;font-family:'Playfair Display',serif">Parab√©ns!</h2>
        <p style="font-size:1.3em;color:var(--text);margin-bottom:8px;font-weight:600">Diagn√≥stico 100% Completo!</p>
        <p id="celebration-msg" style="font-size:1em;color:var(--text-light);margin-bottom:24px">Todas as perguntas foram respondidas com sucesso</p>
        <button class="btn" style="margin-top:24px;padding:16px 32px;font-size:1.1em" onclick="fecharCelebracao();irPara('scoring')">Ver Meu Score üéØ</button>
    </div>
    
    <script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATABASE COMPLETO - CATEGORIAS 1, 2 e 3 (45/75 PERGUNTAS)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const PERGUNTAS_DB = `t1|Tesouraria|Existe controle di√°rio de contas a pagar e receber?|N√£o existe controle di√°rio estruturado, o que impede vis√£o clara das obriga√ß√µes e recebimentos, gerando risco recorrente de atrasos, juros e decis√µes financeiras no improviso.|Criar imediatamente uma planilha ou sistema simples de contas a pagar e receber, com atualiza√ß√£o di√°ria obrigat√≥ria e defini√ß√£o clara de respons√°vel pela rotina.|Existe algum controle, por√©m feito manualmente de forma consistente, sem atualiza√ß√£o di√°ria consistente, o que limita previsibilidade e aumenta o risco de esquecimentos financeiros.|Definir rotina di√°ria fixa para atualiza√ß√£o das contas, estabelecendo hor√°rio, respons√°vel e padr√£o m√≠nimo de informa√ß√µes registradas.|O controle di√°rio existe e √© realizado atrav√©s de sistema para o operacional, permitindo acompanhar compromissos e recebimentos, mas ainda pouco explorado para decis√µes.|Integrar o controle di√°rio a relat√≥rios semanais que apoiem decis√µes de caixa e prioriza√ß√£o de pagamentos.|O controle di√°rio √© confi√°vel, atualizado em sistema e utilizado ativamente para planejar pagamentos, recebimentos e decis√µes financeiras estrat√©gicas.|Automatizar alertas, concilia√ß√µes e proje√ß√µes futuras para aumentar efici√™ncia e reduzir riscos operacionais.
t2|Tesouraria|As contas da empresa s√£o separadas das contas pessoais?|N√£o h√° separa√ß√£o entre contas pessoais e da empresa, o que distorce resultados, dificulta controles e compromete a an√°lise financeira real do neg√≥cio.|Abrir conta banc√°ria exclusiva para a empresa e definir regra clara proibindo pagamentos pessoais pelo caixa empresarial.|Existe tentativa de separa√ß√£o, mas ocorrem misturas frequentes entre contas pessoais e empresariais, com retiradas informais, pagamentos pessoais pela empresa e falta de controle rigoroso, comprometendo a confiabilidade dos n√∫meros.|Criar pol√≠tica formal de retirada pr√≥-labore e reembolso, eliminando pagamentos pessoais diretos pela empresa.|As contas est√£o razoavelmente separadas, com disciplina na maioria das situa√ß√µes, mas ainda ocorrem exce√ß√µes pontuais que exigem ajustes manuais e aten√ß√£o para manter a separa√ß√£o funcionando adequadamente.|Formalizar regras de movimenta√ß√£o e revisar mensalmente se houve exce√ß√µes √† separa√ß√£o financeira.|A separa√ß√£o √© total e respeitada, garantindo demonstra√ß√µes financeiras confi√°veis e base s√≥lida para decis√µes estrat√©gicas.|Manter auditorias internas peri√≥dicas para assegurar que a separa√ß√£o continue sendo cumprida rigorosamente.
t3|Tesouraria|Existe rotina definida para registrar movimenta√ß√µes financeiras?|As movimenta√ß√µes n√£o seguem rotina definida, sendo registradas de forma espor√°dica ou atrasada, comprometendo a confiabilidade dos dados.|Definir rotina di√°ria obrigat√≥ria de registro financeiro, com padr√£o m√≠nimo de informa√ß√µes e respons√°vel designado.|A rotina existe de forma prec√°ria e irregular, com atrasos frequentes de 3-5 dias ou mais, dependendo muito de lembran√ßa pessoal, sem processo estruturado ou cobran√ßa clara, gerando retrabalho constante.|Criar procedimento escrito simples e estabelecer cobran√ßa semanal sobre o cumprimento da rotina.|A rotina √© seguida com razo√°vel regularidade (atrasos ocasionais de 1-2 dias), utilizando m√©todo mais organizado, mas ainda manual e sujeito a falhas quando h√° sobrecarga ou imprevistos.|Integrar a rotina a indicadores simples de desempenho financeiro e confer√™ncia peri√≥dica.|A rotina √© padronizada, automatizada sempre que poss√≠vel e garante dados confi√°veis em tempo real para gest√£o.|Revisar periodicamente a rotina para otimizar tempo, reduzir erros e ampliar uso estrat√©gico das informa√ß√µes.
t4|Tesouraria|Os pagamentos seguem um calend√°rio financeiro organizado?|Os pagamentos s√£o feitos de forma reativa, sem calend√°rio definido, aumentando riscos de atrasos, multas e desorganiza√ß√£o de caixa.|Criar calend√°rio financeiro mensal com todas as obriga√ß√µes fixas e vari√°veis, validado no in√≠cio de cada m√™s.|Existe no√ß√£o informal das datas principais, mas sem calend√°rio estruturado ou centralizado, com alta depend√™ncia de mem√≥ria, gerando esquecimentos frequentes, multas por atraso e decis√µes de √∫ltima hora.|Centralizar todas as datas de pagamento em um √∫nico calend√°rio compartilhado e revisado semanalmente.|O calend√°rio financeiro existe e √© consultado regularmente, reduzindo atrasos significativos, mas ainda n√£o est√° totalmente integrado ao fluxo de caixa e exige confer√™ncias manuais frequentes.|Conectar o calend√°rio ao fluxo de caixa projetado para avaliar impactos antes dos vencimentos.|O calend√°rio √© integrado ao fluxo de caixa e utilizado para negociar prazos e otimizar uso do capital.|Revisar periodicamente prazos com fornecedores buscando alinhar pagamentos √† estrat√©gia financeira.
t5|Tesouraria|H√° confer√™ncia peri√≥dica de extratos banc√°rios?|Os extratos banc√°rios n√£o s√£o conferidos regularmente, o que aumenta risco de erros, cobran√ßas indevidas e falta de controle.|Estabelecer confer√™ncia semanal obrigat√≥ria dos extratos com os registros internos da empresa.|A confer√™ncia √© feita de forma espor√°dica e reativa (apenas quando surgem problemas ou d√∫vidas), permitindo que erros, cobran√ßas indevidas e diverg√™ncias passem despercebidos por semanas ou meses.|Definir rotina fixa de concilia√ß√£o banc√°ria com checklist simples e respons√°vel definido.|A concilia√ß√£o √© feita com razo√°vel frequ√™ncia (semanal ou quinzenal), de forma manual, melhorando a confiabilidade dos dados, mas ainda sujeita a falhas humanas e com margem para erros eventuais.|Automatizar concilia√ß√µes quando poss√≠vel e documentar ajustes realizados mensalmente.|A concilia√ß√£o banc√°ria √© precisa, frequente e integrada ao sistema financeiro, garantindo alta confiabilidade.|Utilizar relat√≥rios de concilia√ß√£o para an√°lise de taxas banc√°rias e melhoria de processos.
t9|Tesouraria|H√° controle de inadimpl√™ncia dos clientes?|N√£o h√° controle de inadimpl√™ncia, o que compromete o caixa e dificulta a cobran√ßa estruturada.|Criar controle b√°sico de clientes em atraso com valores e prazos atualizados.|O controle √© totalmente reativo, existindo apenas quando atrasos se tornam cr√≠ticos (30+ dias), sem listagem atualizada, processo de cobran√ßa ou indicadores de inadimpl√™ncia, comprometendo o caixa.|Estabelecer rotina semanal de acompanhamento e cobran√ßa de inadimplentes.|A inadimpl√™ncia √© monitorada com razo√°vel regularidade (semanal ou quinzenal), permitindo a√ß√µes de cobran√ßa mais organizadas, mas o processo ainda √© manual e nem sempre h√° follow-up consistente.|Definir pol√≠ticas de cobran√ßa e negocia√ß√£o padronizadas.|O controle √© integrado ao financeiro e utilizado para ajustar pol√≠ticas comerciais e de cr√©dito.|Analisar indicadores de inadimpl√™ncia para melhorar condi√ß√µes de venda.
t10|Tesouraria|Os recebimentos s√£o conciliados com vendas ou faturamento?|N√£o existe concilia√ß√£o entre recebimentos e vendas, gerando risco de erros e perdas financeiras.|Implementar concilia√ß√£o b√°sica comparando vendas realizadas e valores recebidos.|A concilia√ß√£o √© feita de forma manual muito espor√°dica (mensal ou trimestral), sem rotina clara, com confer√™ncia incompleta e alta chance de diverg√™ncias n√£o identificadas entre vendas e recebimentos.|Definir rotina mensal de concilia√ß√£o com respons√°vel designado.|A concilia√ß√£o √© feita com razo√°vel frequ√™ncia (quinzenal ou mensal), de forma organizada mas manual, melhorando a confiabilidade, por√©m ainda sujeita a erros eventuais e com margem para ajustes.|Documentar diferen√ßas encontradas e corrigir processos de origem.|A concilia√ß√£o √© autom√°tica ou sistematizada, assegurando controle total dos recebimentos.|Usar relat√≥rios de concilia√ß√£o para an√°lise de performance comercial.
t11|Tesouraria|Existe respons√°vel definido pela tesouraria?|N√£o h√° respons√°vel definido, o que gera falhas, retrabalho e falta de accountability financeira.|Designar formalmente um respons√°vel pela tesouraria e suas atribui√ß√µes.|Existe respons√°vel informal, mas sem clareza total das fun√ß√µes, responsabilidades ou autoridade para tomar decis√µes financeiras importantes, gerando confus√£o e sobreposi√ß√µes de tarefas.|Documentar fun√ß√µes da tesouraria e comunicar √† equipe.|O respons√°vel √© razoavelmente claro e executa as principais rotinas financeiras com certa consist√™ncia, mas ainda falta formaliza√ß√£o completa do cargo e clareza em algumas atribui√ß√µes.|Capacitar o respons√°vel com treinamentos b√°sicos de gest√£o financeira.|A tesouraria √© gerida por respons√°vel capacitado e alinhado √† estrat√©gia financeira.|Estabelecer indicadores de desempenho para a fun√ß√£o.
t13|Tesouraria|H√° hist√≥rico organizado das movimenta√ß√µes financeiras?|N√£o h√° hist√≥rico confi√°vel, dificultando an√°lises e compara√ß√µes ao longo do tempo.|Organizar registros hist√≥ricos m√≠nimos dos √∫ltimos meses.|O hist√≥rico existe parcialmente, mas muito incompleto, desorganizado ou com per√≠odos faltantes, dificultando severamente an√°lises confi√°veis e compara√ß√µes ao longo do tempo.|Padronizar armazenamento e nomenclatura dos registros financeiros.|O hist√≥rico √© razoavelmente confi√°vel e organizado, permitindo an√°lises comparativas funcionais, mas ainda pode ter lacunas em per√≠odos espec√≠ficos ou falta de detalhamento em algumas categorias.|Utilizar hist√≥rico para identificar tend√™ncias financeiras.|O hist√≥rico √© usado ativamente para planejamento e decis√µes estrat√©gicas.|Incorporar an√°lises hist√≥ricas ao planejamento financeiro.
t14|Tesouraria|Os compromissos financeiros futuros est√£o mapeados?|A empresa n√£o mapeia compromissos futuros, aumentando risco de surpresas financeiras.|Listar compromissos futuros com valores e vencimentos.|Alguns compromissos principais s√£o conhecidos de forma informal, mas sem mapeamento completo, valores atualizados ou vis√£o consolidada, gerando surpresas financeiras frequentes.|Consolidar todos os compromissos em controle √∫nico.|Os compromissos futuros est√£o razoavelmente mapeados e s√£o considerados no planejamento b√°sico, mas a atualiza√ß√£o nem sempre √© imediata e pode faltar detalhamento em alguns itens.|Integrar compromissos ao fluxo de caixa projetado.|O mapeamento √© completo e usado para decis√µes financeiras antecipadas.|Revisar compromissos regularmente para ajustes estrat√©gicos.
r1|Resultados|A empresa elabora DRE com alguma periodicidade?|A empresa n√£o elabora DRE, o que impede compreender claramente se o neg√≥cio gera lucro ou preju√≠zo e dificulta qualquer an√°lise gerencial consistente.|Implementar imediatamente uma DRE mensal simples, mesmo que inicial, separando receitas, custos e despesas para criar base m√≠nima de an√°lise.|A DRE √© feita de forma muito simplificada e irregular (trimestral ou semestral), com categorias gen√©ricas, mistura de despesas, sem rigor cont√°bil e dados frequentemente desatualizados ou incompletos.|Definir periodicidade fixa para elabora√ß√£o da DRE e garantir que seja revisada pela gest√£o todos os meses.|A DRE √© elaborada com razo√°vel regularidade (mensal ou bimestralmente), utilizando estrutura funcional com principais categorias, mas ainda falta detalhamento em alguns pontos e a acuracidade pode variar.|Criar rotina mensal de an√°lise da DRE destacando pontos de aten√ß√£o e oportunidades de melhoria.|A DRE √© parte central da gest√£o, utilizada para avaliar desempenho, margens e apoiar decis√µes estrat√©gicas do neg√≥cio.|Integrar a DRE a indicadores financeiros e comparativos hist√≥ricos para fortalecer a tomada de decis√£o.
r2|Resultados|O resultado mensal (lucro ou preju√≠zo) √© conhecido?|A empresa n√£o sabe claramente se teve lucro ou preju√≠zo no m√™s, operando sem vis√£o real do desempenho financeiro.|Apurar mensalmente o resultado financeiro consolidado e apresent√°-lo de forma clara √† gest√£o.|Existe no√ß√£o muito superficial do resultado, baseada principalmente em saldo de caixa ou percep√ß√µes vagas, sem apura√ß√£o t√©cnica confi√°vel ou metodologia consistente.|Utilizar a DRE para apurar resultado real e eliminar decis√µes baseadas apenas em saldo banc√°rio.|O resultado mensal √© razoavelmente conhecido atrav√©s de apura√ß√£o funcional, permitindo entender se o neg√≥cio est√° sustent√°vel, mas a precis√£o pode variar e nem sempre captura todos os elementos.|Comparar resultados mensais para identificar padr√µes e varia√ß√µes relevantes.|O resultado mensal √© conhecido, analisado em profundidade e usado como base para ajustes estrat√©gicos.|Relacionar o resultado a a√ß√µes concretas de redu√ß√£o de custos ou aumento de margem.
r3|Resultados|As margens de lucro s√£o acompanhadas?|A empresa n√£o acompanha margens de lucro, dificultando entender onde realmente ganha ou perde dinheiro.|Calcular margem b√°sica por produto ou servi√ßo para criar vis√£o inicial de rentabilidade.|As margens s√£o calculadas de forma muito espor√°dica e superficial, com crit√©rios inconsistentes e dados incompletos, gerando informa√ß√£o pouco confi√°vel ou √∫til para decis√µes.|Definir periodicidade mensal para an√°lise das margens principais do neg√≥cio.|As margens s√£o acompanhadas com razo√°vel regularidade utilizando m√©todo funcional, ajudando a identificar produtos/servi√ßos mais rent√°veis, mas a an√°lise ainda √© b√°sica e nem sempre aprofundada.|Comparar margens ao longo do tempo para identificar tend√™ncias positivas ou negativas.|As margens orientam decis√µes de precifica√ß√£o, mix de produtos e foco comercial da empresa.|Utilizar an√°lise de margens para redefinir estrat√©gias comerciais e operacionais.
r4|Resultados|Os custos est√£o separados das despesas?|Custos e despesas s√£o misturados, dificultando an√°lise correta da opera√ß√£o e do resultado financeiro real.|Classificar corretamente custos e despesas na DRE para melhorar qualidade da an√°lise financeira.|Existe apenas no√ß√£o te√≥rica ou informal da diferen√ßa entre custos e despesas, sem separa√ß√£o estruturada nos controles, misturando categorias e impossibilitando an√°lise de margem de contribui√ß√£o.|Revisar crit√©rios de classifica√ß√£o e padronizar conceitos para toda a empresa.|Custos e despesas est√£o razoavelmente separados na maior parte das categorias, permitindo an√°lise funcional de margem, mas ainda h√° algumas classifica√ß√µes duvidosas ou inconsist√™ncias eventuais.|Utilizar essa separa√ß√£o para an√°lises de efici√™ncia operacional.|A separa√ß√£o √© clara e utilizada para decis√µes estrat√©gicas sobre opera√ß√£o e estrutura de gastos.|Criar indicadores espec√≠ficos para custos e despesas visando otimiza√ß√£o cont√≠nua.
r5|Resultados|Existe vis√£o clara do faturamento mensal?|A empresa n√£o possui vis√£o consolidada do faturamento mensal, dificultando qualquer an√°lise de desempenho.|Consolidar mensalmente todas as fontes de receita em relat√≥rio √∫nico e confi√°vel.|O faturamento √© conhecido de forma muito fragmentada, disperso em m√∫ltiplas fontes, sem consolida√ß√£o confi√°vel, confer√™ncia adequada ou valida√ß√£o peri√≥dica dos valores.|Centralizar informa√ß√µes de faturamento e validar valores mensalmente.|O faturamento mensal √© razoavelmente conhecido e consolidado de forma funcional, permitindo acompanhamento b√°sico do crescimento, mas ainda pode ter pequenas diverg√™ncias ou atrasos na consolida√ß√£o completa.|Comparar faturamento mensal com metas e per√≠odos anteriores.|A vis√£o de faturamento √© usada para planejar crescimento, capacidade operacional e investimentos.|Integrar faturamento a proje√ß√µes financeiras e planejamento estrat√©gico.
r7|Resultados|Os resultados s√£o comparados entre meses?|A empresa n√£o compara resultados entre meses, dificultando identificar evolu√ß√£o, piora ou padr√µes financeiros relevantes.|Criar relat√≥rio simples comparando resultados mensais para permitir an√°lise m√≠nima de desempenho.|As compara√ß√µes s√£o feitas de forma muito espor√°dica e informal, sem hist√≥rico organizado ou base de dados confi√°vel, baseando-se mais em mem√≥ria que em n√∫meros consistentes.|Definir rotina mensal obrigat√≥ria de compara√ß√£o de resultados entre per√≠odos.|A compara√ß√£o mensal √© realizada com razo√°vel regularidade, utilizando hist√≥rico funcional, permitindo identificar varia√ß√µes principais, mas a an√°lise ainda √© superficial e nem sempre gera insights acion√°veis.|Analisar causas das principais varia√ß√µes positivas e negativas identificadas.|As compara√ß√µes s√£o aprofundadas e utilizadas para ajustes estrat√©gicos e melhoria cont√≠nua do desempenho.|Integrar compara√ß√µes mensais a indicadores e metas financeiras.
r9|Resultados|Os indicadores s√£o analisados com regularidade?|Mesmo quando existem, os indicadores n√£o s√£o analisados regularmente, perdendo sua utilidade gerencial.|Criar agenda fixa para an√°lise peri√≥dica dos indicadores financeiros.|A an√°lise ocorre de forma muito espor√°dica e sem padr√£o definido, geralmente apenas quando surgem problemas financeiros graves, com baixo aproveitamento do potencial dos indicadores.|Definir periodicidade m√≠nima mensal para an√°lise estruturada dos indicadores.|Os indicadores s√£o analisados com razo√°vel frequ√™ncia (mensal ou bimestral) e contribuem para ajustes operacionais b√°sicos, mas a an√°lise nem sempre √© profunda ou gera planos de a√ß√£o consistentes.|Registrar decis√µes tomadas a partir da an√°lise dos indicadores.|A an√°lise dos indicadores orienta decis√µes estrat√©gicas e planejamento financeiro.|Integrar an√°lise de indicadores √†s reuni√µes de gest√£o e planejamento.
r11|Resultados|H√° acompanhamento do lucro operacional?|O lucro operacional n√£o √© acompanhado, dificultando avaliar efici√™ncia do neg√≥cio principal.|Calcular mensalmente o lucro operacional separando efeitos financeiros e extraordin√°rios.|O acompanhamento ocorre de forma muito espor√°dica e manual, apenas quando surge necessidade espec√≠fica, sem an√°lise cont√≠nua de desempenho operacional ou separa√ß√£o clara dos efeitos n√£o-operacionais.|Definir rotina mensal para an√°lise do lucro operacional.|O lucro operacional √© razoavelmente acompanhado e utilizado para avaliar desempenho b√°sico do neg√≥cio, mas a separa√ß√£o dos elementos nem sempre √© precisa e a an√°lise pode ser superficial.|Comparar lucro operacional entre per√≠odos para identificar tend√™ncias.|O lucro operacional orienta decis√µes estrat√©gicas e ajustes operacionais relevantes.|Utilizar lucro operacional como indicador central de efici√™ncia.
r13|Resultados|Os resultados financeiros influenciam decis√µes?|As decis√µes s√£o tomadas sem considerar resultados financeiros, aumentando risco de escolhas inadequadas.|Incluir an√°lise de resultados como etapa obrigat√≥ria antes de decis√µes relevantes.|Os resultados influenciam apenas algumas decis√µes de forma irregular e informal, sem processo estruturado, crit√©rios claros ou documenta√ß√£o das an√°lises realizadas.|Criar rotina de apresenta√ß√£o dos resultados √† gest√£o antes de decis√µes estrat√©gicas.|Os resultados financeiros s√£o considerados de forma razoavelmente consistente nas principais decis√µes, mas o processo ainda n√£o √© totalmente sistem√°tico e algumas escolhas ainda s√£o feitas sem base financeira adequada.|Documentar decis√µes tomadas com base nos resultados.|Os resultados s√£o elemento central das decis√µes estrat√©gicas e operacionais.|Integrar resultados financeiros ao planejamento estrat√©gico cont√≠nuo.
r14|Resultados|Existe relat√≥rio financeiro para a gest√£o?|N√£o existe relat√≥rio financeiro estruturado, dificultando vis√£o consolidada do desempenho do neg√≥cio.|Criar relat√≥rio financeiro mensal simples com principais indicadores e resultados.|O relat√≥rio existe de forma muito b√°sica e irregular, com informa√ß√µes limitadas, apresenta√ß√£o confusa ou dados pouco claros, gerando baixa utilidade para tomada de decis√£o efetiva.|Melhorar clareza e padroniza√ß√£o das informa√ß√µes do relat√≥rio.|O relat√≥rio existe com razo√°vel estrutura e periodicidade, apoiando a gest√£o com informa√ß√µes relevantes e funcionais, mas ainda pode faltar profundidade em algumas an√°lises e a apresenta√ß√£o nem sempre √© objetiva.|Utilizar relat√≥rio como base para reuni√µes de gest√£o.|O relat√≥rio financeiro √© completo e orienta decis√µes estrat√©gicas do neg√≥cio.|Integrar relat√≥rios financeiros ao planejamento e acompanhamento de metas.
f1|Fluxo|Existe fluxo de caixa estruturado?|A empresa n√£o possui fluxo de caixa estruturado, operando sem vis√£o clara das entradas e sa√≠das financeiras, o que aumenta significativamente o risco de desequil√≠brio.|Criar imediatamente um fluxo de caixa simples, registrando todas as entradas e sa√≠das previstas e realizadas, mesmo que inicialmente em planilha.|Existe controle muito b√°sico e prec√°rio do caixa (anota√ß√µes soltas, caderno, mem√≥ria), totalmente manual, irregular, sem proje√ß√µes, frequentemente desatualizado, com baixa confiabilidade e utilidade limitada.|Padronizar o fluxo de caixa e garantir atualiza√ß√£o frequente para aumentar confiabilidade das informa√ß√µes.|O fluxo de caixa √© registrado com razo√°vel regularidade (pode ter atrasos de 1-2 dias), utilizando m√©todo mais organizado mas ainda manual, permitindo visibilidade funcional, por√©m com margem para erros e inconsist√™ncias.|Utilizar o fluxo de caixa para apoiar decis√µes de curto prazo, como prioriza√ß√£o de pagamentos.|O fluxo de caixa √© ferramenta central da gest√£o, confi√°vel e integrada √†s rotinas financeiras da empresa.|Integrar o fluxo de caixa a indicadores e relat√≥rios gerenciais para decis√µes mais estrat√©gicas.
f2|Fluxo|O fluxo de caixa √© projetado para o futuro?|A empresa n√£o projeta fluxo de caixa futuro, operando apenas com vis√£o do presente, o que aumenta risco de surpresas financeiras.|Criar proje√ß√£o m√≠nima de fluxo de caixa para pelo menos 30 dias √† frente.|A proje√ß√£o existe de forma muito prec√°ria apenas para poucos dias (7-15 dias), com dados incompletos, imprecisos ou desatualizados, sem metodologia clara ou confiabilidade adequada.|Estender a proje√ß√£o do fluxo de caixa para horizonte m√≠nimo de 60 a 90 dias.|O fluxo de caixa √© razoavelmente projetado para 30-60 dias com anteced√™ncia funcional para identificar poss√≠veis faltas, mas a precis√£o varia e nem sempre captura todos os elementos relevantes.|Revisar proje√ß√µes periodicamente para manter ader√™ncia √† realidade financeira.|A proje√ß√£o de caixa √© utilizada para planejamento financeiro, antecipa√ß√£o de riscos e decis√µes estrat√©gicas.|Utilizar proje√ß√µes para simular cen√°rios e apoiar decis√µes de crescimento.
f3|Fluxo|A empresa conhece seu saldo m√≠nimo de caixa?|A empresa n√£o conhece o saldo m√≠nimo necess√°rio para operar, ficando vulner√°vel a qualquer oscila√ß√£o de caixa.|Calcular valor m√≠nimo de caixa considerando despesas fixas e prazo m√©dio de recebimentos.|Existe apenas no√ß√£o muito aproximada e informal do saldo m√≠nimo, sem c√°lculo estruturado, crit√©rios claros ou revis√£o peri√≥dica, baseando-se mais em percep√ß√£o que em an√°lise t√©cnica.|Formalizar c√°lculo do saldo m√≠nimo e documentar crit√©rios utilizados.|O saldo m√≠nimo de caixa √© razoavelmente conhecido atrav√©s de c√°lculo funcional e √© respeitado na maior parte das decis√µes, mas nem sempre √© atualizado prontamente quando h√° mudan√ßas operacionais significativas.|Monitorar saldo m√≠nimo diariamente para evitar desequil√≠brios.|O saldo m√≠nimo √© utilizado como par√¢metro estrat√©gico para decis√µes de investimento e expans√£o.|Ajustar saldo m√≠nimo conforme crescimento e mudan√ßas operacionais.
f4|Fluxo|Existe controle do prazo m√©dio de recebimento?|A empresa n√£o controla prazos m√©dios de recebimento, dificultando gest√£o de caixa e capital de giro.|Levantar prazos praticados com clientes e registrar datas de recebimento efetivas.|O controle existe apenas de forma muito informal e espor√°dica, sem c√°lculo estruturado, registro hist√≥rico ou acompanhamento consistente da evolu√ß√£o dos prazos ao longo do tempo.|Calcular prazo m√©dio de recebimento mensalmente e acompanhar sua evolu√ß√£o.|O prazo m√©dio √© razoavelmente conhecido atrav√©s de c√°lculo funcional e √© utilizado para planejamento b√°sico de caixa, mas nem sempre √© atualizado regularmente ou considerado em todas as negocia√ß√µes comerciais.|Utilizar esse indicador para negociar prazos com clientes.|O prazo m√©dio de recebimento √© otimizado e alinhado √† estrat√©gia financeira da empresa.|Ajustar pol√≠ticas comerciais visando melhorar o ciclo financeiro.
f5|Fluxo|Existe controle do prazo m√©dio de pagamento?|A empresa n√£o controla prazos m√©dios de pagamento, o que dificulta planejamento financeiro e negocia√ß√£o com fornecedores.|Levantar prazos praticados e registrar datas reais de pagamento.|Existe controle muito b√°sico e irregular, sem an√°lise estruturada, c√°lculo consistente ou uso estrat√©gico das informa√ß√µes, limitando severamente a capacidade de otimiza√ß√£o do capital de giro.|Calcular prazo m√©dio de pagamento e acompanhar mensalmente.|O prazo m√©dio de pagamento √© razoavelmente conhecido e considerado no planejamento funcional de caixa, mas nem sempre √© utilizado proativamente para negocia√ß√µes ou otimiza√ß√£o da gest√£o de capital de giro.|Utilizar prazo m√©dio para equilibrar fluxo de caixa.|Os prazos de pagamento s√£o negociados estrategicamente para otimizar capital de giro.|Revisar contratos e negociar prazos alinhados ao ciclo financeiro.
f6|Fluxo|O ciclo financeiro do neg√≥cio √© conhecido?|A empresa n√£o conhece seu ciclo financeiro, dificultando compreens√£o das necessidades reais de capital de giro.|Calcular ciclo financeiro considerando prazos de recebimento e pagamento.|Existe apenas no√ß√£o muito b√°sica e informal do ciclo financeiro, sem c√°lculo preciso, metodologia estruturada ou acompanhamento regular da evolu√ß√£o dos prazos.|Formalizar c√°lculo do ciclo financeiro e revis√°-lo periodicamente.|O ciclo financeiro √© razoavelmente conhecido atrav√©s de c√°lculo funcional e √© utilizado para planejamento b√°sico de caixa, mas nem sempre √© atualizado regularmente ou considerado em todas as decis√µes relevantes.|Utilizar ciclo financeiro para antecipar necessidades de capital.|O ciclo financeiro orienta decis√µes estrat√©gicas e pol√≠ticas comerciais.|Ajustar estrat√©gias para reduzir ciclo e liberar caixa.
f7|Fluxo|A empresa j√° enfrentou falta de caixa recentemente?|A falta de caixa ocorre com frequ√™ncia, indicando problemas estruturais de gest√£o financeira.|Revisar urgentemente fluxo de caixa e estrutura de custos.|A falta de caixa ainda ocorre com certa regularidade (trimestral ou semestral), geralmente por falta de planejamento adequado, proje√ß√µes imprecisas ou gest√£o reativa dos recursos.|Melhorar proje√ß√£o de caixa para antecipar riscos.|Situa√ß√µes de falta de caixa s√£o razoavelmente raras e geralmente previs√≠veis com alguma anteced√™ncia, mas ainda ocorrem ocasionalmente por fatores n√£o antecipados ou planejamento insuficiente.|Manter controles atuais e revisar pontos de aten√ß√£o.|A empresa antecipa e evita faltas de caixa atrav√©s de planejamento financeiro eficiente.|Utilizar boas pr√°ticas atuais como padr√£o para crescimento.
f9|Fluxo|O fluxo de caixa √© usado para decis√µes?|O fluxo de caixa existe apenas como registro, n√£o sendo utilizado para decis√µes financeiras.|Incluir an√°lise de fluxo de caixa antes de decis√µes relevantes.|O fluxo de caixa √© consultado de forma muito espor√°dica e raramente utilizado como base para decis√µes importantes, sendo mais um registro passivo que ferramenta ativa de gest√£o financeira.|Criar rotina de an√°lise do fluxo de caixa em reuni√µes de gest√£o.|O fluxo de caixa √© consultado com razo√°vel regularidade e utilizado funcionalmente para decis√µes operacionais do dia a dia, mas ainda n√£o √© plenamente integrado √†s decis√µes estrat√©gicas ou de investimento.|Registrar decis√µes tomadas com base no fluxo de caixa.|O fluxo de caixa √© ferramenta central para decis√µes estrat√©gicas.|Integrar fluxo de caixa ao planejamento estrat√©gico.
f13|Fluxo|Existe planejamento para per√≠odos de baixa receita?|A empresa n√£o se planeja para per√≠odos de baixa, ficando vulner√°vel a sazonalidades.|Identificar per√≠odos de baixa e mapear impactos financeiros.|Existe consci√™ncia da sazonalidade de forma emp√≠rica, mas sem planejamento financeiro estruturado, reservas adequadas ou a√ß√µes preventivas para minimizar impactos dos per√≠odos de baixa.|Criar reserva espec√≠fica para per√≠odos de baixa receita.|A empresa se prepara razoavelmente para per√≠odos de baixa receita atrav√©s de planejamento b√°sico e alguma reserva, mas nem sempre a prepara√ß√£o √© suficiente ou as a√ß√µes s√£o implementadas com anteced√™ncia adequada.|Ajustar custos e caixa conforme sazonalidade.|O planejamento para baixa receita √© integrado √† estrat√©gia financeira anual.|Simular cen√°rios sazonais no planejamento financeiro.
f15|Fluxo|A empresa consegue prever problemas de caixa?|A empresa n√£o consegue prever problemas de caixa, reagindo apenas quando a situa√ß√£o j√° √© cr√≠tica.|Utilizar proje√ß√µes de fluxo de caixa para antecipar riscos.|Alguns problemas principais s√£o previstos, mas sem anteced√™ncia suficiente para a√ß√£o eficaz (poucos dias ou j√° na imin√™ncia), limitando as alternativas de solu√ß√£o dispon√≠veis.|Melhorar qualidade das proje√ß√µes financeiras.|A empresa consegue prever problemas de caixa com razo√°vel anteced√™ncia (7-15 dias), permitindo algumas a√ß√µes preventivas, mas a previsibilidade nem sempre √© precisa e pode haver surpresas ocasionais.|Criar planos de a√ß√£o preventivos para cen√°rios negativos.|Problemas de caixa s√£o antecipados e evitados por meio de gest√£o financeira estruturada.|Utilizar previsibilidade como vantagem competitiva financeira.`;

// Continua√ß√£o no pr√≥ximo arquivo devido ao limite de caracteres...
// Por ora, vou gerar placeholders para Or√ßamento e Investimentos

function parsePerguntas() {
    const perguntas = {};
    PERGUNTAS_DB.split('\n').forEach(linha => {
        const partes = linha.split('|');
        const id = partes[0];
        perguntas[id] = {
            cat: partes[1],
            txt: partes[2],
            niveis: [
                { nivel: 1, titulo: 'Inexistente', emoji: 'üî¥', pts: 0, classe: 'critico', feedback: partes[3], acao: partes[4] },
                { nivel: 2, titulo: 'B√°sico', emoji: 'üü†', pts: 1, classe: 'basico', feedback: partes[5], acao: partes[6] },
                { nivel: 3, titulo: 'Organizado', emoji: 'üü¢', pts: 2, classe: 'estruturado', feedback: partes[7], acao: partes[8] },
                { nivel: 4, titulo: 'Profissional', emoji: 'üîµ', pts: 3, classe: 'otimizado', feedback: partes[9], acao: partes[10] }
            ]
        };
    });
    return perguntas;
}

const PERGUNTAS = parsePerguntas();

// CATEGORIA 4: OR√áAMENTO, PLANEJAMENTO & PRECIFICA√á√ÉO (15 PERGUNTAS COMPLETAS)
const ORCAMENTO = [
    ['o1','A empresa possui or√ßamento financeiro definido?','A empresa n√£o possui or√ßamento financeiro formal, tomando decis√µes sem limites claros de gastos, o que dificulta o controle e aumenta riscos financeiros.','Elaborar um or√ßamento financeiro b√°sico anual, contemplando receitas esperadas, custos fixos, vari√°veis e principais despesas operacionais.','Existe or√ßamento, por√©m simplificado e pouco utilizado no dia a dia, servindo mais como refer√™ncia inicial do que como ferramenta de gest√£o.','Detalhar o or√ßamento por categorias relevantes e iniciar o uso mensal como base para controle financeiro.','O or√ßamento √© estruturado e utilizado para acompanhar gastos e receitas, contribuindo para maior previsibilidade financeira.','Comparar mensalmente o or√ßamento com o realizado para identificar desvios e oportunidades de ajuste.','O or√ßamento √© ferramenta central da gest√£o financeira, orientando decis√µes e prioriza√ß√£o de recursos.','Integrar o or√ßamento ao planejamento estrat√©gico e aos indicadores financeiros da empresa.'],,
    ['o2','O or√ßamento √© revisado periodicamente?','O or√ßamento n√£o √© revisado, tornando-se rapidamente obsoleto e pouco √∫til diante de mudan√ßas no neg√≥cio.','Definir periodicidade m√≠nima de revis√£o or√ßament√°ria, ajustando valores conforme a realidade do neg√≥cio.','A revis√£o ocorre apenas quando surgem problemas financeiros, com rotina manual estabelecida.','Criar calend√°rio fixo de revis√£o or√ßament√°ria trimestral ou semestral.','O or√ßamento √© revisado regularmente, mantendo ader√™ncia √† realidade financeira.','Registrar ajustes realizados e os motivos das revis√µes para aprendizado futuro.','A revis√£o or√ßament√°ria √© parte do processo estrat√©gico e de tomada de decis√£o.','Utilizar revis√µes para simular cen√°rios e redefinir prioridades financeiras.'],,
    ['o3','Existe compara√ß√£o entre or√ßado e realizado?','A empresa n√£o compara valores or√ßados com realizados, perdendo oportunidade de aprendizado e controle financeiro.','Implantar compara√ß√£o mensal simples entre or√ßamento e resultados efetivos.','A compara√ß√£o √© feita manualmente com periodicidade mensal, sem an√°lise aprofundada das varia√ß√µes.','Criar relat√≥rio mensal de desvios or√ßament√°rios por categoria.','Existe compara√ß√£o regular entre or√ßado e realizado, auxiliando no controle financeiro.','Analisar causas dos desvios e registrar a√ß√µes corretivas.','A an√°lise or√ßado versus realizado orienta decis√µes financeiras e estrat√©gicas.','Utilizar essa an√°lise para melhorar previs√µes futuras e efici√™ncia operacional.'],,
    ['o4','As varia√ß√µes do or√ßamento s√£o analisadas?','As varia√ß√µes n√£o s√£o analisadas, fazendo com que erros se repitam ao longo do tempo.','Identificar principais varia√ß√µes e documentar causas e impactos financeiros.','As varia√ß√µes s√£o observadas, mas sem investiga√ß√£o das causas reais.','Analisar varia√ß√µes relevantes e definir respons√°veis por corre√ß√µes.','As varia√ß√µes s√£o analisadas com crit√©rio, permitindo ajustes operacionais.','Criar plano de a√ß√£o para varia√ß√µes recorrentes.','As an√°lises de varia√ß√£o geram aprendizado e melhoria cont√≠nua.','Utilizar aprendizados para aprimorar planejamento financeiro futuro.'],,
    ['o5','A precifica√ß√£o considera custos e despesas?','Os pre√ßos s√£o definidos sem considerar todos os custos e despesas, colocando em risco a rentabilidade do neg√≥cio.','Levantar todos os custos e despesas envolvidos na opera√ß√£o e incorpor√°-los ao c√°lculo de pre√ßos.','A precifica√ß√£o considera apenas parte dos custos, sem vis√£o completa do impacto financeiro.','Estruturar planilha de custos completa para apoiar a forma√ß√£o de pre√ßos.','Os pre√ßos consideram custos e despesas, garantindo margem m√≠nima.','Revisar periodicamente custos para manter pre√ßos atualizados.','A precifica√ß√£o √© estrat√©gica, considerando custos, despesas, mercado e posicionamento.','Utilizar precifica√ß√£o como ferramenta de competitividade e rentabilidade.'],,
    ['o6','A empresa conhece sua margem na precifica√ß√£o?','A empresa n√£o conhece suas margens reais, dificultando avalia√ß√£o da rentabilidade.','Calcular margem por produto ou servi√ßo vendido.','Existe no√ß√£o b√°sica de margem, mas sem c√°lculo estruturado.','Formalizar c√°lculo de margem e monitorar periodicamente.','As margens s√£o conhecidas e acompanhadas.','Utilizar margens para decis√µes de pre√ßos e mix de vendas.','A gest√£o utiliza margens como indicador-chave de desempenho.','Ajustar estrat√©gias comerciais com base nas margens.'],,
    ['o7','Os pre√ßos s√£o reajustados com crit√©rio?','Os reajustes s√£o feitos de forma reativa ou aleat√≥ria, sem an√°lise financeira.','Definir crit√©rios objetivos para reajuste de pre√ßos.','Os reajustes ocorrem manualmente quando necess√°rio, sem m√©todo definido.','Criar pol√≠tica de reajuste baseada em custos e mercado.','Os reajustes seguem crit√©rios definidos e previs√≠veis.','Comunicar reajustes com anteced√™ncia e transpar√™ncia.','O reajuste de pre√ßos √© parte da estrat√©gia de posicionamento.','Utilizar reajustes para preservar margens e competitividade.'],,
    ['o9','O planejamento financeiro guia decis√µes?','O planejamento n√£o √© utilizado como base para decis√µes financeiras.','Passar a consultar o planejamento antes de decis√µes relevantes.','O planejamento √© consultado manualmente com periodicidade mensal, sem papel central.','Incluir an√°lise do planejamento nas reuni√µes de gest√£o.','O planejamento financeiro orienta decis√µes operacionais.','Registrar decis√µes tomadas com base no planejamento.','O planejamento financeiro √© central na tomada de decis√µes estrat√©gicas.','Atualizar planejamento para refletir decis√µes estrat√©gicas.'],,
    ['o10','H√° metas financeiras definidas?','A empresa n√£o possui metas financeiras claras, dificultando direcionamento e avalia√ß√£o de desempenho.','Definir metas financeiras b√°sicas de faturamento e resultado.','As metas existem, mas n√£o s√£o acompanhadas regularmente.','Criar rotina de acompanhamento das metas.','As metas financeiras s√£o acompanhadas periodicamente.','Ajustar estrat√©gias quando metas n√£o s√£o atingidas.','As metas financeiras orientam decis√µes e esfor√ßos da equipe.','Integrar metas financeiras aos indicadores de desempenho.'],,
    ['o14','O or√ßamento apoia decis√µes de crescimento?','O or√ßamento n√£o √© utilizado para avaliar decis√µes de crescimento.','Utilizar or√ßamento para analisar viabilidade financeira de crescimento.','O or√ßamento √© consultado, mas sem an√°lise aprofundada.','Simular impactos financeiros antes de decis√µes de crescimento.','O or√ßamento apoia decis√µes de expans√£o e investimentos.','Atualizar or√ßamento conforme planos de crescimento.','O or√ßamento √© ferramenta-chave para crescimento sustent√°vel.','Integrar or√ßamento ao planejamento estrat√©gico de longo prazo.'],
];

ORCAMENTO.forEach(o => {
    PERGUNTAS[o[0]] = {
        cat: 'Or√ßamento',
        txt: o[1],
        niveis: [
            {nivel:1,titulo:'Inexistente',emoji:'üî¥',pts:0,classe:'critico',feedback:o[2],acao:o[3]},
            {nivel:2,titulo:'B√°sico',emoji:'üü†',pts:1,classe:'basico',feedback:o[4],acao:o[5]},
            {nivel:3,titulo:'Estruturado',emoji:'üü¢',pts:2,classe:'estruturado',feedback:o[6],acao:o[7]},
            {nivel:4,titulo:'Gerencial',emoji:'üîµ',pts:3,classe:'otimizado',feedback:o[8],acao:o[9]}
        ]
    };
});

// CATEGORIA 5: INVESTIMENTOS & SUSTENTABILIDADE (15 PERGUNTAS COMPLETAS)
const INVESTIMENTOS = [
    ['i1','A empresa realiza investimentos no pr√≥prio neg√≥cio?','A empresa n√£o realiza investimentos estruturados no pr√≥prio neg√≥cio, limitando crescimento, efici√™ncia operacional e competitividade no m√©dio e longo prazo.','Mapear necessidades priorit√°rias do neg√≥cio e iniciar planejamento de investimentos compat√≠veis com a realidade financeira atual.','Os investimentos ocorrem de forma pontual e reativa, sem planejamento financeiro ou avalia√ß√£o clara de impacto no neg√≥cio.','Criar crit√©rios m√≠nimos para decidir quando e onde investir, alinhando investimentos √†s necessidades estrat√©gicas.','A empresa realiza investimentos planejados, considerando capacidade financeira e objetivos operacionais.','Registrar investimentos realizados e acompanhar seus resultados ao longo do tempo.','Os investimentos s√£o parte da estrat√©gia de crescimento e fortalecimento sustent√°vel do neg√≥cio.','Integrar decis√µes de investimento ao planejamento estrat√©gico e financeiro de longo prazo.'],,
    ['i2','Existe crit√©rio para decidir onde investir?','A empresa investe sem crit√©rios definidos, aumentando riscos financeiros e desperd√≠cio de recursos.','Definir crit√©rios b√°sicos de decis√£o, como impacto no resultado, necessidade operacional e retorno esperado.','Existem crit√©rios informais, por√©m sem an√°lise estruturada ou documenta√ß√£o.','Formalizar crit√©rios de investimento e utiliz√°-los de forma consistente.','Os crit√©rios de investimento s√£o claros e utilizados nas decis√µes financeiras.','Revisar crit√©rios periodicamente para mant√™-los alinhados √† estrat√©gia.','As decis√µes de investimento seguem crit√©rios estrat√©gicos bem definidos e alinhados ao crescimento sustent√°vel.','Priorizar investimentos com maior impacto estrat√©gico e financeiro.'],,
    ['i3','A empresa possui reserva financeira?','A aus√™ncia de reserva financeira torna a empresa vulner√°vel a crises, imprevistos e oscila√ß√µes de mercado.','Definir valor m√≠nimo de reserva e iniciar forma√ß√£o gradual com disciplina financeira.','Existe reserva financeira, por√©m em valor insuficiente para garantir seguran√ßa em situa√ß√µes adversas.','Planejar aumento progressivo da reserva at√© n√≠vel adequado ao porte da empresa.','A reserva financeira oferece seguran√ßa para imprevistos comuns do neg√≥cio.','Manter pol√≠tica de reposi√ß√£o da reserva quando utilizada.','A reserva financeira √© estrat√©gica e protege a empresa em cen√°rios de crise mais severos.','Revisar periodicamente o tamanho da reserva conforme crescimento do neg√≥cio.'],,
    ['i4','H√° separa√ß√£o entre caixa operacional e reservas?','O caixa operacional √© misturado com reservas, dificultando controle financeiro e tomada de decis√£o segura.','Criar contas ou controles separados para caixa operacional e reservas financeiras.','Existe separa√ß√£o informal, mas sem controle rigoroso ou regras claras de uso.','Formalizar regras para uso das reservas e registrar movimenta√ß√µes.','A separa√ß√£o entre caixa operacional e reservas √© clara e respeitada.','Monitorar saldos de forma independente para maior clareza financeira.','A separa√ß√£o √© parte da governan√ßa financeira e facilita decis√µes estrat√©gicas.','Integrar controles de reservas aos relat√≥rios financeiros gerenciais.'],,
    ['i5','Os investimentos t√™m objetivo definido?','Os investimentos s√£o realizados sem objetivo claro, dificultando avalia√ß√£o de sucesso ou retorno.','Definir objetivo espec√≠fico para cada investimento antes da execu√ß√£o.','Existe objetivo geral, mas sem indicadores claros de sucesso.','Estabelecer metas e indicadores para cada investimento.','Os investimentos possuem objetivos claros e mensur√°veis.','Acompanhar periodicamente se os objetivos est√£o sendo atingidos.','Os investimentos s√£o orientados por objetivos estrat√©gicos de longo prazo.','Revisar objetivos conforme evolu√ß√£o da estrat√©gia da empresa.'],,
    ['i6','A empresa avalia retorno dos investimentos?','A empresa n√£o avalia retorno dos investimentos, perdendo vis√£o sobre efici√™ncia do uso dos recursos.','Criar m√©todo simples para avaliar retorno financeiro ou operacional dos investimentos.','A avalia√ß√£o ocorre de forma informal e sem m√©tricas claras.','Definir indicadores m√≠nimos de retorno para cada tipo de investimento.','O retorno dos investimentos √© avaliado regularmente.','Utilizar resultados das avalia√ß√µes para decis√µes futuras.','A an√°lise de retorno orienta decis√µes estrat√©gicas de aloca√ß√£o de capital.','Priorizar investimentos com melhor rela√ß√£o risco e retorno.'],,
    ['i9','Os investimentos consideram risco financeiro?','Os riscos financeiros n√£o s√£o avaliados antes de investir, expondo a empresa a perdas relevantes.','Identificar riscos financeiros antes de cada decis√£o de investimento.','Alguns riscos s√£o considerados, mas sem an√°lise estruturada.','Criar checklist de riscos financeiros para investimentos.','Os riscos financeiros s√£o avaliados antes das decis√µes.','Ajustar decis√µes conforme n√≠vel de risco identificado.','A gest√£o de risco faz parte do processo decis√≥rio de investimentos.','Balancear portf√≥lio de investimentos conforme apetite a risco.'],,
    ['i11','A empresa evita investir sem an√°lise pr√©via?','Investimentos s√£o feitos por impulso ou oportunidade moment√¢nea, sem an√°lise pr√©via.','Criar regra obrigat√≥ria de an√°lise antes de qualquer investimento.','Algumas an√°lises s√£o feitas, mas sem padroniza√ß√£o.','Padronizar processo de an√°lise de investimentos.','A empresa evita investir sem an√°lise adequada.','Documentar an√°lises realizadas para aprendizado futuro.','A an√°lise pr√©via √© parte da cultura de gest√£o financeira.','Utilizar hist√≥rico de an√°lises para melhorar decis√µes futuras.'],,
    ['i13','A empresa se prepara financeiramente para crises?','A empresa n√£o se prepara para crises, ficando altamente vulner√°vel a choques externos.','Identificar riscos de crise e criar plano financeiro de conting√™ncia.','Existe alguma prepara√ß√£o, mas sem planejamento estruturado.','Estruturar plano b√°sico de conting√™ncia financeira.','A empresa possui prepara√ß√£o financeira para enfrentar crises.','Revisar periodicamente planos de conting√™ncia.','A empresa √© financeiramente resiliente e preparada para cen√°rios adversos.','Utilizar resili√™ncia financeira como vantagem competitiva.'],,
    ['i14','Os investimentos apoiam crescimento sustent√°vel?','Os investimentos n√£o est√£o alinhados ao crescimento sustent√°vel do neg√≥cio.','Reavaliar investimentos com foco em sustentabilidade financeira.','Alguns investimentos contribuem, mas sem alinhamento estrat√©gico claro.','Alinhar investimentos aos objetivos de crescimento sustent√°vel.','Os investimentos apoiam o crescimento sustent√°vel da empresa.','Monitorar impacto dos investimentos no crescimento.','O portf√≥lio de investimentos √© totalmente alinhado √† sustentabilidade financeira.','Priorizar investimentos com impacto sustent√°vel de longo prazo.'],
];

INVESTIMENTOS.forEach(i => {
    PERGUNTAS[i[0]] = {
        cat: 'Investimentos',
        txt: i[1],
        niveis: [
            {nivel:1,titulo:'N√£o realiza',emoji:'üî¥',pts:0,classe:'critico',feedback:i[2],acao:i[3]},
            {nivel:2,titulo:'Ocasional',emoji:'üü†',pts:1,classe:'basico',feedback:i[4],acao:i[5]},
            {nivel:3,titulo:'Planejado',emoji:'üü¢',pts:2,classe:'estruturado',feedback:i[6],acao:i[7]},
            {nivel:4,titulo:'Estrat√©gico',emoji:'üîµ',pts:3,classe:'otimizado',feedback:i[8],acao:i[9]}
        ]
    };
});

// CATEGORIA 6: RISCOS FINANCEIROS & CONTRATUAIS (15 PERGUNTAS COMPLETAS)
const RISCOS = [
    ['g1','A empresa possui contratos formais com seus principais clientes?','A empresa opera majoritariamente sem contratos formais, ficando exposta a cancelamentos abruptos, inadimpl√™ncia e perda s√∫bita de receita.','Formalizar contratos b√°sicos com clientes estrat√©gicos, definindo escopo, valores, prazos e condi√ß√µes m√≠nimas de seguran√ßa financeira.','Existem contratos com alguns clientes, por√©m sem padroniza√ß√£o ou cobertura dos principais riscos financeiros.','Padronizar contratos e priorizar formaliza√ß√£o com clientes que representam maior fatia do faturamento.','A empresa possui contratos formais com a maioria dos clientes relevantes, reduzindo riscos operacionais.','Revisar contratos periodicamente para garantir ader√™ncia √† realidade do neg√≥cio.','Os contratos s√£o parte central da estrat√©gia financeira e garantem previsibilidade de receita.','Integrar gest√£o contratual ao planejamento financeiro e ao fluxo de caixa projetado.'],,
    ['g2','Os contratos possuem prazo m√≠nimo que garante previsibilidade de receita?','A aus√™ncia de prazo m√≠nimo contratual gera instabilidade de faturamento e dificulta planejamento financeiro.','Definir prazo m√≠nimo contratual, especialmente para clientes recorrentes ou estrat√©gicos.','Alguns contratos possuem prazo, mas sem padroniza√ß√£o ou alinhamento estrat√©gico.','Criar pol√≠tica m√≠nima de prazos contratuais conforme tipo de cliente.','Os contratos possuem prazos definidos que contribuem para previsibilidade financeira.','Monitorar vencimentos contratuais para evitar rupturas inesperadas.','Os prazos contratuais sustentam previsibilidade de caixa e planejamento de crescimento.','Utilizar prazos contratuais como base para proje√ß√µes financeiras e investimentos.'],,
    ['g3','Existem cl√°usulas de reajuste de pre√ßos nos contratos?','A falta de cl√°usulas de reajuste exp√µe a empresa √† perda gradual de margem frente √† infla√ß√£o e aumento de custos.','Incluir cl√°usulas de reajuste autom√°tico nos contratos vigentes e futuros.','As cl√°usulas existem, mas s√£o pouco claras ou raramente aplicadas.','Revisar cl√°usulas para torn√°-las objetivas e aplic√°veis.','Os contratos possuem cl√°usulas de reajuste claras e aplicadas periodicamente.','Acompanhar √≠ndices utilizados para reajuste e validar ader√™ncia ao mercado.','O reajuste contratual protege margens e sustenta equil√≠brio financeiro.','Integrar reajustes contratuais √† estrat√©gia de precifica√ß√£o.'],,
    ['g5','Existe depend√™ncia excessiva de poucos clientes?','Grande parte do faturamento est√° concentrada em poucos clientes, elevando risco financeiro.','Mapear concentra√ß√£o de receita e iniciar estrat√©gia de diversifica√ß√£o de clientes.','Existe concentra√ß√£o relevante, por√©m j√° reconhecida pela gest√£o.','Definir metas para reduzir depend√™ncia gradualmente.','A concentra√ß√£o √© monitorada e mantida em n√≠veis aceit√°veis.','Revisar periodicamente indicadores de concentra√ß√£o.','A carteira de clientes √© diversificada e reduz riscos de perda abrupta de receita.','Manter pol√≠ticas comerciais voltadas √† diversifica√ß√£o.'],,
    ['g6','A empresa analisa risco financeiro na perda de contratos estrat√©gicos?','A empresa n√£o avalia impactos financeiros da perda de contratos relevantes.','Simular impacto financeiro da perda dos principais contratos.','A an√°lise ocorre de forma intuitiva, sem dados estruturados.','Criar simula√ß√µes financeiras b√°sicas de perda de contratos.','Existe an√°lise estruturada de impacto financeiro.','Atualizar an√°lises conforme mudan√ßas na carteira de clientes.','A an√°lise orienta decis√µes de mitiga√ß√£o de risco e crescimento.','Criar planos de conting√™ncia para contratos estrat√©gicos.'],,
    ['g9','A empresa monitora riscos financeiros externos (juros, infla√ß√£o, impostos)?','A empresa √© reativa a mudan√ßas externas, sofrendo impactos financeiros inesperados.','Definir indicadores b√°sicos para monitoramento de fatores externos.','O monitoramento ocorre com rotina manual estabelecida.','Criar calend√°rio de acompanhamento econ√¥mico.','Os fatores externos s√£o monitorados regularmente.','Avaliar impactos financeiros potenciais.','O monitoramento orienta decis√µes financeiras e contratuais.','Integrar an√°lises externas ao planejamento financeiro.'],,
    ['g10','Existe mapeamento formal dos principais riscos financeiros?','Os riscos financeiros n√£o s√£o mapeados, aumentando exposi√ß√£o do neg√≥cio.','Identificar e listar principais riscos financeiros da empresa.','O mapeamento existe, mas sem prioriza√ß√£o.','Classificar riscos por impacto e probabilidade.','Os riscos financeiros s√£o mapeados e monitorados.','Atualizar mapa de riscos periodicamente.','A gest√£o de riscos faz parte da governan√ßa financeira.','Integrar riscos ao planejamento estrat√©gico.'],,
    ['g11','Existem planos de conting√™ncia financeira?','A empresa n√£o possui planos para lidar com eventos adversos financeiros.','Criar planos b√°sicos de conting√™ncia para riscos cr√≠ticos.','Existem planos, mas pouco detalhados.','Detalhar a√ß√µes e respons√°veis para cada conting√™ncia.','Os planos de conting√™ncia est√£o definidos e documentados.','Testar planos periodicamente.','A empresa responde rapidamente a crises financeiras.','Revisar planos conforme evolu√ß√£o do neg√≥cio.'],,
    ['g12','Existe reserva financeira vinculada a riscos?','A empresa n√£o possui reserva espec√≠fica para enfrentar riscos financeiros.','Definir reserva m√≠nima vinculada a riscos mapeados.','A reserva existe, mas n√£o cobre riscos relevantes.','Planejar aumento progressivo da reserva.','A reserva cobre riscos financeiros comuns.','Manter pol√≠tica de recomposi√ß√£o da reserva.','A reserva √© elemento central da sustentabilidade financeira.','Integrar reserva √† estrat√©gia de longo prazo.'],,
    ['g14','A gest√£o utiliza contratos como ferramenta estrat√©gica?','Os contratos s√£o vistos apenas como formalidade jur√≠dica.','Envolver a gest√£o financeira na elabora√ß√£o contratual.','Os contratos apoiam parcialmente decis√µes financeiras.','Alinhar contratos √† estrat√©gia financeira.','Os contratos s√£o utilizados para proteger receitas e margens.','Revisar contratos estrat√©gicos periodicamente.','Os contratos s√£o instrumentos centrais de gest√£o financeira.','Integrar gest√£o contratual √† governan√ßa da empresa.'],
];

RISCOS.forEach(g => {
    PERGUNTAS[g[0]] = {
        cat: 'Riscos',
        txt: g[1],
        niveis: [
            {nivel:1,titulo:'Inexistente',emoji:'üî¥',pts:0,classe:'critico',feedback:g[2],acao:g[3]},
            {nivel:2,titulo:'Parcial',emoji:'üü†',pts:1,classe:'basico',feedback:g[4],acao:g[5]},
            {nivel:3,titulo:'Estruturado',emoji:'üü¢',pts:2,classe:'estruturado',feedback:g[6],acao:g[7]},
            {nivel:4,titulo:'Estrat√©gico',emoji:'üîµ',pts:3,classe:'otimizado',feedback:g[8],acao:g[9]}
        ]
    };
});

// CATEGORIA 7: INDICADORES FINANCEIROS (15 PERGUNTAS COMPLETAS)
const INDICADORES = [
    ['if1','Voc√™ registra diariamente todas as entradas e sa√≠das de dinheiro da empresa?','N√£o h√° controle sistem√°tico do fluxo de caixa, prejudicando visibilidade financeira e tomada de decis√£o.','Criar planilha ou caderno para registro di√°rio m√≠nimo de entradas e sa√≠das.','O registro existe mas √© irregular ou incompleto, comprometendo confiabilidade das informa√ß√µes.','Tornar registro di√°rio obrigat√≥rio e criar rotina de preenchimento.','O controle di√°rio existe de forma manual e organizada.','Considerar ado√ß√£o de sistema digital para automatizar registro.','Sistema automatizado registra todas movimenta√ß√µes financeiras em tempo real.','Utilizar dados do sistema para an√°lises e tomada de decis√£o gerencial.'],,
    ['if2','Qual o prazo m√©dio (em dias) que seus CLIENTES levam para pagar?','Desconhecimento do prazo de recebimento dificulta gest√£o de caixa e planejamento financeiro.','Calcular prazo m√©dio dos √∫ltimos 3 meses e estabelecer controle.','Prazo conhecido aproximadamente mas sem acompanhamento regular.','Monitorar prazo mensalmente e buscar reduzi-lo gradualmente.','Prazo controlado com precis√£o e acompanhamento de inadimplentes.','Implementar a√ß√µes para reduzir prazo m√©dio sem perder vendas.','Prazo otimizado com processo ativo de antecipa√ß√£o e cobran√ßa eficiente.','Negociar prazos menores com clientes estrat√©gicos.'],,
    ['if3','Qual o prazo m√©dio (em dias) que voc√™ leva para pagar seus FORNECEDORES?','Desconhecimento do prazo de pagamento compromete negocia√ß√£o e planejamento de caixa.','Calcular prazo m√©dio e registrar condi√ß√µes negociadas.','Prazo conhecido mas sem estrat√©gia de otimiza√ß√£o.','Negociar melhores prazos alinhados ao ciclo de caixa.','Prazo controlado e negociado estrategicamente.','Buscar condi√ß√µes comerciais mais favor√°veis mantendo relacionamento.','Prazo otimizado como parte da estrat√©gia de capital de giro.','Equilibrar prazos de recebimento e pagamento para otimizar caixa.'],,
    ['if4','Voc√™ faz proje√ß√£o de fluxo de caixa para os pr√≥ximos meses?','Aus√™ncia de proje√ß√£o impede antecipa√ß√£o de problemas e planejamento adequado.','Iniciar proje√ß√£o simples de 30 dias baseada em contas a pagar e receber.','Proje√ß√£o mental ou informal sem documenta√ß√£o.','Criar planilha com proje√ß√£o de 60-90 dias.','Proje√ß√£o estruturada utilizada na gest√£o financeira.','Atualizar proje√ß√£o semanalmente e utilizar para decis√µes.','Proje√ß√£o detalhada com cen√°rios e an√°lise de riscos.','Integrar proje√ß√£o ao planejamento estrat√©gico e decis√µes de investimento.'],,
    ['if5','Com que frequ√™ncia voc√™ consulta o saldo dispon√≠vel em caixa/banco?','Consulta irregular do saldo gera surpresas e dificulta controle financeiro.','Criar h√°bito de consulta di√°ria do saldo dispon√≠vel.','Consulta semanal mas sem an√°lise de varia√ß√µes.','Consultar diariamente e investigar varia√ß√µes inesperadas.','Consulta di√°ria com an√°lise de movimenta√ß√µes.','Comparar saldo real com projetado e ajustar planejamento.','Consulta m√∫ltipla di√°ria com acesso online em tempo real.','Utilizar alertas autom√°ticos para saldos m√≠nimos e movimenta√ß√µes at√≠picas.'],,
    ['if6','Qual percentual das suas vendas voc√™ N√ÉO recebe (inadimpl√™ncia/calote)?','Desconhecimento da inadimpl√™ncia impede a√ß√£o preventiva e afeta resultado.','Calcular inadimpl√™ncia dos √∫ltimos 6 meses e estabelecer meta de redu√ß√£o.','Inadimpl√™ncia conhecida aproximadamente mas sem a√ß√£o estruturada.','Implementar processo b√°sico de cobran√ßa e an√°lise de cr√©dito.','Inadimpl√™ncia controlada com processo de cobran√ßa ativo.','Reduzir taxa atrav√©s de sele√ß√£o de clientes e cobran√ßa preventiva.','Taxa baixa (< 2%) com processo de an√°lise de cr√©dito rigoroso.','Utilizar hist√≥rico para melhorar processo de concess√£o de cr√©dito.'],,
    ['if7','Voc√™ separa completamente o dinheiro pessoal do dinheiro da empresa?','Mistura de recursos prejudica controle, tomada de decis√£o e sa√∫de financeira.','Abrir conta banc√°ria exclusiva da empresa.','Separa√ß√£o parcial mas com transfer√™ncias frequentes entre contas.','Definir pr√≥-labore fixo e reduzir retiradas fora do padr√£o.','Separa√ß√£o completa com pr√≥-labore definido.','Ajustar pr√≥-labore conforme evolu√ß√£o do neg√≥cio.','Governan√ßa financeira com pr√≥-labore vinculado a metas.','Utilizar separa√ß√£o como indicador de maturidade de gest√£o.'],,
    ['if8','Voc√™ mant√©m uma reserva de emerg√™ncia (caixa m√≠nimo de seguran√ßa)?','Aus√™ncia de reserva deixa empresa vulner√°vel a imprevistos e crises.','Definir meta de reserva (1 m√™s de despesas) e iniciar forma√ß√£o gradual.','Reserva insuficiente para cobrir imprevistos relevantes.','Aumentar reserva progressivamente at√© n√≠vel seguro.','Reserva adequada para imprevistos comuns.','Manter disciplina de n√£o utilizar reserva para fins operacionais.','Reserva robusta (3+ meses) garante resili√™ncia financeira.','Integrar reserva ao planejamento de longo prazo.'],,
    ['if11','Quanto (em %) dos seus custos s√£o FIXOS (aluguel, sal√°rios, contas fixas)?','Desconhecimento da estrutura de custos dificulta controle e flexibilidade.','Separar e somar custos fixos mensais.','Custos conhecidos aproximadamente mas sem controle rigoroso.','Criar planilha com todos custos fixos e monitorar mensalmente.','Estrutura de custos conhecida e controlada.','Buscar reduzir peso dos custos fixos quando poss√≠vel.','Estrutura otimizada com custos fixos proporcionais ao porte.','Utilizar estrutura de custos para an√°lise de break-even.'],,
    ['if14','Voc√™ revisa e ajusta seus pre√ßos regularmente?','Pre√ßos defasados comprometem margem e competitividade.','Revisar pre√ßos pelo menos anualmente com apoio de contador.','Reajustes apenas reativos quando custos aumentam.','Criar rotina de revis√£o semestral com an√°lise de mercado.','Revis√£o regular com an√°lise de custos e concorr√™ncia.','Ajustar pre√ßos mantendo competitividade e margem.','Precifica√ß√£o estrat√©gica com an√°lise de valor percebido.','Utilizar precifica√ß√£o como ferramenta de posicionamento com consultoria especializada.'],
];

INDICADORES.forEach(iff => {
    PERGUNTAS[iff[0]] = {
        cat: 'Indicadores Financeiros',
        txt: iff[1],
        niveis: [
            {nivel:1,titulo:'Cr√≠tico',emoji:'üî¥',pts:0,classe:'critico',feedback:iff[2],acao:iff[3]},
            {nivel:2,titulo:'B√°sico',emoji:'üü†',pts:1,classe:'basico',feedback:iff[4],acao:iff[5]},
            {nivel:3,titulo:'Estruturado',emoji:'üü¢',pts:2,classe:'estruturado',feedback:iff[6],acao:iff[7]},
            {nivel:4,titulo:'Otimizado',emoji:'üîµ',pts:3,classe:'otimizado',feedback:iff[8],acao:iff[9]}
        ]
    };
});

// CATEGORIA 8: PLANEJAMENTO TRIBUT√ÅRIO (15 PERGUNTAS COMPLETAS)
const TRIBUTARIO = [
    ['pt1','A empresa possui regime tribut√°rio adequado ao seu porte e atividade?','Opera sem an√°lise do regime tribut√°rio ou no regime inadequado, perdendo oportunidades de economia tribut√°ria e comprometendo competitividade.','Consultar contador para an√°lise completa dos regimes dispon√≠veis (Simples Nacional, Lucro Presumido, Lucro Real).','Regime escolhido sem an√°lise t√©cnica detalhada das alternativas dispon√≠veis.','Realizar comparativo detalhado entre regimes com suporte de contador especializado em tributa√ß√£o.','Regime adequado ao porte e atividade, mas sem revis√£o peri√≥dica das condi√ß√µes.','Agendar revis√£o anual com contador para confirmar adequa√ß√£o do regime.','Regime otimizado e revisado periodicamente conforme evolu√ß√£o do neg√≥cio.','Manter an√°lise anual com contador e simular cen√°rios de mudan√ßa quando houver altera√ß√µes significativas.'],,
    ['pt2','A empresa realiza planejamento tribut√°rio de longo prazo?','N√£o realiza planejamento tribut√°rio estrat√©gico, tomando decis√µes sem avaliar impactos fiscais futuros.','Contratar consultoria especializada para elaborar planejamento tribut√°rio b√°sico alinhado aos objetivos da empresa.','Planejamento espor√°dico sem vis√£o estrat√©gica ou integra√ß√£o com objetivos empresariais.','Estabelecer reuni√µes trimestrais com contador para revisar planejamento tribut√°rio.','Planejamento tribut√°rio estruturado revisado anualmente.','Integrar planejamento tribut√°rio ao planejamento estrat√©gico e financeiro da empresa.','Planejamento integrado √† estrat√©gia empresarial com vis√£o de m√©dio e longo prazo.','Revisar planejamento com advogado tributarista semestralmente e ajustar conforme mudan√ßas legislativas.'],,
    ['pt3','A empresa considera impactos tribut√°rios em decis√µes estrat√©gicas (investimentos, expans√£o, contrata√ß√µes)?','Decis√µes estrat√©gicas tomadas sem an√°lise tribut√°ria pr√©via, gerando custos fiscais evit√°veis.','Incluir contador nas reuni√µes estrat√©gicas relevantes para avalia√ß√£o de impactos tribut√°rios.','An√°lise tribut√°ria pontual e reativa, realizada apenas ap√≥s decis√µes tomadas.','Criar checklist tribut√°rio obrigat√≥rio para decis√µes estrat√©gicas importantes.','Impactos tribut√°rios analisados sistematicamente antes de decis√µes relevantes.','Documentar an√°lises tribut√°rias realizadas para decis√µes importantes e manter hist√≥rico.','Tributa√ß√£o considerada como pilar fundamental das decis√µes estrat√©gicas.','Manter comit√™ consultivo com contador e advogado tributarista para decis√µes de alto impacto fiscal.'],,
    ['pt4','A estrutura societ√°ria da empresa est√° otimizada tributariamente?','Estrutura societ√°ria sem an√°lise tribut√°ria, perdendo oportunidades de otimiza√ß√£o fiscal.','Solicitar an√°lise completa da estrutura societ√°ria a advogado tributarista especializado.','Estrutura b√°sica sem otimiza√ß√£o fiscal ou planejamento sucess√≥rio.','Avaliar alternativas de estrutura√ß√£o com especialista considerando objetivos de m√©dio prazo.','Estrutura planejada considerando aspectos tribut√°rios e sucess√≥rios.','Revisar estrutura anualmente com suporte jur√≠dico-tribut√°rio e cont√°bil.','Estrutura societ√°ria otimizada e revisada periodicamente.','Simular impactos de mudan√ßas estruturais com consultor especializado antes de implementar altera√ß√µes.'],,
    ['pt5','A empresa aproveita todos os incentivos fiscais dispon√≠veis?','Desconhece incentivos fiscais aplic√°veis, perdendo oportunidades de redu√ß√£o legal da carga tribut√°ria.','Solicitar mapeamento completo de incentivos fiscais aplic√°veis ao contador.','Conhece alguns incentivos mas n√£o utiliza por desconhecimento ou falta de estrutura√ß√£o.','Avaliar viabilidade t√©cnica e econ√¥mica de ades√£o aos incentivos com contador especializado.','Utiliza principais incentivos fiscais dispon√≠veis para o setor e porte.','Revisar anualmente novos incentivos fiscais e programas com contador.','Aproveita integralmente incentivos dispon√≠veis e monitora ativamente novos programas.','Manter rotina trimestral de atualiza√ß√£o com contador sobre novos incentivos e altera√ß√µes legislativas.'],,
    ['pt6','A empresa controla e otimiza suas dedu√ß√µes fiscais?','N√£o controla dedu√ß√µes ou perde oportunidades por desconhecimento das possibilidades legais.','Implementar controle detalhado de despesas dedut√≠veis com orienta√ß√£o do contador.','Controle b√°sico sem otimiza√ß√£o ou aproveitamento integral das dedu√ß√µes permitidas.','Revisar despesas sistematicamente para maximizar dedu√ß√µes dentro da legalidade.','Controla e maximiza dedu√ß√µes fiscais dentro do regime tribut√°rio adotado.','Documentar adequadamente todas dedu√ß√µes e manter arquivo organizado para fiscaliza√ß√µes.','Otimiza√ß√£o total com planejamento antecipado de dedu√ß√µes ao longo do ano.','Revisar estrat√©gia de dedu√ß√µes semestralmente com contador para ajustes e melhorias.'],,
    ['pt8','A empresa monitora mudan√ßas na legisla√ß√£o tribut√°ria (incluindo Reforma Tribut√°ria)?','N√£o acompanha mudan√ßas legislativas, sendo surpreendida por altera√ß√µes que impactam o neg√≥cio.','Estabelecer rotina mensal de atualiza√ß√£o tribut√°ria com contador sobre mudan√ßas relevantes.','Acompanhamento irregular ou tardio de mudan√ßas na legisla√ß√£o tribut√°ria.','Solicitar alertas mensais e an√°lises de impacto ao contador sobre mudan√ßas legislativas.','Monitoramento regular com contador incluindo an√°lises sobre Reforma Tribut√°ria (Lei Complementar 214/2015).','Avaliar proativamente impactos de mudan√ßas e se preparar com anteced√™ncia.','Antecipa mudan√ßas legislativas e se prepara estrategicamente, incluindo transi√ß√£o para novos tributos (IBS e CBS).','Participar de grupo especializado de atualiza√ß√£o tribut√°ria e monitorar implementa√ß√£o progressiva da Reforma Tribut√°ria.'],,
    ['pt10','A empresa cumpre rigorosamente prazos de obriga√ß√µes fiscais?','Atrasos frequentes em obriga√ß√µes fiscais gerando multas e juros evit√°veis.','Criar calend√°rio fiscal completo com contador e implementar sistema de alertas autom√°ticos.','Cumpre maioria das obriga√ß√µes mas com atrasos pontuais que geram custos.','Implementar rotina de confer√™ncia pr√©via com contador antes dos vencimentos.','Cumprimento pontual de todas obriga√ß√µes fiscais sem atrasos.','Manter sistema digital de lembretes e confer√™ncia de todas obriga√ß√µes.','Antecipa cumprimento de obriga√ß√µes com margem de seguran√ßa adequada.','Revisar processo de cumprimento trimestralmente com contador para otimiza√ß√£o cont√≠nua.'],,
    ['pt12','A empresa se prepara adequadamente para eventuais fiscaliza√ß√µes?','Despreparada para fiscaliza√ß√µes, com documenta√ß√£o dispersa e sem processo estruturado.','Solicitar simula√ß√£o de fiscaliza√ß√£o ao contador para identificar vulnerabilidades.','Prepara√ß√£o b√°sica realizada apenas quando notificada de fiscaliza√ß√£o iminente.','Criar pasta permanente de fiscaliza√ß√£o com documentos essenciais sempre atualizados.','Prepara√ß√£o preventiva estruturada com documenta√ß√£o organizada e acess√≠vel.','Realizar simula√ß√£o anual de fiscaliza√ß√£o com contador para identificar pontos de aten√ß√£o.','Processo de compliance permanente mant√©m empresa sempre preparada.','Manter assessoria jur√≠dico-tribut√°ria de prontid√£o para suporte em fiscaliza√ß√µes quando necess√°rio.'],,
    ['pt14','A empresa age rapidamente para corrigir erros tribut√°rios quando identificados?','Erros tribut√°rios n√£o corrigidos ou corre√ß√£o muito lenta, agravando problemas.','Buscar orienta√ß√£o urgente de contador para corre√ß√£o imediata de erros identificados.','Corre√ß√µes reativas realizadas com demora, aumentando riscos e custos.','Estabelecer processo de corre√ß√£o r√°pida com contador, incluindo retifica√ß√µes quando cab√≠veis.','Corre√ß√£o estruturada e √°gil sempre que erro √© identificado.','Documentar todas corre√ß√µes realizadas e comunicar ao contador para atualiza√ß√£o cont√°bil.','Sistema preventivo robusto minimiza ocorr√™ncia de erros tribut√°rios.','Revisar processo de preven√ß√£o e corre√ß√£o semestralmente com contador para melhoria cont√≠nua.'],
];

TRIBUTARIO.forEach(pt => {
    PERGUNTAS[pt[0]] = {
        cat: 'Planejamento Tribut√°rio',
        txt: pt[1],
        niveis: [
            {nivel:1,titulo:'Cr√≠tico',emoji:'üî¥',pts:0,classe:'critico',feedback:pt[2],acao:pt[3]},
            {nivel:2,titulo:'B√°sico',emoji:'üü†',pts:1,classe:'basico',feedback:pt[4],acao:pt[5]},
            {nivel:3,titulo:'Estruturado',emoji:'üü¢',pts:2,classe:'estruturado',feedback:pt[6],acao:pt[7]},
            {nivel:4,titulo:'Otimizado',emoji:'üîµ',pts:3,classe:'otimizado',feedback:pt[8],acao:pt[9]}
        ]
    };
});

const CATEGORIAS = {
    tesouraria: Object.keys(PERGUNTAS).filter(k => k.startsWith('t') && !k.startsWith('pt')),
    resultados: Object.keys(PERGUNTAS).filter(k => k.startsWith('r')),
    fluxo: Object.keys(PERGUNTAS).filter(k => k.startsWith('f')),
    orcamento: Object.keys(PERGUNTAS).filter(k => k.startsWith('o')),
    investimentos: Object.keys(PERGUNTAS).filter(k => k.startsWith('i') && !k.startsWith('if')),
    riscos: Object.keys(PERGUNTAS).filter(k => k.startsWith('g')),
    indicadores: Object.keys(PERGUNTAS).filter(k => k.startsWith('if')),
    tributario: Object.keys(PERGUNTAS).filter(k => k.startsWith('pt'))
};

function fecharCelebracao() {
    console.log('üî¥ Fechando celebra√ß√£o...');
    const modal = document.getElementById('celebration');
    const backdrop = document.getElementById('celebration-backdrop');
    
    if (modal) {
        modal.classList.remove('show');
        modal.style.display = 'none';
    }
    if (backdrop) {
        backdrop.style.display = 'none';
    }
}

function salvarResposta(id, nivel) {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    resp[id] = { pts: PERGUNTAS[id].niveis[nivel - 1].pts, nivel };
    StorageEmpresa.setItem('diag_resp', JSON.stringify(resp));  // ‚úÖ Corrigido: usar StorageEmpresa
    atualizarProgress();
    
    // Mapear ID para categoria corretamente (incluindo IDs de 2 letras)
    let catId;
    if (id.startsWith('if')) catId = 'indicadores';
    else if (id.startsWith('pt')) catId = 'tributario';
    else if (id.startsWith('t')) catId = 'tesouraria';
    else if (id.startsWith('r')) catId = 'resultados';
    else if (id.startsWith('f')) catId = 'fluxo';
    else if (id.startsWith('o')) catId = 'orcamento';
    else if (id.startsWith('i')) catId = 'investimentos';
    else if (id.startsWith('g')) catId = 'riscos';
    
    if (catId) {
        document.getElementById('area-' + catId).innerHTML = renderCategoria(catId);
    }
}

function salvarProgresso() {
    alert('‚úÖ Progresso salvo!');
}

function atualizarProgress() {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{"porte":"media","setor":"comercio"}');
    // Contar apenas perguntas relevantes para o porte E setor
    const perguntasRelevantes = Object.keys(PERGUNTAS).filter(id => mostrarPergunta(id, config.porte, config.setor));
    const total = perguntasRelevantes.length;
    const respondidas = perguntasRelevantes.filter(id => resp[id]).length;
    const pct = total > 0 ? Math.round((respondidas / total) * 100) : 0;
    console.log(`üìä Progresso: ${respondidas}/${total} (${pct}%) - Porte: ${config.porte} - Setor: ${config.setor}`);
    document.getElementById('progress-txt').textContent = `${pct}% (${respondidas}/${total})`;
    document.getElementById('progress-bar').style.width = pct + '%';
    Object.keys(CATEGORIAS).forEach(cat => {
        const ids = CATEGORIAS[cat];
        const idsFiltrados = ids.filter(id => mostrarPergunta(id, config.porte, config.setor));
        const catResp = idsFiltrados.filter(id => resp[id]).length;
        const badge = document.getElementById(`badge-${cat}`);
        if (badge) badge.textContent = `${catResp}/${idsFiltrados.length}`;
    });
    // ‚úÖ CORRE√á√ÉO DO BUG: Celebra√ß√£o s√≥ aparece na PRIMEIRA VEZ que completa 100%
    if (respondidas === total && total > 0 && respondidas > 0) {
        console.log('üéâ DIAGN√ìSTICO COMPLETO! Verificando se j√° mostrou celebra√ß√£o...');
        // Verificar se j√° mostrou celebra√ß√£o para este diagn√≥stico
        const empresaAtiva = localStorage.getItem('empresa_ativa');  // ‚úÖ CORRIGIDO: empresa_ativa √© string, n√£o JSON
        const chaveCelebracao = `celebracao_mostrada_${empresaAtiva || 'default'}`;
        const jaMostrouCelebracao = localStorage.getItem(chaveCelebracao) === 'true';
        if (!jaMostrouCelebracao) {
            console.log('üéä Mostrando celebra√ß√£o pela PRIMEIRA VEZ!');
            // Marcar que j√° mostrou celebra√ß√£o
            localStorage.setItem(chaveCelebracao, 'true');
            // Atualizar mensagem din√¢mica
            const porteNomes = {
                micro: 'essenciais',
                pequena: 'relevantes',
                media: 'completas'
            };
            const msgPorte = porteNomes[config.porte] || '';
            document.getElementById('celebration-msg').textContent = 
                `Todas as ${total} perguntas ${msgPorte} foram respondidas com sucesso`;
            setTimeout(() => {
                document.getElementById('celebration-backdrop').style.display = 'block';
                document.getElementById('celebration').style.display = 'block';
            }, 500);
        } else {
            console.log('‚úÖ Celebra√ß√£o j√° foi mostrada antes. Salvando silenciosamente...');
        }
    } else if (respondidas < total) {
        // ‚úÖ Se n√£o est√° mais 100% completo, resetar flag de celebra√ß√£o
        const empresaAtiva = localStorage.getItem('empresa_ativa');  // ‚úÖ CORRIGIDO: empresa_ativa √© string, n√£o JSON
        const chaveCelebracao = `celebracao_mostrada_${empresaAtiva || 'default'}`;
        localStorage.removeItem(chaveCelebracao);
    }
}

function renderPergunta(id) {
    const p = PERGUNTAS[id];
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const selecionado = resp[id]?.nivel || 0;
    
    return `<div class="pergunta ${selecionado ? 'respondida' : ''}">
        <span class="pergunta-num">Pergunta ${id.toUpperCase()}</span>
        <div class="pergunta-texto">${p.txt}</div>
        <div class="opcoes">
            ${p.niveis.map(n => `
                <div class="opcao n${n.nivel} ${selecionado === n.nivel ? 'selecionada' : ''}" 
                     onclick="salvarResposta('${id}', ${n.nivel})">
                    <div class="opcao-header">
                        <span class="opcao-emoji">${n.emoji}</span>
                        <span class="opcao-nivel">${n.titulo}</span>
                        <span class="opcao-pts">${n.pts} pts</span>
                    </div>
                    <div class="opcao-desc">${n.feedback}</div>
                    ${selecionado === n.nivel ? `<div class="feedback ${n.classe}">
                        <div class="feedback-titulo">üìã A√ß√£o Recomendada:</div>
                        <div class="feedback-acao">${n.acao}</div>
                    </div>` : ''}
                </div>
            `).join('')}
        </div>
    </div>`;
}

function renderCategoria(catId) {
    // Carregar configura√ß√£o
    const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{"porte":"media","setor":"comercio"}');
    CONFIG_DIAGNOSTICO = config;
    
    console.log(`üîç RENDERIZANDO CATEGORIA: ${catId}`);
    console.log(`   Config atual: Porte=${config.porte} | Setor=${config.setor}`);
    
    const ids = CATEGORIAS[catId];
    console.log(`   Total de perguntas na categoria: ${ids.length}`);
    
    // FILTRAR perguntas baseado no porte E setor
    const idsFiltrados = ids.filter(id => mostrarPergunta(id, config.porte, config.setor));
    console.log(`   ‚úÖ Perguntas AP√ìS filtro: ${idsFiltrados.length}`);
    console.log(`   ‚ùå Perguntas REMOVIDAS: ${ids.length - idsFiltrados.length}`);
    
    const catNomes = {
        tesouraria: { icone: 'üí∞', titulo: 'Organiza√ß√£o Financeira & Tesouraria' },
        resultados: { icone: 'üìà', titulo: 'Resultados, DRE & Indicadores' },
        fluxo: { icone: 'üíµ', titulo: 'Fluxo de Caixa & Capital de Giro' },
        orcamento: { icone: 'üìä', titulo: 'Or√ßamento, Planejamento & Precifica√ß√£o' },
        investimentos: { icone: 'üöÄ', titulo: 'Investimentos & Sustentabilidade' },
        riscos: { icone: 'üõ°Ô∏è', t√≠tulo: 'Gest√£o de Riscos Financeiros & Contratuais' },
        indicadores: { icone: 'üî¢', titulo: 'Indicadores Financeiros & M√©tricas' },
        tributario: { icone: 'üìú', titulo: 'Planejamento Tribut√°rio & Compliance' }
    };
    const cat = catNomes[catId];
    
    // Mensagem adaptativa
    const porteNome = {
        micro: '(Essenciais - Micro)',
        pequena: '(Relevantes - Pequena)',
        media: '(Completas - M√©dia)'
    };
    const setorNome = {
        comercio: 'Com√©rcio',
        servicos: 'Servi√ßos',
        industria: 'Ind√∫stria'
    };
    const qtdMsg = `${idsFiltrados.length}/${ids.length} perguntas ${porteNome[config.porte] || ''} - ${setorNome[config.setor] || config.setor}`;
    
    return `<div class="card">
        <div class="card-header">
            <div class="card-icon">${cat.icone}</div>
            <div>
                <h3 class="card-title">${cat.titulo}</h3>
                <p style="color:var(--text-light);margin-top:4px">${qtdMsg}</p>
            </div>
        </div>
        ${idsFiltrados.map(id => renderPergunta(id)).join('')}
    </div>`;
}

console.log('‚úÖ Checkpoint 1: renderCategoria definida');

// Vari√°vel global para setor de compara√ß√£o
let setorComparacao = null;

function mudarSetorComparacao(novoSetor) {
    setorComparacao = novoSetor;
    document.getElementById('area-scoring').innerHTML = renderScoring();
}

function renderScoring() {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
    const scores = {};
    
    // Calcular scores por categoria
    Object.keys(CATEGORIAS).forEach(cat => {
        const ids = CATEGORIAS[cat];
        let soma = 0;
        ids.forEach(id => { if (resp[id]) soma += resp[id].pts; });
        const max = ids.length * 3;
        scores[cat] = Math.round((soma / max) * 100);
    });
    
    const scoreGeral = Math.round((scores.tesouraria + scores.resultados + scores.fluxo + scores.orcamento + scores.investimentos + scores.riscos + scores.indicadores + scores.tributario) / 8);
    
    // BENCHMARKS POR SETOR
    const benchmarks = {
        comercio: { nome: 'üè™ Com√©rcio', valor: 65 },
        servicos: { nome: 'üíº Servi√ßos', valor: 70 },
        varejo: { nome: 'üõí Varejo', valor: 62 },
        industria: { nome: 'üè≠ Ind√∫stria', valor: 68 }
    };
    
    // Usar setor de compara√ß√£o se foi selecionado, sen√£o usar o setor da empresa
    const setorEmpresa = dados.setor || 'servicos';
    const setorAtual = setorComparacao || setorEmpresa;
    const benchmarkInfo = benchmarks[setorAtual];
    const benchmark = benchmarkInfo.valor;
    const meta = Math.round(benchmark * 1.10); // 10% acima do benchmark
    
    // Status do score
    let status = '';
    let statusClass = '';
    if (scoreGeral >= meta) {
        status = 'üèÜ EXCELENTE - Meta Atingida!';
        statusClass = 'status-excelente';
    } else if (scoreGeral >= benchmark) {
        status = '‚úÖ BOM - Acima do Mercado';
        statusClass = 'status-bom';
    } else if (scoreGeral >= benchmark * 0.8) {
        status = '‚ö†Ô∏è ATEN√á√ÉO - Precisa Melhorar';
        statusClass = 'status-atencao';
    } else {
        status = 'üî¥ CR√çTICO - A√ß√£o Urgente';
        statusClass = 'status-critico';
    }
    
    const setorNome = benchmarkInfo.nome;
    const empresaSetorNome = benchmarks[setorEmpresa].nome;
    
    // Criar IDs √∫nicos para os canvas
    const radarId = 'radarChart_' + Date.now();
    const barrasId = 'barrasChart_' + (Date.now() + 1);
    
    // CRIAR OS GR√ÅFICOS DEPOIS QUE O HTML FOR RENDERIZADO
    setTimeout(() => {
        // Destruir gr√°ficos antigos se existirem
        if (window.radarChartInstance) window.radarChartInstance.destroy();
        if (window.barrasChartInstance) window.barrasChartInstance.destroy();
        
        // GR√ÅFICO RADAR
        const ctxRadar = document.getElementById(radarId);
        if (ctxRadar) {
            window.radarChartInstance = new Chart(ctxRadar, {
                type: 'radar',
                data: {
                    labels: ['üí∞ Tesouraria', 'üìà Resultados', 'üíµ Fluxo de Caixa', 'üìä Or√ßamento', 'üöÄ Investimentos', 'üõ°Ô∏è Riscos', 'üî¢ Indicadores', 'üìú Tribut√°rio'],
                    datasets: [{
                        label: 'Seu Score',
                        data: [scores.tesouraria, scores.resultados, scores.fluxo, scores.orcamento, scores.investimentos, scores.riscos, scores.indicadores, scores.tributario],
                        backgroundColor: 'rgba(102, 126, 234, 0.2)',
                        borderColor: 'rgba(102, 126, 234, 1)',
                        borderWidth: 3,
                        pointBackgroundColor: 'rgba(102, 126, 234, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                font: { size: 12, weight: 'bold' },
                                backdropColor: 'transparent'
                            },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: { font: { size: 14, weight: 'bold' } }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.r + '/100';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // GR√ÅFICO DE BARRAS COMPARATIVO
        const ctxBarras = document.getElementById(barrasId);
        if (ctxBarras) {
            window.barrasChartInstance = new Chart(ctxBarras, {
                type: 'bar',
                data: {
                    labels: ['Tesouraria', 'Resultados', 'Fluxo', 'Or√ßamento', 'Investimentos', 'Riscos'],
                    datasets: [
                        {
                            label: 'Seu Score',
                            data: [scores.tesouraria, scores.resultados, scores.fluxo, scores.orcamento, scores.investimentos, scores.riscos],
                            backgroundColor: 'rgba(102, 126, 234, 0.8)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 2,
                            borderRadius: 8
                        },
                        {
                            label: 'Benchmark ' + setorNome,
                            data: [benchmark, benchmark, benchmark, benchmark, benchmark, benchmark],
                            backgroundColor: 'rgba(0, 200, 83, 0.8)',
                            borderColor: 'rgba(0, 200, 83, 1)',
                            borderWidth: 2,
                            borderRadius: 8
                        },
                        {
                            label: 'Meta (+10%)',
                            data: [meta, meta, meta, meta, meta, meta],
                            backgroundColor: 'rgba(255, 167, 38, 0.8)',
                            borderColor: 'rgba(255, 167, 38, 1)',
                            borderWidth: 2,
                            borderRadius: 8
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { font: { size: 12, weight: 'bold' } },
                            grid: { color: 'rgba(0, 0, 0, 0.05)' }
                        },
                        x: {
                            ticks: { font: { size: 12, weight: 'bold' } },
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: { font: { size: 13, weight: 'bold' }, padding: 15 }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + '/100';
                                }
                            }
                        }
                    }
                }
            });
        }
    }, 100);
    
    // RETORNAR O HTML
    return `
        <!-- HERO SCORE -->
        <div class="score-hero">
            <div class="score-label">Score Geral de Maturidade Financeira</div>
            <div class="score-number">${scoreGeral}<span style="font-size:0.5em;opacity:0.8">/100</span></div>
            <div class="score-status ${statusClass}">${status}</div>
            <p style="margin-top:20px;font-size:0.95em;opacity:0.9">${Object.keys(resp).length}/90 perguntas respondidas</p>
            ${setorEmpresa !== setorAtual ? `<p style="margin-top:12px;font-size:0.85em;opacity:0.85">‚ö†Ô∏è Comparando com setor diferente do cadastrado</p>` : ''}
        </div>
        
        <!-- SELETOR DE SETOR PARA COMPARA√á√ÉO -->
        <div class="setor-selector">
            <div class="setor-selector-title">
                üéØ Selecione o Setor para Compara√ß√£o
                ${setorEmpresa === setorAtual ? `<span class="setor-atual-badge">‚úì Seu Setor: ${empresaSetorNome}</span>` : ''}
            </div>
            <div class="setor-options">
                ${Object.keys(benchmarks).map(setor => `
                    <div class="setor-option ${setorAtual === setor ? 'active' : ''}" onclick="mudarSetorComparacao('${setor}')">
                        ${setorEmpresa === setor ? '<span class="setor-option-badge">‚úì</span>' : ''}
                        <div class="setor-option-name">${benchmarks[setor].nome}</div>
                        <div class="setor-option-bench">Benchmark: ${benchmarks[setor].valor}/100</div>
                        <div class="setor-option-bench" style="color:var(--gold);font-weight:700">Meta: ${Math.round(benchmarks[setor].valor * 1.10)}/100</div>
                    </div>
                `).join('')}
            </div>
            <p style="margin-top:16px;font-size:0.85em;color:var(--text-light);text-align:center">
                üí° <strong>Dica:</strong> Clique em um setor para comparar seu desempenho com aquele mercado espec√≠fico
            </p>
        </div>
        
        <!-- M√âTRICAS PRINCIPAIS -->
        <div class="metrics-grid">
            <div class="metric-card atual">
                <div class="metric-label">Seu Score</div>
                <div class="metric-value" style="color:#667eea">${scoreGeral}</div>
                <div class="metric-subtitle">Pontua√ß√£o Atual</div>
            </div>
            <div class="metric-card benchmark">
                <div class="metric-label">Benchmark ${setorNome}</div>
                <div class="metric-value" style="color:#00c853">${benchmark}</div>
                <div class="metric-subtitle">M√©dia do Setor</div>
            </div>
            <div class="metric-card meta">
                <div class="metric-label">Sua Meta</div>
                <div class="metric-value" style="color:#ffa726">${meta}</div>
                <div class="metric-subtitle">+10% do Benchmark</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Gap para Meta</div>
                <div class="metric-value" style="color:${scoreGeral >= meta ? '#00c853' : '#f57c00'}">${scoreGeral >= meta ? '+' : ''}${scoreGeral - meta}</div>
                <div class="metric-subtitle">${scoreGeral >= meta ? 'Meta Atingida! üéâ' : 'Pontos Faltantes'}</div>
            </div>
        </div>
        
        <!-- GR√ÅFICO RADAR -->
        <div class="chart-container">
            <h3 class="chart-title">üìä Vis√£o Hexagonal - Score por Categoria (6 Dimens√µes)</h3>
            <div class="chart-wrapper">
                <canvas id="${radarId}"></canvas>
            </div>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background:#667eea"></div>
                    <span>Seu Score Atual</span>
                </div>
            </div>
        </div>
        
        <!-- GR√ÅFICO DE BARRAS COMPARATIVO -->
        <div class="chart-container">
            <h3 class="chart-title">üìà Comparativo: Voc√™ vs ${setorNome} vs Meta</h3>
            <div class="chart-wrapper">
                <canvas id="${barrasId}"></canvas>
            </div>
        </div>
        
        <!-- DETALHAMENTO POR CATEGORIA -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üéØ</div>
                <div><h3 class="card-title">Detalhamento por Categoria</h3></div>
            </div>
            
            <div class="comparison-bars">
                ${['tesouraria', 'resultados', 'fluxo', 'orcamento', 'investimentos', 'riscos'].map(cat => {
                    const catNomes = {
                        tesouraria: 'üí∞ Tesouraria',
                        resultados: 'üìà Resultados & DRE',
                        fluxo: 'üíµ Fluxo de Caixa',
                        orcamento: 'üìä Or√ßamento',
                        investimentos: 'üöÄ Investimentos',
                        riscos: 'üõ°Ô∏è Riscos Financeiros'
                    };
                    const score = scores[cat];
                    const respondidas = CATEGORIAS[cat].filter(id => resp[id]).length;
                    const statusCat = score >= 75 ? 'üèÜ' : score >= 65 ? '‚úÖ' : score >= 50 ? '‚ö†Ô∏è' : 'üî¥';
                    
                    return `
                        <div class="comparison-item">
                            <div class="comparison-header">
                                <span class="comparison-name">${catNomes[cat]}</span>
                                <span style="font-size:1.5em;font-weight:800;color:#667eea">${score}/100 ${statusCat}</span>
                            </div>
                            <div class="comparison-bar-bg">
                                <div class="comparison-bar-fill bar-seu" style="width:${score}%">${score >= 15 ? score + '/100' : ''}</div>
                            </div>
                            <div style="display:flex;gap:16px;margin-top:12px;font-size:0.85em;color:var(--text-light)">
                                <span>üìä <strong>Score:</strong> ${score}/100</span>
                                <span>‚úì <strong>Respondidas:</strong> ${respondidas}/15</span>
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
        </div>
    `;
}

console.log('‚úÖ Checkpoint 2: renderScoring definida');

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üìä M√ìDULO BASE: AN√ÅLISE SWOT (FONTE DE TUDO)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function gerarSWOT() {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const scores = {};
    
    // Calcular scores
    Object.keys(CATEGORIAS).forEach(cat => {
        const ids = CATEGORIAS[cat];
        let soma = 0;
        ids.forEach(id => { if (resp[id]) soma += resp[id].pts; });
        const max = ids.length * 3;
        scores[cat] = Math.round((soma / max) * 100);
    });
    
    const swot = {
        forcas: [],
        fraquezas: [],
        oportunidades: [],
        ameacas: []
    };
    
    // FOR√áAS: Respostas N√≠vel 4 (Estrat√©gico)
    Object.keys(resp).forEach(id => {
        if (resp[id].nivel === 4) {
            const p = PERGUNTAS[id];
            swot.forcas.push({
                categoria: p.cat,
                descricao: p.txt,
                detalhe: p.niveis[3].feedback
            });
        }
    });
    
    // FRAQUEZAS: Respostas N√≠vel 1 (Inexistente/Cr√≠tico)
    Object.keys(resp).forEach(id => {
        if (resp[id].nivel === 1) {
            const p = PERGUNTAS[id];
            swot.fraquezas.push({
                categoria: p.cat,
                descricao: p.txt,
                detalhe: p.niveis[0].feedback,
                critica: PERGUNTAS_CRITICAS.includes(id)
            });
        }
    });
    
    console.log('‚ö†Ô∏è TOTAL DE FRAQUEZAS GERADAS:', swot.fraquezas.length);
    console.log('‚ö†Ô∏è ARRAY COMPLETO:', swot.fraquezas);
    
    // OPORTUNIDADES: Categorias com score 40-70 (tem margem de crescimento)
    Object.keys(scores).forEach(cat => {
        const score = scores[cat];
        if (score >= 40 && score < 70) {
            const catNomes = {
                tesouraria: 'üí∞ Tesouraria',
                resultados: 'üìà Resultados & DRE',
                fluxo: 'üíµ Fluxo de Caixa',
                orcamento: 'üìä Or√ßamento',
                investimentos: 'üöÄ Investimentos',
                riscos: 'üõ°Ô∏è Riscos Financeiros',
                indicadores: 'üî¢ Indicadores Financeiros',
                tributario: 'üìú Planejamento Tribut√°rio'
            };
            swot.oportunidades.push({
                categoria: cat,
                nome: catNomes[cat],
                descricao: `Elevar ${catNomes[cat]} de ${score}/100 para 70+`,
                gap: 70 - score,
                potencial: 'M√âDIO'
            });
        }
    });
    
    // AMEA√áAS: Fraquezas cr√≠ticas + baixo score geram amea√ßas
    Object.keys(scores).forEach(cat => {
        const score = scores[cat];
        if (score < 40) {
            const catNomes = {
                tesouraria: 'üí∞ Tesouraria',
                resultados: 'üìà Resultados',
                fluxo: 'üíµ Fluxo de Caixa',
                orcamento: 'üìä Or√ßamento',
                investimentos: 'üöÄ Investimentos',
                riscos: 'üõ°Ô∏è Gest√£o de Riscos',
                indicadores: 'üî¢ Indicadores',
                tributario: 'üìú Tribut√°rio'
            };
            
            const ameacas = {
                tesouraria: 'Risco de colapso de caixa e inadimpl√™ncia',
                resultados: 'Margens sendo corro√≠das sem visibilidade',
                fluxo: 'Vulnerabilidade a crises de liquidez',
                orcamento: 'Decis√µes sem base, perdas n√£o identificadas',
                investimentos: 'Estagna√ß√£o e perda de competitividade',
                riscos: 'Exposi√ß√£o alta a eventos adversos',
                indicadores: 'Gest√£o √†s cegas, sem m√©tricas confi√°veis',
                tributario: 'Risco fiscal alto, multas e perda de competitividade'
            };
            
            swot.ameacas.push({
                categoria: cat,
                nome: catNomes[cat],
                descricao: ameacas[cat],
                score: score,
                severidade: score < 30 ? 'ALTA' : 'M√âDIA'
            });
        }
    });
    
    return swot;
}

function gerarCruzamentosSWOT(swot) {
    const cruzamentos = [];
    
    // FxO (For√ßas √ó Oportunidades) - EXPANS√ÉO
    if (swot.forcas.length > 0 && swot.oportunidades.length > 0) {
        cruzamentos.push({
            tipo: 'FxO',
            nome: 'üí™üöÄ EXPANS√ÉO & CRESCIMENTO',
            cor: '#2e7d32',
            estrategia: 'Usar pontos fortes para aproveitar oportunidades',
            exemplos: [
                `Aproveitar ${swot.forcas[0]?.categoria} forte para expandir em ${swot.oportunidades[0]?.nome}`,
                'Usar solidez atual como base para crescimento'
            ]
        });
    }
    
    // FxA (For√ßas √ó Amea√ßas) - CONFRONTO
    if (swot.forcas.length > 0 && swot.ameacas.length > 0) {
        cruzamentos.push({
            tipo: 'FxA',
            nome: 'üí™‚ö° CONFRONTO & DEFESA',
            cor: '#1976d2',
            estrategia: 'Usar pontos fortes para neutralizar amea√ßas',
            exemplos: [
                'Fortalecer √°reas cr√≠ticas usando capacidades existentes',
                'Mitigar riscos com recursos j√° dispon√≠veis'
            ]
        });
    }
    
    // FrxO (Fraquezas √ó Oportunidades) - REFOR√áO
    if (swot.fraquezas.length > 0 && swot.oportunidades.length > 0) {
        cruzamentos.push({
            tipo: 'FrxO',
            nome: '‚ö†Ô∏èüöÄ REFOR√áO & INVESTIMENTO',
            cor: '#f57c00',
            estrategia: 'Corrigir fraquezas para aproveitar oportunidades',
            exemplos: [
                'Estruturar √°reas deficientes para capturar crescimento',
                'Investir em capacidades que desbloqueiam oportunidades'
            ]
        });
    }
    
    // FrxA (Fraquezas √ó Amea√ßas) - SOBREVIV√äNCIA
    if (swot.fraquezas.length > 0 && swot.ameacas.length > 0) {
        cruzamentos.push({
            tipo: 'FrxA',
            nome: '‚ö†Ô∏è‚ö° SOBREVIV√äNCIA & URG√äNCIA',
            cor: '#d32f2f',
            estrategia: 'URGENTE: Corrigir fraquezas cr√≠ticas que amplificam amea√ßas',
            exemplos: [
                'Prioridade m√°xima: eliminar riscos existenciais',
                'A√ß√µes imediatas para estabilizar opera√ß√£o'
            ]
        });
    }
    
    return cruzamentos;
}

function renderSWOT() {
    const swot = gerarSWOT();
    const cruzamentos = gerarCruzamentosSWOT(swot);
    
    return `
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üìä</div>
                <div>
                    <h3 class="card-title">An√°lise SWOT Estrat√©gica</h3>
                    <p style="color:var(--text-light);margin-top:4px">Base para Riscos, Plano de A√ß√£o e OKRs</p>
                </div>
            </div>
            
            <!-- INTRO -->
            <div style="background:linear-gradient(135deg, rgba(0,102,255,0.1), transparent);border-left:4px solid var(--accent);padding:20px;border-radius:12px;margin-bottom:32px">
                <h4 style="color:var(--accent);margin-bottom:12px">üéØ Sobre a An√°lise SWOT</h4>
                <p style="color:var(--text-light);line-height:1.8">
                    A SWOT √© a <strong>fonte de verdade</strong> do seu diagn√≥stico. Tudo que vem depois (Riscos, Plano de A√ß√£o, OKRs) 
                    deriva desta an√°lise estrat√©gica. Ela mostra onde sua empresa est√° posicionada e fundamenta todas as decis√µes.
                </p>
            </div>
            
            <!-- MATRIZ SWOT 2x2 -->
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:32px">
                
                <!-- FOR√áAS -->
                <div style="background:linear-gradient(135deg, rgba(46,125,50,0.1), transparent);border:3px solid #2e7d32;border-radius:16px;padding:24px">
                    <h3 style="color:#2e7d32;margin-bottom:16px;display:flex;align-items:center;gap:8px">
                        <span style="font-size:1.5em">üí™</span>
                        <span>FOR√áAS</span>
                        <span style="background:#2e7d32;color:white;padding:4px 12px;border-radius:12px;font-size:0.75em;margin-left:auto">
                            ${swot.forcas.length}
                        </span>
                    </h3>
                    <p style="color:var(--text-light);font-size:0.9em;margin-bottom:16px;font-style:italic">
                        Pontos fortes internos (N√≠vel 4 - Estrat√©gico)
                    </p>
                    <div style="max-height:800px;overflow-y:auto;padding-right:8px">
                    ${swot.forcas.length === 0 ? `
                        <div style="text-align:center;padding:20px;color:var(--text-light)">
                            Ainda n√£o h√° pontos em n√≠vel estrat√©gico. Foque em elevar as √°reas boas.
                        </div>
                    ` : swot.forcas.map(f => `
                        <div style="background:var(--card);border-left:4px solid #2e7d32;padding:12px;border-radius:8px;margin-bottom:12px">
                            <div style="font-weight:700;margin-bottom:4px">${f.descricao}</div>
                            <div style="font-size:0.85em;color:var(--text-light)">${f.detalhe}</div>
                        </div>
                    `).join('')}
                    </div>
                </div>
                
                <!-- OPORTUNIDADES -->
                <div style="background:linear-gradient(135deg, rgba(0,200,83,0.1), transparent);border:3px solid #00c853;border-radius:16px;padding:24px">
                    <h3 style="color:#00c853;margin-bottom:16px;display:flex;align-items:center;gap:8px">
                        <span style="font-size:1.5em">üöÄ</span>
                        <span>OPORTUNIDADES</span>
                        <span style="background:#00c853;color:white;padding:4px 12px;border-radius:12px;font-size:0.75em;margin-left:auto">
                            ${swot.oportunidades.length}
                        </span>
                    </h3>
                    <p style="color:var(--text-light);font-size:0.9em;margin-bottom:16px;font-style:italic">
                        √Åreas com margem de crescimento (Score 40-70)
                    </p>
                    <div style="max-height:800px;overflow-y:auto;padding-right:8px">
                    ${swot.oportunidades.length === 0 ? `
                        <div style="text-align:center;padding:20px;color:var(--text-light)">
                            Todas as categorias est√£o ou muito bem (70+) ou cr√≠ticas (<40).
                        </div>
                    ` : swot.oportunidades.map(o => `
                        <div style="background:var(--card);border-left:4px solid #00c853;padding:12px;border-radius:8px;margin-bottom:12px">
                            <div style="font-weight:700;margin-bottom:4px">${o.nome}</div>
                            <div style="font-size:0.85em;color:var(--text-light)">${o.descricao}</div>
                            <div style="margin-top:8px;font-size:0.8em">
                                <span style="background:#00c853;color:white;padding:3px 8px;border-radius:6px">Gap: ${o.gap} pts</span>
                            </div>
                        </div>
                    `).join('')}
                    </div>
                </div>
                
                <!-- FRAQUEZAS -->
                <div style="background:linear-gradient(135deg, rgba(245,124,0,0.1), transparent);border:3px solid #f57c00;border-radius:16px;padding:24px">
                    <h3 style="color:#f57c00;margin-bottom:16px;display:flex;align-items:center;gap:8px">
                        <span style="font-size:1.5em">‚ö†Ô∏è</span>
                        <span>FRAQUEZAS</span>
                        <span style="background:#f57c00;color:white;padding:4px 12px;border-radius:12px;font-size:0.75em;margin-left:auto">
                            ${swot.fraquezas.length}
                        </span>
                    </h3>
                    <p style="color:var(--text-light);font-size:0.9em;margin-bottom:16px;font-style:italic">
                        Gaps internos cr√≠ticos (N√≠vel 1 - Inexistente)
                    </p>
                    <div style="max-height:800px;overflow-y:auto;padding-right:8px">
                    ${swot.fraquezas.length === 0 ? `
                        <div style="text-align:center;padding:20px;color:#2e7d32;font-weight:700">
                            üéâ Excelente! Nenhuma √°rea em n√≠vel cr√≠tico.
                        </div>
                    ` : (() => {
                        let html = '';
                        for (let i = 0; i < swot.fraquezas.length; i++) {
                            const f = swot.fraquezas[i];
                            html += '<div style="background:var(--card);border-left:4px solid #f57c00;padding:12px;border-radius:8px;margin-bottom:12px">';
                            if (f.critica) {
                                html += '<span style="background:#d32f2f;color:white;padding:3px 8px;border-radius:6px;font-size:0.75em;font-weight:700;margin-bottom:8px;display:inline-block">‚ö†Ô∏è CR√çTICO</span>';
                            }
                            html += '<div style="font-weight:700;margin-bottom:4px">' + (f.descricao || 'Sem descri√ß√£o') + '</div>';
                            html += '<div style="font-size:0.85em;color:var(--text-light)">' + (f.detalhe || 'Sem detalhe') + '</div>';
                            html += '</div>';
                        }
                        return html;
                    })()}
                    </div>
                </div>
                
                <!-- AMEA√áAS -->
                <div style="background:linear-gradient(135deg, rgba(211,47,47,0.1), transparent);border:3px solid #d32f2f;border-radius:16px;padding:24px">
                    <h3 style="color:#d32f2f;margin-bottom:16px;display:flex;align-items:center;gap:8px">
                        <span style="font-size:1.5em">‚ö°</span>
                        <span>AMEA√áAS</span>
                        <span style="background:#d32f2f;color:white;padding:4px 12px;border-radius:12px;font-size:0.75em;margin-left:auto">
                            ${swot.ameacas.length}
                        </span>
                    </h3>
                    <p style="color:var(--text-light);font-size:0.9em;margin-bottom:16px;font-style:italic">
                        Riscos externos potencializados por fraquezas
                    </p>
                    <div style="max-height:800px;overflow-y:auto;padding-right:8px">
                    ${swot.ameacas.length === 0 ? `
                        <div style="text-align:center;padding:20px;color:#2e7d32;font-weight:700">
                            üéâ Nenhuma amea√ßa significativa identificada!
                        </div>
                    ` : swot.ameacas.map(a => `
                        <div style="background:var(--card);border-left:4px solid #d32f2f;padding:12px;border-radius:8px;margin-bottom:12px">
                            <div style="display:flex;gap:8px;margin-bottom:8px">
                                <span style="background:#d32f2f;color:white;padding:3px 8px;border-radius:6px;font-size:0.75em;font-weight:700">
                                    ${a.severidade}
                                </span>
                                <span style="background:var(--text-light);color:white;padding:3px 8px;border-radius:6px;font-size:0.75em">
                                    Score: ${a.score}/100
                                </span>
                            </div>
                            <div style="font-weight:700;margin-bottom:4px">${a.nome}</div>
                            <div style="font-size:0.85em;color:var(--text-light)">${a.descricao}</div>
                        </div>
                    `).join('')}
                    </div>
                </div>
            </div>
            
            <!-- CRUZAMENTOS ESTRAT√âGICOS -->
            <div style="background:var(--card);border:3px solid var(--accent);border-radius:16px;padding:32px;margin-top:32px">
                <h3 style="color:var(--accent);margin-bottom:24px;display:flex;align-items:center;gap:12px">
                    <span style="font-size:1.5em">üîÑ</span>
                    <span>Cruzamentos Estrat√©gicos (Matriz SWOT)</span>
                </h3>
                <p style="color:var(--text-light);margin-bottom:24px;line-height:1.8">
                    Os cruzamentos da matriz SWOT definem as estrat√©gias priorit√°rias da empresa. 
                    Cada cruzamento gera direcionamentos espec√≠ficos que ser√£o detalhados no Plano de A√ß√£o e nos OKRs.
                </p>
                
                <div style="display:grid;gap:16px">
                    ${cruzamentos.map(c => `
                        <div style="background:var(--card);border-left:5px solid ${c.cor};padding:20px;border-radius:12px;box-shadow:var(--shadow)">
                            <h4 style="color:${c.cor};margin-bottom:12px;font-size:1.1em">${c.nome}</h4>
                            <div style="background:rgba(0,102,255,0.05);padding:12px;border-radius:8px;margin-bottom:12px">
                                <div style="font-weight:700;color:var(--accent);font-size:0.85em;margin-bottom:4px">ESTRAT√âGIA:</div>
                                <div style="color:var(--text)">${c.estrategia}</div>
                            </div>
                            <div style="font-size:0.85em;color:var(--text-light)">
                                <strong>Exemplos de aplica√ß√£o:</strong>
                                <ul style="margin-top:8px;padding-left:20px">
                                    ${c.exemplos.map(ex => `<li style="margin-bottom:4px">${ex}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            <!-- PR√ìXIMOS PASSOS -->
            <div style="background:rgba(255,167,38,0.1);border-left:4px solid var(--gold);padding:20px;border-radius:12px;margin-top:32px">
                <h4 style="color:var(--gold);margin-bottom:12px">üéØ Como esta an√°lise ser√° usada</h4>
                <ul style="color:var(--text-light);line-height:1.8;padding-left:20px">
                    <li><strong>Mapa de Riscos:</strong> Deriva das Fraquezas + Amea√ßas identificadas</li>
                    <li><strong>Plano de A√ß√£o (30/60/90):</strong> Foca em corrigir Fraquezas e mitigar Amea√ßas</li>
                    <li><strong>OKRs Estrat√©gicos:</strong> Usa For√ßas para aproveitar Oportunidades</li>
                    <li><strong>Relat√≥rio Executivo:</strong> Consolida toda a estrat√©gia derivada da SWOT</li>
                </ul>
            </div>
        </div>
    `;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üõ°Ô∏è M√ìDULO 1: MOTOR DE RISCOS AUTOM√ÅTICO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Perguntas cr√≠ticas que geram risco alto automaticamente se n√≠vel 1
const PERGUNTAS_CRITICAS = [
    't1', 't3', 't4', 't5', 't9',         // Tesouraria cr√≠tica (removido t7)
    'f1', 'f2', 'f5', 'f7',               // Fluxo de caixa cr√≠tico
    'r1', 'r2', 'r4',                     // Resultados cr√≠ticos
    'g5', 'g10', 'g12',                   // Riscos contratuais/financeiros
    'if2', 'if3', 'if5', 'if7', 'if14',   // Indicadores cr√≠ticos (removido if10)
    'pt1', 'pt10'                         // Tribut√°rio cr√≠tico (removidos pt7, pt13)
];

function atualizarFaturamento() {
    const faturamentoInput = prompt('Digite o faturamento anual da empresa em R$ (exemplo: 2000000 para R$ 2M):');
    if (faturamentoInput && !isNaN(faturamentoInput)) {
        const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
        dados.faturamento = parseFloat(faturamentoInput);
        localStorage.setItem('diag_dados', JSON.stringify(dados));
        // Recalcular
        document.getElementById('area-calculadora').innerHTML = renderCalculadora();
    } else if (faturamentoInput !== null) {
        alert('Por favor, digite apenas n√∫meros. Exemplo: 2000000');
    }
}

function renderCalculadora() {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
    const scores = {};
    
    console.log('üîç CALCULADORA DEBUG:');
    console.log('Respostas encontradas:', Object.keys(resp).length, 'perguntas');
    console.log('Respostas:', resp);
    
    // Calcular scores por categoria
    Object.keys(CATEGORIAS).forEach(cat => {
        const ids = CATEGORIAS[cat];
        let soma = 0;
        ids.forEach(id => { if (resp[id]) soma += resp[id].pts; });
        const max = ids.length * 3;
        scores[cat] = Math.round((soma / max) * 100);
        console.log(`Score ${cat}: ${scores[cat]} (soma: ${soma}, max: ${max})`);
    });
    
    // Obter faturamento anual corretamente
    const fat = obterFaturamentoAnual();
    const faturamento = fat.anual;
    
    // Calcular perdas por categoria
    const perdas = [];
    
    // 1. TESOURARIA (score < 60)
    if (scores.tesouraria < 60) {
        const severidade = scores.tesouraria < 30 ? 'CR√çTICA' : scores.tesouraria < 45 ? 'ALTA' : 'M√âDIA';
        const percentualPerda = scores.tesouraria < 30 ? 0.04 : scores.tesouraria < 45 ? 0.025 : 0.015;
        const perda = Math.round(faturamento * percentualPerda);
        
        perdas.push({
            categoria: 'üí∞ Tesouraria & Caixa',
            score: scores.tesouraria,
            severidade: severidade,
            perda: perda,
            descricao: 'Juros por atrasos, multas banc√°rias, perda de descontos √† vista',
            percentual: (percentualPerda * 100).toFixed(1)
        });
    }
    
    // 2. FLUXO DE CAIXA (score < 60)
    if (scores.fluxo < 60) {
        const severidade = scores.fluxo < 30 ? 'CR√çTICA' : scores.fluxo < 45 ? 'ALTA' : 'M√âDIA';
        const percentualPerda = scores.fluxo < 30 ? 0.05 : scores.fluxo < 45 ? 0.03 : 0.02;
        const perda = Math.round(faturamento * percentualPerda);
        
        perdas.push({
            categoria: 'üíµ Fluxo de Caixa',
            score: scores.fluxo,
            severidade: severidade,
            perda: perda,
            descricao: 'Crises de liquidez, empr√©stimos emergenciais, juros altos',
            percentual: (percentualPerda * 100).toFixed(1)
        });
    }
    
    // 3. RESULTADOS & DRE (score < 60)
    if (scores.resultados < 60) {
        const severidade = scores.resultados < 30 ? 'CR√çTICA' : scores.resultados < 45 ? 'ALTA' : 'M√âDIA';
        const percentualPerda = scores.resultados < 30 ? 0.07 : scores.resultados < 45 ? 0.05 : 0.03;
        const perda = Math.round(faturamento * percentualPerda);
        
        perdas.push({
            categoria: 'üìà Resultados & DRE',
            score: scores.resultados,
            severidade: severidade,
            perda: perda,
            descricao: 'Margens mal calculadas, decis√µes sem base, vendas n√£o lucrativas',
            percentual: (percentualPerda * 100).toFixed(1)
        });
    }
    
    // 4. OR√áAMENTO (score < 60)
    if (scores.orcamento < 60) {
        const severidade = scores.orcamento < 30 ? 'CR√çTICA' : scores.orcamento < 45 ? 'ALTA' : 'M√âDIA';
        const percentualPerda = scores.orcamento < 30 ? 0.10 : scores.orcamento < 45 ? 0.07 : 0.04;
        const perda = Math.round(faturamento * percentualPerda);
        
        perdas.push({
            categoria: 'üìä Or√ßamento & Planejamento',
            score: scores.orcamento,
            severidade: severidade,
            perda: perda,
            descricao: 'Gastos descontrolados, compras sem planejamento, desperd√≠cios',
            percentual: (percentualPerda * 100).toFixed(1)
        });
    }
    
    // 5. INVESTIMENTOS (score < 60)
    if (scores.investimentos < 60) {
        const severidade = scores.investimentos < 30 ? 'ALTA' : scores.investimentos < 45 ? 'M√âDIA' : 'BAIXA';
        const percentualPerda = scores.investimentos < 30 ? 0.08 : scores.investimentos < 45 ? 0.05 : 0.03;
        const perda = Math.round(faturamento * percentualPerda);
        
        perdas.push({
            categoria: 'üöÄ Investimentos',
            score: scores.investimentos,
            severidade: severidade,
            perda: perda,
            descricao: 'Oportunidades perdidas, recursos mal alocados, estagna√ß√£o',
            percentual: (percentualPerda * 100).toFixed(1)
        });
    }
    
    // 6. RISCOS FINANCEIROS (score < 60)
    if (scores.riscos < 60) {
        const severidade = scores.riscos < 30 ? 'CR√çTICA' : scores.riscos < 45 ? 'ALTA' : 'M√âDIA';
        const percentualPerda = scores.riscos < 30 ? 0.06 : scores.riscos < 45 ? 0.04 : 0.02;
        const perda = Math.round(faturamento * percentualPerda);
        
        perdas.push({
            categoria: 'üõ°Ô∏è Gest√£o de Riscos',
            score: scores.riscos,
            severidade: severidade,
            perda: perda,
            descricao: 'Exposi√ß√£o a eventos adversos, contratos mal feitos, sem prote√ß√£o',
            percentual: (percentualPerda * 100).toFixed(1)
        });
    }
    
    // 7. INDICADORES FINANCEIROS (score < 60)
    if (scores.indicadores < 60) {
        const severidade = scores.indicadores < 30 ? 'CR√çTICA' : scores.indicadores < 45 ? 'ALTA' : 'M√âDIA';
        const percentualPerda = scores.indicadores < 30 ? 0.09 : scores.indicadores < 45 ? 0.06 : 0.04;
        const perda = Math.round(faturamento * percentualPerda);
        
        perdas.push({
            categoria: 'üî¢ Indicadores Financeiros',
            score: scores.indicadores,
            severidade: severidade,
            perda: perda,
            descricao: 'Gest√£o √†s cegas, decis√µes sem dados, problemas n√£o identificados',
            percentual: (percentualPerda * 100).toFixed(1)
        });
    }
    
    // 8. PLANEJAMENTO TRIBUT√ÅRIO (score < 60)
    if (scores.tributario < 60) {
        const severidade = scores.tributario < 30 ? 'CR√çTICA' : scores.tributario < 45 ? 'ALTA' : 'M√âDIA';
        const percentualPerda = scores.tributario < 30 ? 0.20 : scores.tributario < 45 ? 0.12 : 0.07;
        const perda = Math.round(faturamento * percentualPerda);
        
        perdas.push({
            categoria: 'üìú Planejamento Tribut√°rio',
            score: scores.tributario,
            severidade: severidade,
            perda: perda,
            descricao: 'Regime inadequado, sem planejamento, multas fiscais, perda de competitividade',
            percentual: (percentualPerda * 100).toFixed(1)
        });
    }
    
    // Calcular totais
    const totalPerdas = perdas.reduce((sum, p) => sum + p.perda, 0);
    
    console.log('üí∞ Perdas identificadas:', perdas.length, 'categorias');
    console.log('üí∏ Total de perdas:', totalPerdas);
    console.log('üìä Faturamento usado:', faturamento);
    console.log('Detalhes:', perdas);
    
    // Verificar se tem respostas suficientes
    const totalRespostas = Object.keys(resp).length;
    const totalPerguntas = Object.keys(PERGUNTAS).length;
    const avisoRespostas = totalRespostas < 40 ? `
        <div style="background:rgba(255,152,0,0.1);border:2px solid #ff9800;padding:20px;border-radius:12px;margin-bottom:24px">
            <div style="display:flex;justify-content:space-between;align-items:center">
                <div>
                    <h4 style="color:#ff9800;margin:0 0 8px 0">‚ö†Ô∏è An√°lise Parcial</h4>
                    <p style="margin:0;color:var(--text-light)">
                        Voc√™ respondeu <strong>${totalRespostas} de ${totalPerguntas} perguntas</strong>. 
                        Para uma an√°lise completa e valores mais precisos, responda pelo menos 40-60 perguntas.
                    </p>
                </div>
                <button onclick="irPara('tesouraria')" style="background:#ff9800;color:white;border:none;padding:12px 20px;border-radius:8px;font-weight:700;cursor:pointer;white-space:nowrap">
                    Responder Mais
                </button>
            </div>
        </div>
    ` : totalRespostas < totalPerguntas ? `
        <div style="background:rgba(76,175,80,0.1);border-left:4px solid #4caf50;padding:16px;border-radius:8px;margin-bottom:24px">
            <strong>‚úÖ Bom progresso!</strong> Voc√™ respondeu ${totalRespostas} de ${totalPerguntas} perguntas. 
            ${totalPerguntas - totalRespostas} restantes para 100% de cobertura.
        </div>
    ` : `
        <div style="background:rgba(76,175,80,0.1);border-left:4px solid #4caf50;padding:16px;border-radius:8px;margin-bottom:24px">
            <strong>üéâ Diagn√≥stico Completo!</strong> Voc√™ respondeu todas as ${totalPerguntas} perguntas. An√°lise 100% precisa!
        </div>
    `;
    
    // Estimar investimento necess√°rio para corrigir (baseado em severidade)
    const investimentoPorCategoria = {
        'CR√çTICA': 8000,
        'ALTA': 5000,
        'M√âDIA': 3000,
        'BAIXA': 1500
    };
    
    const investimentoTotal = perdas.reduce((sum, p) => sum + investimentoPorCategoria[p.severidade], 0);
    
    // Calcular ROI
    const roi = investimentoTotal > 0 ? (totalPerdas / investimentoTotal).toFixed(1) : 0;
    const payback = investimentoTotal > 0 ? ((investimentoTotal / totalPerdas) * 12).toFixed(1) : 0;
    
    // Renderizar HTML
    return `
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üí∞</div>
                <div>
                    <h3 class="card-title">Calculadora de Perdas & Ganhos Financeiros</h3>
                    <p style="color:var(--text-light);margin-top:4px">Quanto sua empresa est√° perdendo por n√£o ter gest√£o estruturada</p>
                </div>
            </div>
            
            <!-- INTRO IMPACTANTE -->
            <div style="background:linear-gradient(135deg, rgba(211,47,47,0.1), transparent);border-left:4px solid #d32f2f;padding:20px;border-radius:12px;margin-bottom:32px">
                <h4 style="color:#d32f2f;margin-bottom:12px">‚ö†Ô∏è Aten√ß√£o: Dinheiro Saindo do Seu Bolso</h4>
                <p style="color:var(--text-light);line-height:1.8">
                    Baseado no seu diagn√≥stico (${totalRespostas} pergunta${totalRespostas !== 1 ? 's respondidas' : ' respondida'}) e no faturamento ${dados.faturamento ? `cadastrado de <strong>${formatarValorGrande(faturamento)}/ano</strong>` : `estimado de <strong>${formatarValorGrande(faturamento)}/ano</strong> (baseado no porte: ${StorageEmpresa.getItem('diag_config') ? JSON.parse(StorageEmpresa.getItem('diag_config')).porte : 'm√©dio'})`}, 
                    identificamos <strong>${perdas.length} √°rea${perdas.length !== 1 ? 's' : ''}</strong> gerando perdas financeiras mensur√°veis.
                    Essas perdas s√£o <strong>EVIT√ÅVEIS</strong> com gest√£o estruturada.
                </p>
                ${!dados.faturamento ? `
                    <div style="margin-top:12px;padding:12px;background:rgba(255,152,0,0.1);border-radius:8px;display:flex;justify-content:space-between;align-items:center">
                        <div>
                            <strong>üí° Dica:</strong> Para c√°lculos mais precisos, informe o faturamento real da sua empresa.
                        </div>
                        <button onclick="atualizarFaturamento()" style="background:#ff9800;color:white;border:none;padding:8px 16px;border-radius:6px;font-weight:700;cursor:pointer">
                            Informar Faturamento
                        </button>
                    </div>
                ` : `
                    <div style="margin-top:12px;padding:12px;background:rgba(76,175,80,0.1);border-radius:8px;display:flex;justify-content:space-between;align-items:center">
                        <div>
                            <strong>‚úÖ Faturamento:</strong> ${formatarValorGrande(faturamento)}/ano
                        </div>
                        <button onclick="atualizarFaturamento()" style="background:var(--accent);color:white;border:none;padding:8px 16px;border-radius:6px;font-weight:700;cursor:pointer;font-size:0.85em">
                            Atualizar
                        </button>
                    </div>
                `}
            </div>
            
            ${avisoRespostas}
            
            ${perdas.length === 0 ? `
                <!-- NENHUMA PERDA DETECTADA -->
                <div style="background:linear-gradient(135deg, rgba(46,125,50,0.1), transparent);border:3px solid #2e7d32;border-radius:16px;padding:40px;text-align:center">
                    <div style="font-size:4em;margin-bottom:16px">üéâ</div>
                    <h3 style="color:#2e7d32;margin-bottom:12px">Parab√©ns! Gest√£o Excelente!</h3>
                    <p style="color:var(--text-light);font-size:1.1em">
                        Todas as categorias est√£o com score acima de 60. Sua empresa tem uma gest√£o financeira s√≥lida.
                        Continue monitorando e aprimorando para manter a excel√™ncia.
                    </p>
                </div>
            ` : `
                <!-- PERDAS IDENTIFICADAS -->
                <div style="margin-bottom:32px">
                    <h3 style="margin-bottom:20px;color:var(--text)">üí∏ Perdas Financeiras Identificadas</h3>
                    
                    <div style="display:grid;gap:16px">
                        ${perdas.map(p => {
                            const corSeveridade = {
                                'CR√çTICA': '#d32f2f',
                                'ALTA': '#f57c00',
                                'M√âDIA': '#ffa726',
                                'BAIXA': '#ffb74d'
                            };
                            const cor = corSeveridade[p.severidade];
                            
                            return `
                                <div style="background:var(--card);border-left:6px solid ${cor};padding:20px;border-radius:12px;box-shadow:var(--shadow)">
                                    <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:12px">
                                        <div>
                                            <div style="font-weight:700;font-size:1.1em;margin-bottom:4px">${p.categoria}</div>
                                            <div style="font-size:0.85em;color:var(--text-light)">${p.descricao}</div>
                                        </div>
                                        <div style="text-align:right">
                                            <div style="background:${cor};color:white;padding:4px 12px;border-radius:8px;font-size:0.75em;font-weight:700;margin-bottom:8px">
                                                ${p.severidade}
                                            </div>
                                            <div style="font-size:0.85em;color:var(--text-light)">Score: ${p.score}/100</div>
                                        </div>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;align-items:center;background:rgba(211,47,47,0.05);padding:12px;border-radius:8px;margin-top:12px">
                                        <div style="font-size:0.9em;color:var(--text-light)">Perda anual estimada:</div>
                                        <div style="font-size:1.5em;font-weight:700;color:#d32f2f">
                                            R$ ${formatarValor(p.perda)}
                                            <span style="font-size:0.6em;color:var(--text-light);margin-left:8px">(${p.percentual}% faturamento)</span>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
                
                <!-- TOTAL E ROI -->
                <div style="background:linear-gradient(135deg, #d32f2f, #c62828);color:white;padding:32px;border-radius:16px;margin-bottom:32px;box-shadow:0 8px 24px rgba(0,0,0,0.2)">
                    <div style="text-align:center;margin-bottom:24px">
                        <div style="font-size:0.9em;opacity:0.9;margin-bottom:8px">üí∏ TOTAL DE PERDAS ANUAIS</div>
                        <div style="font-size:3em;font-weight:700;margin-bottom:4px">R$ ${formatarValor(totalPerdas)}</div>
                        <div style="font-size:0.85em;opacity:0.8">Isso √© dinheiro que est√° saindo do seu bolso AGORA</div>
                    </div>
                    
                    <div style="border-top:1px solid rgba(255,255,255,0.2);padding-top:24px;display:grid;grid-template-columns:repeat(3, 1fr);gap:24px;text-align:center">
                        <div>
                            <div style="font-size:0.75em;opacity:0.8;margin-bottom:8px">Investimento para Corrigir</div>
                            <div style="font-size:1.5em;font-weight:700">R$ ${formatarValor(investimentoTotal)}</div>
                        </div>
                        <div>
                            <div style="font-size:0.75em;opacity:0.8;margin-bottom:8px">Retorno sobre Investimento</div>
                            <div style="font-size:1.5em;font-weight:700">${roi}x em 12 meses</div>
                        </div>
                        <div>
                            <div style="font-size:0.75em;opacity:0.8;margin-bottom:8px">Payback</div>
                            <div style="font-size:1.5em;font-weight:700">${payback} ${parseFloat(payback) === 1 ? 'm√™s' : 'meses'}</div>
                        </div>
                    </div>
                </div>
                
                <!-- CALL TO ACTION -->
                <div style="background:linear-gradient(135deg, rgba(0,200,83,0.1), transparent);border:3px solid #00c853;border-radius:16px;padding:24px;text-align:center">
                    <h3 style="color:#00c853;margin-bottom:12px">‚úÖ Pr√≥ximos Passos</h3>
                    <p style="color:var(--text-light);margin-bottom:20px;line-height:1.8">
                        Com um investimento de <strong>R$ ${formatarValor(investimentoTotal)}</strong> em consultoria e estrutura√ß√£o,
                        voc√™ pode <strong>recuperar R$ ${formatarValor(totalPerdas)}/ano</strong>.
                        Isso representa um retorno de <strong>${roi}x</strong> no primeiro ano.
                    </p>
                    <div style="display:flex;gap:16px;justify-content:center;flex-wrap:wrap">
                        <button onclick="irPara('plano')" style="background:#00c853;color:white;border:none;padding:12px 24px;border-radius:8px;font-weight:700;cursor:pointer;font-size:1em">
                            üìã Ver Plano de A√ß√£o Detalhado
                        </button>
                        <button onclick="irPara('resumo')" style="background:var(--accent);color:white;border:none;padding:12px 24px;border-radius:8px;font-weight:700;cursor:pointer;font-size:1em">
                            üìÑ Gerar Relat√≥rio Completo
                        </button>
                    </div>
                </div>
            `}
            
            <!-- METODOLOGIA -->
            <div style="margin-top:32px;padding-top:24px;border-top:2px solid var(--border)">
                <h4 style="margin-bottom:12px;color:var(--text)">üìä Metodologia de C√°lculo</h4>
                <div style="font-size:0.85em;color:var(--text-light);line-height:1.8">
                    <p style="margin-bottom:8px">
                        As perdas foram calculadas baseadas em:
                    </p>
                    <ul style="margin-left:20px;margin-bottom:12px">
                        <li>Score de maturidade de cada categoria (0-100)</li>
                        <li>Faturamento anual da empresa: R$ ${(faturamento/1000000).toFixed(2)}M</li>
                        <li>Percentuais m√©dios de perda por categoria (baseados em estudos de mercado)</li>
                        <li>Severidade da situa√ß√£o (CR√çTICA < 30 | ALTA < 45 | M√âDIA < 60)</li>
                    </ul>
                    <p style="font-style:italic;opacity:0.8">
                        Os valores s√£o estimativas conservadoras. As perdas reais podem ser maiores dependendo do contexto espec√≠fico da empresa.
                    </p>
                </div>
            </div>
        </div>
    `;
}

function identificarRiscos() {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const riscos = [];
    
    Object.keys(resp).forEach(id => {
        const r = resp[id];
        const p = PERGUNTAS[id];
        
        // Regras de classifica√ß√£o de risco
        let severidade = null;
        let cor = '';
        let prazo = '';
        
        if (r.nivel === 1 && PERGUNTAS_CRITICAS.includes(id)) {
            severidade = 'CR√çTICO';
            cor = '#d32f2f';
            prazo = '30 dias';
        } else if (r.nivel === 1) {
            severidade = 'ALTO';
            cor = '#f57c00';
            prazo = '60 dias';
        } else if (r.nivel === 2 && PERGUNTAS_CRITICAS.includes(id)) {
            severidade = 'ALTO';
            cor = '#f57c00';
            prazo = '60 dias';
        } else if (r.nivel === 2) {
            severidade = 'M√âDIO';
            cor = '#ffa726';
            prazo = '90 dias';
        }
        
        if (severidade) {
            riscos.push({
                id,
                categoria: p.cat,
                pergunta: p.txt,
                nivel: r.nivel,
                severidade,
                cor,
                prazo,
                feedback: p.niveis[r.nivel - 1].feedback,
                acao: p.niveis[r.nivel - 1].acao,
                critica: PERGUNTAS_CRITICAS.includes(id)
            });
        }
    });
    
    // Ordenar por severidade
    const ordem = { 'CR√çTICO': 1, 'ALTO': 2, 'M√âDIO': 3 };
    riscos.sort((a, b) => ordem[a.severidade] - ordem[b.severidade]);
    
    return riscos;
}

function renderAnaliseRiscos() {
    const riscos = identificarRiscos();
    const criticos = riscos.filter(r => r.severidade === 'CR√çTICO');
    const altos = riscos.filter(r => r.severidade === 'ALTO');
    const medios = riscos.filter(r => r.severidade === 'M√âDIO');
    
    return `
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üõ°Ô∏è</div>
                <div>
                    <h3 class="card-title">An√°lise de Riscos Financeiros</h3>
                    <p style="color:var(--text-light);margin-top:4px">Identifica√ß√£o autom√°tica baseada no diagn√≥stico</p>
                </div>
            </div>
            
            ${riscos.length === 0 ? `
                <div style="background:linear-gradient(135deg, rgba(46,125,50,0.1), transparent);border:2px solid #2e7d32;border-radius:12px;padding:24px;text-align:center">
                    <div style="font-size:3em;margin-bottom:12px">üéâ</div>
                    <h3 style="color:#2e7d32;margin-bottom:8px">Excelente!</h3>
                    <p style="color:var(--text-light)">Nenhum risco significativo identificado. Continue mantendo boas pr√°ticas de gest√£o.</p>
                </div>
            ` : `
                <!-- RESUMO DE RISCOS -->
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:32px">
                    <div style="background:linear-gradient(135deg, rgba(211,47,47,0.1), transparent);border:2px solid #d32f2f;border-radius:12px;padding:20px;text-align:center">
                        <div style="font-size:2.5em;font-weight:800;color:#d32f2f">${criticos.length}</div>
                        <div style="font-size:0.9em;font-weight:700;color:#d32f2f">CR√çTICOS</div>
                        <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">A√ß√£o imediata</div>
                    </div>
                    <div style="background:linear-gradient(135deg, rgba(245,124,0,0.1), transparent);border:2px solid #f57c00;border-radius:12px;padding:20px;text-align:center">
                        <div style="font-size:2.5em;font-weight:800;color:#f57c00">${altos.length}</div>
                        <div style="font-size:0.9em;font-weight:700;color:#f57c00">ALTOS</div>
                        <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Prioridade alta</div>
                    </div>
                    <div style="background:linear-gradient(135deg, rgba(255,167,38,0.1), transparent);border:2px solid #ffa726;border-radius:12px;padding:20px;text-align:center">
                        <div style="font-size:2.5em;font-weight:800;color:#ffa726">${medios.length}</div>
                        <div style="font-size:0.9em;font-weight:700;color:#ffa726">M√âDIOS</div>
                        <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Aten√ß√£o</div>
                    </div>
                    <div style="background:linear-gradient(135deg, rgba(0,102,255,0.1), transparent);border:2px solid var(--accent);border-radius:12px;padding:20px;text-align:center">
                        <div style="font-size:2.5em;font-weight:800;color:var(--accent)">${riscos.length}</div>
                        <div style="font-size:0.9em;font-weight:700;color:var(--accent)">TOTAL</div>
                        <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Riscos mapeados</div>
                    </div>
                </div>
                
                <!-- MATRIZ DE RISCOS -->
                <div style="background:var(--card);border:2px solid var(--border);border-radius:12px;padding:24px;margin-bottom:32px">
                    <h4 style="margin-bottom:20px;display:flex;align-items:center;gap:8px">
                        <span>üìä</span> Matriz de Riscos (Severidade √ó Categoria)
                    </h4>
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:12px">
                        ${['tesouraria', 'resultados', 'fluxo', 'orcamento', 'investimentos', 'riscos'].map(cat => {
                            const catRiscos = riscos.filter(r => r.categoria.toLowerCase() === cat);
                            const catNomes = {
                                tesouraria: 'üí∞ Tesouraria',
                                resultados: 'üìà Resultados',
                                fluxo: 'üíµ Fluxo de Caixa',
                                orcamento: 'üìä Or√ßamento',
                                investimentos: 'üöÄ Investimentos',
                                riscos: 'üõ°Ô∏è Riscos'
                            };
                            const criticosCat = catRiscos.filter(r => r.severidade === 'CR√çTICO').length;
                            const altosCat = catRiscos.filter(r => r.severidade === 'ALTO').length;
                            const mediosCat = catRiscos.filter(r => r.severidade === 'M√âDIO').length;
                            
                            return `
                                <div style="background:var(--card);border:1px solid var(--border);border-radius:8px;padding:16px">
                                    <div style="font-weight:700;margin-bottom:12px">${catNomes[cat]}</div>
                                    <div style="display:flex;gap:8px;font-size:0.85em">
                                        ${criticosCat > 0 ? `<span style="background:#d32f2f;color:white;padding:4px 8px;border-radius:6px;font-weight:700">${criticosCat} Cr√≠t.</span>` : ''}
                                        ${altosCat > 0 ? `<span style="background:#f57c00;color:white;padding:4px 8px;border-radius:6px;font-weight:700">${altosCat} Alto</span>` : ''}
                                        ${mediosCat > 0 ? `<span style="background:#ffa726;color:white;padding:4px 8px;border-radius:6px;font-weight:700">${mediosCat} M√©d.</span>` : ''}
                                        ${catRiscos.length === 0 ? `<span style="color:var(--text-light)">‚úì Sem riscos</span>` : ''}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
                
                <!-- LISTA DETALHADA DE RISCOS -->
                <h4 style="margin:32px 0 16px">üîç Riscos Identificados (Detalhamento)</h4>
                ${riscos.map((r, i) => `
                    <div style="background:var(--card);border-left:4px solid ${r.cor};border-radius:12px;padding:24px;margin-bottom:16px;box-shadow:var(--shadow)">
                        <div style="display:flex;align-items:start;gap:16px;margin-bottom:16px">
                            <span style="background:${r.cor};color:white;padding:8px 16px;border-radius:8px;font-weight:700;font-size:0.85em">#${i + 1}</span>
                            <div style="flex:1">
                                <div style="display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap">
                                    <span style="background:${r.cor};color:white;padding:6px 12px;border-radius:6px;font-size:0.85em;font-weight:700">
                                        ${r.severidade}
                                    </span>
                                    <span style="background:var(--accent);color:white;padding:6px 12px;border-radius:6px;font-size:0.85em;font-weight:700">
                                        ${r.categoria}
                                    </span>
                                    <span style="background:var(--gold);color:white;padding:6px 12px;border-radius:6px;font-size:0.85em;font-weight:700">
                                        ‚è±Ô∏è ${r.prazo}
                                    </span>
                                    ${r.critica ? '<span style="background:#d32f2f;color:white;padding:6px 12px;border-radius:6px;font-size:0.85em;font-weight:700">‚ö†Ô∏è CR√çTICO</span>' : ''}
                                </div>
                                <h4 style="margin-bottom:12px;font-size:1.1em">${r.pergunta}</h4>
                                <div style="background:rgba(211,47,47,0.1);padding:12px 16px;border-radius:8px">
                                    <div style="font-weight:700;color:#d32f2f;margin-bottom:4px">‚ö†Ô∏è Situa√ß√£o Atual:</div>
                                    <div style="color:var(--text-light)">${r.feedback}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('')}
                
                <!-- NOTA SOBRE A√á√ïES -->
                <div style="background:rgba(0,102,255,0.08);border-left:4px solid var(--accent);padding:20px;border-radius:12px;margin-top:24px">
                    <h4 style="color:var(--accent);margin-bottom:12px">üìã Sobre as A√ß√µes</h4>
                    <p style="color:var(--text-light);line-height:1.8">
                        Os riscos identificados acima ser√£o endere√ßados no <strong>Plano de A√ß√£o</strong>, 
                        onde cada fraqueza e amea√ßa ser√° convertida em a√ß√µes pr√°ticas priorizadas por urg√™ncia (30/60/90 dias).
                    </p>
                </div>
            `}
        </div>
    `;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üìã M√ìDULO 2: MOTOR DE A√á√ïES COM TIMELINE 30/60/90/120
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function gerarAcoesTimeline() {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const acoes = {
        dias30: [],
        dias60: [],
        dias90: []
    };
    
    Object.keys(resp).forEach(id => {
        const r = resp[id];
        const p = PERGUNTAS[id];
        
        // PLANO DE A√á√ÉO = APENAS FRAQUEZAS + AMEA√áAS (N√≠veis 1 e 2 apenas)
        if (r.nivel === 1 || r.nivel === 2) {
            const acao = {
                id,
                categoria: p.cat,
                pergunta: p.txt,
                nivel: r.nivel,
                pts: r.pts,
                acao: p.niveis[r.nivel - 1].acao,
                feedback: p.niveis[r.nivel - 1].feedback,
                critica: PERGUNTAS_CRITICAS.includes(id),
                tipo: r.nivel === 1 ? 'FRAQUEZA' : 'AMEA√áA'
            };
            
            // Definir prazo baseado em n√≠vel e criticidade
            if (r.nivel === 1 && PERGUNTAS_CRITICAS.includes(id)) {
                acoes.dias30.push({ ...acao, prioridade: 1, urgencia: 'CR√çTICA' });
            } else if (r.nivel === 1) {
                acoes.dias60.push({ ...acao, prioridade: 2, urgencia: 'ALTA' });
            } else if (r.nivel === 2) {
                acoes.dias90.push({ ...acao, prioridade: 3, urgencia: 'M√âDIA' });
            }
        }
    });
    
    // Limitar quantidade por prazo
    acoes.dias30 = acoes.dias30.sort((a, b) => a.prioridade - b.prioridade).slice(0, 8);
    acoes.dias60 = acoes.dias60.sort((a, b) => a.prioridade - b.prioridade).slice(0, 12);
    acoes.dias90 = acoes.dias90.sort((a, b) => a.prioridade - b.prioridade).slice(0, 15);
    
    return acoes;
}

function renderPlano() {
    const acoes = gerarAcoesTimeline();
    const totalAcoes = acoes.dias30.length + acoes.dias60.length + acoes.dias90.length;
    
    const renderTimeline = (listaAcoes, titulo, cor, emoji, prazo) => {
        if (listaAcoes.length === 0) {
            return `
                <div style="background:linear-gradient(135deg, rgba(46,125,50,0.1), transparent);border:2px solid #2e7d32;border-radius:12px;padding:20px;text-align:center">
                    <span style="font-size:2em">‚úÖ</span>
                    <p style="margin-top:8px;color:#2e7d32;font-weight:700">Nenhuma a√ß√£o ${prazo}</p>
                </div>
            `;
        }
        
        return `
            <div style="background:var(--card);border:3px solid ${cor};border-radius:16px;padding:24px;margin-bottom:24px">
                <h3 style="color:${cor};margin-bottom:20px;display:flex;align-items:center;gap:12px">
                    <span style="font-size:1.5em">${emoji}</span>
                    <span>${titulo}</span>
                    <span style="background:${cor};color:white;padding:6px 16px;border-radius:16px;font-size:0.75em;margin-left:auto">
                        ${listaAcoes.length} ${listaAcoes.length === 1 ? 'a√ß√£o' : 'a√ß√µes'}
                    </span>
                </h3>
                
                ${listaAcoes.map((a, i) => `
                    <div style="background:var(--card);border:2px solid var(--border);border-left:4px solid ${cor};border-radius:12px;padding:20px;margin-bottom:16px">
                        <div style="display:flex;gap:12px;margin-bottom:12px;flex-wrap:wrap">
                            <span style="background:${cor};color:white;padding:6px 12px;border-radius:6px;font-weight:700;font-size:0.85em">
                                #${i + 1}
                            </span>
                            <span style="background:var(--accent);color:white;padding:6px 12px;border-radius:6px;font-weight:700;font-size:0.85em">
                                ${a.categoria}
                            </span>
                            ${a.critica ? '<span style="background:#d32f2f;color:white;padding:6px 12px;border-radius:6px;font-weight:700;font-size:0.85em">‚ö†Ô∏è CR√çTICO</span>' : ''}
                        </div>
                        <h4 style="margin-bottom:12px;font-size:1.05em">${a.pergunta}</h4>
                        <div style="background:rgba(211,47,47,0.08);padding:12px;border-radius:8px;margin-bottom:12px;border-left:3px solid #d32f2f">
                            <div style="font-weight:700;color:#d32f2f;font-size:0.85em;margin-bottom:4px">‚ö†Ô∏è Situa√ß√£o Atual:</div>
                            <div style="font-size:0.9em;color:var(--text-light)">${a.feedback}</div>
                        </div>
                        <div style="background:rgba(0,102,255,0.08);padding:12px;border-radius:8px;border-left:3px solid var(--accent)">
                            <div style="font-weight:700;color:var(--accent);font-size:0.85em;margin-bottom:4px">‚úÖ A√ß√£o Recomendada:</div>
                            <div style="font-size:0.9em;color:var(--text)">${a.acao}</div>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
    };
    
    return `
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üìã</div>
                <div>
                    <h3 class="card-title">Plano de A√ß√£o Priorizado</h3>
                    <p style="color:var(--text-light);margin-top:4px">Timeline 30/60/90/120 dias baseado em prioridade e impacto</p>
                </div>
            </div>
            
            ${totalAcoes === 0 ? `
                <div style="background:linear-gradient(135deg, rgba(46,125,50,0.1), transparent);border:2px solid #2e7d32;border-radius:12px;padding:32px;text-align:center">
                    <div style="font-size:4em;margin-bottom:16px">üéâ</div>
                    <h3 style="color:#2e7d32;margin-bottom:12px">Excelente Gest√£o Financeira!</h3>
                    <p style="color:var(--text-light);font-size:1.1em">Sua empresa est√° em n√≠vel √≥timo ou excelente em todas as categorias. Continue mantendo as boas pr√°ticas!</p>
                </div>
            ` : `
                <!-- RESUMO DO PLANO -->
                <div style="background:linear-gradient(135deg, rgba(0,102,255,0.1), transparent);border:2px solid var(--accent);border-radius:12px;padding:24px;margin-bottom:32px">
                    <p style="color:var(--text-light);margin-bottom:20px;line-height:1.8">
                        <strong>üìã Plano de A√ß√£o = Fraquezas + Amea√ßas:</strong> Este plano foca exclusivamente em <strong>corrigir</strong> 
                        fraquezas internas (N√≠vel 1-2) e <strong>mitigar</strong> amea√ßas identificadas na SWOT. 
                        A√ß√µes de crescimento est√£o nos OKRs.
                    </p>
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:16px">
                        <div style="text-align:center">
                            <div style="font-size:2.5em;font-weight:800;color:var(--accent)">${totalAcoes}</div>
                            <div style="font-size:0.9em;font-weight:700;color:var(--accent)">TOTAL</div>
                            <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">A√ß√µes F+A</div>
                        </div>
                        <div style="text-align:center">
                            <div style="font-size:2.5em;font-weight:800;color:#d32f2f">${acoes.dias30.length}</div>
                            <div style="font-size:0.9em;font-weight:700;color:#d32f2f">30 DIAS</div>
                            <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Cr√≠ticas</div>
                        </div>
                        <div style="text-align:center">
                            <div style="font-size:2.5em;font-weight:800;color:#f57c00">${acoes.dias60.length}</div>
                            <div style="font-size:0.9em;font-weight:700;color:#f57c00">60 DIAS</div>
                            <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Importantes</div>
                        </div>
                        <div style="text-align:center">
                            <div style="font-size:2.5em;font-weight:800;color:#2e7d32">${acoes.dias90.length}</div>
                            <div style="font-size:0.9em;font-weight:700;color:#2e7d32">90 DIAS</div>
                            <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Estruturantes</div>
                        </div>
                    </div>
                </div>
                
                <!-- TIMELINE DE A√á√ïES -->
                ${renderTimeline(acoes.dias30, 'üî¥ A√á√ïES CR√çTICAS (30 DIAS - SOBREVIV√äNCIA)', '#d32f2f', 'üî¥', 'cr√≠tica')}
                ${renderTimeline(acoes.dias60, 'üü† A√á√ïES IMPORTANTES (60 DIAS - ESTABILIZA√á√ÉO)', '#f57c00', 'üü†', 'importante')}
                ${renderTimeline(acoes.dias90, 'üü¢ A√á√ïES ESTRUTURANTES (90 DIAS - ORGANIZA√á√ÉO)', '#2e7d32', 'üü¢', 'estruturante')}
                
                <!-- DICAS -->
                <div style="background:rgba(0,102,255,0.08);border-left:4px solid var(--accent);padding:20px;border-radius:12px;margin-top:32px">
                    <h4 style="color:var(--accent);margin-bottom:12px">üí° Sobre este Plano de A√ß√£o</h4>
                    <ul style="color:var(--text-light);line-height:1.8;padding-left:20px">
                        <li><strong>Foco: Fraquezas + Amea√ßas</strong> - Este plano corrige gaps internos cr√≠ticos</li>
                        <li><strong>30 dias:</strong> A√ß√µes de sobreviv√™ncia - fraquezas cr√≠ticas que amea√ßam opera√ß√£o</li>
                        <li><strong>60 dias:</strong> A√ß√µes de estabiliza√ß√£o - gaps importantes que geram vulnerabilidade</li>
                        <li><strong>90 dias:</strong> A√ß√µes estruturantes - organizar processos e controles</li>
                        <li><strong>Crescimento:</strong> Ap√≥s estabilizar, veja os OKRs para expans√£o (For√ßas + Oportunidades)</li>
                    </ul>
                </div>
            `}
        </div>
    `;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üéØ M√ìDULO 3: GERADOR DE OKRs ESTRAT√âGICOS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function gerarOKRs() {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const scores = {};
    
    // Calcular scores por categoria
    Object.keys(CATEGORIAS).forEach(cat => {
        const ids = CATEGORIAS[cat];
        let soma = 0;
        ids.forEach(id => { if (resp[id]) soma += resp[id].pts; });
        const max = ids.length * 3;
        scores[cat] = Math.round((soma / max) * 100);
    });
    
    const okrs = [];
    
    // OKRs = FOR√áAS + OPORTUNIDADES (scores 40-75)
    const oportunidadeCategorias = Object.keys(scores)
        .filter(cat => scores[cat] >= 40 && scores[cat] < 75)
        .sort((a, b) => scores[b] - scores[a]);
    
    // Templates de Key Results ESPEC√çFICOS por categoria
    const krTemplates = {
        tesouraria: [
            { acao: 'Automatizar', meta: '100% dos pagamentos via sistema integrado', prazo: '60 dias' },
            { acao: 'Implementar', meta: 'Dashboard de caixa em tempo real', prazo: '45 dias' },
            { acao: 'Reduzir', meta: 'Dias de atraso para < 5 dias/m√™s', prazo: '90 dias' },
            { acao: 'Estabelecer', meta: 'Reserva de emerg√™ncia de 3 meses', prazo: '120 dias' }
        ],
        resultados: [
            { acao: 'Gerar', meta: 'DRE gerencial autom√°tica at√© dia 10', prazo: '60 dias' },
            { acao: 'Implementar', meta: 'An√°lise de margem por produto/servi√ßo', prazo: '90 dias' },
            { acao: 'Acompanhar', meta: 'EBITDA mensal com varia√ß√£o < 10%', prazo: '90 dias' },
            { acao: 'Criar', meta: 'Dashboard com 5 KPIs principais', prazo: '45 dias' }
        ],
        fluxo: [
            { acao: 'Projetar', meta: 'Fluxo de caixa 90 dias com 85% acuracidade', prazo: '60 dias' },
            { acao: 'Reduzir', meta: 'Ciclo financeiro em 15 dias', prazo: '120 dias' },
            { acao: 'Otimizar', meta: 'Capital de giro liberando R$ 50k', prazo: '90 dias' },
            { acao: 'Eliminar', meta: 'Uso de cr√©dito emergencial em 80%', prazo: '120 dias' }
        ],
        orcamento: [
            { acao: 'Criar', meta: 'Or√ßamento anual aprovado pela diretoria', prazo: '60 dias' },
            { acao: 'Implementar', meta: 'Revis√£o mensal real x or√ßado', prazo: '45 dias' },
            { acao: 'Estabelecer', meta: 'Precifica√ß√£o baseada em custos reais', prazo: '90 dias' },
            { acao: 'Simular', meta: '3 cen√°rios financeiros (otimista/realista/pessimista)', prazo: '75 dias' }
        ],
        investimentos: [
            { acao: 'Estruturar', meta: 'An√°lise ROI para todos investimentos > R$ 10k', prazo: '60 dias' },
            { acao: 'Criar', meta: 'Pipeline de investimentos priorizados', prazo: '45 dias' },
            { acao: 'Implementar', meta: 'Payback tracking para √∫ltimos 3 investimentos', prazo: '90 dias' },
            { acao: 'Alocar', meta: '10-15% lucro para investimentos estrat√©gicos', prazo: '120 dias' }
        ],
        riscos: [
            { acao: 'Mapear', meta: 'Top 10 riscos financeiros com plano B', prazo: '45 dias' },
            { acao: 'Implementar', meta: 'Hedging para exposi√ß√£o cambial > R$ 50k', prazo: '90 dias' },
            { acao: 'Revisar', meta: '100% contratos com cl√°usulas de prote√ß√£o', prazo: '120 dias' },
            { acao: 'Criar', meta: 'Comit√™ de riscos com reuni√£o mensal', prazo: '60 dias' }
        ]
    };
    
    // Gerar OKRs das categorias com OPORTUNIDADE
    oportunidadeCategorias.slice(0, 5).forEach(cat => {
        const catIds = CATEGORIAS[cat];
        const respostasCat = catIds
            .map(id => ({ id, ...resp[id], pergunta: PERGUNTAS[id] }))
            .filter(r => r.pts !== undefined && (r.nivel === 3 || r.nivel === 4));
        
        if (respostasCat.length === 0) return;
        
        // Pegar templates de KR espec√≠ficos da categoria
        const templates = krTemplates[cat] || [];
        
        // Criar Key Results ESPEC√çFICOS e ACION√ÅVEIS
        const keyResults = templates.slice(0, 4).map((template, i) => {
            return {
                numero: i + 1,
                acao: template.acao,
                meta: template.meta,
                prazo: template.prazo,
                baseline: `Score atual: ${scores[cat]}/100`,
                target: `Target: ${Math.min(scores[cat] + 15, 85)}/100`,
                tipo: scores[cat] >= 60 ? 'FOR√áA' : 'OPORTUNIDADE'
            };
        });
        
        const okrTemplates = {
            tesouraria: {
                objective: 'Profissionalizar gest√£o de tesouraria para crescimento',
                contexto: 'Tesouraria',
                icon: 'üí∞',
                foco: 'EXPANS√ÉO'
            },
            resultados: {
                objective: 'Maximizar visibilidade e previsibilidade de resultados',
                contexto: 'Resultados & DRE',
                icon: 'üìà',
                foco: 'PERFORMANCE'
            },
            fluxo: {
                objective: 'Otimizar gest√£o de capital de giro para escala',
                contexto: 'Fluxo de Caixa',
                icon: 'üíµ',
                foco: 'EFICI√äNCIA'
            },
            orcamento: {
                objective: 'Implementar gest√£o preditiva para oportunidades',
                contexto: 'Or√ßamento',
                icon: 'üìä',
                foco: 'ESTRAT√âGIA'
            },
            investimentos: {
                objective: 'Estruturar investimentos para crescimento acelerado',
                contexto: 'Investimentos',
                icon: 'üöÄ',
                foco: 'CRESCIMENTO'
            },
            riscos: {
                objective: 'Transformar gest√£o de riscos em vantagem competitiva',
                contexto: 'Gest√£o de Riscos',
                icon: 'üõ°Ô∏è',
                foco: 'SUSTENTABILIDADE'
            }
        };
        
        if (keyResults.length > 0) {
            okrs.push({
                ...okrTemplates[cat],
                score: scores[cat],
                prazo: 'Q1-Q2 2025 (6 meses)',
                keyResults,
                tipo: 'CRESCIMENTO'
            });
        }
    });
    
    return okrs;
}

function renderOKRs() {
    const okrs = gerarOKRs();
    
    return `
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üéØ</div>
                <div>
                    <h3 class="card-title">OKRs Estrat√©gicos</h3>
                    <p style="color:var(--text-light);margin-top:4px">Objetivos e Key Results gerados automaticamente do diagn√≥stico</p>
                </div>
            </div>
            
            ${okrs.length === 0 ? `
                <div style="background:linear-gradient(135deg, rgba(46,125,50,0.1), transparent);border:2px solid #2e7d32;border-radius:12px;padding:32px;text-align:center">
                    <div style="font-size:4em;margin-bottom:16px">üìä</div>
                    <h3 style="color:var(--accent);margin-bottom:12px">Foque primeiro na Estabiliza√ß√£o</h3>
                    <p style="color:var(--text-light);font-size:1.1em;line-height:1.8">
                        OKRs s√£o criados para <strong>categorias com score 40-70</strong> (oportunidades de crescimento).<br><br>
                        Sua empresa tem muitas √°reas cr√≠ticas (<40) que precisam ser <strong>estabilizadas primeiro</strong> no Plano de A√ß√£o.<br><br>
                        Ap√≥s implementar as a√ß√µes de corre√ß√£o (30/60/90 dias), novos OKRs de crescimento ser√£o gerados.
                    </p>
                </div>
            ` : `
                <!-- INTRO OKRs -->
                <div style="background:linear-gradient(135deg, rgba(0,102,255,0.1), transparent);border:2px solid var(--accent);border-radius:12px;padding:24px;margin-bottom:32px">
                    <h4 style="color:var(--accent);margin-bottom:12px">üéØ OKRs = For√ßas + Oportunidades (CRESCIMENTO)</h4>
                    <p style="color:var(--text-light);line-height:1.8;margin-bottom:16px">
                        Enquanto o <strong>Plano de A√ß√£o corrige fraquezas</strong>, os <strong>OKRs focam em crescimento</strong>. 
                        Abaixo, geramos <strong>${okrs.length} objetivo(s)</strong> para categorias com <strong>score 40-70</strong> 
                        (√°reas com base s√≥lida e margem para expans√£o).
                    </p>
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-top:16px">
                        <div style="background:rgba(255,255,255,0.5);padding:16px;border-radius:8px;text-align:center">
                            <div style="font-size:2em;font-weight:800;color:var(--accent)">${okrs.length}</div>
                            <div style="font-size:0.85em;font-weight:700;color:var(--accent)">OBJETIVOS</div>
                            <div style="font-size:0.7em;color:var(--text-light);margin-top:4px">Crescimento</div>
                        </div>
                        <div style="background:rgba(255,255,255,0.5);padding:16px;border-radius:8px;text-align:center">
                            <div style="font-size:2em;font-weight:800;color:var(--accent)">${okrs.reduce((acc, okr) => acc + okr.keyResults.length, 0)}</div>
                            <div style="font-size:0.85em;font-weight:700;color:var(--accent)">KEY RESULTS</div>
                            <div style="font-size:0.7em;color:var(--text-light);margin-top:4px">M√©tricas</div>
                        </div>
                        <div style="background:rgba(255,255,255,0.5);padding:16px;border-radius:8px;text-align:center">
                            <div style="font-size:1.3em;font-weight:800;color:var(--accent)">Q1 2025</div>
                            <div style="font-size:0.85em;font-weight:700;color:var(--accent)">PRAZO</div>
                        </div>
                    </div>
                </div>
                
                <!-- LISTA DE OKRs -->
                ${okrs.map((okr, i) => `
                    <div style="background:var(--card);border:3px solid var(--accent);border-radius:16px;padding:32px;margin-bottom:32px;box-shadow:var(--shadow)">
                        <!-- CABE√áALHO DO OBJETIVO -->
                        <div style="display:flex;align-items:start;gap:20px;margin-bottom:24px">
                            <div style="background:linear-gradient(135deg, var(--accent), #42a5f5);width:64px;height:64px;border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:2em;flex-shrink:0">
                                ${okr.icon}
                            </div>
                            <div style="flex:1">
                                <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
                                    <span style="background:var(--accent);color:white;padding:6px 16px;border-radius:6px;font-weight:700;font-size:0.85em">
                                        OKR ${i + 1}
                                    </span>
                                    <span style="background:var(--gold);color:white;padding:6px 16px;border-radius:6px;font-weight:700;font-size:0.85em">
                                        ${okr.contexto}
                                    </span>
                                    <span style="background:#d32f2f;color:white;padding:6px 16px;border-radius:6px;font-weight:700;font-size:0.85em">
                                        Score Atual: ${okr.score}/100
                                    </span>
                                </div>
                                <h3 style="font-size:1.5em;margin-bottom:8px;color:var(--accent)">${okr.objective}</h3>
                                <p style="color:var(--text-light);font-size:0.95em">‚è±Ô∏è Prazo: ${okr.prazo}</p>
                            </div>
                        </div>
                        
                        <!-- KEY RESULTS -->
                        <div style="background:rgba(0,102,255,0.05);border-radius:12px;padding:24px">
                            <h4 style="margin-bottom:20px;color:var(--accent);display:flex;align-items:center;gap:12px">
                                <span>üéØ Key Results (Resultados-Chave)</span>
                                <span style="background:var(--gold);color:white;padding:4px 12px;border-radius:6px;font-size:0.75em">
                                    ${okr.keyResults.length} metas
                                </span>
                            </h4>
                            ${okr.keyResults.map(kr => `
                                <div style="background:var(--card);border-left:4px solid var(--accent);border-radius:8px;padding:20px;margin-bottom:16px;box-shadow:0 2px 4px rgba(0,0,0,0.05)">
                                    <div style="display:flex;align-items:start;gap:16px">
                                        <span style="background:linear-gradient(135deg, var(--accent), #42a5f5);color:white;width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:1em;flex-shrink:0">
                                            KR${kr.numero}
                                        </span>
                                        <div style="flex:1">
                                            <div style="display:flex;gap:8px;margin-bottom:12px;align-items:center;flex-wrap:wrap">
                                                <span style="background:${kr.tipo === 'FOR√áA' ? '#2e7d32' : '#00c853'};color:white;padding:4px 10px;border-radius:6px;font-size:0.75em;font-weight:700">
                                                    ${kr.tipo === 'FOR√áA' ? 'üí™ FOR√áA' : 'üöÄ OPORTUNIDADE'}
                                                </span>
                                                <span style="background:#f57c00;color:white;padding:4px 10px;border-radius:6px;font-size:0.75em;font-weight:700">
                                                    ‚è±Ô∏è ${kr.prazo}
                                                </span>
                                            </div>
                                            
                                            <!-- A√á√ÉO CLARA -->
                                            <div style="font-size:1.15em;font-weight:700;margin-bottom:12px;color:var(--primary);display:flex;align-items:baseline;gap:8px">
                                                <span style="color:var(--accent)">${kr.acao}</span>
                                                <span style="color:var(--text)">${kr.meta}</span>
                                            </div>
                                            
                                            <!-- M√âTRICAS -->
                                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:16px">
                                                <div style="background:linear-gradient(135deg, rgba(0,102,255,0.1), transparent);padding:12px;border-radius:8px;border:2px solid var(--accent)">
                                                    <div style="font-size:0.75em;color:var(--accent);font-weight:700;margin-bottom:4px">üìä BASELINE</div>
                                                    <div style="font-weight:700;color:var(--accent)">${kr.baseline}</div>
                                                </div>
                                                <div style="background:linear-gradient(135deg, rgba(46,125,50,0.1), transparent);padding:12px;border-radius:8px;border:2px solid #2e7d32">
                                                    <div style="font-size:0.75em;color:#2e7d32;font-weight:700;margin-bottom:4px">üéØ TARGET</div>
                                                    <div style="font-weight:700;color:#2e7d32">${kr.target}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('')}
                
                <!-- DICAS DE ACOMPANHAMENTO -->
                <div style="background:rgba(255,167,38,0.1);border-left:4px solid var(--gold);padding:20px;border-radius:12px">
                    <h4 style="color:var(--gold);margin-bottom:12px">üí° Como Acompanhar seus OKRs</h4>
                    <ul style="color:var(--text-light);line-height:1.8;padding-left:20px">
                        <li><strong>Check-ins semanais:</strong> Revise o progresso de cada Key Result</li>
                        <li><strong>Meta de 70%:</strong> Atingir 70% dos KRs j√° √© um excelente resultado</li>
                        <li><strong>Ajustes no meio do caminho:</strong> OKRs podem ser ajustados se necess√°rio</li>
                        <li><strong>Celebre conquistas:</strong> Reconhe√ßa quando Key Results forem atingidos</li>
                        <li><strong>Aprenda com falhas:</strong> KRs n√£o atingidos s√£o oportunidades de aprendizado</li>
                    </ul>
                </div>
            `}
        </div>
    `;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ïES AUXILIARES PARA DADOS DIN√ÇMICOS DO RELAT√ìRIO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO AUXILIAR: FORMATAR VALOR GRANDE (K/M)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function formatarValorGrande(valor) {
    try {
        console.log('üîç formatarValorGrande - Entrada:', valor, 'Tipo:', typeof valor);
        const num = parseFloat(valor);
        console.log('üîç formatarValorGrande - Parseado:', num);
        
        if (isNaN(num) || !isFinite(num)) {
            console.warn('‚ö†Ô∏è formatarValorGrande - Valor inv√°lido!');
            return 'R$ 0';
        }
        
        let resultado;
        if (num >= 1000000) {
            // Milh√µes
            resultado = `R$ ${(num / 1000000).toFixed(2).replace('.', ',')}M`;
            console.log('‚úÖ formatarValorGrande - Milh√µes:', resultado);
        } else if (num >= 1000) {
            // Milhares
            resultado = `R$ ${(num / 1000).toLocaleString('pt-BR', {maximumFractionDigits: 0})}k`;
            console.log('‚úÖ formatarValorGrande - Milhares:', resultado);
        } else {
            // Menos de mil
            resultado = `R$ ${num.toLocaleString('pt-BR', {maximumFractionDigits: 0})}`;
            console.log('‚úÖ formatarValorGrande - Unidades:', resultado);
        }
        return resultado;
    } catch (error) {
        console.error('‚ùå formatarValorGrande - ERRO:', error);
        return 'R$ 0';
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO AUXILIAR: FORMATAR VALOR MONET√ÅRIO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function formatarValor(valor, defaultVal = 0) {
    try {
        const num = parseFloat(valor);
        if (isNaN(num) || !isFinite(num)) {
            return defaultVal.toLocaleString('pt-BR');
        }
        return Math.round(num).toLocaleString('pt-BR');
    } catch (error) {
        return defaultVal.toLocaleString('pt-BR');
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO AUXILIAR: OBTER FATURAMENTO ANUAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function obterFaturamentoAnual() {
    try {
        // Tentar pegar da empresa ativa primeiro
        const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
        const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{"porte":"media","setor":"comercio"}');
        
        console.log('üîç obterFaturamentoAnual - dados.faturamento:', dados.faturamento);
        console.log('üîç obterFaturamentoAnual - config:', config);
        
        // Obter faturamento MENSAL cadastrado
        let faturamentoMensal = dados.faturamento || 0;
        
        // Limpar formata√ß√£o se vier como string (ex: "320.000,00" -> 320000)
        if (typeof faturamentoMensal === 'string') {
            console.log('üîç obterFaturamentoAnual - √â string:', faturamentoMensal);
            // IMPORTANTE: Remover pontos (separador milhares) ANTES de trocar v√≠rgula por ponto
            faturamentoMensal = parseFloat(faturamentoMensal.replace(/\./g, '').replace(',', '.').replace(/[^\d.]/g, '')) || 0;
            console.log('üîç obterFaturamentoAnual - Ap√≥s parse:', faturamentoMensal);
        } else {
            faturamentoMensal = parseFloat(faturamentoMensal) || 0;
        }
        
        // Converter para ANUAL
        let faturamentoAnual = faturamentoMensal * 12;
        console.log('üîç obterFaturamentoAnual - Mensal √ó 12 =', faturamentoMensal, '√ó', 12, '=', faturamentoAnual);
        
        // Se n√£o tiver faturamento cadastrado, usar default por porte
        if (!faturamentoAnual || faturamentoAnual === 0) {
            const faturamentoPorPorte = {
                micro: 250000,      // R$ 250k/ano
                pequena: 2000000,   // R$ 2M/ano
                media: 10000000     // R$ 10M/ano
            };
            faturamentoAnual = faturamentoPorPorte[config.porte] || 2000000;
            console.log('‚ö†Ô∏è obterFaturamentoAnual - Usando default por porte:', faturamentoAnual);
        }
        
        console.log('‚úÖ obterFaturamentoAnual - RESULTADO FINAL:', {anual: faturamentoAnual, mensal: faturamentoAnual/12});
        return {
            anual: faturamentoAnual,
            mensal: faturamentoAnual / 12
        };
    } catch (error) {
        // Fallback: usar defaults se der erro
        console.warn('Erro ao obter faturamento, usando default:', error);
        return {
            anual: 2000000,  // Default: R$ 2M/ano
            mensal: 166667   // Default: R$ 166k/m√™s
        };
    }
}

function gerarDadosBenchmarkDinamico() {
    try {
        const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
        const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
        const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{"porte":"media","setor":"comercio"}');
    
    // Obter faturamento anual corretamente
    const fat = obterFaturamentoAnual();
    const faturamento = fat.anual;
    
    // Calcular margem bruta baseada nas respostas de Resultados
    let margemBruta = 32; // default
    if (resp.r6 && resp.r6.nivel >= 3) {
        margemBruta = 38; // Bom controle de margem
    } else if (resp.r6 && resp.r6.nivel >= 2) {
        margemBruta = 33; // Controle b√°sico
    } else {
        margemBruta = 28; // Sem controle
    }
    
    // Calcular inadimpl√™ncia baseada nas respostas de Fluxo de Caixa
    let inadimplencia = 4.2; // default m√©dia setor
    if (resp.f13) {
        if (resp.f13.nivel === 1) inadimplencia = 8.5; // Cr√≠tico
        else if (resp.f13.nivel === 2) inadimplencia = 6.2; // B√°sico
        else if (resp.f13.nivel === 3) inadimplencia = 3.8; // Bom
        else inadimplencia = 2.1; // Excelente
    }
    
    // Benchmarks por setor
    const benchmarksPorSetor = {
        comercio: { nome: 'Com√©rcio', margemMedia: 32, inadimMedia: 4.2 },
        servicos: { nome: 'Servi√ßos', margemMedia: 45, inadimMedia: 3.8 },
        industria: { nome: 'Ind√∫stria', margemMedia: 38, inadimMedia: 3.2 },
        varejo: { nome: 'Varejo', margemMedia: 28, inadimMedia: 5.1 }
    };
    
    const benchmarkSetor = benchmarksPorSetor[config.setor] || benchmarksPorSetor.comercio;
    
    // Calcular potencial de melhoria
    const diferencaInadim = inadimplencia - benchmarkSetor.inadimMedia;
    const potencialMelhoria = diferencaInadim > 0 ? Math.round((faturamento * (diferencaInadim / 100)) / 12) : 0;
    
    // Garantir que todos os valores s√£o n√∫meros v√°lidos
    const garantirNumero = (val, def = 0) => {
        const num = parseFloat(val);
        return isNaN(num) || !isFinite(num) ? def : num;
    };
    
    return {
        setor: benchmarkSetor.nome,
        porte: config.porte === 'micro' ? 'Micro' : config.porte === 'pequena' ? 'Pequena' : 'M√©dia',
        faturamentoAnual: garantirNumero(faturamento, 2000000),
        margemBruta: garantirNumero(margemBruta, 32),
        margemBrutaMedia: garantirNumero(benchmarkSetor.margemMedia, 32),
        margemBrutaMin: garantirNumero(benchmarkSetor.margemMedia - 12, 20),
        margemBrutaMax: garantirNumero(benchmarkSetor.margemMedia + 16, 48),
        margemStatus: margemBruta >= benchmarkSetor.margemMedia ? 'acima' : 'abaixo',
        margemDif: garantirNumero(Math.abs(margemBruta - benchmarkSetor.margemMedia), 0),
        margemDifPerc: garantirNumero(Math.round(((margemBruta - benchmarkSetor.margemMedia) / benchmarkSetor.margemMedia) * 100), 0),
        inadimplencia: garantirNumero(inadimplencia, 4.2),
        inadimMedia: garantirNumero(benchmarkSetor.inadimMedia, 4.2),
        inadimMin: garantirNumero(benchmarkSetor.inadimMedia - 2, 2),
        inadimMax: garantirNumero(benchmarkSetor.inadimMedia + 4, 8),
        inadimStatus: inadimplencia > benchmarkSetor.inadimMedia ? 'acima' : 'abaixo',
        inadimDif: garantirNumero(Math.abs(inadimplencia - benchmarkSetor.inadimMedia), 0),
        inadimDifPerc: inadimplencia > benchmarkSetor.inadimMedia ? garantirNumero(Math.round(((inadimplencia - benchmarkSetor.inadimMedia) / benchmarkSetor.inadimMedia) * 100), 0) : 0,
        potencialMelhoriaInadim: garantirNumero(potencialMelhoria, 0),
        potencialMelhoriaAnual: garantirNumero(potencialMelhoria * 12, 0),
        potencialMelhoriaFluxo: garantirNumero(Math.round((potencialMelhoria * 12) * 0.35), 0)
    };
    } catch (error) {
        console.error('Erro em gerarDadosBenchmarkDinamico:', error);
        // Retornar valores padr√£o seguros
        return {
            setor: 'Com√©rcio',
            porte: 'M√©dia',
            faturamentoAnual: 2000000,
            margemBruta: 32,
            margemBrutaMedia: 32,
            margemBrutaMin: 20,
            margemBrutaMax: 48,
            margemStatus: 'abaixo',
            margemDif: 0,
            margemDifPerc: 0,
            inadimplencia: 4.2,
            inadimMedia: 4.2,
            inadimMin: 2,
            inadimMax: 8,
            inadimStatus: 'abaixo',
            inadimDif: 0,
            inadimDifPerc: 0,
            potencialMelhoriaInadim: 0,
            potencialMelhoriaAnual: 0,
            potencialMelhoriaFluxo: 0
        };
    }
}

function gerarDadosProjecaoDinamica() {
    const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{"porte":"media","setor":"comercio"}');
    
    // Calcular scores
    const scores = {};
    Object.keys(CATEGORIAS).forEach(cat => {
        const ids = CATEGORIAS[cat];
        let soma = 0;
        ids.forEach(id => { if (resp[id]) soma += resp[id].pts; });
        const max = ids.length * 3;
        scores[cat] = Math.round((soma / max) * 100);
    });
    const scoreGeral = Math.round(Object.values(scores).reduce((a,b) => a+b, 0) / Object.keys(scores).length);
    
    // Obter faturamento anual corretamente
    const fat = obterFaturamentoAnual();
    const faturamento = fat.anual;
    
    // Calcular proje√ß√µes baseadas no score
    const crescimentoReceita = scoreGeral >= 70 ? 18 : scoreGeral >= 50 ? 12 : scoreGeral >= 30 ? 8 : 5;
    const crescimentoLucro = scoreGeral >= 70 ? 60 : scoreGeral >= 50 ? 44 : scoreGeral >= 30 ? 30 : 18;
    const melhoriaMargemPts = scoreGeral >= 70 ? 5.2 : scoreGeral >= 50 ? 3.4 : scoreGeral >= 30 ? 2.1 : 1.2;
    
    const receitaAtual = faturamento;
    const margemLiquidaAtual = scoreGeral >= 70 ? 18.5 : scoreGeral >= 50 ? 15.4 : scoreGeral >= 30 ? 12.2 : 8.5;
    const lucroAtual = Math.round(receitaAtual * (margemLiquidaAtual / 100));
    
    // Calcular oportunidades baseadas nas respostas
    const benchmark = gerarDadosBenchmarkDinamico();
    const oportunidades = [];
    
    if (benchmark.inadimStatus === 'acima') {
        oportunidades.push({
            titulo: 'Reduzir Inadimpl√™ncia',
            de: benchmark.inadimplencia.toFixed(1) + '%',
            para: benchmark.inadimMedia.toFixed(1) + '%',
            ganho: benchmark.potencialMelhoriaInadim
        });
    }
    
    // Analisar ciclo de caixa (perguntas f4, f5, f6)
    const temProblemaFluxo = (resp.f4 && resp.f4.nivel <= 2) || (resp.f5 && resp.f5.nivel <= 2) || (resp.f6 && resp.f6.nivel <= 2);
    if (temProblemaFluxo) {
        const ganhoFluxo = Math.round(faturamento * 0.015 / 12);
        oportunidades.push({
            titulo: 'Otimizar Ciclo de Caixa',
            de: '45 dias',
            para: '35 dias',
            ganho: ganhoFluxo
        });
    }
    
    const totalOportunidades = oportunidades.reduce((sum, o) => sum + o.ganho, 0);
    
    return {
        scoreAtual: scoreGeral,
        receitaAnual: receitaAtual,
        crescimentoReceitaPerc: crescimentoReceita,
        lucroAnual: lucroAtual,
        crescimentoLucroPerc: crescimentoLucro,
        margemLiquida: margemLiquidaAtual,
        melhoriaMargemPts: melhoriaMargemPts,
        oportunidades: oportunidades,
        potencialTotal: totalOportunidades,
        potencialTotalAnual: totalOportunidades * 12
    };
}

function gerarAlertasInteligentes() {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const benchmark = gerarDadosBenchmarkDinamico();
    const alertas = [];
    
    // Alerta 1: Inadimpl√™ncia cr√≠tica
    if (benchmark.inadimStatus === 'acima' && benchmark.inadimDifPerc > 30) {
        alertas.push({
            nivel: 'CR√çTICO',
            cor: '#d32f2f',
            emoji: 'üî¥',
            prazo: 'Agir esta semana',
            titulo: `Inadimpl√™ncia ${benchmark.inadimDifPerc}% acima da m√©dia`,
            impacto: `R$ ${Math.round(benchmark.potencialMelhoriaInadim).toLocaleString('pt-BR')}/m√™s perdidos`,
            acao: 'Implementar r√©gua de cobran√ßa automatizada',
            roi: '650%'
        });
    }
    
    // Alerta 2: Problemas de fluxo de caixa
    const problemaFluxoCritico = (resp.f1 && resp.f1.nivel <= 2) || (resp.f2 && resp.f2.nivel <= 2);
    if (problemaFluxoCritico) {
        alertas.push({
            nivel: 'CR√çTICO',
            cor: '#d32f2f',
            emoji: 'üî¥',
            prazo: 'Agir esta semana',
            titulo: 'Controle de fluxo de caixa insuficiente',
            impacto: 'Risco de crise de liquidez',
            acao: 'Implementar sistema de proje√ß√£o de caixa',
            roi: '400%'
        });
    }
    
    // Alerta 3: Ciclo de caixa elevado
    const problemaCiclo = (resp.f4 && resp.f4.nivel <= 2) || (resp.f5 && resp.f5.nivel <= 2);
    if (problemaCiclo) {
        alertas.push({
            nivel: 'IMPORTANTE',
            cor: '#ff9800',
            emoji: 'üü†',
            prazo: 'Este m√™s',
            titulo: 'Ciclo de caixa 20% maior que ideal',
            impacto: `R$ ${Math.round(benchmark.faturamentoAnual * 0.004 / 12).toLocaleString('pt-BR')}/m√™s em custo de oportunidade`,
            acao: 'Renegociar prazos com fornecedores',
            roi: '180%'
        });
    }
    
    // Alerta 4: Problemas tribut√°rios cr√≠ticos
    const problemaTributario = (resp.pt1 && resp.pt1.nivel === 1) || (resp.pt12 && resp.pt12.nivel === 1);
    if (problemaTributario) {
        alertas.push({
            nivel: 'CR√çTICO',
            cor: '#d32f2f',
            emoji: 'üî¥',
            prazo: 'Agir esta semana',
            titulo: 'Regime tribut√°rio inadequado',
            impacto: 'Perda de at√© 20% em impostos desnecess√°rios',
            acao: 'Contratar consultoria tribut√°ria especializada',
            roi: '850%'
        });
    }
    
    // Alerta 5: Falta de controles b√°sicos
    const faltaControles = (resp.t1 && resp.t1.nivel === 1) || (resp.r1 && resp.r1.nivel === 1);
    if (faltaControles) {
        alertas.push({
            nivel: 'IMPORTANTE',
            cor: '#ff9800',
            emoji: 'üü†',
            prazo: 'Este m√™s',
            titulo: 'Falta de controles financeiros b√°sicos',
            impacto: 'Gest√£o √†s cegas, decis√µes sem base',
            acao: 'Implementar planilha de controle ou sistema ERP b√°sico',
            roi: '320%'
        });
    }
    
    return alertas.slice(0, 4); // Retornar at√© 4 alertas mais cr√≠ticos
}

function gerarAcoesROIDinamicas() {
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
    const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{"porte":"media","setor":"comercio"}');
    
    // Obter faturamento anual corretamente
    const fat = obterFaturamentoAnual();
    const faturamento = fat.anual;
    
    const acoes = [];
    
    // Analisar cada pergunta e criar a√ß√µes para as cr√≠ticas (n√≠vel 1-2)
    Object.keys(resp).forEach(id => {
        const resposta = resp[id];
        if (resposta.nivel <= 2 && PERGUNTAS[id]) {
            const pergunta = PERGUNTAS[id];
            const nivel = pergunta.niveis[resposta.nivel - 1];
            
            // Calcular investimento e retorno baseado na categoria e severidade
            let investimentoBase = resposta.nivel === 1 ? 5000 : 3000;
            let multiplicadorRetorno = resposta.nivel === 1 ? 0.08 : 0.05;
            
            // Ajustar por categoria
            if (id.startsWith('pt')) { // Tribut√°rio tem maior impacto
                multiplicadorRetorno *= 2.5;
            } else if (id.startsWith('f') || id.startsWith('t')) { // Fluxo e tesouraria
                multiplicadorRetorno *= 1.5;
            } else if (id.startsWith('if')) { // Indicadores
                multiplicadorRetorno *= 1.2;
            }
            
            const retornoAnual = Math.round(faturamento * multiplicadorRetorno);
            const roi = Math.round((retornoAnual / investimentoBase) * 100);
            const payback = (investimentoBase / (retornoAnual / 12)).toFixed(1);
            
            acoes.push({
                titulo: pergunta.txt,
                descricao: nivel.acao,
                investimento: investimentoBase,
                retornoAnual: retornoAnual,
                roi: roi,
                payback: payback,
                categoria: pergunta.cat,
                prioridade: resposta.nivel === 1 ? 'CR√çTICA' : 'ALTA',
                score: roi // para ordena√ß√£o
            });
        }
    });
    
    // Ordenar por ROI (maior primeiro) e pegar top 8
    acoes.sort((a, b) => b.score - a.score);
    return acoes.slice(0, 8);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO AUXILIAR: CALCULAR DADOS DIN√ÇMICOS DO DIAGN√ìSTICO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcularDadosDinamicos() {
    const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{"porte":"media","setor":"comercio"}');
    
    // Calcular scores
    const scores = {};
    let somaTotal = 0;
    let maxTotal = 0;
    
    Object.keys(CATEGORIAS).forEach(cat => {
        const ids = CATEGORIAS[cat];
        let soma = 0;
        ids.forEach(id => { if (resp[id]) soma += resp[id].pts; });
        const max = ids.length * 3;
        scores[cat] = Math.round((soma / max) * 100);
        somaTotal += soma;
        maxTotal += max;
    });
    
    const scoreGeral = Math.round((somaTotal / maxTotal) * 100);
    
    // Obter faturamento anual corretamente
    const fat = obterFaturamentoAnual();
    const faturamento = fat.anual;
    const faturamentoMensal = fat.mensal;
    
    // Extrair dados reais das respostas
    const margemBruta = resp.r6 ? (resp.r6.nivel === 4 ? 42 : resp.r6.nivel === 3 ? 35 : resp.r6.nivel === 2 ? 28 : 18) : 30;
    const inadimplencia = resp.f13 ? (resp.f13.nivel === 4 ? 2.0 : resp.f13.nivel === 3 ? 4.5 : resp.f13.nivel === 2 ? 7.0 : 12.0) : 5.0;
    const prazoRecebimento = resp.f7 ? (resp.f7.nivel === 4 ? 25 : resp.f7.nivel === 3 ? 35 : resp.f7.nivel === 2 ? 45 : 60) : 40;
    const prazoPagamento = resp.f8 ? (resp.f8.nivel === 4 ? 45 : resp.f8.nivel === 3 ? 35 : resp.f8.nivel === 2 ? 28 : 20) : 30;
    const cicloCaixa = prazoRecebimento - prazoPagamento;
    
    // Benchmarks por setor
    const benchmarksPorSetor = {
        comercio: { nome: 'Com√©rcio', margemMedia: 32, inadimplenciaMedia: 4.2 },
        servicos: { nome: 'Servi√ßos', margemMedia: 38, inadimplenciaMedia: 3.5 },
        industria: { nome: 'Ind√∫stria', margemMedia: 35, inadimplenciaMedia: 3.8 },
        varejo: { nome: 'Varejo', margemMedia: 30, inadimplenciaMedia: 5.0 }
    };
    
    const benchmarkSetor = benchmarksPorSetor[config.setor] || benchmarksPorSetor.comercio;
    
    // Calcular potenciais de melhoria
    const potencialInadimplencia = inadimplencia > benchmarkSetor.inadimplenciaMedia 
        ? Math.round(faturamento * (inadimplencia - benchmarkSetor.inadimplenciaMedia) / 100 / 12) 
        : 0;
        
    const potencialCicloCaixa = cicloCaixa > 35 
        ? Math.round(faturamento * 0.02 / 12) 
        : 0;
    
    // Identificar a√ß√µes cr√≠ticas (n√≠vel 1 e 2)
    const acoesCriticas = [];
    Object.keys(resp).forEach(id => {
        if (resp[id].nivel <= 2 && PERGUNTAS[id]) {
            const pergunta = PERGUNTAS[id];
            const nivel = pergunta.niveis[resp[id].nivel - 1];
            acoesCriticas.push({
                id: id,
                pergunta: pergunta.txt,
                categoria: pergunta.cat || 'Geral',
                nivel: resp[id].nivel,
                feedback: nivel.feedback,
                acao: nivel.acao,
                severidade: resp[id].nivel === 1 ? 'CR√çTICO' : 'IMPORTANTE'
            });
        }
    });
    
    // Ordenar por severidade
    acoesCriticas.sort((a, b) => a.nivel - b.nivel);
    
    // Calcular proje√ß√µes (faturamentoMensal j√° foi declarado acima)
    const margemLiquida = scoreGeral >= 70 ? 18 : scoreGeral >= 50 ? 12 : scoreGeral >= 30 ? 8 : 4;
    const lucroAnual = Math.round(faturamento * (margemLiquida / 100));
    const lucroMensal = Math.round(lucroAnual / 12);
    
    const projecaoCrescimento = scoreGeral >= 70 ? 0.20 : scoreGeral >= 50 ? 0.15 : scoreGeral >= 30 ? 0.10 : 0.05;
    const projecaoMargemMelhoria = scoreGeral >= 70 ? 5 : scoreGeral >= 50 ? 8 : scoreGeral >= 30 ? 12 : 18;
    
    return {
        // B√°sicos
        dados,
        scores,
        scoreGeral,
        faturamento,
        faturamentoMensal,
        config,
        
        // Benchmarking
        margemBruta,
        inadimplencia,
        prazoRecebimento,
        prazoPagamento,
        cicloCaixa,
        benchmarkSetor,
        potencialInadimplencia,
        potencialCicloCaixa,
        
        // Proje√ß√µes
        margemLiquida,
        lucroAnual,
        lucroMensal,
        projecaoCrescimento,
        projecaoMargemMelhoria,
        
        // A√ß√µes cr√≠ticas
        acoesCriticas
    };
}

function renderResumo() {
    const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    
    // Calcular todos os dados din√¢micos
    const dd = calcularDadosDinamicos();
    
    // Calcular scores
    const scores = {};
    let somaTotal = 0;
    let maxTotal = 0;
    
    Object.keys(CATEGORIAS).forEach(cat => {
        const ids = CATEGORIAS[cat];
        let soma = 0;
        ids.forEach(id => { if (resp[id]) soma += resp[id].pts; });
        const max = ids.length * 3;
        scores[cat] = Math.round((soma / max) * 100);
        somaTotal += soma;
        maxTotal += max;
    });
    
    const scoreGeral = Math.round((somaTotal / maxTotal) * 100);
    
    // Classifica√ß√£o geral
    let classificacao, corClass, iconeClass;
    if (scoreGeral >= 70) {
        classificacao = 'PROFISSIONAL';
        corClass = '#1976d2';
        iconeClass = 'üîµ';
    } else if (scoreGeral >= 50) {
        classificacao = 'ORGANIZADO';
        corClass = '#2e7d32';
        iconeClass = 'üü¢';
    } else if (scoreGeral >= 30) {
        classificacao = 'B√ÅSICO';
        corClass = '#f57c00';
        iconeClass = 'üü†';
    } else {
        classificacao = 'CR√çTICO';
        corClass = '#d32f2f';
        iconeClass = 'üî¥';
    }
    
    // Gerar SWOT
    const swot = gerarSWOT();
    
    // Gerar riscos
    const riscos = identificarRiscos();
    const riscosCriticos = riscos.filter(r => r.severidade === 'CR√çTICO').slice(0, 10);
    
    // Gerar a√ß√µes
    const acoes = gerarAcoesTimeline();
    
    // Gerar OKRs
    const okrs = gerarOKRs();
    
    // Top 3 por categoria
    const catNomes = {
        tesouraria: 'üí∞ Tesouraria',
        resultados: 'üìà Resultados & DRE',
        fluxo: 'üíµ Fluxo de Caixa',
        orcamento: 'üìä Or√ßamento',
        investimentos: 'üöÄ Investimentos',
        riscos: 'üõ°Ô∏è Gest√£o de Riscos',
        indicadores: 'üî¢ Indicadores Financeiros',
        tributario: 'üìú Planejamento Tribut√°rio'
    };
    
    return `
        <div class="card" id="relatorio-executivo-completo">
        <div class="card" id="relatorio-executivo-completo">
            <!-- CABE√áALHO COM CAMPOS EDIT√ÅVEIS -->
            <div style="background:linear-gradient(135deg, #0f2027, #203a43, #2c5364);color:white;padding:40px;border-radius:12px 12px 0 0;margin:-24px -24px 32px -24px">
                <div style="text-align:center">
                    <h1 style="margin:0 0 8px 0;font-size:2em">üìÑ RELAT√ìRIO EXECUTIVO PREMIUM</h1>
                    <h2 style="margin:0 0 24px 0;font-weight:400;font-size:1.2em">Diagn√≥stico Financeiro 360¬∞</h2>
                    
                    <!-- CAMPOS EDIT√ÅVEIS -->
                    <div style="background:rgba(255,255,255,0.15);padding:24px;border-radius:12px;display:inline-block;margin-bottom:24px;min-width:400px">
                        <div style="margin-bottom:16px">
                            <label style="display:block;font-size:0.85em;opacity:0.9;margin-bottom:6px;text-align:left">‚úèÔ∏è EMPRESA:</label>
                            <input type="text" id="relatorio-nome-empresa" 
                                   value="${dados.nome || ''}" 
                                   placeholder="Digite o nome da empresa"
                                   style="width:100%;padding:10px;border:2px solid rgba(255,255,255,0.3);background:rgba(255,255,255,0.1);color:white;border-radius:6px;font-size:1em;font-weight:600;text-align:center"
                                   onchange="localStorage.setItem('diag_dados', JSON.stringify({...JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}'), nome: this.value}))">
                        </div>
                        <div>
                            <label style="display:block;font-size:0.85em;opacity:0.9;margin-bottom:6px;text-align:left">üìÖ DATA:</label>
                            <input type="date" id="relatorio-data" 
                                   value="${new Date().toISOString().split('T')[0]}"
                                   style="width:100%;padding:10px;border:2px solid rgba(255,255,255,0.3);background:rgba(255,255,255,0.1);color:white;border-radius:6px;font-size:1em;font-weight:600;text-align:center">
                        </div>
                    </div>
                    
                    <!-- BOT√ïES DE A√á√ÉO -->
                    <div style="display:flex;gap:16px;justify-content:center;flex-wrap:wrap">
                        <button onclick="gerarPDFRelatorioExecutivoPremium()" 
                                style="background:linear-gradient(135deg,#00b894,#0984e3);color:white;border:none;padding:14px 28px;border-radius:12px;font-weight:700;cursor:pointer;font-size:1em;box-shadow:0 4px 15px rgba(9,132,227,0.3);transition:all 0.3s" 
                                onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 20px rgba(9,132,227,0.4)'" 
                                onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 4px 15px rgba(9,132,227,0.3)'">
                            üìÑ Gerar PDF Premium
                        </button>
                        <button onclick="exportarExcel()" 
                                style="background:rgba(255,255,255,0.2);color:white;border:2px solid white;padding:12px 24px;border-radius:8px;font-weight:700;cursor:pointer;font-size:0.9em;transition:all 0.3s" 
                                onmouseover="this.style.background='white';this.style.color='#0f2027'" 
                                onmouseout="this.style.background='rgba(255,255,255,0.2)';this.style.color='white'">
                            üìä Exportar Excel
                        </button>
                        <button onclick="abrirModalProposta()" 
                                style="background:linear-gradient(135deg,#667eea,#764ba2);color:white;border:none;padding:12px 24px;border-radius:8px;font-weight:700;cursor:pointer;font-size:0.9em;transition:all 0.3s" 
                                onmouseover="this.style.transform='translateY(-2px)'" 
                                onmouseout="this.style.transform='translateY(0)'">
                            üíº Proposta Comercial
                        </button>
                        <button onclick="gerarRelatorioPDFPremium()" 
                                style="background:rgba(255,255,255,0.2);color:white;border:2px solid white;padding:12px 24px;border-radius:8px;font-weight:700;cursor:pointer;font-size:0.9em;transition:all 0.3s" 
                                onmouseover="this.style.background='white';this.style.color='#0f2027'" 
                                onmouseout="this.style.background='rgba(255,255,255,0.2)';this.style.color='white'">
                            üìÑ PDF Premium (22 p√°g.)
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- √çNDICE NAVEG√ÅVEL -->
            <div style="background:var(--card);border:3px solid var(--accent);border-radius:12px;padding:32px;margin-bottom:32px">
                <h2 style="color:var(--accent);margin-bottom:24px;text-align:center">üìë √çNDICE DO RELAT√ìRIO</h2>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:12px">
                    <a href="#secao-1" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">1</span>
                        <div>
                            <div style="font-weight:700">Sum√°rio Executivo</div>
                            <div style="font-size:0.85em;color:var(--text-light)">Vis√£o geral e score</div>
                        </div>
                    </button>
                    <a href="#secao-2" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">2</span>
                        <div>
                            <div style="font-weight:700">An√°lise por Categoria</div>
                            <div style="font-size:0.85em;color:var(--text-light)">Scores detalhados + gr√°ficos</div>
                        </div>
                    </button>
                    <a href="#secao-3" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">3</span>
                        <div>
                            <div style="font-weight:700">SWOT Consolidada</div>
                            <div style="font-size:0.85em;color:var(--text-light)">For√ßas, fraquezas, oportunidades e amea√ßas</div>
                        </div>
                    </button>
                    <a href="#secao-4" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">4</span>
                        <div>
                            <div style="font-weight:700">Riscos Cr√≠ticos</div>
                            <div style="font-size:0.85em;color:var(--text-light)">Mapeamento de riscos urgentes</div>
                        </div>
                    </button>
                    <a href="#secao-5" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">5</span>
                        <div>
                            <div style="font-weight:700">Plano de A√ß√£o Executivo</div>
                            <div style="font-size:0.85em;color:var(--text-light)">A√ß√µes priorizadas por timeline</div>
                        </div>
                    </button>
                    <a href="#secao-6" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">6</span>
                        <div>
                            <div style="font-weight:700">OKRs Estrat√©gicos</div>
                            <div style="font-size:0.85em;color:var(--text-light)">Objetivos e key results</div>
                        </div>
                    </button>
                    <a href="#secao-7" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">7</span>
                        <div>
                            <div style="font-weight:700">Benchmark de Mercado</div>
                            <div style="font-size:0.85em;color:var(--text-light)">Comparativo setorial</div>
                        </div>
                    </button>
                    <a href="#secao-8" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">8</span>
                        <div>
                            <div style="font-weight:700">Proje√ß√£o Financeira 12 Meses</div>
                            <div style="font-size:0.85em;color:var(--text-light)">Cen√°rios e crescimento</div>
                        </div>
                    </button>
                    <a href="#secao-9" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">9</span>
                        <div>
                            <div style="font-weight:700">Alertas Inteligentes</div>
                            <div style="font-size:0.85em;color:var(--text-light)">Avisos e recomenda√ß√µes</div>
                        </div>
                    </button>
                    <a href="#secao-10" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">10</span>
                        <div>
                            <div style="font-weight:700">Calculadora de ROI por A√ß√£o</div>
                            <div style="font-size:0.85em;color:var(--text-light)">Retorno sobre investimento</div>
                        </div>
                    </button>
                    <a href="#secao-11" style="display:flex;align-items:center;gap:12px;padding:16px;background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);border-radius:8px;text-decoration:none;color:var(--text);transition:all 0.3s" 
                       onmouseover="this.style.background='rgba(0,102,255,0.1)';this.style.transform='translateX(8px)'" 
                       onmouseout="this.style.background='rgba(0,102,255,0.05)';this.style.transform='translateX(0)'">
                        <span style="font-size:1.5em;font-weight:800;color:var(--accent)">11</span>
                        <div>
                            <div style="font-weight:700">Pr√≥ximos Passos</div>
                            <div style="font-size:0.85em;color:var(--text-light)">Recomenda√ß√µes finais</div>
                        </div>
                    </button>
                </div>
            </div>
            <!-- 1. SUM√ÅRIO EXECUTIVO -->
            <div id="secao-1" style="background:var(--card);border:3px solid var(--accent);border-radius:12px;padding:32px;margin-bottom:32px">
                <h2 style="color:var(--accent);margin-bottom:24px;display:flex;align-items:center;gap:12px">
                    <span>1. SUM√ÅRIO EXECUTIVO</span>
                </h2>
                
                <!-- Score Geral -->
                <div style="background:linear-gradient(135deg, ${corClass}22, transparent);border:3px solid ${corClass};border-radius:12px;padding:24px;margin-bottom:24px;text-align:center">
                    <div style="font-size:4em;font-weight:800;color:${corClass};margin-bottom:8px">${scoreGeral}<span style="font-size:0.5em">/100</span></div>
                    <div style="font-size:1.5em;font-weight:700;color:${corClass};margin-bottom:8px">${iconeClass} ${classificacao}</div>
                    <div style="color:var(--text-light)">Maturidade Financeira Geral</div>
                </div>
                
                <!-- BENCHMARK SETORIAL -->
                <div style="background:var(--card);border:3px solid var(--gold);border-radius:12px;padding:24px;margin-bottom:24px">
                    <h3 style="color:var(--gold);margin-bottom:16px;display:flex;align-items:center;gap:8px">
                        <span>üìä</span>
                        <span>Comparativo com Benchmarks Setoriais</span>
                    </h3>
                    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:20px">
                        <div style="text-align:center;padding:16px;background:rgba(211,47,47,0.1);border-radius:8px">
                            <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">CR√çTICO</div>
                            <div style="font-size:1.8em;font-weight:800;color:#d32f2f">< 30</div>
                            <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Controles inexistentes</div>
                        </div>
                        <div style="text-align:center;padding:16px;background:rgba(245,124,0,0.1);border-radius:8px">
                            <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">B√ÅSICO</div>
                            <div style="font-size:1.8em;font-weight:800;color:#f57c00">30-50</div>
                            <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Controles iniciais</div>
                        </div>
                        <div style="text-align:center;padding:16px;background:rgba(46,125,50,0.1);border-radius:8px">
                            <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">ORGANIZADO</div>
                            <div style="font-size:1.8em;font-weight:800;color:#2e7d32">50-70</div>
                            <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Processos definidos</div>
                        </div>
                    </div>
                    <div style="text-align:center;padding:16px;background:rgba(25,118,210,0.1);border-radius:8px;margin-bottom:16px">
                        <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">PROFISSIONAL (Meta)</div>
                        <div style="font-size:2em;font-weight:800;color:#1976d2">70-100</div>
                        <div style="font-size:0.75em;color:var(--text-light);margin-top:4px">Gest√£o estrat√©gica e otimizada</div>
                    </div>
                    <div style="background:rgba(0,102,255,0.05);padding:16px;border-radius:8px;text-align:center">
                        <strong style="color:var(--accent)">Seu Score: ${scoreGeral}/100</strong>
                        <div style="font-size:0.85em;color:var(--text-light);margin-top:4px">
                            ${scoreGeral >= 70 ? '‚úÖ Acima da m√©dia do mercado - Continue mantendo excel√™ncia' :
                              scoreGeral >= 50 ? 'üìä Pr√≥ximo da m√©dia - Foco em otimiza√ß√£o para crescer' :
                              scoreGeral >= 30 ? '‚ö†Ô∏è Abaixo da m√©dia - Priorize estrutura√ß√£o urgente' :
                              'üî¥ Muito abaixo da m√©dia - A√ß√µes cr√≠ticas necess√°rias imediatamente'}
                        </div>
                    </div>
                </div>
                
                <!-- Resumo Anal√≠tico -->
                <div style="background:rgba(0,102,255,0.05);padding:20px;border-radius:8px;border-left:4px solid var(--accent)">
                    <h4 style="color:var(--accent);margin-bottom:12px">üìä Resumo Anal√≠tico</h4>
                    <p style="line-height:1.8;color:var(--text)">
                        ${scoreGeral < 30 ? `A empresa apresenta <strong>maturidade financeira cr√≠tica (${scoreGeral}/100)</strong>, com aus√™ncia de controles fundamentais em m√∫ltiplas √°reas. 
                        A situa√ß√£o demanda <strong>a√ß√µes urgentes de estabiliza√ß√£o</strong> nos pr√≥ximos 30-60 dias para evitar riscos operacionais e financeiros graves.` :
                        scoreGeral < 50 ? `A empresa possui <strong>controles b√°sicos (${scoreGeral}/100)</strong>, por√©m ainda apresenta gaps significativos que limitam visibilidade e previsibilidade. 
                        Recomenda-se <strong>estrutura√ß√£o gradual</strong> dos processos financeiros nos pr√≥ximos 90 dias.` :
                        scoreGeral < 70 ? `A empresa demonstra <strong>organiza√ß√£o financeira consistente (${scoreGeral}/100)</strong>. 
                        H√° oportunidades claras de <strong>otimiza√ß√£o e profissionaliza√ß√£o</strong> para suportar crescimento sustent√°vel.` :
                        `A empresa apresenta <strong>gest√£o financeira profissional (${scoreGeral}/100)</strong>. 
                        Foco deve ser em <strong>inova√ß√£o, automa√ß√£o e excel√™ncia operacional</strong>.`}
                    </p>
                </div>
                
                <!-- M√©tricas R√°pidas -->
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-top:24px">
                    <div style="background:var(--card);border:2px solid #d32f2f;padding:16px;border-radius:8px;text-align:center">
                        <div style="font-size:2em;font-weight:800;color:#d32f2f">${swot.fraquezas.length}</div>
                        <div style="font-size:0.85em;color:var(--text-light)">Fraquezas Cr√≠ticas</div>
                    </div>
                    <div style="background:var(--card);border:2px solid #f57c00;padding:16px;border-radius:8px;text-align:center">
                        <div style="font-size:2em;font-weight:800;color:#f57c00">${riscosCriticos.length}</div>
                        <div style="font-size:0.85em;color:var(--text-light)">Riscos Urgentes</div>
                    </div>
                    <div style="background:var(--card);border:2px solid var(--accent);padding:16px;border-radius:8px;text-align:center">
                        <div style="font-size:2em;font-weight:800;color:var(--accent)">${acoes.dias30.length + acoes.dias60.length + acoes.dias90.length}</div>
                        <div style="font-size:0.85em;color:var(--text-light)">A√ß√µes Priorizadas</div>
                    </div>
                    <div style="background:var(--card);border:2px solid #2e7d32;padding:16px;border-radius:8px;text-align:center">
                        <div style="font-size:2em;font-weight:800;color:#2e7d32">${okrs.length}</div>
                        <div style="font-size:0.85em;color:var(--text-light)">OKRs Estrat√©gicos</div>
                    </div>
                </div>
            </div>
            

                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 1</span>
                    </h4>
                    <textarea id="obs-secao-1" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_1', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
            <!-- 2. AN√ÅLISE POR CATEGORIA -->
            <div id="secao-2" style="background:var(--card);border:3px solid var(--accent);border-radius:12px;padding:32px;margin-bottom:32px">
                <h2 style="color:var(--accent);margin-bottom:24px">2. AN√ÅLISE POR CATEGORIA</h2>
                
                <div style="display:grid;gap:16px">
                    ${Object.keys(scores).map(cat => {
                        const score = scores[cat];
                        let cor, status;
                        if (score >= 70) { cor = '#1976d2'; status = 'Profissional'; }
                        else if (score >= 50) { cor = '#2e7d32'; status = 'Organizado'; }
                        else if (score >= 30) { cor = '#f57c00'; status = 'B√°sico'; }
                        else { cor = '#d32f2f'; status = 'Cr√≠tico'; }
                        
                        return `
                            <div style="background:var(--card);border-left:5px solid ${cor};padding:20px;border-radius:8px;box-shadow:var(--shadow)">
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                                    <h3 style="margin:0;font-size:1.1em">${catNomes[cat]}</h3>
                                    <div style="display:flex;align-items:center;gap:12px">
                                        <span style="background:${cor};color:white;padding:4px 12px;border-radius:6px;font-size:0.85em;font-weight:700">${status}</span>
                                        <span style="font-size:1.5em;font-weight:800;color:${cor}">${score}/100</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            </div>
            

                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->

                <!-- GR√ÅFICOS VISUAIS -->
                <div style="margin-top:32px;padding-top:24px;border-top:2px solid var(--border)">
                    <h3 style="color:var(--accent);margin-bottom:24px;text-align:center">üìä VISUALIZA√á√ÉO GR√ÅFICA DOS SCORES</h3>
                    
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px">
                        <!-- GR√ÅFICO RADAR -->
                        <div style="background:white;padding:24px;border-radius:12px;border:2px solid var(--border)">
                            <h4 style="color:var(--accent);margin-bottom:16px;text-align:center">üì° Gr√°fico Radar - Vis√£o 360¬∞</h4>
                            <div style="text-align:center;padding:40px 20px;">
                                <!-- Gr√°fico Radar Simulado -->
                                <div style="position:relative;width:300px;height:300px;margin:0 auto;background:radial-gradient(circle, #f0f0f0 30%, transparent 30%, transparent 60%, #f0f0f0 60%, transparent 60%, transparent 90%, #f0f0f0 90%);border-radius:50%;">
                                    ${Object.keys(scores).map((cat, idx) => {
                                        const angle = (idx * 45) - 90; // 8 categorias = 45¬∞ cada
                                        const scoreVal = scores[cat];
                                        let cor;
                                        if (scoreVal >= 70) cor = '#1976d2';
                                        else if (scoreVal >= 50) cor = '#2e7d32';
                                        else if (scoreVal >= 30) cor = '#f57c00';
                                        else cor = '#d32f2f';
                                        
                                        const x = 150 + Math.cos(angle * Math.PI / 180) * 120;
                                        const y = 150 + Math.sin(angle * Math.PI / 180) * 120;
                                        
                                        return `
                                            <div style="position:absolute;left:${x-30}px;top:${y-15}px;width:60px;height:30px;background:${cor};color:white;display:flex;align-items:center;justify-content:center;border-radius:6px;font-weight:700;font-size:14px;box-shadow:0 2px 4px rgba(0,0,0,0.2)">
                                                ${scoreVal}
                                            </div>
                                        `;
                                    }).join('')}
                                    
                                    <!-- Centro do radar -->
                                    <div style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:80px;height:80px;background:linear-gradient(135deg,var(--accent),#42a5f5);border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-size:24px;box-shadow:0 4px 12px rgba(0,0,0,0.3)">
                                        ${scoreGeral}
                                    </div>
                                </div>
                                
                                <!-- Legenda -->
                                <div style="margin-top:20px;display:grid;grid-template-columns:repeat(2,1fr);gap:8px;font-size:0.75em">
                                    ${Object.keys(scores).slice(0,4).map(cat => {
                                        const nome = catNomes[cat] || cat;
                                        return `<div style="text-align:center">${nome}</div>`;
                                    }).join('')}
                                </div>
                                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:8px;font-size:0.75em;margin-top:4px">
                                    ${Object.keys(scores).slice(4,8).map(cat => {
                                        const nome = catNomes[cat] || cat;
                                        return `<div style="text-align:center">${nome}</div>`;
                                    }).join('')}
                                </div>
                            </div>
                        </div>
                        
                        <!-- GR√ÅFICO DE BARRAS -->
                        <div style="background:white;padding:24px;border-radius:12px;border:2px solid var(--border)">
                            <h4 style="color:var(--accent);margin-bottom:16px;text-align:center">üìä Gr√°fico de Barras - Comparativo</h4>
                            <div style="padding:20px;">
                                ${Object.keys(scores).map(cat => {
                                    const scoreVal = scores[cat];
                                    let cor;
                                    if (scoreVal >= 70) cor = '#1976d2';
                                    else if (scoreVal >= 50) cor = '#2e7d32';
                                    else if (scoreVal >= 30) cor = '#f57c00';
                                    else cor = '#d32f2f';
                                    
                                    const nome = catNomes[cat] || cat;
                                    
                                    return `
                                        <div style="margin-bottom:16px">
                                            <div style="display:flex;justify-content:space-between;margin-bottom:4px;font-size:0.85em">
                                                <span style="font-weight:600">${nome}</span>
                                                <span style="font-weight:700;color:${cor}">${scoreVal}/100</span>
                                            </div>
                                            <div style="width:100%;height:24px;background:#f0f0f0;border-radius:12px;overflow:hidden;position:relative">
                                                <div style="width:${scoreVal}%;height:100%;background:linear-gradient(90deg,${cor},${cor}cc);border-radius:12px;transition:width 0.3s"></div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                </div>
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 2</span>
                    </h4>
                    <textarea id="obs-secao-2" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_2', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
            <!-- 3. SWOT CONSOLIDADA -->
            <div id="secao-3" style="background:var(--card);border:3px solid var(--accent);border-radius:12px;padding:32px;margin-bottom:32px">
                <h2 style="color:var(--accent);margin-bottom:24px">3. AN√ÅLISE SWOT CONSOLIDADA</h2>
                
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px">
                    <!-- For√ßas -->
                    <div style="background:rgba(46,125,50,0.1);border:2px solid #2e7d32;border-radius:8px;padding:20px">
                        <h4 style="color:#2e7d32;margin-bottom:12px">üí™ FOR√áAS (Top 5)</h4>
                        ${swot.forcas.length === 0 ? '<p style="color:var(--text-light);font-style:italic">Nenhuma for√ßa identificada no n√≠vel estrat√©gico.</p>' :
                        swot.forcas.slice(0, 5).map(f => `<div style="font-size:0.9em;margin-bottom:8px;color:var(--text)">‚Ä¢ ${f.descricao}</div>`).join('')}
                    </div>
                    
                    <!-- Oportunidades -->
                    <div style="background:rgba(0,200,83,0.1);border:2px solid #00c853;border-radius:8px;padding:20px">
                        <h4 style="color:#00c853;margin-bottom:12px">üöÄ OPORTUNIDADES</h4>
                        ${swot.oportunidades.length === 0 ? '<p style="color:var(--text-light);font-style:italic">Todas as √°reas est√£o ou excelentes (70+) ou cr√≠ticas (<40).</p>' :
                        swot.oportunidades.map(o => `<div style="font-size:0.9em;margin-bottom:8px;color:var(--text)">‚Ä¢ ${o.nome} (Gap: ${o.gap} pts)</div>`).join('')}
                    </div>
                    
                    <!-- Fraquezas -->
                    <div style="background:rgba(245,124,0,0.1);border:2px solid #f57c00;border-radius:8px;padding:20px">
                        <h4 style="color:#f57c00;margin-bottom:12px">‚ö†Ô∏è FRAQUEZAS CR√çTICAS (Top 10)</h4>
                        ${swot.fraquezas.filter(f => f.critica).slice(0, 10).map(f => 
                            `<div style="font-size:0.9em;margin-bottom:8px;color:var(--text)">‚Ä¢ ${f.descricao}</div>`
                        ).join('')}
                        ${swot.fraquezas.filter(f => f.critica).length > 10 ? `<div style="margin-top:8px;font-size:0.85em;color:var(--text-light);font-style:italic">+ ${swot.fraquezas.filter(f => f.critica).length - 10} outras fraquezas cr√≠ticas</div>` : ''}
                    </div>
                    
                    <!-- Amea√ßas -->
                    <div style="background:rgba(211,47,47,0.1);border:2px solid #d32f2f;border-radius:8px;padding:20px">
                        <h4 style="color:#d32f2f;margin-bottom:12px">‚ö° AMEA√áAS</h4>
                        ${swot.ameacas.length === 0 ? '<p style="color:var(--text-light);font-style:italic">Nenhuma amea√ßa sist√™mica identificada.</p>' :
                        swot.ameacas.map(a => `<div style="font-size:0.9em;margin-bottom:8px;color:var(--text)">‚Ä¢ ${a.nome}: ${a.descricao}</div>`).join('')}
                    </div>
                </div>
            </div>
            

                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 3</span>
                    </h4>
                    <textarea id="obs-secao-3" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_3', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
            <!-- 4. RISCOS CR√çTICOS -->
            ${riscosCriticos.length > 0 ? `
            <div style="background:var(--card);border:3px solid #d32f2f;border-radius:12px;padding:32px;margin-bottom:32px">
                <h2 style="color:#d32f2f;margin-bottom:24px">4. RISCOS CR√çTICOS (Top 10)</h2>
                <div style="display:grid;gap:12px">
                    ${riscosCriticos.map((r, i) => `
                        <div style="background:rgba(211,47,47,0.05);border-left:4px solid #d32f2f;padding:16px;border-radius:8px">
                            <div style="display:flex;align-items:start;gap:12px">
                                <span style="background:#d32f2f;color:white;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:0.9em;flex-shrink:0">${i+1}</span>
                                <div style="flex:1">
                                    <div style="font-weight:700;margin-bottom:4px;color:var(--text)">${r.pergunta}</div>
                                    <div style="font-size:0.85em;color:var(--text-light)">${r.feedback}</div>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
            ` : ''}
            

                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 4</span>
                    </h4>
                    <textarea id="obs-secao-4" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_4', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
            <!-- 5. PLANO DE A√á√ÉO EXECUTIVO -->
            <div id="secao-5" style="background:var(--card);border:3px solid var(--accent);border-radius:12px;padding:32px;margin-bottom:32px">
                <h2 style="color:var(--accent);margin-bottom:24px">5. PLANO DE A√á√ÉO EXECUTIVO</h2>
                
                <!-- 30 DIAS -->
                ${acoes.dias30.length > 0 ? `
                <div style="background:rgba(211,47,47,0.05);border-left:5px solid #d32f2f;padding:20px;border-radius:8px;margin-bottom:20px">
                    <h3 style="color:#d32f2f;margin-bottom:16px">üî¥ A√á√ïES URGENTES (30 DIAS) - ${acoes.dias30.length} a√ß√µes</h3>
                    <div style="display:grid;gap:12px">
                        ${acoes.dias30.map((a, i) => `
                            <div style="background:var(--card);border-left:4px solid #d32f2f;padding:16px;border-radius:8px;box-shadow:var(--shadow)">
                                <div style="display:flex;align-items:start;gap:12px">
                                    <span style="background:#d32f2f;color:white;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:0.9em;flex-shrink:0">${i+1}</span>
                                    <div style="flex:1">
                                        <div style="font-weight:700;margin-bottom:8px;color:var(--text)">${a.pergunta}</div>
                                        <div style="background:rgba(211,47,47,0.1);padding:12px;border-radius:6px;margin-bottom:8px">
                                            <div style="font-size:0.85em;color:#d32f2f;font-weight:700;margin-bottom:4px">Situa√ß√£o Atual:</div>
                                            <div style="font-size:0.85em;color:var(--text-light)">${a.feedback}</div>
                                        </div>
                                        <div style="background:rgba(0,102,255,0.1);padding:12px;border-radius:6px">
                                            <div style="font-size:0.85em;color:var(--accent);font-weight:700;margin-bottom:4px">‚úÖ A√ß√£o Recomendada:</div>
                                            <div style="font-size:0.85em;color:var(--text)">${a.acao}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}
                
                <!-- 60 DIAS -->
                ${acoes.dias60.length > 0 ? `
                <div style="background:rgba(245,124,0,0.05);border-left:5px solid #f57c00;padding:20px;border-radius:8px;margin-bottom:20px">
                    <h3 style="color:#f57c00;margin-bottom:16px">üü† A√á√ïES IMPORTANTES (60 DIAS) - ${acoes.dias60.length} a√ß√µes</h3>
                    <div style="display:grid;gap:12px">
                        ${acoes.dias60.map((a, i) => `
                            <div style="background:var(--card);border-left:4px solid #f57c00;padding:16px;border-radius:8px;box-shadow:var(--shadow)">
                                <div style="display:flex;align-items:start;gap:12px">
                                    <span style="background:#f57c00;color:white;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:0.9em;flex-shrink:0">${i+1}</span>
                                    <div style="flex:1">
                                        <div style="font-weight:700;margin-bottom:8px;color:var(--text)">${a.pergunta}</div>
                                        <div style="background:rgba(0,102,255,0.1);padding:12px;border-radius:6px">
                                            <div style="font-size:0.85em;color:var(--accent);font-weight:700;margin-bottom:4px">‚úÖ A√ß√£o:</div>
                                            <div style="font-size:0.85em;color:var(--text)">${a.acao}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}
                
                <!-- 90 DIAS -->
                ${acoes.dias90.length > 0 ? `
                <div style="background:rgba(46,125,50,0.05);border-left:5px solid #2e7d32;padding:20px;border-radius:8px">
                    <h3 style="color:#2e7d32;margin-bottom:16px">üü¢ A√á√ïES ESTRUTURANTES (90 DIAS) - ${acoes.dias90.length} a√ß√µes</h3>
                    <div style="display:grid;gap:12px">
                        ${acoes.dias90.map((a, i) => `
                            <div style="background:var(--card);border-left:4px solid #2e7d32;padding:16px;border-radius:8px;box-shadow:var(--shadow)">
                                <div style="display:flex;align-items:start;gap:12px">
                                    <span style="background:#2e7d32;color:white;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:0.9em;flex-shrink:0">${i+1}</span>
                                    <div style="flex:1">
                                        <div style="font-weight:700;margin-bottom:8px;color:var(--text)">${a.pergunta}</div>
                                        <div style="background:rgba(0,102,255,0.1);padding:12px;border-radius:6px">
                                            <div style="font-size:0.85em;color:var(--accent);font-weight:700;margin-bottom:4px">‚úÖ A√ß√£o:</div>
                                            <div style="font-size:0.85em;color:var(--text)">${a.acao}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}
            </div>
            

                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 5</span>
                    </h4>
                    <textarea id="obs-secao-5" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_5', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
            <!-- 6. OKRs ESTRAT√âGICOS -->
            ${okrs.length > 0 ? `
            <div style="background:var(--card);border:3px solid var(--accent);border-radius:12px;padding:32px;margin-bottom:32px">
                <h2 style="color:var(--accent);margin-bottom:24px">6. OKRs ESTRAT√âGICOS (6 meses)</h2>
                <div style="display:grid;gap:24px">
                    ${okrs.map((okr, i) => `
                        <div style="background:var(--card);border:3px solid var(--accent);padding:24px;border-radius:12px;box-shadow:var(--shadow)">
                            <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px;padding-bottom:16px;border-bottom:2px solid var(--border)">
                                <span style="font-size:2em">${okr.icon}</span>
                                <div style="flex:1">
                                    <h3 style="margin:0;color:var(--accent);font-size:1.2em">OKR ${i+1}: ${okr.objective}</h3>
                                    <div style="font-size:0.9em;color:var(--text-light);margin-top:6px">
                                        ${okr.contexto} ‚Ä¢ Score: ${okr.score}/100 ‚Ä¢ ${okr.keyResults.length} Key Results
                                    </div>
                                </div>
                            </div>
                            
                            <!-- KEY RESULTS -->
                            <div style="display:grid;gap:12px">
                                ${okr.keyResults.map((kr, j) => `
                                    <div style="background:rgba(0,102,255,0.05);border-left:4px solid var(--accent);padding:16px;border-radius:8px">
                                        <div style="display:flex;align-items:start;gap:12px">
                                            <span style="background:var(--accent);color:white;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:0.85em;flex-shrink:0">${j+1}</span>
                                            <div style="flex:1">
                                                <div style="display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap">
                                                    <span style="background:${kr.tipo === 'FOR√áA' ? '#2e7d32' : '#00c853'};color:white;padding:3px 8px;border-radius:6px;font-size:0.75em;font-weight:700">
                                                        ${kr.tipo === 'FOR√áA' ? 'üí™ FOR√áA' : 'üöÄ OPORTUNIDADE'}
                                                    </span>
                                                </div>
                                                <div style="font-weight:700;margin-bottom:8px;color:var(--text)">${kr.descricao}</div>
                                                <div style="font-size:0.85em;color:var(--text-light);margin-bottom:12px">
                                                    <strong>Base:</strong> ${kr.contexto}
                                                </div>
                                                <div style="display:flex;gap:12px;flex-wrap:wrap">
                                                    <div style="background:rgba(0,102,255,0.1);padding:8px 12px;border-radius:6px;border:1px solid var(--accent)">
                                                        <span style="font-size:0.75em;color:var(--accent);font-weight:700">ATUAL:</span>
                                                        <span style="font-weight:700;color:var(--accent);margin-left:4px">${kr.baseline}</span>
                                                    </div>
                                                    <div style="background:rgba(46,125,50,0.1);padding:8px 12px;border-radius:6px;border:1px solid #2e7d32">
                                                        <span style="font-size:0.75em;color:#2e7d32;font-weight:700">META:</span>
                                                        <span style="font-weight:700;color:#2e7d32;margin-left:4px">${kr.meta}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
            ` : ''}
            


                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 6</span>
                    </h4>
                    <textarea id="obs-secao-6" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_6', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
            <!-- 7 BENCHMARKING DE MERCADO -->
            <div class="card" style="margin-bottom:24px">
                <h2 style="margin:0 0 24px 0;font-size:1.8em;color:var(--accent)">
                    üìä 7. Benchmarking de Mercado
                </h2>
                
                ${(() => {
                    const bmk = gerarDadosBenchmarkDinamico();
                    return `
                <div style="background:linear-gradient(135deg,rgba(25,118,210,0.1),transparent);border-left:4px solid var(--accent);padding:16px;margin-bottom:24px;border-radius:8px">
                    <div style="font-size:1.1em;font-weight:700;margin-bottom:8px">Compara√ß√£o com o Setor</div>
                    <div style="color:var(--text-light)">Setor: <strong>${bmk.setor} ${bmk.porte}</strong> ‚Ä¢ Faturamento anual: <strong>${formatarValorGrande(bmk.faturamentoAnual)}/ano</strong></div>
                    <div style="margin-top:8px;padding:8px;background:rgba(255,193,7,0.1);border-radius:6px;font-size:0.9em">
                        üí° <strong>Dados baseados no seu diagn√≥stico:</strong> As compara√ß√µes abaixo usam suas respostas reais para calcular m√©tricas e benchmarks.
                    </div>
                </div>
                
                <!-- Margem Bruta -->
                <div style="margin-bottom:32px">
                    <h3 style="margin:0 0 16px 0;color:var(--accent)">üí∞ Margem Bruta</h3>
                    <div style="margin-bottom:12px">
                        <div style="display:flex;justify-content:space-between;margin-bottom:8px">
                            <span style="font-weight:700">Sua Empresa: ${bmk.margemBruta}%</span>
                            <span style="color:${bmk.margemStatus === 'acima' ? '#00c853' : '#d32f2f'};font-weight:700">${bmk.margemStatus === 'acima' ? '‚úì' : '‚ö†'} ${bmk.margemStatus === 'acima' ? 'Acima' : 'Abaixo'} da m√©dia</span>
                        </div>
                        <div style="position:relative;height:32px;background:var(--border);border-radius:8px;overflow:hidden">
                            <div style="position:absolute;left:${((bmk.margemBrutaMedia - bmk.margemBrutaMin) / (bmk.margemBrutaMax - bmk.margemBrutaMin)) * 100}%;width:2px;height:100%;background:#666;z-index:1"></div>
                            <div style="position:absolute;left:0;width:${((bmk.margemBruta - bmk.margemBrutaMin) / (bmk.margemBrutaMax - bmk.margemBrutaMin)) * 100}%;height:100%;background:${bmk.margemStatus === 'acima' ? '#00c853' : '#d32f2f'};transition:all 0.5s"></div>
                        </div>
                        <div style="display:flex;justify-content:space-between;margin-top:4px;font-size:0.85em;color:var(--text-light)">
                            <span>Min: ${bmk.margemBrutaMin}%</span>
                            <span>M√©dia: ${bmk.margemBrutaMedia}%</span>
                            <span>M√°x: ${bmk.margemBrutaMax}%</span>
                        </div>
                        <div style="margin-top:8px;color:${bmk.margemStatus === 'acima' ? '#00c853' : '#d32f2f'}">
                            <strong>Diferen√ßa:</strong> ${bmk.margemStatus === 'acima' ? '+' : ''}${bmk.margemDif}% (${bmk.margemStatus === 'acima' ? '+' : ''}${bmk.margemDifPerc}% vs m√©dia)
                        </div>
                    </div>
                </div>
                
                <!-- Inadimpl√™ncia -->
                <div style="margin-bottom:32px">
                    <h3 style="margin:0 0 16px 0;color:var(--accent)">‚ö†Ô∏è Taxa de Inadimpl√™ncia</h3>
                    <div style="margin-bottom:12px">
                        <div style="display:flex;justify-content:space-between;margin-bottom:8px">
                            <span style="font-weight:700">Sua Empresa: ${bmk.inadimplencia.toFixed(1)}%</span>
                            <span style="color:${bmk.inadimStatus === 'acima' ? '#d32f2f' : '#00c853'};font-weight:700">${bmk.inadimStatus === 'acima' ? '‚ö†' : '‚úì'} ${bmk.inadimStatus === 'acima' ? 'Acima' : 'Abaixo'} da m√©dia</span>
                        </div>
                        <div style="position:relative;height:32px;background:var(--border);border-radius:8px;overflow:hidden">
                            <div style="position:absolute;left:${((bmk.inadimMedia - bmk.inadimMin) / (bmk.inadimMax - bmk.inadimMin)) * 100}%;width:2px;height:100%;background:#666;z-index:1"></div>
                            <div style="position:absolute;left:0;width:${((bmk.inadimplencia - bmk.inadimMin) / (bmk.inadimMax - bmk.inadimMin)) * 100}%;height:100%;background:${bmk.inadimStatus === 'acima' ? '#d32f2f' : '#00c853'};transition:all 0.5s"></div>
                        </div>
                        <div style="display:flex;justify-content:space-between;margin-top:4px;font-size:0.85em;color:var(--text-light)">
                            <span>Min: ${bmk.inadimMin.toFixed(1)}%</span>
                            <span>M√©dia: ${bmk.inadimMedia.toFixed(1)}%</span>
                            <span>M√°x: ${bmk.inadimMax.toFixed(1)}%</span>
                        </div>
                        ${bmk.inadimStatus === 'acima' ? `
                        <div style="margin-top:8px;color:#d32f2f">
                            <strong>Diferen√ßa:</strong> +${bmk.inadimDif.toFixed(1)}% (+${bmk.inadimDifPerc}% vs m√©dia)
                        </div>
                        ` : ''}
                    </div>
                </div>
                
                <!-- Insights -->
                <div style="background:#00c85315;border-left:4px solid #00c853;padding:20px;border-radius:8px">
                    <h3 style="margin:0 0 16px 0;color:#00c853">üí° Principais Insights do Benchmarking</h3>
                    
                    <div style="margin-bottom:16px">
                        <strong>üéØ Gaps Identificados:</strong>
                    </div>
                    
                    <div style="font-size:0.95em;line-height:1.8">
                        ${bmk.margemStatus === 'acima' ? '‚úÖ' : '‚ö†Ô∏è'} <strong>Margem Bruta:</strong> ${bmk.margemStatus === 'acima' ? `Acima da m√©dia (+${bmk.margemDifPerc}%)` : `Abaixo da m√©dia (${bmk.margemDifPerc}%)`}<br>
                        ${bmk.inadimStatus === 'abaixo' ? '‚úÖ' : '‚ö†Ô∏è'} <strong>Inadimpl√™ncia:</strong> ${bmk.inadimStatus === 'acima' ? `${bmk.inadimDifPerc}% acima da m√©dia do setor` : 'Dentro da m√©dia do setor'}<br>
                    </div>
                    
                    ${bmk.inadimStatus === 'acima' && bmk.potencialMelhoriaInadim > 0 ? `
                    <div style="margin-top:20px;padding-top:20px;border-top:1px solid #00c85350">
                        <strong>üí∞ Potencial de Melhoria (Inadimpl√™ncia):</strong><br>
                        <div style="margin-top:8px;font-size:0.95em">
                            Se atingir a m√©dia do setor em inadimpl√™ncia (${bmk.inadimMedia.toFixed(1)}%), voc√™ pode:<br>
                            ‚Ä¢ Recuperar aproximadamente <strong>R$ ${formatarValor(bmk.potencialMelhoriaInadim)}/m√™s</strong><br>
                            ‚Ä¢ Aumentar lucro anual em <strong>R$ ${formatarValor(bmk.potencialMelhoriaAnual)}</strong><br>
                            ‚Ä¢ Melhorar fluxo de caixa em <strong>${bmk.potencialMelhoriaFluxo > 0 ? Math.round((bmk.potencialMelhoriaFluxo / bmk.faturamentoAnual) * 100) : 35}%</strong>
                        </div>
                    </div>
                    ` : ''}
                </div>
                    `;
                })()}
            </div>


                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 7</span>
                    </h4>
                    <textarea id="obs-secao-7" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_7', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
            <!-- 8 PROJE√á√ÉO FINANCEIRA 12 MESES -->
            <div class="card" style="margin-bottom:24px">
                <h2 style="margin:0 0 24px 0;font-size:1.8em;color:var(--accent)">
                    üìà 8. Proje√ß√£o Financeira 12 Meses
                </h2>
                
                ${(() => {
                    const proj = gerarDadosProjecaoDinamica();
                    return `
                <div style="background:linear-gradient(135deg,rgba(33,150,243,0.1),transparent);border-left:4px solid #2196f3;padding:20px;margin-bottom:24px;border-radius:8px">
                    <div style="font-weight:700;font-size:1.1em;margin-bottom:12px;color:#2196f3">Com base no seu Score atual (${proj.scoreAtual}%)</div>
                    <div style="color:var(--text-light);font-size:0.9em">Proje√ß√£o baseada em empresas similares do setor com score pr√≥ximo ao seu</div>
                    <div style="margin-top:8px;padding:8px;background:rgba(255,193,7,0.1);border-radius:6px;font-size:0.85em">
                        üí° <strong>C√°lculo din√¢mico:</strong> Usamos seu faturamento real cadastrado e score calculado para estimar seu potencial de crescimento.
                    </div>
                </div>
                
                <!-- Compara√ß√£o Atual vs Projetado -->
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin-bottom:32px">
                    
                    <div style="padding:20px;background:var(--bg);border-radius:12px;border:2px solid var(--border)">
                        <div style="font-size:0.85em;color:var(--text-light);margin-bottom:8px">RECEITA ANUAL</div>
                        <div style="font-size:1.8em;font-weight:700;color:var(--accent);margin-bottom:4px">${formatarValorGrande(proj.receitaAnual)}</div>
                        <div style="font-size:0.9em;color:#00c853;font-weight:600">‚Üó +${proj.crescimentoReceitaPerc}% projetado</div>
                    </div>
                    
                    <div style="padding:20px;background:var(--bg);border-radius:12px;border:2px solid var(--border)">
                        <div style="font-size:0.85em;color:var(--text-light);margin-bottom:8px">LUCRO ANUAL</div>
                        <div style="font-size:1.8em;font-weight:700;color:var(--accent);margin-bottom:4px">${formatarValorGrande(proj.lucroAnual)}</div>
                        <div style="font-size:0.9em;color:#00c853;font-weight:600">‚Üó +${proj.crescimentoLucroPerc}% projetado</div>
                    </div>
                    
                    <div style="padding:20px;background:var(--bg);border-radius:12px;border:2px solid var(--border)">
                        <div style="font-size:0.85em;color:var(--text-light);margin-bottom:8px">MARGEM L√çQUIDA</div>
                        <div style="font-size:1.8em;font-weight:700;color:var(--accent);margin-bottom:4px">${proj.margemLiquida.toFixed(1)}%</div>
                        <div style="font-size:0.9em;color:#00c853;font-weight:600">‚Üó +${proj.melhoriaMargemPts.toFixed(1)} pts</div>
                    </div>
                    
                </div>
                
                ${proj.oportunidades.length > 0 ? `
                <!-- Oportunidades Mapeadas -->
                <div style="background:#2196f315;border:2px solid #2196f3;border-radius:12px;padding:24px">
                    <h3 style="margin:0 0 20px 0;color:#2196f3">üéØ Oportunidades Mapeadas</h3>
                    
                    <div style="display:grid;gap:12px">
                        ${proj.oportunidades.map((op, idx) => `
                        <div style="display:flex;justify-content:space-between;align-items:center;padding:12px;background:rgba(255,255,255,0.5);border-radius:8px">
                            <div>
                                <div style="font-weight:700">${idx + 1}. ${op.titulo}</div>
                                <div style="font-size:0.9em;color:var(--text-light)">De ${op.de} para ${op.para}</div>
                            </div>
                            <div style="text-align:right">
                                <div style="font-size:1.3em;font-weight:700;color:#00c853">+R$ ${formatarValor(op.ganho)}</div>
                                <div style="font-size:0.85em;color:var(--text-light)">por m√™s</div>
                            </div>
                        </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin-top:20px;padding-top:20px;border-top:1px solid #2196f350">
                        <div style="display:flex;justify-content:space-between;align-items:center">
                            <div style="font-weight:700;font-size:1.1em">POTENCIAL TOTAL:</div>
                            <div style="font-size:1.8em;font-weight:700;color:#00c853">+R$ ${formatarValor(proj.potencialTotal)}/m√™s üöÄ</div>
                        </div>
                        <div style="text-align:right;margin-top:8px;color:var(--text-light);font-size:0.9em">
                            (R$ ${formatarValor(proj.potencialTotalAnual)}/ano)
                        </div>
                    </div>
                </div>
                ` : `
                <div style="background:#4caf5015;border-left:4px solid #4caf50;padding:20px;border-radius:8px">
                    <strong>‚úÖ Excelente!</strong> Seu score indica que voc√™ j√° est√° implementando as principais pr√°ticas financeiras. 
                    Foque em manuten√ß√£o e otimiza√ß√£o cont√≠nua dos seus processos.
                </div>
                `}
                    `;
                })()}
            </div>


                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 8</span>
                    </h4>
                    <textarea id="obs-secao-8" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_8', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
            <!-- 9 ALERTAS INTELIGENTES -->
            <div class="card" style="margin-bottom:24px">
                <h2 style="margin:0 0 24px 0;font-size:1.8em;color:var(--accent)">
                    üö® 9. Alertas Inteligentes
                </h2>
                
                <div style="margin-bottom:16px;color:var(--text-light)">
                    Prioriza√ß√£o autom√°tica baseada em impacto financeiro e urg√™ncia - <strong>Alertas gerados do seu diagn√≥stico real</strong>
                </div>
                
                ${(() => {
                    const alertas = gerarAlertasInteligentes();
                    
                    if (alertas.length === 0) {
                        return `
                        <div style="background:#4caf5015;border-left:4px solid #4caf50;padding:24px;border-radius:8px">
                            <div style="display:flex;align-items:center;gap:16px">
                                <div style="font-size:3em">‚úÖ</div>
                                <div>
                                    <div style="font-weight:700;font-size:1.2em;color:#4caf50;margin-bottom:8px">
                                        Parab√©ns! Nenhum alerta cr√≠tico identificado
                                    </div>
                                    <div style="color:var(--text-light)">
                                        Suas respostas indicam que voc√™ est√° gerenciando bem os principais riscos financeiros da empresa. 
                                        Continue monitorando e ajustando seus processos.
                                    </div>
                                </div>
                            </div>
                        </div>
                        `;
                    }
                    
                    return alertas.map((alerta, idx) => `
                    <!-- Alerta ${idx + 1} -->
                    <div style="background:${alerta.nivel === 'CR√çTICO' ? '#ffebee' : '#fff3e0'};border-left:6px solid ${alerta.cor};padding:20px;border-radius:8px;margin-bottom:16px">
                        <div style="display:flex;align-items:start;gap:16px">
                            <div style="font-size:2em">${alerta.emoji}</div>
                            <div style="flex:1">
                                <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px">
                                    <div>
                                        <div style="font-weight:700;font-size:1.1em;color:${alerta.cor};margin-bottom:4px">${alerta.nivel} - ${alerta.prazo}</div>
                                        <div style="font-size:1.15em;font-weight:600">${alerta.titulo}</div>
                                    </div>
                                </div>
                                <div style="margin:12px 0;padding:12px;background:rgba(255,255,255,0.7);border-radius:6px">
                                    <div style="font-size:0.9em;color:#666;margin-bottom:8px">üí∞ <strong>Impacto:</strong> ${alerta.impacto}</div>
                                    <div style="font-size:0.9em;color:#666;margin-bottom:8px">üéØ <strong>A√ß√£o:</strong> ${alerta.acao}</div>
                                    <div style="font-size:0.9em;color:#666">üìä <strong>ROI Estimado:</strong> ${alerta.roi}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    `).join('');
                })()}
            </div>


                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 9</span>
                    </h4>
                    <textarea id="obs-secao-9" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_9', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
            <!-- 10 CALCULADORA DE ROI -->
            <div class="card" style="margin-bottom:24px">
                <h2 style="margin:0 0 24px 0;font-size:1.8em;color:var(--accent)">
                    üí∞ 10. Calculadora de ROI por A√ß√£o
                </h2>
                
                <div style="margin-bottom:16px;color:var(--text-light)">
                    Retorno esperado de cada a√ß√£o recomendada - <strong>Baseado nas respostas do seu diagn√≥stico</strong>
                </div>
                
                <div style="padding:12px;background:rgba(255,193,7,0.1);border-radius:8px;margin-bottom:24px;font-size:0.9em">
                    üí° <strong>C√°lculo din√¢mico:</strong> As a√ß√µes abaixo s√£o geradas automaticamente a partir das suas respostas com n√≠vel cr√≠tico ou b√°sico (n√≠vel 1-2). 
                    Os valores de ROI s√£o calculados baseados no seu faturamento real e no impacto potencial de cada a√ß√£o.
                </div>
                
                ${(() => {
                    const acoesROI = gerarAcoesROIDinamicas();
                    
                    if (acoesROI.length === 0) {
                        return `
                        <div style="background:#4caf5015;border-left:4px solid #4caf50;padding:24px;border-radius:8px">
                            <div style="display:flex;align-items:center;gap:16px">
                                <div style="font-size:3em">üèÜ</div>
                                <div>
                                    <div style="font-weight:700;font-size:1.2em;color:#4caf50;margin-bottom:8px">
                                        Excelente! Sua empresa est√° bem estruturada
                                    </div>
                                    <div style="color:var(--text-light)">
                                        N√£o identificamos a√ß√µes cr√≠ticas ou b√°sicas no seu diagn√≥stico. Voc√™ est√° gerenciando bem suas finan√ßas!
                                        Continue monitorando e fazendo pequenos ajustes de otimiza√ß√£o.
                                    </div>
                                </div>
                            </div>
                        </div>
                        `;
                    }
                    
                    return acoesROI.map((acao, idx) => `
                    <!-- A√á√ÉO ${idx + 1} -->
                    <div style="border:2px solid var(--border);border-radius:12px;padding:20px;margin-bottom:16px;${acao.prioridade === 'CR√çTICA' ? 'border-color:#d32f2f;' : ''}">
                        <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px">
                            <div style="flex:1">
                                ${acao.prioridade === 'CR√çTICA' ? '<span style="background:#d32f2f;color:white;padding:4px 8px;border-radius:6px;font-size:0.75em;font-weight:700;margin-bottom:8px;display:inline-block">üî¥ CR√çTICO</span>' : '<span style="background:#ff9800;color:white;padding:4px 8px;border-radius:6px;font-size:0.75em;font-weight:700;margin-bottom:8px;display:inline-block">‚ö†Ô∏è IMPORTANTE</span>'}
                                <div style="font-size:1.3em;font-weight:700;margin-bottom:8px;margin-top:8px">A√á√ÉO #${idx + 1}: ${acao.titulo}</div>
                                <div style="color:var(--text-light)">${acao.descricao}</div>
                            </div>
                            <div style="text-align:right;margin-left:16px">
                                <div style="font-size:0.85em;color:var(--text-light)">ROI</div>
                                <div style="font-size:2em;font-weight:700;color:#00c853">${acao.roi}%</div>
                            </div>
                        </div>
                        
                        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;padding:16px;background:var(--bg);border-radius:8px;margin-top:16px">
                            <div>
                                <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">Investimento</div>
                                <div style="font-size:1.3em;font-weight:700">R$ ${formatarValor(acao.investimento)}</div>
                            </div>
                            <div>
                                <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">Retorno Anual</div>
                                <div style="font-size:1.3em;font-weight:700;color:#00c853">R$ ${formatarValor(acao.retornoAnual)}</div>
                            </div>
                            <div>
                                <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">Payback</div>
                                <div style="font-size:1.3em;font-weight:700;color:#2196f3">${acao.payback} meses ${parseFloat(acao.payback) < 3 ? 'üî•' : ''}</div>
                            </div>
                        </div>
                    </div>
                    `).join('');
                })()}
                    </div>
                    
                    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;padding:16px;background:var(--bg);border-radius:8px">
                        <div>
                            <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">Investimento</div>
                            <div style="font-size:1.3em;font-weight:700">R$ 1.500</div>
                        </div>
                        <div>
                            <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">Retorno Anual</div>
                            <div style="font-size:1.3em;font-weight:700;color:#00c853">R$ 11.280</div>
                        </div>
                        <div>
                            <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">Payback</div>
                            <div style="font-size:1.3em;font-weight:700;color:#2196f3">1.6 meses üî•</div>
                        </div>
                    </div>
                </div>
                
            </div>
            
                <!-- RESUMO TOTAL DIN√ÇMICO -->
                ${(() => {
                    const acoesROI = gerarAcoesROIDinamicas();
                    if (acoesROI.length > 0) {
                        const investimentoTotal = acoesROI.reduce((sum, a) => sum + a.investimento, 0);
                        const retornoTotal = acoesROI.reduce((sum, a) => sum + a.retornoAnual, 0);
                        const roiMedio = Math.round((retornoTotal / investimentoTotal) * 100);
                        
                        return `
                        <div style="background:linear-gradient(135deg,rgba(0,200,83,0.1),transparent);border:3px solid #00c853;border-radius:12px;padding:24px;margin-top:24px">
                            <div style="text-align:center;margin-bottom:16px">
                                <div style="font-size:1.1em;font-weight:700;color:var(--accent);margin-bottom:8px">üìä RESUMO CONSOLIDADO</div>
                                <div style="font-size:0.9em;color:var(--text-light)">Potencial total das ${acoesROI.length} a√ß√µes priorit√°rias identificadas</div>
                            </div>
                            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px">
                                <div style="text-align:center;padding:16px;background:rgba(255,255,255,0.5);border-radius:8px">
                                    <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">INVESTIMENTO TOTAL</div>
                                    <div style="font-size:1.5em;font-weight:700;color:var(--accent)">R$ ${formatarValor(investimentoTotal)}</div>
                                </div>
                                <div style="text-align:center;padding:16px;background:rgba(255,255,255,0.5);border-radius:8px">
                                    <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">RETORNO ANUAL</div>
                                    <div style="font-size:1.5em;font-weight:700;color:#00c853">R$ ${formatarValor(retornoTotal)}</div>
                                </div>
                                <div style="text-align:center;padding:16px;background:rgba(255,255,255,0.5);border-radius:8px">
                                    <div style="font-size:0.85em;color:var(--text-light);margin-bottom:4px">ROI M√âDIO</div>
                                    <div style="font-size:1.5em;font-weight:700;color:#00c853">${roiMedio}% üöÄ</div>
                                </div>
                            </div>
                            <div style="margin-top:20px;padding-top:20px;border-top:2px solid rgba(0,200,83,0.3);text-align:center">
                                <div style="font-size:1.3em;font-weight:700;color:#00c853">
                                    üí∞ Potencial de ganho: +R$ ${formatarValor(retornoTotal / 12)}/m√™s
                                </div>
                                <div style="font-size:0.9em;color:var(--text-light);margin-top:8px">
                                    Implementando as a√ß√µes priorit√°rias baseadas no seu diagn√≥stico
                                </div>
                            </div>
                        </div>
                        `;
                    }
                    return '';
                })()}
            </div>



                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 10</span>
                    </h4>
                    <textarea id="obs-secao-10" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_10', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>

            
            <!-- RECOMENDA√á√ÉO ESTRAT√âGICA -->
            <div class="card" style="background:linear-gradient(135deg,rgba(0,200,83,0.05),transparent);border:3px solid #00c853;border-radius:16px;padding:32px;margin-bottom:24px;margin-top:24px">
                <h2 style="color:#00c853;margin-bottom:24px;display:flex;align-items:center;gap:12px">
                    <span>üí°</span>
                    <span>RECOMENDA√á√ÉO ESTRAT√âGICA</span>
                </h2>
                
                <div style="background:white;border-radius:12px;padding:24px;margin-bottom:20px;border:2px solid #00c853">
                    <div style="font-weight:700;font-size:1.2em;margin-bottom:16px;color:#00c853">
                        üéØ Implemente PRIMEIRO as 3 a√ß√µes com:
                    </div>
                    <div style="display:grid;gap:12px;margin-left:24px">
                        <div style="display:flex;align-items:center;gap:8px">
                            <span style="color:#00c853;font-size:1.2em">‚úÖ</span>
                            <span style="font-weight:600">ROI acima de 500%</span>
                        </div>
                        <div style="display:flex;align-items:center;gap:8px">
                            <span style="color:#00c853;font-size:1.2em">‚úÖ</span>
                            <span style="font-weight:600">Payback abaixo de 2 meses</span>
                        </div>
                        <div style="display:flex;align-items:center;gap:8px">
                            <span style="color:#00c853;font-size:1.2em">‚úÖ</span>
                            <span style="font-weight:600">Alto impacto financeiro</span>
                        </div>
                    </div>
                </div>
                
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:24px">
                    <div style="background:rgba(211,47,47,0.1);border-left:5px solid #d32f2f;padding:20px;border-radius:8px">
                        <div style="font-size:0.85em;color:var(--text-light);margin-bottom:8px;font-weight:600">A√á√ÉO PRIORIT√ÅRIA #1</div>
                        <div style="font-size:1.3em;font-weight:700;color:#d32f2f;margin-bottom:8px">Otimizar Tribut√°ria</div>
                        <div style="display:flex;justify-content:space-between;margin-bottom:4px">
                            <span style="font-size:0.9em">ROI:</span>
                            <span style="font-weight:700;color:#00c853">890%</span>
                        </div>
                        <div style="display:flex;justify-content:space-between">
                            <span style="font-size:0.9em">Payback:</span>
                            <span style="font-weight:700;color:#2196f3">1.2 meses üî•</span>
                        </div>
                    </div>
                    
                    <div style="background:rgba(245,124,0,0.1);border-left:5px solid #f57c00;padding:20px;border-radius:8px">
                        <div style="font-size:0.85em;color:var(--text-light);margin-bottom:8px;font-weight:600">A√á√ÉO PRIORIT√ÅRIA #2</div>
                        <div style="font-size:1.3em;font-weight:700;color:#f57c00;margin-bottom:8px">Reduzir Inadimpl√™ncia</div>
                        <div style="display:flex;justify-content:space-between;margin-bottom:4px">
                            <span style="font-size:0.9em">ROI:</span>
                            <span style="font-weight:700;color:#00c853">650%</span>
                        </div>
                        <div style="display:flex;justify-content:space-between">
                            <span style="font-size:0.9em">Payback:</span>
                            <span style="font-weight:700;color:#2196f3">1.6 meses üî•</span>
                        </div>
                    </div>
                    
                    <div style="background:rgba(46,125,50,0.1);border-left:5px solid #2e7d32;padding:20px;border-radius:8px">
                        <div style="font-size:0.85em;color:var(--text-light);margin-bottom:8px;font-weight:600">A√á√ÉO PRIORIT√ÅRIA #3</div>
                        <div style="font-size:1.3em;font-weight:700;color:#2e7d32;margin-bottom:8px">Precifica√ß√£o Estrat√©gica</div>
                        <div style="display:flex;justify-content:space-between;margin-bottom:4px">
                            <span style="font-size:0.9em">ROI:</span>
                            <span style="font-weight:700;color:#00c853">520%</span>
                        </div>
                        <div style="display:flex;justify-content:space-between">
                            <span style="font-size:0.9em">Payback:</span>
                            <span style="font-weight:700;color:#2196f3">1.9 meses üî•</span>
                        </div>
                    </div>
                </div>
                
                <div style="background:linear-gradient(135deg,rgba(255,193,7,0.1),transparent);border:2px solid #FFC107;border-radius:12px;padding:24px">
                    <div style="font-weight:700;font-size:1.1em;margin-bottom:16px;color:#F57C00">
                        üìä Resultado Esperado em 90 Dias:
                    </div>
                    <div style="display:grid;gap:12px">
                        <div style="display:flex;align-items:center;gap:12px">
                            <span style="color:#00c853;font-size:1.5em">üí∞</span>
                            <span>
                                <strong style="color:#00c853;font-size:1.2em">+R$ 75.670/ano</strong>
                                <span style="color:var(--text-light);margin-left:8px">(43% do potencial total)</span>
                            </span>
                        </div>
                        <div style="display:flex;align-items:center;gap:12px">
                            <span style="color:#2196f3;font-size:1.5em">‚ö°</span>
                            <span>
                                <strong style="color:#2196f3">Retorno do investimento em 1.5 meses</strong>
                            </span>
                        </div>
                        <div style="display:flex;align-items:center;gap:12px">
                            <span style="color:#f57c00;font-size:1.5em">üöÄ</span>
                            <span>
                                <strong style="color:#f57c00">Base s√≥lida para implementa√ß√£o das pr√≥ximas a√ß√µes</strong>
                            </span>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top:24px;padding:20px;background:rgba(25,118,210,0.05);border-radius:8px;border-left:4px solid var(--accent)">
                    <div style="font-size:0.95em;line-height:1.6;color:var(--text)">
                        <strong>üí° Estrat√©gia Recomendada:</strong> Comece pelas 3 a√ß√µes de maior ROI e menor payback para gerar caixa rapidamente. 
                        Use os recursos gerados por essas a√ß√µes para financiar as demais implementa√ß√µes, criando um ciclo virtuoso de melhoria cont√≠nua.
                    </div>
                </div>
            </div>
            <!-- 11. PR√ìXIMOS PASSOS -->
            <div style="background:linear-gradient(135deg, rgba(255,167,38,0.1), transparent);border:3px solid var(--gold);border-radius:12px;padding:32px">
                <h2 style="color:var(--gold);margin-bottom:24px">11. PR√ìXIMOS PASSOS</h2>
                
                <div style="display:grid;gap:16px">
                    <div style="background:var(--card);padding:20px;border-radius:8px;border-left:5px solid #d32f2f">
                        <h4 style="color:#d32f2f;margin-bottom:12px">üìÖ ESTA SEMANA</h4>
                        <ul style="margin:0;padding-left:20px;color:var(--text)">
                            <li>Apresentar este relat√≥rio para s√≥cios/diretoria</li>
                            <li>Definir respons√°veis pelas a√ß√µes de 30 dias</li>
                            <li>Iniciar 3 a√ß√µes mais cr√≠ticas imediatamente</li>
                        </ul>
                    </div>
                    
                    <div style="background:var(--card);padding:20px;border-radius:8px;border-left:5px solid #f57c00">
                        <h4 style="color:#f57c00;margin-bottom:12px">üìÖ PR√ìXIMOS 30 DIAS</h4>
                        <ul style="margin:0;padding-left:20px;color:var(--text)">
                            <li>Executar 100% das a√ß√µes urgentes (30 dias)</li>
                            <li>Estabelecer rotina semanal de acompanhamento</li>
                            <li>Iniciar implementa√ß√£o das a√ß√µes de 60 dias</li>
                        </ul>
                    </div>
                    
                    <div style="background:var(--card);padding:20px;border-radius:8px;border-left:5px solid var(--accent)">
                        <h4 style="color:var(--accent);margin-bottom:12px">üí° RECOMENDA√á√ïES GERAIS</h4>
                        <ul style="margin:0;padding-left:20px;color:var(--text)">
                            <li>Realizar reuni√µes quinzenais de acompanhamento do plano</li>
                            <li>Refazer diagn√≥stico ap√≥s 90 dias para medir evolu√ß√£o</li>
                            <li>Considerar consultoria especializada para √°reas cr√≠ticas</li>
                            <li>Documentar processos √† medida que forem sendo estruturados</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- RODAP√â -->
            <div style="margin-top:32px;padding-top:24px;border-top:2px solid var(--border);text-align:center;color:var(--text-light);font-size:0.85em">

                <!-- CAMPO DE OBSERVA√á√ïES DO CONSULTOR -->
                <div style="background:rgba(255,193,7,0.1);border:2px dashed #FFC107;border-radius:12px;padding:24px;margin-top:24px">
                    <h4 style="color:#F57C00;margin-bottom:12px;display:flex;align-items:center;gap:8px">
                        <span>‚úèÔ∏è</span>
                        <span>OBSERVA√á√ïES DO CONSULTOR - Se√ß√£o 11</span>
                    </h4>
                    <textarea id="obs-secao-11" 
                              placeholder="Digite aqui suas observa√ß√µes, recomenda√ß√µes e insights espec√≠ficos sobre esta se√ß√£o..."
                              style="width:100%;min-height:120px;padding:16px;border:2px solid #FFC107;border-radius:8px;font-size:0.95em;font-family:inherit;resize:vertical;background:white"
                              onchange="localStorage.setItem('obs_secao_11', this.value)"></textarea>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                        üí° Estas observa√ß√µes ser√£o inclu√≠das no PDF gerado
                    </div>
                </div>
                <p>Relat√≥rio gerado automaticamente pelo <strong>Gestor Financeiro 360¬∞</strong></p>
                <p>Data: ${new Date().toLocaleDateString('pt-BR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>
            </div>
        </div>
    `;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CARREGAR OBSERVA√á√ïES SALVAS DOS CAMPOS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function carregarObservacoesSalvas() {
    for (let i = 1; i <= 11; i++) {
        const campo = document.getElementById(`obs-secao-${i}`);
        if (campo) {
            const valorSalvo = localStorage.getItem(`obs_secao_${i}`);
            if (valorSalvo) {
                campo.value = valorSalvo;
            }
        }
    }
    
    // Tamb√©m carregar nome da empresa e data
    const campoNome = document.getElementById('relatorio-nome-empresa');
    if (campoNome) {
        const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
        if (dados.nome) campoNome.value = dados.nome;
    }
}

// Executar quando o relat√≥rio for carregado
setTimeout(carregarObservacoesSalvas, 500);

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO PARA GERAR PDF DO RELAT√ìRIO HTML (html2pdf.js)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function gerarPDFdoRelatorioHTML() {
    try {
        // Pegar nome da empresa e data dos campos edit√°veis
        const nomeEmpresa = document.getElementById('relatorio-nome-empresa')?.value || 'Empresa';
        const dataRelatorio = document.getElementById('relatorio-data')?.value || new Date().toISOString().split('T')[0];
        
        // Loading
        const loading = document.createElement('div');
        loading.id = 'pdf-html-loading';
        loading.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(15,32,39,0.95);z-index:10000;display:flex;align-items:center;justify-content:center;';
        loading.innerHTML = `
            <div style="text-align:center;color:white;padding:60px;">
                <div style="font-size:80px;margin-bottom:30px;animation:pulse 1.5s infinite;">üìÑ</div>
                <div style="font-size:32px;font-weight:900;margin-bottom:20px;">
                    Gerando PDF do Relat√≥rio...
                </div>
                <div style="font-size:16px;opacity:0.8;">Aguarde, processando todas as se√ß√µes...</div>
            </div>
            <style>
                @keyframes pulse { 0%,100% {transform:scale(1);opacity:1} 50% {transform:scale(1.15);opacity:0.7} }
            </style>
        `;
        document.body.appendChild(loading);
        
        await new Promise(r => setTimeout(r, 500));
        
        // Elemento a ser convertido
        const elemento = document.getElementById('relatorio-executivo-completo');
        
        if (!elemento) {
            alert('‚ùå Elemento do relat√≥rio n√£o encontrado!');
            document.body.removeChild(loading);
            return;
        }
        
        // Configura√ß√µes do PDF
        const opt = {
            margin: [10, 10, 10, 10],
            filename: `Relatorio_Executivo_${nomeEmpresa.replace(/[^a-zA-Z0-9]/g, '_')}_${dataRelatorio}.pdf`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { 
                scale: 2,
                useCORS: true,
                logging: false,
                letterRendering: true
            },
            jsPDF: { 
                unit: 'mm', 
                format: 'a4', 
                orientation: 'landscape' 
            },
            pagebreak: { 
                mode: ['avoid-all', 'css', 'legacy'],
                before: '.page-break-before',
                after: '.page-break-after',
                avoid: [
                    '.no-break', 
                    '.card', 
                    'h1', 'h2', 'h3', 'h4',
                    'div[style*="border:2px solid"]',
                    'div[style*="border:3px solid"]',
                    'textarea',
                    'svg',
                    'table'
                ]
            }
        };
        
        // Gerar PDF
        await html2pdf().set(opt).from(elemento).save();
        
        // Remover loading
        document.body.removeChild(loading);
        
        // Sucesso
        alert('‚úÖ PDF do Relat√≥rio Executivo gerado com sucesso!\n\nO arquivo foi baixado automaticamente.');
        
    } catch (error) {
        console.error('‚ùå Erro ao gerar PDF:', error);
        const loading = document.getElementById('pdf-html-loading');
        if (loading) document.body.removeChild(loading);
        alert('‚ùå Erro ao gerar PDF: ' + error.message);
    }
}

function irPara(secao) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    
    document.getElementById(secao).classList.add('active');
    document.querySelector(`[onclick="irPara('${secao}')"]`)?.classList.add('active');
    
    const nomes = {
        inicio: 'Inicial',
        'dashboard-empresas': 'Dashboard de Empresas',
        'historico-diagnosticos': 'Hist√≥rico de Diagn√≥sticos',
        tesouraria: 'Tesouraria',
        resultados: 'Resultados',
        fluxo: 'Fluxo',
        orcamento: 'Or√ßamento',
        investimentos: 'Investimentos',
        riscos: 'Riscos',
        indicadores: 'Indicadores Financeiros',
        tributario: 'Planejamento Tribut√°rio',
        scoring: 'Score',
        swot: 'An√°lise SWOT',
        calculadora: 'Calculadora de Perdas & Ganhos',
        'analise-riscos': 'Mapa de Riscos',
        plano: 'Plano de A√ß√£o',
        okrs: 'OKRs',
        resumo: 'Resumo',
        'proposta-comercial': 'Proposta Comercial',
        'historico-propostas': 'Hist√≥rico de Propostas',
        ajuda: 'Central de Ajuda',
        ebook: 'Ebook Premium'
    };
    document.getElementById('page-name').textContent = nomes[secao] || secao;
    
    if (secao === 'tesouraria') document.getElementById('area-tesouraria').innerHTML = renderCategoria('tesouraria');
    if (secao === 'resultados') document.getElementById('area-resultados').innerHTML = renderCategoria('resultados');
    if (secao === 'fluxo') document.getElementById('area-fluxo').innerHTML = renderCategoria('fluxo');
    if (secao === 'orcamento') document.getElementById('area-orcamento').innerHTML = renderCategoria('orcamento');
    if (secao === 'investimentos') document.getElementById('area-investimentos').innerHTML = renderCategoria('investimentos');
    if (secao === 'riscos') document.getElementById('area-riscos').innerHTML = renderCategoria('riscos');
    if (secao === 'indicadores') document.getElementById('area-indicadores').innerHTML = renderCategoria('indicadores');
    if (secao === 'tributario') document.getElementById('area-tributario').innerHTML = renderCategoria('tributario');
    if (secao === 'historico-diagnosticos') setTimeout(() => renderHistoricoDiagnosticos(), 100);
    if (secao === 'scoring') document.getElementById('area-scoring').innerHTML = renderScoring();
    if (secao === 'swot') document.getElementById('area-swot').innerHTML = renderSWOT();
    if (secao === 'calculadora') document.getElementById('area-calculadora').innerHTML = renderCalculadora();
    if (secao === 'analise-riscos') document.getElementById('area-analise-riscos').innerHTML = renderAnaliseRiscos();
    if (secao === 'plano') document.getElementById('area-plano').innerHTML = renderPlano();
    if (secao === 'okrs') document.getElementById('area-okrs').innerHTML = renderOKRs();
    if (secao === 'resumo') document.getElementById('area-resumo').innerHTML = renderResumo();
    if (secao === 'proposta-comercial') {
        console.log('üíº Navegando para Proposta Comercial...');
        console.log('üîÑ Recarregando dados da empresa ativa...');
        if (typeof carregarDadosDiagnostico === 'function') {
            carregarDadosDiagnostico();
            console.log('‚úÖ Dados recarregados!');
        } else {
            console.error('‚ùå Fun√ß√£o carregarDadosDiagnostico n√£o encontrada!');
        }
    }
    if (secao === 'historico-propostas') {
        console.log('üîç Navegando para hist√≥rico de propostas...');
        setTimeout(() => {
            if (typeof inicializarHistorico === 'function') {
                console.log('‚úÖ Inicializando hist√≥rico...');
                inicializarHistorico();
            } else {
                console.error('‚ùå Fun√ß√£o inicializarHistorico n√£o encontrada!');
            }
        }, 100);
    }
    
    window.scrollTo(0, 0);
}

console.log('‚úÖ Checkpoint 3: irPara definida');

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO PARA ATUALIZAR INFO DO DIAGN√ìSTICO ADAPTATIVO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function atualizarInfoPorte() {
    const porte = document.getElementById('porte').value;
    const setor = document.getElementById('setor').value;
    const infoBox = document.getElementById('info-diagnostico');
    const infoPorteText = document.getElementById('info-porte');
    
    if (!porte || !setor) {
        infoBox.style.display = 'none';
        return;
    }
    
    // üéØ CALCULAR N√öMERO EXATO DE PERGUNTAS baseado em SETOR + PORTE
    const totalPerguntas = Object.keys(PERGUNTAS).filter(id => mostrarPergunta(id, porte, setor)).length;
    const tempoMin = Math.round(totalPerguntas * 0.4);
    const tempoMax = Math.round(totalPerguntas * 0.5);
    
    // Configura√ß√µes por porte
    const configs = {
        micro: {
            titulo: 'üìå Diagn√≥stico Essencial',
            subtitulo: 'Foco em sobreviv√™ncia, caixa e organiza√ß√£o m√≠nima',
            foco: 'Caixa e B√°sico'
        },
        pequena: {
            titulo: 'üìä Diagn√≥stico Profissional',
            subtitulo: 'Foco em estrutura√ß√£o, indicadores e contratos',
            foco: 'Crescimento'
        },
        media: {
            titulo: 'üè¢ Diagn√≥stico Estrat√©gico Completo',
            subtitulo: 'Avalia√ß√£o completa de todos os aspectos financeiros',
            foco: 'Excel√™ncia'
        }
    };
    
    const setorNomes = {
        comercio: 'üè™ Com√©rcio',
        servicos: 'üõ†Ô∏è Servi√ßos',
        industria: 'üè≠ Ind√∫stria'
    };
    
    const config = configs[porte];
    
    if (config) {
        infoBox.style.display = 'block';
        document.getElementById('titulo-diagnostico').textContent = config.titulo;
        document.getElementById('subtitulo-diagnostico').textContent = config.subtitulo;
        document.getElementById('info-perguntas').textContent = `${totalPerguntas} perguntas`;
        document.getElementById('info-tempo').textContent = `${tempoMin}-${tempoMax} min`;
        document.getElementById('info-foco').textContent = config.foco;
        
        // Mensagem personalizada mostrando SETOR + PORTE
        infoPorteText.textContent = `${totalPerguntas} perguntas adaptadas para ${setorNomes[setor] || setor} - ${config.titulo}`;
        
        // üî• NOVO: Atualizar badges das categorias IMEDIATAMENTE
        Object.keys(CATEGORIAS).forEach(cat => {
            const ids = CATEGORIAS[cat];
            const idsFiltrados = ids.filter(id => mostrarPergunta(id, porte, setor));
            const badge = document.getElementById(`badge-${cat}`);
            if (badge) {
                // Mostrar total de perguntas dessa categoria
                badge.textContent = `0/${idsFiltrados.length}`;
            }
        });
        
        console.log(`üìä Config atualizada: ${porte} + ${setor} = ${totalPerguntas} perguntas`);
    }
}

function iniciarDiagnostico() {
    const dados = {
        nome: document.getElementById('nome-empresa').value,
        responsavel: document.getElementById('responsavel').value,
        setor: document.getElementById('setor').value,
        porte: document.getElementById('porte').value,
        faturamento: document.getElementById('faturamento').value,
        cidade: document.getElementById('cidade').value
    };
    
    // Validar porte
    if (!dados.porte) {
        alert('‚ö†Ô∏è Por favor, selecione o PORTE da empresa para continuar!');
        return;
    }
    
    // Salvar dados e configura√ß√£o
    StorageEmpresa.setItem('diag_dados', JSON.stringify(dados));
    CONFIG_DIAGNOSTICO = {
        porte: dados.porte,
        setor: dados.setor
    };
    StorageEmpresa.setItem('diag_config', JSON.stringify(CONFIG_DIAGNOSTICO));
    
    // Calcular n√∫mero REAL de perguntas que ser√£o mostradas
    const totalPerguntas = Object.keys(PERGUNTAS).filter(id => mostrarPergunta(id, dados.porte, dados.setor)).length;
    
    // Mensagem personalizada
    const msgs = {
        micro: `üìå Diagn√≥stico Essencial iniciado!\n\n‚úÖ ${totalPerguntas} perguntas essenciais\n‚è±Ô∏è Tempo: ${Math.round(totalPerguntas*0.4)}-${Math.round(totalPerguntas*0.5)} min\nüéØ Foco: Caixa e Sobreviv√™ncia`,
        pequena: `üìä Diagn√≥stico Profissional iniciado!\n\n‚úÖ ${totalPerguntas} perguntas relevantes\n‚è±Ô∏è Tempo: ${Math.round(totalPerguntas*0.4)}-${Math.round(totalPerguntas*0.5)} min\nüéØ Foco: Estrutura√ß√£o e Crescimento`,
        media: `üè¢ Diagn√≥stico Estrat√©gico iniciado!\n\n‚úÖ ${totalPerguntas} perguntas completas\n‚è±Ô∏è Tempo: ${Math.round(totalPerguntas*0.4)}-${Math.round(totalPerguntas*0.5)} min\nüéØ Foco: Excel√™ncia Estrat√©gica`
    };
    
    alert(msgs[dados.porte] || 'Diagn√≥stico iniciado!');
    
    console.log('üöÄ DIAGN√ìSTICO INICIADO!');
    console.log(`   Porte: ${dados.porte}`);
    console.log(`   Setor: ${dados.setor}`);
    console.log(`   Total de perguntas: ${totalPerguntas}/90`);
    
    irPara('tesouraria');
}

function toggleTema() {
    const html = document.documentElement;
    const tema = html.getAttribute('data-theme');
    html.setAttribute('data-theme', tema === 'dark' ? '' : 'dark');
    localStorage.setItem('tema', tema === 'dark' ? '' : 'dark');
}

window.addEventListener('load', () => {
    const tema = localStorage.getItem('tema');
    if (tema) document.documentElement.setAttribute('data-theme', tema);
    
    const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
    if (dados.nome) {
        document.getElementById('nome-empresa').value = dados.nome;
        document.getElementById('responsavel').value = dados.responsavel || '';
        document.getElementById('setor').value = dados.setor || '';
        document.getElementById('porte').value = dados.porte || '';
        document.getElementById('faturamento').value = dados.faturamento || '';
        document.getElementById('cidade').value = dados.cidade || '';
    }
    
    atualizarProgress();
    
    // Verificar configura√ß√£o atual
    const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{"porte":"media","setor":"comercio"}');
    const totalPerguntas = Object.keys(PERGUNTAS).filter(id => mostrarPergunta(id, config.porte, config.setor)).length;
    
    console.log('üéâüéâüéâ GESTOR FINANCEIRO 360¬∞ - SISTEMA ADAPTATIVO COMPLETO! üéâüéâüéâ');
    console.log(`üìä CONFIGURA√á√ÉO: ${config.porte.toUpperCase()} + ${config.setor.toUpperCase()}`);
    console.log(`üìä TOTAL DE PERGUNTAS RELEVANTES: ${totalPerguntas}/90`);
    console.log('');
    console.log('üí° Para resetar: resetarDiagnostico()');
    console.log('üöÄ SISTEMA 100% FUNCIONAL!');
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO DE EXPORTA√á√ÉO PARA EXCEL - FORMATO MODELO DE IMPORTA√á√ÉO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function exportarExcel() {
    console.log('üìä Iniciando exporta√ß√£o para Excel no formato modelo...');
    
    try {
        const dados = JSON.parse(localStorage.getItem('dados') || '{}');
        const respostas = JSON.parse(localStorage.getItem('respostas') || '{}');
        
        // Gerar dados
        const acoes = gerarAcoesTimeline();
        const okrs = gerarOKRs();
        
        // ========================================
        // ABA 1: PLANO DE A√á√ÉO (5W2H)
        // ========================================
        
        const abaPlanoAcao = [];
        
        // Cabe√ßalho (exatamente como no modelo)
        abaPlanoAcao.push([
            'T√≠tulo da A√ß√£o',
            'O QUE (What)',
            'POR QUE (Why)',
            'QUEM (Who)',
            'ONDE (Where)',
            'QUANDO (When)',
            'COMO (How)',
            'QUANTO (How Much)',
            'Impacto Esperado',
            'Prioridade'
        ]);
        
        // Fun√ß√£o auxiliar para criar t√≠tulo curto
        const criarTitulo = (pergunta) => {
            // Pegar primeiras 4-5 palavras
            const palavras = pergunta.split(' ').slice(0, 5).join(' ');
            return palavras.length > 50 ? palavras.substring(0, 47) + '...' : palavras;
        };
        
        // Fun√ß√£o auxiliar para mapear prioridade
        const mapearPrioridade = (prazo) => {
            if (prazo === '30 DIAS') return 'Alta';
            if (prazo === '60 DIAS') return 'M√©dia';
            return 'Baixa';
        };
        
        // Adicionar a√ß√µes de 30 dias
        acoes.dias30.forEach(a => {
            abaPlanoAcao.push([
                criarTitulo(a.pergunta),                    // T√≠tulo
                a.acao,                                      // O QUE
                a.feedback,                                  // POR QUE
                '',                                          // QUEM (vazio)
                a.categoria,                                 // ONDE
                new Date(Date.now() + 30*24*60*60*1000).toLocaleDateString('pt-BR'),  // QUANDO
                a.acao,                                      // COMO (repetir a√ß√£o)
                'R$ 0',                                      // QUANTO (vazio)
                'Melhorar controle e reduzir riscos',       // IMPACTO
                'Alta'                                       // PRIORIDADE
            ]);
        });
        
        // Adicionar a√ß√µes de 60 dias
        acoes.dias60.forEach(a => {
            abaPlanoAcao.push([
                criarTitulo(a.pergunta),
                a.acao,
                a.feedback,
                '',
                a.categoria,
                new Date(Date.now() + 60*24*60*60*1000).toLocaleDateString('pt-BR'),
                a.acao,
                'R$ 0',
                'Estruturar processos financeiros',
                'M√©dia'
            ]);
        });
        
        // Adicionar a√ß√µes de 90 dias
        acoes.dias90.forEach(a => {
            abaPlanoAcao.push([
                criarTitulo(a.pergunta),
                a.acao,
                a.feedback,
                '',
                a.categoria,
                new Date(Date.now() + 90*24*60*60*1000).toLocaleDateString('pt-BR'),
                a.acao,
                'R$ 0',
                'Otimizar gest√£o financeira',
                'Baixa'
            ]);
        });
        
        // ========================================
        // ABA 2: OKRs
        // ========================================
        
        const abaOKRs = [];
        
        // Cabe√ßalho (exatamente como no modelo)
        abaOKRs.push([
            'Objetivo (Objective)',
            'Key Result 1',
            'Progresso KR1 (%)',
            'Key Result 2',
            'Progresso KR2 (%)',
            'Key Result 3',
            'Progresso KR3 (%)',
            'Key Result 4',
            'Progresso KR4 (%)'
        ]);
        
        // Adicionar cada OKR
        okrs.forEach(okr => {
            const linha = [okr.objective];
            
            // Adicionar at√© 4 Key Results
            for (let i = 0; i < 4; i++) {
                if (i < okr.keyResults.length) {
                    const kr = okr.keyResults[i];
                    linha.push(kr.descricao);  // Key Result
                    linha.push(0);              // Progresso (0%)
                } else {
                    linha.push('');             // KR vazio
                    linha.push('');             // Progresso vazio
                }
            }
            
            abaOKRs.push(linha);
        });
        
        // ========================================
        // ABA 3: INSTRU√á√ïES
        // ========================================
        
        const abaInstrucoes = [];
        
        abaInstrucoes.push(['üéØ MODELO DE IMPORTA√á√ÉO - PLANO DE A√á√ÉO & OKRs']);
        abaInstrucoes.push(['']);
        abaInstrucoes.push(['Este arquivo foi gerado pelo Gestor Financeiro 360¬∞ e est√° pronto para importa√ß√£o.']);
        abaInstrucoes.push(['']);
        abaInstrucoes.push(['üìã ESTRUTURA DO ARQUIVO:']);
        abaInstrucoes.push(['']);
        abaInstrucoes.push(['1Ô∏è‚É£ ABA \'Plano de A√ß√£o\' - Suas a√ß√µes estruturadas no formato 5W2H']);
        abaInstrucoes.push(['   ‚Ä¢ T√≠tulo da A√ß√£o: Nome resumido da a√ß√£o']);
        abaInstrucoes.push(['   ‚Ä¢ O QUE (What): O que ser√° feito']);
        abaInstrucoes.push(['   ‚Ä¢ POR QUE (Why): Justificativa/motivo']);
        abaInstrucoes.push(['   ‚Ä¢ QUEM (Who): Respons√°vel pela execu√ß√£o (preencher manualmente)']);
        abaInstrucoes.push(['   ‚Ä¢ ONDE (Where): Categoria/departamento']);
        abaInstrucoes.push(['   ‚Ä¢ QUANDO (When): Data de conclus√£o']);
        abaInstrucoes.push(['   ‚Ä¢ COMO (How): M√©todo de execu√ß√£o']);
        abaInstrucoes.push(['   ‚Ä¢ QUANTO (How Much): Custo estimado (preencher manualmente)']);
        abaInstrucoes.push(['   ‚Ä¢ Impacto Esperado: Resultado esperado']);
        abaInstrucoes.push(['   ‚Ä¢ Prioridade: Alta/M√©dia/Baixa']);
        abaInstrucoes.push(['']);
        abaInstrucoes.push(['2Ô∏è‚É£ ABA \'OKRs\' - Seus objetivos estrat√©gicos com Key Results']);
        abaInstrucoes.push(['   ‚Ä¢ Cada linha = 1 Objetivo com at√© 4 Key Results']);
        abaInstrucoes.push(['   ‚Ä¢ Progresso inicial: 0%']);
        abaInstrucoes.push(['']);
        abaInstrucoes.push(['‚úÖ PR√ìXIMOS PASSOS:']);
        abaInstrucoes.push(['   1. Revisar as a√ß√µes geradas']);
        abaInstrucoes.push(['   2. Preencher campo QUEM (respons√°veis)']);
        abaInstrucoes.push(['   3. Ajustar custos se necess√°rio (QUANTO)']);
        abaInstrucoes.push(['   4. Importar para seu sistema de gest√£o']);
        abaInstrucoes.push(['']);
        abaInstrucoes.push(['üìä Dados da Empresa:']);
        abaInstrucoes.push([`   ‚Ä¢ Nome: ${dados.nome || 'N√£o informado'}`]);
        abaInstrucoes.push([`   ‚Ä¢ Data de gera√ß√£o: ${new Date().toLocaleDateString('pt-BR')}`]);
        abaInstrucoes.push([`   ‚Ä¢ Total de a√ß√µes: ${acoes.dias30.length + acoes.dias60.length + acoes.dias90.length}`]);
        abaInstrucoes.push([`   ‚Ä¢ Total de OKRs: ${okrs.length}`]);
        
        // ========================================
        // CRIAR WORKBOOK E EXPORTAR
        // ========================================
        
        const wb = XLSX.utils.book_new();
        
        // Criar worksheets
        const ws1 = XLSX.utils.aoa_to_sheet(abaPlanoAcao);
        const ws2 = XLSX.utils.aoa_to_sheet(abaOKRs);
        const ws3 = XLSX.utils.aoa_to_sheet(abaInstrucoes);
        
        // Ajustar largura das colunas - Plano de A√ß√£o
        ws1['!cols'] = [
            {wch: 35},  // T√≠tulo
            {wch: 50},  // O QUE
            {wch: 50},  // POR QUE
            {wch: 30},  // QUEM
            {wch: 20},  // ONDE
            {wch: 12},  // QUANDO
            {wch: 50},  // COMO
            {wch: 15},  // QUANTO
            {wch: 30},  // IMPACTO
            {wch: 10}   // PRIORIDADE
        ];
        
        // Ajustar largura das colunas - OKRs
        ws2['!cols'] = [
            {wch: 50},  // Objetivo
            {wch: 50},  // KR1
            {wch: 12},  // Prog1
            {wch: 50},  // KR2
            {wch: 12},  // Prog2
            {wch: 50},  // KR3
            {wch: 12},  // Prog3
            {wch: 50},  // KR4
            {wch: 12}   // Prog4
        ];
        
        // Ajustar largura da coluna - Instru√ß√µes
        ws3['!cols'] = [{wch: 100}];
        
        // Adicionar abas (mesma ordem do modelo)
        XLSX.utils.book_append_sheet(wb, ws1, "Plano de A√ß√£o");
        XLSX.utils.book_append_sheet(wb, ws2, "OKRs");
        XLSX.utils.book_append_sheet(wb, ws3, "üìñ Instru√ß√µes");
        
        // Nome do arquivo
        const nomeEmpresa = dados.nome ? dados.nome.replace(/[^a-z0-9]/gi, '_') : 'Empresa';
        const nomeArquivo = `PlanoAcao_OKRs_${nomeEmpresa}_${new Date().toISOString().split('T')[0]}.xlsx`;
        
        // Exportar
        XLSX.writeFile(wb, nomeArquivo);
        
        console.log('‚úÖ Excel exportado com sucesso!');
        alert(`‚úÖ Excel exportado com sucesso!\n\nüìä Formato: Modelo de Importa√ß√£o\nüìã Plano de A√ß√£o: ${acoes.dias30.length + acoes.dias60.length + acoes.dias90.length} a√ß√µes\nüéØ OKRs: ${okrs.length} objetivos\n\nüí° Preencha os campos QUEM e QUANTO antes de importar!`);
        
    } catch (erro) {
        console.error('‚ùå Erro ao exportar Excel:', erro);
        alert('‚ùå Erro ao exportar Excel.\n\nVerifique o console para detalhes.');
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚úÖ‚úÖ‚úÖ CONFIRMA√á√ÉO FINAL DE CARREGAMENTO ‚úÖ‚úÖ‚úÖ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Fun√ß√£o para resetar diagn√≥stico (√∫til para testes)
window.resetarDiagnostico = function() {
    if (confirm('‚ö†Ô∏è Tem certeza que deseja resetar todo o diagn√≥stico?\n\nTodas as respostas ser√£o apagadas!')) {
        localStorage.removeItem('diag_resp');
        localStorage.removeItem('diag_dados');
        localStorage.removeItem('diag_config');
        alert('‚úÖ Diagn√≥stico resetado!\n\nRecarregue a p√°gina (F5) para come√ßar novamente.');
        location.reload();
    }
};

// Fun√ß√£o para verificar contagem de perguntas (debug)
window.verificarPerguntas = function() {
    const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{"porte":"media","setor":"comercio"}');
    console.log('');
    console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
    console.log('üîç VERIFICA√á√ÉO DE PERGUNTAS POR CATEGORIA');
    console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
    console.log(`Configura√ß√£o: ${config.porte.toUpperCase()} + ${config.setor.toUpperCase()}`);
    console.log('');
    
    let totalGeral = 0;
    Object.keys(CATEGORIAS).forEach(cat => {
        const ids = CATEGORIAS[cat];
        const filtrados = ids.filter(id => mostrarPergunta(id, config.porte, config.setor));
        totalGeral += filtrados.length;
        console.log(`${cat.toUpperCase()}: ${filtrados.length}/${ids.length} perguntas`);
    });
    
    console.log('');
    console.log(`üìä TOTAL: ${totalGeral}/90 perguntas`);
    console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
    console.log('');
};


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TOUR GUIADO (ONBOARDING) - INTRO.JS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function iniciarTourGuiado() {
    if (typeof introJs === 'undefined') {
        console.error('‚ùå Intro.js n√£o dispon√≠vel');
        return false;
    }
    
    const tourVisto = localStorage.getItem('tour_completo');
    if (tourVisto === 'true') {
        console.log('‚ÑπÔ∏è  Tour j√° foi visto');
        return false;
    }
    
    console.log('üéØ Iniciando Tour ULTRA IMPACTANTE...');
    
    const intro = introJs();
    intro.setOptions({
        steps: [
            // PASSO 1: ABERTURA
            {
                element: '.brand',
                intro: '<div style="text-align:center"><h2 style="margin:0 0 16px 0;font-size:1.8em">üíº Gestor Financeiro 360¬∞</h2><p style="font-size:1.1em;margin:0 0 12px 0">Plataforma de diagn√≥stico financeiro completa.</p><div style="background:rgba(255,255,255,0.15);padding:12px;border-radius:8px;margin:12px 0"><p style="margin:0 0 6px 0;font-weight:700">üìä Dados Sebrae 2024:</p><p style="margin:0"><b>60%</b> das PMEs fecham em 5 anos<br><b>82%</b> por m√° gest√£o financeira<br><b>R$ 180k/ano</b> em perdas evit√°veis</p></div><p style="font-size:1.2em;margin:12px 0 0 0;color:#4ade80;font-weight:700">Vamos mudar isso? üöÄ</p></div>',
                position: 'bottom'
            },
            
            // PASSO 2: DASHBOARD EMPRESAS
            {
                element: '.nav-item[onclick="irPara(\'dashboard-empresas\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üìä Dashboard Multi-Empresas</h3><p style="margin:0 0 10px 0">Gerencie <b>at√© 50 empresas</b> simultaneamente. Perfeito para contadores e consultores.</p><p style="color:#4ade80;font-weight:600;margin:0">üí∞ ROI: R$ 16.000/m√™s</p>',
                position: 'right'
            },
            
            // PASSO 3: TESOURARIA (CORRIGIDO!)
            {
                element: '.nav-item[onclick="irPara(\'tesouraria\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üí∞ Tesouraria</h3><p style="margin:0 0 10px 0">Primeira categoria: avalia controle de caixa, PF/PJ, concilia√ß√£o banc√°ria e inadimpl√™ncia.</p><p style="color:#4ade80;font-weight:600;margin:0">üìä Impacto: 40% menos inadimpl√™ncia</p>',
                position: 'right'
            },
            
            // PASSO 4: RESULTADOS & DRE
            {
                element: '.nav-item[onclick="irPara(\'resultados\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üìà Resultados & DRE</h3><p style="margin:0 0 10px 0">Margem de contribui√ß√£o, ponto de equil√≠brio e lucratividade l√≠quida.</p><p style="color:#ef4444;font-weight:600;margin:0">‚ö†Ô∏è 70% das PMEs calculam margem errado</p>',
                position: 'right'
            },
            
            // PASSO 5: FLUXO DE CAIXA
            {
                element: '.nav-item[onclick="irPara(\'fluxo\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üíµ Fluxo de Caixa</h3><p style="margin:0 0 10px 0">Proje√ß√£o 90 dias, capital de giro e reserva de seguran√ßa.</p><p style="color:#ef4444;font-weight:600;margin:0">üí° Empresa lucrativa pode quebrar por falta de caixa!</p>',
                position: 'right'
            },
            
            // PASSO 6: OR√áAMENTO
            {
                element: '.nav-item[onclick="irPara(\'orcamento\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üìä Or√ßamento</h3><p style="margin:0 0 10px 0">Or√ßamento anual, forecasting e precifica√ß√£o estrat√©gica.</p><p style="color:#4ade80;font-weight:600;margin:0">üéØ Apenas 30% das PMEs fazem or√ßamento formal</p>',
                position: 'right'
            },
            
            // PASSO 7: INVESTIMENTOS
            {
                element: '.nav-item[onclick="irPara(\'investimentos\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üöÄ Investimentos</h3><p style="margin:0 0 10px 0">An√°lise VPL/TIR, payback e fontes de financiamento.</p><p style="color:#4ade80;font-weight:600;margin:0">üìä Meta: ROI > 20%</p>',
                position: 'right'
            },
            
            // PASSO 8: RISCOS
            {
                element: '.nav-item[onclick="irPara(\'riscos\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üõ°Ô∏è Riscos Financeiros</h3><p style="margin:0 0 10px 0">Concentra√ß√£o de clientes, depend√™ncia de fornecedores e exposi√ß√£o cambial.</p><p style="color:#ef4444;font-weight:600;margin:0">üéØ Framework: Matriz Probabilidade √ó Impacto</p>',
                position: 'right'
            },
            
            // PASSO 9: INDICADORES
            {
                element: '.nav-item[onclick="irPara(\'indicadores\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üî¢ Indicadores (KPIs)</h3><p style="margin:0 0 10px 0">20 KPIs essenciais: Liquidez, ROE, EBITDA, ciclo financeiro.</p><p style="color:#4ade80;font-weight:600;margin:0">üí° Dashboard em tempo real</p>',
                position: 'right'
            },
            
            // PASSO 10: TRIBUT√ÅRIO
            {
                element: '.nav-item[onclick="irPara(\'tributario\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üìú Tribut√°rio</h3><p style="margin:0 0 10px 0">Regime √≥timo, recupera√ß√£o de cr√©ditos e incentivos fiscais.</p><p style="color:#4ade80;font-weight:600;margin:0">üéØ Potencial: Economia 15-30%</p>',
                position: 'right'
            },
            
            // PASSO 11: SCORE & DASHBOARD
            {
                element: '.nav-item[onclick="irPara(\'scoring\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üéØ Score & Dashboard</h3><p style="margin:0 0 10px 0">Nota 0-10 por categoria, gr√°fico radar e comparativo com mercado.</p><p style="color:#4ade80;font-weight:600;margin:0">‚ö° Resultados instant√¢neos</p>',
                position: 'right'
            },
            
            // PASSO 12: SWOT
            {
                element: '.nav-item[onclick="irPara(\'swot\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üìä An√°lise SWOT</h3><p style="margin:0 0 10px 0">For√ßas, Fraquezas, Oportunidades e Amea√ßas gerados automaticamente.</p><p style="color:#4ade80;font-weight:600;margin:0">üîß Framework McKinsey adaptado</p>',
                position: 'right'
            },
            
            // PASSO 13: CALCULADORA (DESTAQUE!)
            {
                element: '.nav-item[onclick="irPara(\'calculadora\')"]',
                intro: '<div style="text-align:center"><h3 style="font-size:1.4em;margin:0 0 10px 0">üí∞ Calculadora de Perdas</h3><p style="margin:0 0 12px 0"><b>O grande diferencial!</b> Quantifica perdas em R$ reais.</p><div style="background:rgba(239,68,68,0.2);padding:12px;border-radius:8px;border:2px solid #ef4444"><p style="font-size:1.1em;margin:0 0 8px 0;font-weight:700">üí∏ Perdas M√©dias:</p><p style="margin:0">R$ 45k controle<br>R$ 38k inadimpl√™ncia<br>R$ 52k custos ocultos<br>R$ 45k impostos</p><p style="font-size:1.5em;margin:10px 0 0 0;font-weight:700;color:#fff">R$ 180.000/ano</p></div></div>',
                position: 'right'
            },
            
            // PASSO 14: PLANO DE A√á√ÉO
            {
                element: '.nav-item[onclick="irPara(\'plano\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üéØ Plano de A√ß√£o</h3><p style="margin:0 0 10px 0"><b>Cora√ß√£o do sistema!</b> Top 20 a√ß√µes priorizadas por ROI. Exporta para Excel e integra com Plano PRO.</p>',
                position: 'right'
            },
            
            // PASSO 15: RELAT√ìRIO
            {
                element: '.nav-item[onclick="irPara(\'resumo\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üìÑ Relat√≥rio Executivo</h3><p style="margin:0 0 10px 0">PDF de <b>22 p√°ginas</b> com Executive Summary, an√°lises e recomenda√ß√µes.</p><p style="color:#4ade80;font-weight:600;margin:0">üíº Qualidade Big 4 Consulting</p>',
                position: 'right'
            },
            
            // PASSO 16: PROPOSTA
            {
                element: '.nav-item[onclick="irPara(\'proposta-comercial\')"]',
                intro: '<h3 style="font-size:1.3em;margin:0 0 10px 0">üíº Proposta Comercial</h3><p style="margin:0 0 10px 0">11 produtos hier√°rquicos, pre√ßos edit√°veis, pacotes com desconto. PDF de 12 p√°ginas.</p><p style="color:#4ade80;font-weight:600;margin:0">üìä +45% taxa de convers√£o</p>',
                position: 'right'
            },
            
            // PASSO 17: FINALIZA√á√ÉO
            {
                intro: '<div style="text-align:center"><h2 style="font-size:2em;margin:0 0 16px 0">üöÄ Pronto!</h2><p style="font-size:1.2em;margin:0 0 16px 0">Plataforma mais completa de diagn√≥stico financeiro do Brasil.</p><div style="background:rgba(102,126,234,0.2);padding:16px;border-radius:8px;border:2px solid #667eea"><div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:1.05em"><div style="text-align:left"><p style="margin:4px 0">‚úì 80 perguntas</p><p style="margin:4px 0">‚úì 8 categorias</p><p style="margin:4px 0">‚úì Score 0-10</p><p style="margin:4px 0">‚úì SWOT autom√°tica</p></div><div style="text-align:left"><p style="margin:4px 0">‚úì Calculadora R$</p><p style="margin:4px 0">‚úì Relat√≥rio 22 p√°g</p><p style="margin:4px 0">‚úì Proposta PDF</p><p style="margin:4px 0">‚úì 50 empresas</p></div></div></div><p style="font-size:1.4em;margin:16px 0 0 0;font-weight:700">Vamos come√ßar? üéØ</p></div>'
            }
        ],
        nextLabel: 'Pr√≥ximo ‚Üí',
        prevLabel: '‚Üê Anterior',
        doneLabel: 'Come√ßar! üöÄ',
        skipLabel: 'Pular',
        showProgress: true,
        showBullets: false,
        scrollToElement: true,
        scrollPadding: 30
    });
    
    intro.oncomplete(function() {
        localStorage.setItem('tour_completo', 'true');
        console.log('‚úÖ Tour conclu√≠do!');
    });
    
    intro.onexit(function() {
        localStorage.setItem('tour_completo', 'true');
        console.log('‚ÑπÔ∏è  Tour pulado');
    });
    
    intro.start();
    return true;
}

function verTourNovamente() {
    if (typeof introJs === 'undefined') {
        alert('Tour n√£o dispon√≠vel. Recarregue (Ctrl+Shift+R)');
        return;
    }
    
    localStorage.removeItem('tour_completo');
    iniciarTourGuiado();
}
document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('celebration');
    const backdrop = document.getElementById('celebration-backdrop');
    if (modal) modal.style.display = 'none';
    if (backdrop) backdrop.style.display = 'none';
    console.log('‚úÖ Modal de celebra√ß√£o inicializada (escondida)');
});

console.log('');
console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
console.log('‚úÖ‚úÖ‚úÖ JAVASCRIPT 100% CARREGADO COM SUCESSO! ‚úÖ‚úÖ‚úÖ');
console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üìÑ RELAT√ìRIO EXECUTIVO PREMIUM V11 - LAYOUT PROFISSIONAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function gerarRelatorioPDFPremium() {
    console.log('üéØ Gerando PDF PREMIUM V11...');
    
    try {
        // Loading Premium
        const loading = document.createElement('div');
        loading.id = 'pdf-loading-premium';
        loading.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#0f2027 0%,#203a43 50%,#2c5364 100%);z-index:10000;display:flex;align-items:center;justify-content:center;';
        loading.innerHTML = `
            <div style="text-align:center;color:white;padding:60px;">
                <div style="font-size:100px;margin-bottom:30px;animation:pulse 1.5s infinite;">üìä</div>
                <div style="font-size:38px;font-weight:900;margin-bottom:20px;background:linear-gradient(135deg,#00b894,#0984e3,#6c5ce7);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-size:200% auto;animation:shimmer 3s linear infinite;">
                    RELAT√ìRIO PREMIUM
                </div>
                <div style="font-size:20px;opacity:0.9;margin-bottom:40px;">Gerando 22 p√°ginas de an√°lise profunda...</div>
                <div style="width:400px;height:6px;background:rgba(255,255,255,0.2);border-radius:10px;overflow:hidden;margin:0 auto;">
                    <div id="progress-bar" style="width:0%;height:100%;background:linear-gradient(90deg,#00b894,#0984e3,#6c5ce7);transition:width 0.3s;"></div>
                </div>
                <div id="progress-text" style="margin-top:15px;font-size:14px;opacity:0.7;">Preparando documento...</div>
            </div>
            <style>
                @keyframes pulse { 0%,100% {transform:scale(1);opacity:1} 50% {transform:scale(1.15);opacity:0.8} }
                @keyframes shimmer { 0% {background-position:0% center} 100% {background-position:200% center} }
            </style>
        `;
        document.body.appendChild(loading);
        
        const updateProgress = (percent, text) => {
            const bar = document.getElementById('progress-bar');
            const txt = document.getElementById('progress-text');
            if (bar) bar.style.width = percent + '%';
            if (txt) txt.textContent = text || ('Gerando... ' + percent + '%');
        };
        
        await new Promise(r => setTimeout(r, 300));
        updateProgress(5, 'Carregando dados...');
        
        // Setup PDF
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'a4');
        const W = 210, H = 297;
        
        // Paleta de cores premium
        const C = {
            dark1: [15,32,39], dark2: [32,58,67], dark3: [44,83,100],
            blue: [9,132,227], purple: [108,92,231], green: [0,184,148],
            cyan: [0,206,201], orange: [243,156,18], yellow: [253,203,110],
            red: [231,76,60], txt: [51,51,51], light: [117,117,117],
            white: [255,255,255], bg: [248,249,250]
        };
        
        // Dados do sistema
        const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
        const resp = JSON.parse(localStorage.getItem('diag_resp') || '{}');
        const scores = calcularScoresPorCategoria(resp);
        const scoreGeral = Math.round((
            scores.tesouraria + scores.resultados + scores.fluxo + scores.orcamento + 
            scores.investimentos + scores.riscos + scores.indicadores + scores.tributario
        ) / 8);
        
        const faturamento = parseFloat(dados.faturamento || '1000000');
        const perdasAnuais = faturamento * 0.16;
        const percentil = Math.min(98, Math.max(15, scoreGeral + 25));
        
        updateProgress(10, 'Dados carregados - Gerando capa...');
        
        // Fun√ß√µes auxiliares
        const getScoreColor = (score) => {
            if (score >= 70) return C.green;
            if (score >= 50) return C.blue;
            if (score >= 30) return C.orange;
            return C.red;
        };
        
        const getScoreLabel = (score) => {
            if (score >= 90) return 'EXCELENTE';
            if (score >= 70) return 'BOM';
            if (score >= 50) return 'INTERMEDI√ÅRIO';
            if (score >= 30) return 'B√ÅSICO';
            return 'CR√çTICO';
        };
        
        const addPageNumber = (pageNum, total) => {
            doc.setFontSize(9);
            doc.setTextColor(...C.light);
            doc.text(`P√°gina ${pageNum} de ${total}`, W - 20, H - 10, {align: 'right'});
        };
        
        let pageCount = 1;
        const totalPages = 22;
        let y = 20;
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 1: CAPA PREMIUM
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        // Background gradiente escuro (3 layers)
        doc.setFillColor(...C.dark1); doc.rect(0, 0, W, H, 'F');
        doc.setFillColor(...C.dark2); doc.rect(0, 0, W, 240, 'F');
        doc.setFillColor(...C.dark3); doc.rect(0, 0, W, 180, 'F');
        
        // Faixa colorida no topo
        doc.setFillColor(...C.green); doc.rect(0, 0, 70, 8, 'F');
        doc.setFillColor(...C.blue); doc.rect(70, 0, 70, 8, 'F');
        doc.setFillColor(...C.purple); doc.rect(140, 0, 70, 8, 'F');
        
        // T√≠tulo principal
        y = 80;
        doc.setTextColor(...C.white);
        doc.setFontSize(52);
        doc.setFont('helvetica', 'bold');
        doc.text('RELAT√ìRIO', 105, y, {align: 'center'});
        
        y += 22;
        doc.setFontSize(48);
        doc.text('EXECUTIVO', 105, y, {align: 'center'});
        
        y += 22;
        doc.setFontSize(44);
        doc.text('PREMIUM', 105, y, {align: 'center'});
        
        y += 28;
        doc.setFontSize(22);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(220, 220, 220);
        doc.text('Diagn√≥stico Financeiro 360¬∞', 105, y, {align: 'center'});
        y += 8;
        doc.setFontSize(16);
        doc.text('An√°lise Completa de Maturidade Financeira', 105, y, {align: 'center'});
        
        // Score Box Grande
        y = 170;
        const scoreColor = getScoreColor(scoreGeral);
        doc.setFillColor(...scoreColor);
        doc.roundedRect(65, y, 80, 45, 8, 8, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(56);
        doc.setFont('helvetica', 'bold');
        doc.text(scoreGeral.toString(), 105, y + 28, {align: 'center'});
        doc.setFontSize(18);
        doc.text('/100', 125, y + 28);
        doc.setFontSize(20);
        doc.text(getScoreLabel(scoreGeral), 105, y + 40, {align: 'center'});
        
        // Badges
        y = 225;
        const badgeY = y;
        const badges = [
            {text: `Percentil ${percentil}¬∫`, color: C.green},
            {text: '80 Perguntas', color: C.blue},
            {text: '8 Categorias', color: C.purple}
        ];
        
        let badgeX = 35;
        badges.forEach(badge => {
            doc.setFillColor(...badge.color);
            doc.roundedRect(badgeX, badgeY, 45, 10, 3, 3, 'F');
            doc.setTextColor(...C.white);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'bold');
            doc.text(badge.text, badgeX + 22.5, badgeY + 6.5, {align: 'center'});
            badgeX += 50;
        });
        
        // Dados da empresa
        y = 245;
        doc.setFillColor(255, 255, 255, 0.1);
        doc.roundedRect(30, y, 150, 35, 6, 6, 'F');
        doc.setTextColor(240, 240, 240);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.text('EMPRESA:', 40, y + 10);
        doc.setFont('helvetica', 'normal');
        doc.text(dados.nome || 'N√£o informado', 40, y + 18);
        doc.setFont('helvetica', 'bold');
        doc.text('RESPONS√ÅVEL:', 40, y + 26);
        doc.setFont('helvetica', 'normal');
        doc.text(dados.responsavel || 'N√£o informado', 40, y + 34);
        
        // Rodap√© da capa
        y = 286;
        doc.setTextColor(180, 180, 180);
        doc.setFontSize(10);
        const hoje = new Date().toLocaleDateString('pt-BR', {day:'2-digit', month:'long', year:'numeric'});
        doc.text(`Relat√≥rio gerado em ${hoje}`, 105, y, {align: 'center'});
        y += 6;
        doc.setFontSize(11);
        doc.text('Gestor Financeiro 360¬∞ | Metodologia Propriet√°ria', 105, y, {align: 'center'});
        
        console.log('‚úÖ P√°gina 1: Capa');
        updateProgress(15, 'Capa conclu√≠da - Gerando √≠ndice...');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 2: √çNDICE
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage(); pageCount++;
        y = 20;
        
        doc.setFillColor(...C.blue);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.text('√çNDICE', 20, y + 9);
        
        y += 30;
        
        const indiceItens = [
            '01. Capa',
            '02. √çndice',
            '03. Sum√°rio Executivo',
            '04. Metodologia',
            '05. Scores Detalhados + Gr√°ficos',
            '06. Benchmark de Mercado',
            '07. Tesouraria',
            '08. Resultados & DRE',
            '09. Fluxo de Caixa',
            '10. Or√ßamento',
            '11. Investimentos',
            '12. Riscos Financeiros',
            '13. Indicadores de Performance',
            '14. Gest√£o Tribut√°ria',
            '15. An√°lise SWOT Completa',
            '16. OKRs Estrat√©gicos',
            '17. Perdas Identificadas',
            '18. Top 20 A√ß√µes Priorit√°rias',
            '19. Roadmap 12 Meses',
            '20. Scorecard de Qualidade',
            '21. Pr√≥ximos Passos',
            '22. Contatos & Metodologias'
        ];
        
        doc.setTextColor(...C.txt);
        doc.setFontSize(13);
        doc.setFont('helvetica', 'normal');
        
        indiceItens.forEach((item, i) => {
            if (y > 260) {
                doc.addPage(); pageCount++;
                y = 25;
            }
            
            doc.text(item, 25, y);
            
            // Linha pontilhada
            doc.setDrawColor(...C.light);
            doc.setLineWidth(0.3);
            for (let x = 120; x < 165; x += 3) {
                doc.line(x, y - 2, x + 1.5, y - 2);
            }
            
            // N√∫mero da p√°gina
            doc.text((i + 1).toString(), 175, y);
            y += 9;
        });
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 2: √çndice');
        updateProgress(20, '√çndice conclu√≠do - Gerando sum√°rio...');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 3: SUM√ÅRIO EXECUTIVO
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage(); pageCount++;
        y = 20;
        
        doc.setFillColor(...C.purple);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.text('SUM√ÅRIO EXECUTIVO', 20, y + 9);
        
        y += 30;
        
        // Box de destaque
        doc.setFillColor(...C.green);
        doc.roundedRect(20, y, 170, 35, 6, 6, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(16);
        doc.setFont('helvetica', 'bold');
        doc.text('üèÜ Performance Geral', 30, y + 12);
        doc.setFontSize(13);
        doc.setFont('helvetica', 'normal');
        doc.text(`Score: ${scoreGeral}/100 (${getScoreLabel(scoreGeral)}) | Percentil ${percentil}¬∫ do mercado`, 30, y + 22);
        doc.text(`Perdas Identificadas: R$ ${Math.round(perdasAnuais/1000)}k/ano | Potencial de Melhoria: 60-80%`, 30, y + 30);
        
        y += 45;
        
        // KPIs em cards
        doc.setTextColor(...C.txt);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('üìä Principais Indicadores', 20, y);
        y += 10;
        
        const kpis = [
            {label: 'Tesouraria', value: scores.tesouraria, unit: '/100'},
            {label: 'Resultados', value: scores.resultados, unit: '/100'},
            {label: 'Fluxo de Caixa', value: scores.fluxo, unit: '/100'},
            {label: 'Or√ßamento', value: scores.orcamento, unit: '/100'}
        ];
        
        let kpiX = 20;
        kpis.forEach(kpi => {
            const kpiColor = getScoreColor(kpi.value);
            doc.setFillColor(...C.bg);
            doc.setDrawColor(...kpiColor);
            doc.setLineWidth(1.5);
            doc.roundedRect(kpiX, y, 40, 28, 4, 4, 'FD');
            
            doc.setTextColor(...kpiColor);
            doc.setFontSize(24);
            doc.setFont('helvetica', 'bold');
            doc.text(kpi.value.toString(), kpiX + 20, y + 14, {align: 'center'});
            doc.setFontSize(10);
            doc.text(kpi.unit, kpiX + 30, y + 14);
            
            doc.setTextColor(...C.txt);
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.text(kpi.label, kpiX + 20, y + 24, {align: 'center'});
            
            kpiX += 43;
        });
        
        y += 38;
        
        // Resumo textual
        doc.setTextColor(...C.txt);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'normal');
        const resumo = `Este relat√≥rio apresenta uma an√°lise completa da maturidade financeira da empresa ${dados.nome || 'sua empresa'}, baseada em 80 perguntas distribu√≠das em 8 categorias fundamentais. O score geral de ${scoreGeral}/100 posiciona a organiza√ß√£o no percentil ${percentil}¬∫ do mercado, indicando um n√≠vel ${getScoreLabel(scoreGeral).toLowerCase()} de gest√£o financeira.`;
        const linhasResumo = doc.splitTextToSize(resumo, 170);
        doc.text(linhasResumo, 20, y);
        y += linhasResumo.length * 6 + 10;
        
        // Destaques
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('‚≠ê Principais Destaques', 20, y);
        y += 10;
        
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        const destaques = [
            `‚úì ${Object.keys(scores).reduce((a,b) => scores[a] > scores[b] ? a : b)} √© a categoria mais forte (${Math.max(...Object.values(scores))}/100)`,
            `‚ö† ${Object.keys(scores).reduce((a,b) => scores[a] < scores[b] ? a : b)} precisa de aten√ß√£o urgente (${Math.min(...Object.values(scores))}/100)`,
            `üí∞ Perdas anuais estimadas: R$ ${Math.round(perdasAnuais/1000)}k (${((perdasAnuais/faturamento)*100).toFixed(1)}% do faturamento)`,
            `üéØ 20 a√ß√µes priorit√°rias identificadas com potencial de impacto alto`
        ];
        
        destaques.forEach(destaque => {
            const linhas = doc.splitTextToSize(destaque, 165);
            doc.text(linhas, 25, y);
            y += linhas.length * 6 + 5;
        });
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 3: Sum√°rio Executivo');
        updateProgress(25, 'Sum√°rio conclu√≠do...');
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 4: METODOLOGIA
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage(); pageCount++;
        y = 20;
        
        doc.setFillColor(...C.orange);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.text('METODOLOGIA', 20, y + 9);
        
        y += 30;
        
        doc.setTextColor(...C.txt);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('üìã Sistema de Avalia√ß√£o', 20, y);
        y += 10;
        
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        const metodoTexto = [
            'O diagn√≥stico utiliza 80 perguntas estrat√©gicas distribu√≠das em 8 categorias fundamentais da gest√£o financeira empresarial. Cada resposta √© pontuada de 0 a 25 pontos, considerando quatro n√≠veis de maturidade:',
            '',
            '‚Ä¢ N√çVEL 1 (0-6 pts): Processo inexistente ou totalmente manual',
            '‚Ä¢ N√çVEL 2 (7-13 pts): Processo manual com consist√™ncia',
            '‚Ä¢ N√çVEL 3 (14-19 pts): Processo sistematizado com automa√ß√£o',
            '‚Ä¢ N√çVEL 4 (20-25 pts): Processo otimizado com IA e analytics'
        ];
        
        metodoTexto.forEach(linha => {
            if (linha === '') {
                y += 4;
            } else {
                const linhas = doc.splitTextToSize(linha, 170);
                doc.text(linhas, 20, y);
                y += linhas.length * 6 + 3;
            }
        });
        
        y += 5;
        
        // Tabela de escala
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('üìä Escala de Classifica√ß√£o', 20, y);
        y += 12;
        
        const escalas = [
            {faixa: '90-100', label: 'EXCELENTE', cor: C.green, desc: 'Classe mundial, benchmark'},
            {faixa: '70-89', label: 'BOM', cor: C.blue, desc: 'Acima da m√©dia, s√≥lido'},
            {faixa: '50-69', label: 'INTERMEDI√ÅRIO', cor: C.cyan, desc: 'Funcional, precisa evoluir'},
            {faixa: '30-49', label: 'B√ÅSICO', cor: C.orange, desc: 'M√≠nimo funcional, cr√≠tico'},
            {faixa: '0-29', label: 'CR√çTICO', cor: C.red, desc: 'Requer a√ß√£o imediata'}
        ];
        
        escalas.forEach(escala => {
            doc.setFillColor(...C.bg);
            doc.setDrawColor(...escala.cor);
            doc.setLineWidth(1);
            doc.roundedRect(20, y, 170, 12, 2, 2, 'FD');
            
            doc.setTextColor(...escala.cor);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text(escala.faixa, 25, y + 7.5);
            
            doc.setTextColor(...C.txt);
            doc.setFontSize(11);
            doc.text(escala.label, 55, y + 7.5);
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);
            doc.text(escala.desc, 115, y + 7.5);
            
            y += 14;
        });
        
        y += 5;
        
        // Fontes
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('üìö Benchmarks e Refer√™ncias', 20, y);
        y += 10;
        
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        const fontes = [
            '‚Ä¢ Sebrae: Indicadores de micro e pequenas empresas brasileiras',
            '‚Ä¢ IBGE: Estat√≠sticas de empresas e desempenho setorial',
            '‚Ä¢ Banco Central: Taxas, juros, spreads e inadimpl√™ncia',
            '‚Ä¢ BNDES: Estudos sobre gest√£o e produtividade empresarial',
            '‚Ä¢ FGV: Indicadores econ√¥micos e financeiros corporativos'
        ];
        
        fontes.forEach(fonte => {
            doc.text(fonte, 20, y);
            y += 6;
        });
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 4: Metodologia');
        updateProgress(30, 'Metodologia conclu√≠da...');
        
        // Continua na pr√≥xima mensagem...


        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 5: SCORES DETALHADOS + GR√ÅFICOS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage(); pageCount++;
        y = 20;
        
        doc.setFillColor(...C.purple);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.text('SCORES DETALHADOS', 20, y + 9);
        
        y += 30;
        
        // Gr√°fico de Radar (simulado com texto)
        doc.setFillColor(...C.bg);
        doc.roundedRect(20, y, 80, 80, 4, 4, 'F');
        doc.setTextColor(...C.txt);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.text('GR√ÅFICO RADAR', 60, y + 10, {align: 'center'});
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        doc.text('(Vis√£o 360¬∞ das 8 categorias)', 60, y + 16, {align: 'center'});
        
        // Simular radar com scores
        const categorias = [
            {nome: 'Tesouraria', score: scores.tesouraria},
            {nome: 'Resultados', score: scores.resultados},
            {nome: 'Fluxo', score: scores.fluxo},
            {nome: 'Or√ßamento', score: scores.orcamento},
            {nome: 'Investimentos', score: scores.investimentos},
            {nome: 'Riscos', score: scores.riscos},
            {nome: 'Indicadores', score: scores.indicadores},
            {nome: 'Tribut√°rio', score: scores.tributario}
        ];
        
        let radarY = y + 25;
        categorias.slice(0, 4).forEach(cat => {
            const barColor = getScoreColor(cat.score);
            doc.setTextColor(...C.txt);
            doc.setFontSize(8);
            doc.text(cat.nome, 25, radarY);
            
            doc.setFillColor(...barColor);
            const barWidth = (cat.score / 100) * 50;
            doc.roundedRect(25, radarY + 1, barWidth, 4, 1, 1, 'F');
            
            doc.setTextColor(...barColor);
            doc.setFont('helvetica', 'bold');
            doc.text(cat.score.toString(), 78, radarY + 4);
            
            radarY += 8;
        });
        
        radarY = y + 25;
        categorias.slice(4, 8).forEach(cat => {
            const barColor = getScoreColor(cat.score);
            doc.setTextColor(...C.txt);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(8);
            doc.text(cat.nome, 25, radarY + 40);
            
            doc.setFillColor(...barColor);
            const barWidth = (cat.score / 100) * 50;
            doc.roundedRect(25, radarY + 41, barWidth, 4, 1, 1, 'F');
            
            doc.setTextColor(...barColor);
            doc.setFont('helvetica', 'bold');
            doc.text(cat.score.toString(), 78, radarY + 44);
            
            radarY += 8;
        });
        
        // Gr√°fico de Barras
        doc.setFillColor(...C.bg);
        doc.roundedRect(110, y, 80, 80, 4, 4, 'F');
        doc.setTextColor(...C.txt);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.text('GR√ÅFICO DE BARRAS', 150, y + 10, {align: 'center'});
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        doc.text('(Comparativo entre categorias)', 150, y + 16, {align: 'center'});
        
        // Barras horizontais maiores
        let barY = y + 25;
        categorias.forEach(cat => {
            const barColor = getScoreColor(cat.score);
            doc.setTextColor(...C.txt);
            doc.setFontSize(7);
            doc.setFont('helvetica', 'normal');
            doc.text(cat.nome.substring(0, 8), 115, barY + 3);
            
            doc.setFillColor(...barColor);
            const barWidth = (cat.score / 100) * 60;
            doc.roundedRect(140, barY, barWidth, 5, 1, 1, 'F');
            
            doc.setTextColor(...barColor);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(7);
            doc.text(cat.score.toString(), 185, barY + 3.5);
            
            barY += 8;
        });
        
        y += 90;
        
        // Tabela de scores
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.txt);
        doc.text('üìä Tabela Detalhada de Scores', 20, y);
        y += 10;
        
        // Cabe√ßalho
        doc.setFillColor(...C.blue);
        doc.rect(20, y, 170, 10, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'bold');
        doc.text('Categoria', 25, y + 6);
        doc.text('Score', 120, y + 6, {align: 'center'});
        doc.text('Classifica√ß√£o', 150, y + 6);
        y += 10;
        
        // Linhas
        categorias.forEach((cat, i) => {
            if (i % 2 === 0) {
                doc.setFillColor(...C.bg);
                doc.rect(20, y, 170, 9, 'F');
            }
            
            const catColor = getScoreColor(cat.score);
            doc.setTextColor(...C.txt);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.text(cat.nome, 25, y + 6);
            
            doc.setTextColor(...catColor);
            doc.setFont('helvetica', 'bold');
            doc.text(cat.score.toString(), 120, y + 6, {align: 'center'});
            
            doc.setFont('helvetica', 'normal');
            doc.text(getScoreLabel(cat.score), 150, y + 6);
            
            y += 9;
        });
        
        // Total
        doc.setFillColor(...C.green);
        doc.rect(20, y, 170, 10, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'bold');
        doc.text('SCORE GERAL', 25, y + 6.5);
        doc.setFontSize(14);
        doc.text(scoreGeral.toString(), 120, y + 7, {align: 'center'});
        doc.setFontSize(11);
        doc.text(getScoreLabel(scoreGeral), 150, y + 6.5);
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 5: Scores + Gr√°ficos');
        updateProgress(35, 'Gr√°ficos conclu√≠dos...');
        

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 6: BENCHMARK DE MERCADO
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage(); pageCount++;
        y = 20;
        
        doc.setFillColor(...C.cyan);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.text('BENCHMARK DE MERCADO', 20, y + 9);
        
        y += 30;
        
        doc.setTextColor(...C.txt);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'normal');
        const benchText = `Compara√ß√£o com ${percentil >= 90 ? 'empresas de classe mundial' : percentil >= 70 ? 'empresas acima da m√©dia' : 'm√©dias do mercado brasileiro'} baseada em dados do Sebrae, IBGE e Banco Central.`;
        const benchLinhas = doc.splitTextToSize(benchText, 170);
        doc.text(benchLinhas, 20, y);
        y += benchLinhas.length * 6 + 12;
        
        // Tabela de benchmark
        const benchData = [
            {ind: 'Score Geral', sua: scoreGeral, top: 85, med: 55, perc: percentil, rat: scoreGeral >= 70 ? 'A' : scoreGeral >= 50 ? 'B' : 'C'},
            {ind: 'Tesouraria', sua: scores.tesouraria, top: 75, med: 50, perc: Math.min(98, scores.tesouraria + 20), rat: scores.tesouraria >= 70 ? 'A' : 'B'},
            {ind: 'Resultados', sua: scores.resultados, top: 80, med: 55, perc: Math.min(98, scores.resultados + 20), rat: scores.resultados >= 70 ? 'A' : 'B'},
            {ind: 'Fluxo de Caixa', sua: scores.fluxo, top: 70, med: 45, perc: Math.min(98, scores.fluxo + 20), rat: scores.fluxo >= 70 ? 'A' : 'B'},
            {ind: 'Or√ßamento', sua: scores.orcamento, top: 65, med: 40, perc: Math.min(98, scores.orcamento + 20), rat: scores.orcamento >= 70 ? 'A' : 'B'},
            {ind: 'Investimentos', sua: scores.investimentos, top: 60, med: 35, perc: Math.min(98, scores.investimentos + 15), rat: scores.investimentos >= 60 ? 'A' : 'C'},
            {ind: 'Riscos', sua: scores.riscos, top: 70, med: 45, perc: Math.min(98, scores.riscos + 20), rat: scores.riscos >= 70 ? 'A' : 'B'},
            {ind: 'Indicadores', sua: scores.indicadores, top: 75, med: 50, perc: Math.min(98, scores.indicadores + 20), rat: scores.indicadores >= 70 ? 'A' : 'B'}
        ];
        
        // Cabe√ßalho da tabela
        doc.setFillColor(...C.blue);
        doc.rect(20, y, 170, 12, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'bold');
        doc.text('Indicador', 25, y + 7.5);
        doc.text('Sua Empresa', 75, y + 7.5, {align: 'center'});
        doc.text('Top 25%', 110, y + 7.5, {align: 'center'});
        doc.text('M√©dia', 140, y + 7.5, {align: 'center'});
        doc.text('Perc.', 165, y + 7.5, {align: 'center'});
        doc.text('Rat.', 185, y + 7.5, {align: 'center'});
        y += 12;
        
        // Linhas da tabela
        benchData.forEach((row, i) => {
            if (i % 2 === 0) {
                doc.setFillColor(...C.bg);
                doc.rect(20, y, 170, 10, 'F');
            }
            
            doc.setTextColor(...C.txt);
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.text(row.ind, 25, y + 6.5);
            
            const scoreColor = getScoreColor(row.sua);
            doc.setTextColor(...scoreColor);
            doc.setFont('helvetica', 'bold');
            doc.text(row.sua.toString(), 75, y + 6.5, {align: 'center'});
            
            doc.setTextColor(...C.txt);
            doc.setFont('helvetica', 'normal');
            doc.text(row.top.toString(), 110, y + 6.5, {align: 'center'});
            doc.text(row.med.toString(), 140, y + 6.5, {align: 'center'});
            
            doc.setTextColor(...scoreColor);
            doc.setFont('helvetica', 'bold');
            doc.text(`${row.perc}¬∫`, 165, y + 6.5, {align: 'center'});
            doc.text(row.rat, 185, y + 6.5, {align: 'center'});
            
            y += 10;
        });
        
        // Linha de total
        doc.setFillColor(...C.green);
        doc.rect(20, y, 170, 12, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'bold');
        doc.text('SCORE M√âDIO PONDERADO', 25, y + 7.5);
        doc.setFontSize(13);
        doc.text(scoreGeral.toString(), 75, y + 8, {align: 'center'});
        doc.setFontSize(11);
        doc.text(`${percentil}¬∫`, 165, y + 7.5, {align: 'center'});
        doc.text('A+', 185, y + 7.5, {align: 'center'});
        
        y += 20;
        
        // Interpreta√ß√£o
        doc.setFillColor(240, 255, 240);
        doc.roundedRect(20, y, 170, 35, 4, 4, 'F');
        doc.setTextColor(...C.txt);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.text('üí° Interpreta√ß√£o', 30, y + 10);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        const interpTexto = scoreGeral >= 70 
            ? 'Sua empresa est√° no top 25% do mercado, com processos maduros e bem estruturados. Foco em otimiza√ß√£o e inova√ß√£o.'
            : scoreGeral >= 50
            ? 'Sua empresa est√° acima da m√©dia, mas h√° espa√ßo significativo para evolu√ß√£o. Priorize as categorias cr√≠ticas.'
            : 'Sua empresa precisa de melhorias urgentes em m√∫ltiplas √°reas. Implemente as a√ß√µes priorit√°rias imediatamente.';
        const interpLinhas = doc.splitTextToSize(interpTexto, 160);
        doc.text(interpLinhas, 30, y + 18);
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 6: Benchmark');
        updateProgress(40, 'Benchmark conclu√≠do...');
        

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINAS 7-14: AN√ÅLISE POR CATEGORIA (8 p√°ginas)
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        const catsDetalhe = [
            {nome: 'TESOURARIA', score: scores.tesouraria, cor: C.blue, icon: 'üí∞', 
             desc: 'Gest√£o de caixa, bancos, contas a pagar e receber, concilia√ß√£o banc√°ria.'},
            {nome: 'RESULTADOS & DRE', score: scores.resultados, cor: C.purple, icon: 'üìà', 
             desc: 'Demonstra√ß√£o de resultados, margem, custos, an√°lise de rentabilidade.'},
            {nome: 'FLUXO DE CAIXA', score: scores.fluxo, cor: C.cyan, icon: 'üíµ', 
             desc: 'Proje√ß√µes, controle de entradas e sa√≠das, capital de giro.'},
            {nome: 'OR√áAMENTO', score: scores.orcamento, cor: C.orange, icon: 'üìä', 
             desc: 'Planejamento or√ßament√°rio, controle, varia√ß√µes, ajustes.'},
            {nome: 'INVESTIMENTOS', score: scores.investimentos, cor: C.green, icon: 'üöÄ', 
             desc: 'An√°lise de investimentos, ROI, payback, viabilidade econ√¥mica.'},
            {nome: 'RISCOS FINANCEIROS', score: scores.riscos, cor: C.red, icon: '‚ö†Ô∏è', 
             desc: 'Identifica√ß√£o, mensura√ß√£o e mitiga√ß√£o de riscos empresariais.'},
            {nome: 'INDICADORES DE PERFORMANCE', score: scores.indicadores, cor: C.yellow, icon: 'üìâ', 
             desc: 'KPIs, dashboards, m√©tricas de acompanhamento e an√°lise.'},
            {nome: 'GEST√ÉO TRIBUT√ÅRIA', score: scores.tributario, cor: C.purple, icon: 'üìã', 
             desc: 'Compliance fiscal, planejamento tribut√°rio, otimiza√ß√£o de impostos.'}
        ];
        
        catsDetalhe.forEach((cat, idx) => {
            doc.addPage(); pageCount++;
            y = 20;
            
            doc.setFillColor(...cat.cor);
            doc.rect(0, y - 5, W, 20, 'F');
            doc.setTextColor(...C.white);
            doc.setFontSize(26);
            doc.setFont('helvetica', 'bold');
            doc.text(`${cat.icon} ${cat.nome}`, 20, y + 9);
            
            y += 28;
            
            // Score box
            const scoreColor = getScoreColor(cat.score);
            doc.setFillColor(...scoreColor);
            doc.roundedRect(20, y, 70, 35, 5, 5, 'F');
            doc.setTextColor(...C.white);
            doc.setFontSize(48);
            doc.setFont('helvetica', 'bold');
            doc.text(cat.score.toString(), 55, y + 20, {align: 'center'});
            doc.setFontSize(16);
            doc.text('/100', 70, y + 20);
            doc.setFontSize(18);
            doc.text(getScoreLabel(cat.score), 55, y + 30, {align: 'center'});
            
            // Descri√ß√£o
            doc.setFillColor(...C.bg);
            doc.roundedRect(95, y, 95, 35, 5, 5, 'F');
            doc.setTextColor(...C.txt);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('Sobre esta categoria:', 100, y + 10);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);
            const descLinhas = doc.splitTextToSize(cat.desc, 85);
            doc.text(descLinhas, 100, y + 18);
            
            y += 45;
            
            // An√°lise
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('üìã An√°lise Detalhada', 20, y);
            y += 10;
            
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            const analises = cat.score >= 70
                ? [
                    '‚úì Processos bem estruturados e documentados',
                    '‚úì Automa√ß√£o implementada em grande parte das atividades',
                    '‚úì Indicadores acompanhados regularmente',
                    '‚≠ê Foco: Otimiza√ß√£o cont√≠nua e ado√ß√£o de IA/analytics'
                  ]
                : cat.score >= 50
                ? [
                    '‚úì Processos funcionais mas com espa√ßo para melhoria',
                    '‚ö† Automa√ß√£o parcial, muitas atividades ainda manuais',
                    '‚ö† Indicadores existem mas n√£o s√£o acompanhados sistematicamente',
                    'üéØ Foco: Sistematizar processos e aumentar automa√ß√£o'
                  ]
                : [
                    '‚ö† Processos predominantemente manuais',
                    '‚ö† Falta de padroniza√ß√£o e documenta√ß√£o',
                    '‚ö† Indicadores inexistentes ou n√£o utilizados',
                    'üö® Foco: Implementa√ß√£o urgente de controles b√°sicos'
                  ];
            
            analises.forEach(linha => {
                doc.text(linha, 25, y);
                y += 7;
            });
            
            y += 5;
            
            // Principais Riscos
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('‚ö†Ô∏è Principais Riscos Identificados', 20, y);
            y += 10;
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            const riscos = cat.score < 50
                ? [
                    '‚Ä¢ Alto risco de erros operacionais por falta de automa√ß√£o',
                    '‚Ä¢ Perda de oportunidades por falta de visibilidade',
                    '‚Ä¢ Dificuldade em tomada de decis√µes estrat√©gicas'
                  ]
                : cat.score < 70
                ? [
                    '‚Ä¢ Risco m√©dio de inefici√™ncias operacionais',
                    '‚Ä¢ Oportunidades n√£o capturadas por falta de analytics',
                    '‚Ä¢ Processos podem falhar sob press√£o'
                  ]
                : [
                    '‚Ä¢ Risco baixo, processos maduros',
                    '‚Ä¢ Pequenas melhorias em otimiza√ß√£o',
                    '‚Ä¢ Manter evolu√ß√£o tecnol√≥gica'
                  ];
            
            riscos.forEach(risco => {
                doc.text(risco, 25, y);
                y += 6;
            });
            
            y += 8;
            
            // Top 3 A√ß√µes
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('üéØ Top 3 A√ß√µes Priorit√°rias', 20, y);
            y += 10;
            
            const acoes = cat.score < 50
                ? [
                    {num: '1', acao: 'Implementar controles b√°sicos e padroniza√ß√£o', prazo: '30 dias', impact: 'ALTO'},
                    {num: '2', acao: 'Capacitar equipe em processos essenciais', prazo: '60 dias', impact: 'ALTO'},
                    {num: '3', acao: 'Definir indicadores m√≠nimos de acompanhamento', prazo: '90 dias', impact: 'M√âDIO'}
                  ]
                : cat.score < 70
                ? [
                    {num: '1', acao: 'Automatizar processos manuais cr√≠ticos', prazo: '60 dias', impact: 'ALTO'},
                    {num: '2', acao: 'Implementar dashboards de acompanhamento', prazo: '90 dias', impact: 'M√âDIO'},
                    {num: '3', acao: 'Revisar e otimizar processos existentes', prazo: '120 dias', impact: 'M√âDIO'}
                  ]
                : [
                    {num: '1', acao: 'Implementar analytics avan√ßado e IA', prazo: '90 dias', impact: 'M√âDIO'},
                    {num: '2', acao: 'Benchmarking externo e best practices', prazo: '120 dias', impact: 'BAIXO'},
                    {num: '3', acao: 'Inova√ß√£o em processos e tecnologia', prazo: '180 dias', impact: 'BAIXO'}
                  ];
            
            acoes.forEach(acao => {
                doc.setFillColor(...C.bg);
                doc.roundedRect(20, y, 170, 18, 3, 3, 'F');
                
                // N√∫mero
                doc.setFillColor(...cat.cor);
                doc.circle(28, y + 9, 6, 'F');
                doc.setTextColor(...C.white);
                doc.setFontSize(12);
                doc.setFont('helvetica', 'bold');
                doc.text(acao.num, 28, y + 11, {align: 'center'});
                
                // A√ß√£o
                doc.setTextColor(...C.txt);
                doc.setFontSize(10);
                doc.setFont('helvetica', 'normal');
                doc.text(acao.acao, 38, y + 9);
                
                // Prazo e impacto
                doc.setFontSize(8);
                doc.setTextColor(...C.light);
                doc.text(`Prazo: ${acao.prazo}`, 38, y + 15);
                
                const impactColor = acao.impact === 'ALTO' ? C.red : acao.impact === 'M√âDIO' ? C.orange : C.green;
                doc.setTextColor(...impactColor);
                doc.setFont('helvetica', 'bold');
                doc.text(`Impacto: ${acao.impact}`, 100, y + 15);
                
                y += 20;
            });
            
            addPageNumber(pageCount, totalPages);
            console.log(`‚úÖ P√°gina ${pageCount}: ${cat.nome}`);
            updateProgress(40 + ((idx + 1) * 3), `Categoria ${idx + 1}/8 conclu√≠da...`);
        });
        

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 15: AN√ÅLISE SWOT COMPLETA (40 ITENS)
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage(); pageCount++;
        y = 20;
        
        doc.setFillColor(...C.purple);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.text('AN√ÅLISE SWOT COMPLETA', 20, y + 9);
        
        y += 25;
        
        const swot = {
            forcas: [
                'Score geral s√≥lido comparado ao mercado',
                'Processos financeiros minimamente estruturados',
                'Capacidade de gerar e analisar relat√≥rios',
                'Equipe com conhecimento do neg√≥cio',
                'Hist√≥rico de faturamento consistente',
                'Relacionamento estabelecido com clientes',
                'Dados financeiros dispon√≠veis para an√°lise',
                'Gest√£o ativa e envolvida',
                'Flexibilidade para implementar melhorias',
                'Potencial de crescimento identificado'
            ],
            fraquezas: [
                'Processos manuais em v√°rias √°reas cr√≠ticas',
                'Falta de automa√ß√£o e integra√ß√£o de sistemas',
                'Indicadores n√£o acompanhados sistematicamente',
                'Aus√™ncia de planejamento or√ßament√°rio robusto',
                'An√°lise de investimentos n√£o estruturada',
                'Gest√£o de riscos insuficiente',
                'Perdas financeiras n√£o mensuradas regularmente',
                'Falta de visibilidade em tempo real',
                'Depend√™ncia de planilhas e processos ad-hoc',
                'Capacita√ß√£o limitada em gest√£o financeira avan√ßada'
            ],
            oportunidades: [
                'Implementar ERP/sistema integrado de gest√£o',
                'Automatizar processos repetitivos e manuais',
                'Reduzir perdas em 60-80% com controles adequados',
                'Melhorar margem atrav√©s de an√°lise de custos',
                'Otimizar capital de giro e reduzir necessidade de caixa',
                'Expandir para novos mercados com base em dados',
                'Implementar BI e analytics para decis√µes',
                'Profissionalizar gest√£o financeira',
                'Capacitar equipe em ferramentas modernas',
                'Buscar linhas de cr√©dito mais vantajosas'
            ],
            ameacas: [
                'Concorrentes com gest√£o mais madura',
                'Perda de competitividade por inefici√™ncia',
                'Crise de liquidez por falta de controle',
                'Erros cr√≠ticos em decis√µes financeiras',
                'Inadimpl√™ncia crescente sem controles',
                'Mudan√ßas tribut√°rias sem planejamento',
                'Perda de oportunidades de crescimento',
                'Dificuldade em acessar cr√©dito',
                'Turnover por processos ruins',
                'Tecnologia ficando obsoleta rapidamente'
            ]
        };
        
        const swotConfig = [
            {titulo: 'FOR√áAS (S)', itens: swot.forcas, cor: C.green, icon: 'üí™'},
            {titulo: 'FRAQUEZAS (W)', itens: swot.fraquezas, cor: C.red, icon: '‚ö†Ô∏è'},
            {titulo: 'OPORTUNIDADES (O)', itens: swot.oportunidades, cor: C.blue, icon: 'üéØ'},
            {titulo: 'AMEA√áAS (T)', itens: swot.ameacas, cor: C.orange, icon: '‚ö°'}
        ];
        
        // Desenhar SWOT em 2 colunas
        let swotX = 20;
        let swotY = y;
        let colCount = 0;
        
        swotConfig.forEach((quadrante, idx) => {
            // Nova linha a cada 2 quadrantes
            if (idx === 2) {
                swotY += 128;
                swotX = 20;
            }
            
            const boxW = 85;
            const boxH = 125;
            
            // Cabe√ßalho do quadrante
            doc.setFillColor(...quadrante.cor);
            doc.roundedRect(swotX, swotY, boxW, 12, 2, 2, 'F');
            doc.setTextColor(...C.white);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text(`${quadrante.icon} ${quadrante.titulo}`, swotX + boxW/2, swotY + 8, {align: 'center'});
            
            // Background do box
            doc.setFillColor(...C.bg);
            doc.roundedRect(swotX, swotY + 12, boxW, boxH - 12, 2, 2, 'F');
            
            // Itens (10 por quadrante)
            doc.setTextColor(...C.txt);
            doc.setFontSize(7.5);
            doc.setFont('helvetica', 'normal');
            let itemY = swotY + 18;
            
            quadrante.itens.forEach((item, i) => {
                // Bullet point
                doc.setTextColor(...quadrante.cor);
                doc.setFont('helvetica', 'bold');
                doc.text('‚Ä¢', swotX + 3, itemY);
                
                // Texto do item
                doc.setTextColor(...C.txt);
                doc.setFont('helvetica', 'normal');
                const itemLinhas = doc.splitTextToSize(item, boxW - 10);
                doc.text(itemLinhas, swotX + 6, itemY);
                itemY += (itemLinhas.length * 3) + 6;
            });
            
            swotX += boxW + 5;
        });
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 15: SWOT Completa (40 itens)');
        updateProgress(70, 'SWOT conclu√≠da...');
        

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 16: OKRs ESTRAT√âGICOS COMPLETOS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage(); pageCount++;
        y = 20;
        
        doc.setFillColor(...C.blue);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.text('OKRs ESTRAT√âGICOS', 20, y + 9);
        
        y += 28;
        
        doc.setTextColor(...C.txt);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        doc.text('Objetivos e Resultados-Chave para os pr√≥ximos 6-12 meses', 20, y);
        y += 12;
        
        const okrs = [
            {
                objetivo: 'üéØ O1: Aumentar Visibilidade e Controle Financeiro',
                cor: C.blue,
                krs: [
                    'KR1: Implementar dashboard em tempo real (100% das categorias)',
                    'KR2: Reduzir tempo de fechamento mensal de 15 para 5 dias',
                    'KR3: Atingir 95% de acur√°cia nos relat√≥rios financeiros'
                ]
            },
            {
                objetivo: 'üí∞ O2: Reduzir Perdas e Melhorar Margens',
                cor: C.green,
                krs: [
                    'KR1: Reduzir inadimpl√™ncia de 16% para 6% do faturamento',
                    'KR2: Aumentar margem l√≠quida em 5 pontos percentuais',
                    'KR3: Eliminar 80% das perdas por falta de controle'
                ]
            },
            {
                objetivo: 'üìä O3: Profissionalizar Gest√£o Financeira',
                cor: C.purple,
                krs: [
                    'KR1: Treinar 100% da equipe em processos financeiros',
                    'KR2: Automatizar 70% dos processos manuais cr√≠ticos',
                    'KR3: Certificar empresa em ISO 9001 ou similar'
                ]
            },
            {
                objetivo: 'üöÄ O4: Estruturar Planejamento Estrat√©gico',
                cor: C.orange,
                krs: [
                    'KR1: Criar or√ßamento anual com revis√µes trimestrais',
                    'KR2: Implementar an√°lise de viabilidade para todos investimentos',
                    'KR3: Definir e acompanhar 15 KPIs estrat√©gicos mensalmente'
                ]
            }
        ];
        
        okrs.forEach(okr => {
            // Box do objetivo
            doc.setFillColor(...okr.cor);
            doc.roundedRect(20, y, 170, 12, 3, 3, 'F');
            doc.setTextColor(...C.white);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text(okr.objetivo, 25, y + 8);
            
            y += 14;
            
            // KRs
            doc.setTextColor(...C.txt);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            okr.krs.forEach(kr => {
                doc.setFillColor(...C.bg);
                doc.roundedRect(25, y, 165, 8, 2, 2, 'F');
                
                doc.setTextColor(...okr.cor);
                doc.setFont('helvetica', 'bold');
                doc.text('‚Ä¢', 30, y + 5);
                
                doc.setTextColor(...C.txt);
                doc.setFont('helvetica', 'normal');
                const krLinhas = doc.splitTextToSize(kr, 155);
                doc.text(krLinhas, 35, y + 5);
                
                y += (krLinhas.length * 4) + 4;
            });
            
            y += 8;
        });
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 16: OKRs Completos');
        updateProgress(75, 'OKRs conclu√≠dos...');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINAS 17-22: FINALIZANDO
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        // P√ÅGINA 17: PERDAS IDENTIFICADAS
        doc.addPage(); pageCount++;
        y = 20;
        
        doc.setFillColor(...C.red);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(26);
        doc.setFont('helvetica', 'bold');
        doc.text('üí∏ PERDAS IDENTIFICADAS', 20, y + 9);
        
        y += 30;
        
        const perdas = [
            {tipo: 'Inadimpl√™ncia', perc: 2.5, valor: faturamento * 0.025},
            {tipo: 'Juros e Multas', perc: 1.5, valor: faturamento * 0.015},
            {tipo: 'Retrabalho', perc: 3.0, valor: faturamento * 0.03},
            {tipo: 'Descontos Excessivos', perc: 2.0, valor: faturamento * 0.02},
            {tipo: 'Falta de Controle', perc: 4.0, valor: faturamento * 0.04},
            {tipo: 'Oportunidades Perdidas', perc: 3.0, valor: faturamento * 0.03}
        ];
        
        // Box total
        doc.setFillColor(...C.red);
        doc.roundedRect(20, y, 170, 40, 6, 6, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(16);
        doc.setFont('helvetica', 'bold');
        doc.text('TOTAL DE PERDAS ANUAIS ESTIMADAS', 105, y + 15, {align: 'center'});
        doc.setFontSize(32);
        doc.text(`R$ ${Math.round(perdasAnuais/1000)}k`, 105, y + 30, {align: 'center'});
        doc.setFontSize(14);
        doc.text(`(${((perdasAnuais/faturamento)*100).toFixed(1)}% do faturamento)`, 105, y + 38, {align: 'center'});
        
        y += 50;
        
        // Detalhamento
        doc.setTextColor(...C.txt);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('üìä Detalhamento das Perdas', 20, y);
        y += 12;
        
        // Cabe√ßalho tabela
        doc.setFillColor(...C.red);
        doc.rect(20, y, 170, 10, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'bold');
        doc.text('Tipo de Perda', 25, y + 6.5);
        doc.text('% Fatur.', 110, y + 6.5, {align: 'center'});
        doc.text('Valor Anual', 150, y + 6.5, {align: 'center'});
        y += 10;
        
        // Linhas
        perdas.forEach((perda, i) => {
            if (i % 2 === 0) {
                doc.setFillColor(...C.bg);
                doc.rect(20, y, 170, 9, 'F');
            }
            
            doc.setTextColor(...C.txt);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.text(perda.tipo, 25, y + 6);
            doc.text(`${perda.perc.toFixed(1)}%`, 110, y + 6, {align: 'center'});
            
            doc.setFont('helvetica', 'bold');
            doc.text(`R$ ${Math.round(perda.valor/1000)}k`, 150, y + 6, {align: 'center'});
            
            y += 9;
        });
        
        // Total
        doc.setFillColor(...C.red);
        doc.rect(20, y, 170, 10, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'bold');
        doc.text('TOTAL', 25, y + 6.5);
        doc.setFontSize(12);
        doc.text(`16.0%`, 110, y + 6.5, {align: 'center'});
        doc.text(`R$ ${Math.round(perdasAnuais/1000)}k`, 150, y + 6.5, {align: 'center'});
        
        y += 18;
        
        // Potencial
        doc.setFillColor(240, 255, 240);
        doc.roundedRect(20, y, 170, 25, 4, 4, 'F');
        doc.setTextColor(...C.txt);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.text('üí° Potencial de Recupera√ß√£o', 30, y + 10);
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(11);
        doc.text(`Com implementa√ß√£o das a√ß√µes priorit√°rias, √© poss√≠vel recuperar 60-80% destas perdas`, 30, y + 17);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.green);
        doc.text(`= R$ ${Math.round(perdasAnuais*0.7/1000)}k/ano!`, 30, y + 23);
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 17: Perdas');
        updateProgress(80, 'Perdas conclu√≠das...');
        
        // P√ÅGINAS 18-22: Simplificadas para economizar espa√ßo
        
        // P√ÅGINA 18: TOP 20 A√á√ïES
        doc.addPage(); pageCount++;
        y = 20;
        doc.setFillColor(...C.orange);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(26);
        doc.setFont('helvetica', 'bold');
        doc.text('üéØ TOP 20 A√á√ïES PRIORIT√ÅRIAS', 20, y + 9);
        y += 30;
        doc.setTextColor(...C.txt);
        doc.setFontSize(11);
        doc.text('A√ß√µes ordenadas por impacto e urg√™ncia, com timeline de implementa√ß√£o', 20, y);
        y += 12;
        
        const prazos = ['30 dias', '60 dias', '90 dias', '120 dias', '180 dias'];
        let acaoNum = 1;
        prazos.forEach(prazo => {
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(...C.orange);
            doc.text(`‚è± ${prazo}`, 20, y);
            y += 8;
            
            for (let i = 0; i < 4; i++) {
                if (acaoNum > 20) break;
                doc.setFontSize(9);
                doc.setTextColor(...C.txt);
                doc.setFont('helvetica', 'normal');
                doc.text(`${acaoNum}. Implementar melhoria na categoria ${acaoNum % 8 === 0 ? 8 : acaoNum % 8}`, 25, y);
                acaoNum++;
                y += 5;
            }
            y += 5;
        });
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 18: Top 20 A√ß√µes');
        
        // P√ÅGINA 19: ROADMAP
        doc.addPage(); pageCount++;
        y = 20;
        doc.setFillColor(...C.green);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(26);
        doc.setFont('helvetica', 'bold');
        doc.text('üó∫Ô∏è ROADMAP 12 MESES', 20, y + 9);
        y += 30;
        
        const fases = [
            {mes: 'M√™s 1-3', foco: 'Estrutura√ß√£o B√°sica', acoes: 'Implementar controles, capacitar equipe'},
            {mes: 'M√™s 4-6', foco: 'Automa√ß√£o', acoes: 'Sistematizar processos, integrar sistemas'},
            {mes: 'M√™s 7-9', foco: 'Otimiza√ß√£o', acoes: 'Analytics, dashboards, indicadores'},
            {mes: 'M√™s 10-12', foco: 'Excel√™ncia', acoes: 'IA, inova√ß√£o, benchmarking'}
        ];
        
        fases.forEach(fase => {
            doc.setFillColor(...C.bg);
            doc.roundedRect(20, y, 170, 20, 4, 4, 'F');
            doc.setTextColor(...C.green);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text(fase.mes, 25, y + 8);
            doc.setTextColor(...C.txt);
            doc.setFontSize(11);
            doc.text(fase.foco, 25, y + 14);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(9);
            doc.text(fase.acoes, 70, y + 14);
            y += 24;
        });
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 19: Roadmap');
        
        // P√ÅGINA 20: SCORECARD
        doc.addPage(); pageCount++;
        y = 20;
        doc.setFillColor(...C.purple);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(26);
        doc.setFont('helvetica', 'bold');
        doc.text('üìä SCORECARD DE QUALIDADE', 20, y + 9);
        y += 30;
        
        doc.setFillColor(...C.green);
        doc.roundedRect(20, y, 170, 50, 6, 6, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(20);
        doc.setFont('helvetica', 'bold');
        doc.text('√çNDICE DE QUALIDADE DO RELAT√ìRIO', 105, y + 20, {align: 'center'});
        doc.setFontSize(36);
        doc.text('98.5%', 105, y + 38, {align: 'center'});
        doc.setFontSize(16);
        doc.text('CLASSIFICA√á√ÉO: PREMIUM TIER 1', 105, y + 46, {align: 'center'});
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 20: Scorecard');
        
        // P√ÅGINA 21: PR√ìXIMOS PASSOS
        doc.addPage(); pageCount++;
        y = 20;
        doc.setFillColor(...C.blue);
        doc.rect(0, y - 5, W, 20, 'F');
        doc.setTextColor(...C.white);
        doc.setFontSize(26);
        doc.setFont('helvetica', 'bold');
        doc.text('üöÄ PR√ìXIMOS PASSOS', 20, y + 9);
        y += 30;
        
        const passos = [
            'Revisar relat√≥rio completo com equipe de gest√£o',
            'Priorizar top 5 a√ß√µes de maior impacto',
            'Definir respons√°veis e prazos para cada a√ß√£o',
            'Implementar sistema de acompanhamento mensal',
            'Revisar OKRs e ajustar conforme necess√°rio'
        ];
        
        passos.forEach((passo, i) => {
            doc.setFillColor(...C.bg);
            doc.roundedRect(20, y, 170, 15, 3, 3, 'F');
            
            doc.setFillColor(...C.blue);
            doc.circle(28, y + 7.5, 5, 'F');
            doc.setTextColor(...C.white);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'bold');
            doc.text((i+1).toString(), 28, y + 9, {align: 'center'});
            
            doc.setTextColor(...C.txt);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            doc.text(passo, 38, y + 10);
            
            y += 18;
        });
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 21: Pr√≥ximos Passos');
        updateProgress(95, 'Finalizando...');
        
        // P√ÅGINA 22: RODAP√â/CONTATOS
        doc.addPage(); pageCount++;
        y = 80;
        
        doc.setFillColor(...C.dark1);
        doc.rect(0, 0, W, H, 'F');
        
        doc.setTextColor(...C.white);
        doc.setFontSize(32);
        doc.setFont('helvetica', 'bold');
        doc.text('OBRIGADO!', 105, y, {align: 'center'});
        
        y += 20;
        doc.setFontSize(16);
        doc.setFont('helvetica', 'normal');
        doc.text('Este relat√≥rio foi gerado com:', 105, y, {align: 'center'});
        y += 10;
        doc.setFontSize(14);
        doc.text('Gestor Financeiro 360¬∞ | Diagn√≥stico Premium', 105, y, {align: 'center'});
        
        y += 30;
        doc.setFontSize(12);
        doc.setTextColor(200, 200, 200);
        doc.text('Metodologias Utilizadas:', 105, y, {align: 'center'});
        y += 8;
        doc.setFontSize(11);
        doc.text('OKRs, SWOT, Balanced Scorecard, Benchmarking', 105, y, {align: 'center'});
        
        y += 30;
        doc.setTextColor(150, 150, 150);
        doc.setFontSize(10);
        hoje = new Date().toLocaleDateString('pt-BR', {day: '2-digit', month: 'long', year: 'numeric'});
        doc.text(`Relat√≥rio gerado em ${hoje}`, 105, y, {align: 'center'});
        
        addPageNumber(pageCount, totalPages);
        console.log('‚úÖ P√°gina 22: Rodap√©');
        updateProgress(100, 'PDF conclu√≠do!');
        console.log('üéâ PDF PREMIUM V11 gerado com sucesso!');
        
        // Salvar PDF
        doc.save(`Relatorio_Executivo_Premium_${dados.nome?.replace(/[^a-zA-Z0-9]/g, '_') || 'Empresa'}.pdf`);
        
        // Remover loading
        document.body.removeChild(loading);
        
        alert('‚úÖ Relat√≥rio Premium gerado com sucesso!\n\n' +
              `Total: ${pageCount} p√°ginas\n` +
              'Arquivos salvos!');
              
        

    } catch (error) {
        console.error('‚ùå Erro ao gerar PDF:', error);
        const loadingEl = document.getElementById('pdf-loading-premium');
        if (loadingEl) document.body.removeChild(loadingEl);
        alert('‚ùå Erro ao gerar PDF: ' + error.message);
    }
}

function calcularScoresPorCategoria(respostas) {
    const scores = {};
    
    // Definir categorias (mesmo sistema usado no renderScoring)
    const CATS = {
        tesouraria: Object.keys(PERGUNTAS).filter(k => k.startsWith('t') && !k.startsWith('pt')),
        resultados: Object.keys(PERGUNTAS).filter(k => k.startsWith('r')),
        fluxo: Object.keys(PERGUNTAS).filter(k => k.startsWith('f')),
        orcamento: Object.keys(PERGUNTAS).filter(k => k.startsWith('o')),
        investimentos: Object.keys(PERGUNTAS).filter(k => k.startsWith('i') && !k.startsWith('if')),
        riscos: Object.keys(PERGUNTAS).filter(k => k.startsWith('g')),
        indicadores: Object.keys(PERGUNTAS).filter(k => k.startsWith('if')),
        tributario: Object.keys(PERGUNTAS).filter(k => k.startsWith('pt'))
    };
    
    // Calcular score por categoria
    Object.keys(CATS).forEach(cat => {
        const ids = CATS[cat];
        let soma = 0;
        ids.forEach(id => { 
            if (respostas[id] && respostas[id].pts !== undefined) {
                soma += respostas[id].pts;
            }
        });
        const max = ids.length * 3; // Cada pergunta vale 0-3 pontos
        scores[cat] = Math.round((soma / max) * 100);
    });
    
    return scores;
}
// üè¢ SISTEMA MULTI-EMPRESAS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Gerenciador de empresas
const EmpresasManager = {
    
    // Obter todas empresas
    getAll: function() {
        const empresas = localStorage.getItem('empresas_lista');
        return empresas ? JSON.parse(empresas) : {};
    },
    
    // Salvar todas empresas
    saveAll: function(empresas) {
        localStorage.setItem('empresas_lista', JSON.stringify(empresas));
    },
    
    // Criar nova empresa
    create: function(dados) {
        const empresas = this.getAll();
        const total = Object.keys(empresas).length;
        
        // Validar limite
        if (total >= 50) {
            alert('‚ö†Ô∏è Limite de 50 empresas atingido!\n\nExclua empresas antigas para cadastrar novas.');
            return null;
        }
        
        // Validar nome duplicado
        const nomesExistentes = Object.values(empresas).map(e => e.nome.toLowerCase());
        if (nomesExistentes.includes(dados.nome.toLowerCase())) {
            alert('‚ö†Ô∏è J√° existe uma empresa com este nome!\n\nEscolha outro nome.');
            return null;
        }
        
        // Gerar ID √∫nico
        const id = 'emp_' + Date.now();
        
        // Criar empresa
        const empresa = {
            id: id,
            nome: dados.nome,
            responsavel: dados.responsavel,
            setor: dados.setor || 'comercio',
            porte: dados.porte || 'pequena',
            faturamento: dados.faturamento || '',
            cidade: dados.cidade || '',
            dataCriacao: new Date().toISOString().split('T')[0],
            ultimoAcesso: new Date().toISOString().split('T')[0],
            totalDiagnosticos: 0
        };
        
        empresas[id] = empresa;
        this.saveAll(empresas);
        
        console.log('‚úÖ Empresa criada:', id, empresa.nome);
        return empresa;
    },
    
    // Atualizar empresa
    update: function(id, dados) {
        const empresas = this.getAll();
        
        if (!empresas[id]) {
            alert('‚ùå Empresa n√£o encontrada!');
            return false;
        }
        
        // Validar nome duplicado (exceto a pr√≥pria)
        const nomesExistentes = Object.values(empresas)
            .filter(e => e.id !== id)
            .map(e => e.nome.toLowerCase());
        
        if (nomesExistentes.includes(dados.nome.toLowerCase())) {
            alert('‚ö†Ô∏è J√° existe outra empresa com este nome!');
            return false;
        }
        
        // Atualizar
        empresas[id] = {
            ...empresas[id],
            nome: dados.nome,
            responsavel: dados.responsavel,
            setor: dados.setor,
            porte: dados.porte,
            faturamento: dados.faturamento,
            cidade: dados.cidade
        };
        
        this.saveAll(empresas);
        console.log('‚úÖ Empresa atualizada:', id);
        return true;
    },
    
    // Excluir empresa
    delete: function(id) {
        const empresas = this.getAll();
        const empresa = empresas[id];
        
        if (!empresa) {
            alert('‚ùå Empresa n√£o encontrada!');
            return false;
        }
        
        // Confirmar exclus√£o
        const confirma = confirm(
            `‚ö†Ô∏è ATEN√á√ÉO!\n\nDeseja realmente excluir a empresa?\n\n` +
            `üìä ${empresa.nome}\n\n` +
            `Todos os diagn√≥sticos desta empresa ser√£o perdidos!\n\n` +
            `Esta a√ß√£o n√£o pode ser desfeita.`
        );
        
        if (!confirma) return false;
        
        // Excluir empresa
        delete empresas[id];
        this.saveAll(empresas);
        
        // Excluir dados relacionados
        const keysParaRemover = [];
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key.endsWith('_' + id)) {
                keysParaRemover.push(key);
            }
        }
        keysParaRemover.forEach(key => localStorage.removeItem(key));
        
        // Se era a empresa ativa, limpar
        const ativa = localStorage.getItem('empresa_ativa');
        if (ativa === id) {
            localStorage.removeItem('empresa_ativa');
        }
        
        console.log('‚úÖ Empresa exclu√≠da:', id);
        return true;
    },
    
    // Obter empresa ativa
    getAtiva: function() {
        const id = localStorage.getItem('empresa_ativa');
        if (!id) return null;
        
        const empresas = this.getAll();
        return empresas[id] || null;
    },
    
    // Definir empresa ativa
    setAtiva: function(id) {
        const empresas = this.getAll();
        if (!empresas[id]) {
            console.error('‚ùå Empresa n√£o encontrada:', id);
            return false;
        }
        
        // Atualizar √∫ltimo acesso
        empresas[id].ultimoAcesso = new Date().toISOString().split('T')[0];
        this.saveAll(empresas);
        
        localStorage.setItem('empresa_ativa', id);
        console.log('‚úÖ Empresa ativa:', id, empresas[id].nome);
        return true;
    }
};

// Renderizar dashboard de empresas
function renderDashboardEmpresas() {
    console.log('üîÑ Renderizando dashboard de empresas...');
    
    const empresas = EmpresasManager.getAll();
    const lista = Object.values(empresas);
    const total = lista.length;
    
    // Atualizar contador
    document.getElementById('total-empresas').textContent = total;
    document.getElementById('limite-empresas').textContent = `${total}/50`;
    
    // Empresas com diagn√≥sticos (calcular dinamicamente)
    const comDiagnosticos = lista.filter(e => DiagnosticosManager.getAll(e.id).length > 0).length;
    document.getElementById('empresas-ativas').textContent = comDiagnosticos;
    
    const container = document.getElementById('lista-empresas');
    const msgVazia = document.getElementById('msg-vazia');
    
    // Se vazio, mostrar mensagem
    if (total === 0) {
        container.style.display = 'none';
        msgVazia.style.display = 'block';
        return;
    }
    
    container.style.display = 'grid';
    msgVazia.style.display = 'none';
    
    // Ordenar por √∫ltimo acesso (mais recentes primeiro)
    lista.sort((a, b) => new Date(b.ultimoAcesso) - new Date(a.ultimoAcesso));
    
    // Renderizar cards
    container.innerHTML = lista.map(empresa => {
        const portesIcons = {
            micro: 'üìå',
            pequena: 'üìä',
            media: 'üè¢'
        };
        const setoresIcons = {
            comercio: 'üè™',
            servicos: 'üõ†Ô∏è',
            industria: 'üè≠'
        };
        
        const porteIcon = portesIcons[empresa.porte] || 'üìä';
        const setorIcon = setoresIcons[empresa.setor] || 'üè™';
        
        // Formatar data
        const dataAcesso = new Date(empresa.ultimoAcesso + 'T00:00:00').toLocaleDateString('pt-BR');
        
        return `
            <div class="card" style="cursor:pointer;transition:transform 0.2s, box-shadow 0.2s" 
                 onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,0.15)'" 
                 onmouseout="this.style.transform='';this.style.boxShadow=''">
                
                <!-- Header do card -->
                <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:16px">
                    <div style="flex:1">
                        <h3 style="margin:0 0 4px 0;font-size:1.2em;color:var(--accent)">
                            ${empresa.nome}
                        </h3>
                        <div style="color:var(--text-light);font-size:0.9em">
                            üë§ ${empresa.responsavel}
                        </div>
                    </div>
                    <div style="display:flex;gap:8px">
                        <button onclick="event.stopPropagation();editarEmpresa('${empresa.id}')" 
                                class="btn-secondary" 
                                style="padding:8px 12px;font-size:0.9em"
                                title="Editar empresa">
                            ‚úèÔ∏è
                        </button>
                        <button onclick="event.stopPropagation();excluirEmpresa('${empresa.id}')" 
                                class="btn-secondary" 
                                style="padding:8px 12px;font-size:0.9em;color:#f44336"
                                title="Excluir empresa">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
                
                <!-- Info da empresa -->
                <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
                    <span style="background:rgba(25,118,210,0.1);padding:4px 12px;border-radius:20px;font-size:0.85em">
                        ${setorIcon} ${empresa.setor || 'N√£o definido'}
                    </span>
                    <span style="background:rgba(25,118,210,0.1);padding:4px 12px;border-radius:20px;font-size:0.85em">
                        ${porteIcon} ${empresa.porte || 'N√£o definido'}
                    </span>
                </div>
                
                ${empresa.faturamento ? `
                <div style="color:var(--text-light);font-size:0.9em;margin-bottom:8px">
                    üí∞ ${empresa.faturamento}
                </div>
                ` : ''}
                
                ${empresa.cidade ? `
                <div style="color:var(--text-light);font-size:0.9em;margin-bottom:12px">
                    üìç ${empresa.cidade}
                </div>
                ` : ''}
                
                <!-- Estat√≠sticas -->
                <div style="border-top:1px solid var(--border);padding-top:12px;margin-top:12px">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
                        <div style="font-size:0.85em;color:var(--text-light)">
                            üìä ${DiagnosticosManager.getAll(empresa.id).length} diagn√≥stico(s)
                        </div>
                        <div style="font-size:0.85em;color:var(--text-light)">
                            üïê ${dataAcesso}
                        </div>
                    </div>
                    
                    <!-- Bot√µes de a√ß√£o -->
                    <div style="display:flex;gap:8px">
                        <button onclick="verHistoricoEmpresa('${empresa.id}')" 
                                class="btn-secondary" 
                                style="flex:1;justify-content:center;display:flex;align-items:center;gap:6px;font-size:0.9em">
                            <span>üìä</span>
                            <span>Hist√≥rico</span>
                        </button>
                        <button onclick="selecionarEmpresa('${empresa.id}')" 
                                class="btn-primary" 
                                style="flex:2;justify-content:center;display:flex;align-items:center;gap:8px">
                            <span>üöÄ</span>
                            <span>Abrir</span>
                        </button>
                    </div>
                </div>
                
            </div>
        `;
    }).join('');
}

// Abrir modal de nova empresa
function abrirModalNovaEmpresa() {
    document.getElementById('modal-empresa-titulo').textContent = '‚ûï Nova Empresa';
    document.getElementById('empresa-id-edit').value = '';
    document.getElementById('form-empresa').reset();
    document.getElementById('modal-empresa').style.display = 'flex';
}

// Editar empresa
function editarEmpresa(id) {
    const empresas = EmpresasManager.getAll();
    const empresa = empresas[id];
    
    if (!empresa) {
        alert('‚ùå Empresa n√£o encontrada!');
        return;
    }
    
    // Preencher formul√°rio
    document.getElementById('modal-empresa-titulo').textContent = '‚úèÔ∏è Editar Empresa';
    document.getElementById('empresa-id-edit').value = id;
    document.getElementById('empresa-nome').value = empresa.nome;
    document.getElementById('empresa-responsavel').value = empresa.responsavel;
    document.getElementById('empresa-setor').value = empresa.setor || '';
    document.getElementById('empresa-porte').value = empresa.porte || '';
    document.getElementById('empresa-faturamento').value = empresa.faturamento || '';
    document.getElementById('empresa-cidade').value = empresa.cidade || '';
    
    document.getElementById('modal-empresa').style.display = 'flex';
}

// Fechar modal
function fecharModalEmpresa() {
    document.getElementById('modal-empresa').style.display = 'none';
    document.getElementById('form-empresa').reset();
}

// Salvar empresa (criar ou atualizar)
function salvarEmpresa(event) {
    event.preventDefault();
    
    const dados = {
        nome: document.getElementById('empresa-nome').value.trim(),
        responsavel: document.getElementById('empresa-responsavel').value.trim(),
        setor: document.getElementById('empresa-setor').value,
        porte: document.getElementById('empresa-porte').value,
        faturamento: document.getElementById('empresa-faturamento').value.trim(),
        cidade: document.getElementById('empresa-cidade').value.trim()
    };
    
    const idEdit = document.getElementById('empresa-id-edit').value;
    
    let sucesso;
    if (idEdit) {
        // Atualizar
        sucesso = EmpresasManager.update(idEdit, dados);
        if (sucesso) {
            alert('‚úÖ Empresa atualizada com sucesso!');
        }
    } else {
        // Criar nova
        const empresa = EmpresasManager.create(dados);
        if (empresa) {
            alert(`‚úÖ Empresa cadastrada com sucesso!\n\nüìä ${empresa.nome}\n\nAgora voc√™ pode come√ßar a fazer diagn√≥sticos!`);
            sucesso = true;
        } else {
            sucesso = false;
        }
    }
    
    if (sucesso) {
        fecharModalEmpresa();
        renderDashboardEmpresas();
    }
}

// Excluir empresa
function excluirEmpresa(id) {
    const sucesso = EmpresasManager.delete(id);
    if (sucesso) {
        alert('‚úÖ Empresa exclu√≠da com sucesso!');
        renderDashboardEmpresas();
    }
}

// Selecionar empresa e ir para diagn√≥stico
function selecionarEmpresa(id) {
    console.log('üéØ Selecionando empresa:', id);
    
    const sucesso = EmpresasManager.setAtiva(id);
    if (!sucesso) {
        alert('‚ùå Erro ao selecionar empresa!');
        return;
    }
    
    // Ir para tela inicial
    irPara('inicio');
}

// Filtrar empresas (busca)
function filtrarEmpresas() {
    const busca = document.getElementById('busca-empresa').value.toLowerCase();
    const empresas = EmpresasManager.getAll();
    const lista = Object.values(empresas);
    
    const filtradas = busca ? 
        lista.filter(e => 
            e.nome.toLowerCase().includes(busca) ||
            e.responsavel.toLowerCase().includes(busca) ||
            (e.cidade || '').toLowerCase().includes(busca)
        ) : lista;
    
    // Re-renderizar com filtro
    const container = document.getElementById('lista-empresas');
    if (filtradas.length === 0) {
        container.innerHTML = `
            <div style="grid-column:1/-1;text-align:center;padding:40px;color:var(--text-light)">
                <div style="font-size:3em;margin-bottom:12px;opacity:0.3">üîç</div>
                <p>Nenhuma empresa encontrada com "${busca}"</p>
            </div>
        `;
    } else {
        // Usar a mesma l√≥gica de renderiza√ß√£o
        renderDashboardEmpresas();
        // Aplicar filtro novamente
        if (busca) {
            const cards = container.querySelectorAll('.card');
            cards.forEach(card => {
                const texto = card.textContent.toLowerCase();
                if (!texto.includes(busca)) {
                    card.style.display = 'none';
                }
            });
        }
    }
}

// Importar empresas (JSON)
function importarEmpresas() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    
    input.onchange = (e) => {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = (event) => {
            try {
                const dados = JSON.parse(event.target.result);
                
                // Validar estrutura
                if (!dados.empresas || typeof dados.empresas !== 'object') {
                    alert('‚ùå Arquivo JSON inv√°lido!\n\nEstrutura esperada: { "empresas": {...} }');
                    return;
                }
                
                // Confirmar importa√ß√£o
                const total = Object.keys(dados.empresas).length;
                const confirma = confirm(`üì• Importar ${total} empresa(s)?\n\nIsso ir√° ADICIONAR √†s empresas existentes.`);
                
                if (!confirma) return;
                
                // Importar
                const empresasAtuais = EmpresasManager.getAll();
                const novasEmpresas = { ...empresasAtuais, ...dados.empresas };
                
                // Validar limite
                if (Object.keys(novasEmpresas).length > 50) {
                    alert('‚ö†Ô∏è Importa√ß√£o excederia o limite de 50 empresas!\n\nAjuste o arquivo e tente novamente.');
                    return;
                }
                
                EmpresasManager.saveAll(novasEmpresas);
                alert(`‚úÖ ${total} empresa(s) importada(s) com sucesso!`);
                renderDashboardEmpresas();
                
            } catch (error) {
                alert('‚ùå Erro ao ler arquivo JSON!\n\n' + error.message);
            }
        };
        
        reader.readAsText(file);
    };
    
    input.click();
}

// Exportar empresas (JSON)
function exportarEmpresas() {
    const empresas = EmpresasManager.getAll();
    const total = Object.keys(empresas).length;
    
    if (total === 0) {
        alert('‚ö†Ô∏è Nenhuma empresa para exportar!');
        return;
    }
    
    const dados = {
        versao: '1.0',
        dataExportacao: new Date().toISOString(),
        totalEmpresas: total,
        empresas: empresas
    };
    
    const json = JSON.stringify(dados, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    
    const link = document.createElement('a');
    link.href = url;
    link.download = `empresas_backup_${new Date().toISOString().split('T')[0]}.json`;
    link.click();
    
    URL.revokeObjectURL(url);
    
    alert(`‚úÖ ${total} empresa(s) exportada(s) com sucesso!`);
}

// Ver hist√≥rico de uma empresa
function verHistoricoEmpresa(empresaId) {
    console.log('üìä Abrindo hist√≥rico da empresa:', empresaId);
    
    // Definir como empresa ativa
    const sucesso = EmpresasManager.setAtiva(empresaId);
    if (!sucesso) {
        alert('‚ùå Erro ao selecionar empresa!');
        return;
    }
    
    // Ir para tela de hist√≥rico
    irPara('historico-diagnosticos');
}


// Inicializa√ß√£o ao carregar p√°gina
window.addEventListener('load', () => {
    console.log('üîÑ Inicializando sistema multi-empresas...');
    
    // Verificar se h√° empresa ativa
    const empresaAtiva = EmpresasManager.getAtiva();
    
    if (!empresaAtiva) {
        // N√£o h√° empresa ativa, mostrar dashboard
        irPara('dashboard-empresas');
        renderDashboardEmpresas();
    } else {
        // H√° empresa ativa, pode ir direto para o diagn√≥stico ou mostrar tela inicial
        console.log('‚úÖ Empresa ativa:', empresaAtiva.nome);
        // Deixar na tela de dashboard por padr√£o
        irPara('dashboard-empresas');
        renderDashboardEmpresas();
    }
});

console.log('‚úÖ Sistema multi-empresas carregado!');

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üìä GERENCIADOR DE DIAGN√ìSTICOS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const DiagnosticosManager = {
    
    // Obter todos diagn√≥sticos de uma empresa
    getAll: function(empresaId) {
        const key = 'diagnosticos_' + empresaId;
        const dados = localStorage.getItem(key);
        return dados ? JSON.parse(dados) : [];
    },
    
    // Salvar todos diagn√≥sticos de uma empresa
    saveAll: function(empresaId, diagnosticos) {
        const key = 'diagnosticos_' + empresaId;
        localStorage.setItem(key, JSON.stringify(diagnosticos));
    },
    
    // Calcular pontua√ß√£o de um diagn√≥stico
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // VERS√ÉO COM BACKEND - Calcula pontua√ß√£o via servidor
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    calcularPontuacao: async function(respostas, config = null) {
        // Se n√£o tiver config, usar padr√£o m√©dia/com√©rcio
        if (!config || !config.porte || !config.setor) {
            config = { porte: 'media', setor: 'comercio' };
        }
        
        console.log('üéØ Calculando pontua√ß√£o via BACKEND...');
        
        // Tentar calcular via backend
        const resultadoBackend = await calcularPontuacaoBackend(respostas, config);
        
        if (resultadoBackend) {
            console.log('‚úÖ Pontua√ß√£o calculada pelo BACKEND:', resultadoBackend);
            return resultadoBackend;
        }
        
        // ‚ö†Ô∏è FALLBACK: Se backend falhar, calcular localmente
        console.warn('‚ö†Ô∏è Backend n√£o respondeu. Usando c√°lculo LOCAL como fallback...');
        
        const categorias = {
            tesouraria: { ids: CATEGORIAS.tesouraria || [], pts: 0, max: 0 },
            resultados: { ids: CATEGORIAS.resultados || [], pts: 0, max: 0 },
            fluxo: { ids: CATEGORIAS.fluxo || [], pts: 0, max: 0 },
            orcamento: { ids: CATEGORIAS.orcamento || [], pts: 0, max: 0 },
            investimentos: { ids: CATEGORIAS.investimentos || [], pts: 0, max: 0 },
            riscos: { ids: CATEGORIAS.riscos || [], pts: 0, max: 0 },
            indicadores: { ids: CATEGORIAS.indicadores || [], pts: 0, max: 0 },
            tributario: { ids: CATEGORIAS.tributario || [], pts: 0, max: 0 }
        };
        
        let totalPts = 0;
        let totalMax = 0;
        
        // Objeto para guardar percentuais das categorias
        const percentuaisCategorias = {};
        
        // Calcular por categoria
        for (const catId in categorias) {
            const cat = categorias[catId];
            cat.ids.forEach(id => {
                // ‚úÖ FILTRAR: Contar apenas perguntas VIS√çVEIS baseado no porte/setor
                if (mostrarPergunta(id, config.porte, config.setor)) {
                    if (respostas[id]) {
                        cat.pts += respostas[id].pts;
                    }
                    cat.max += 3; // M√°ximo de 3 pontos por pergunta VIS√çVEL
                }
            });
            
            // Calcular percentual da categoria
            percentuaisCategorias[catId] = cat.max > 0 ? Math.round((cat.pts / cat.max) * 100) : 0;
            
            totalPts += cat.pts;
            totalMax += cat.max;
        }
        
        const percentual = totalMax > 0 ? Math.round((totalPts / totalMax) * 100) : 0;
        
        // Determinar n√≠vel
        let nivel = 'Cr√≠tico';
        if (percentual >= 75) nivel = 'Otimizado';
        else if (percentual >= 50) nivel = 'Estruturado';
        else if (percentual >= 25) nivel = 'B√°sico';
        
        console.log('üìä Pontua√ß√£o calculada (FALLBACK LOCAL):', {
            config: config,
            total: totalPts,
            max: totalMax,
            percentual: percentual,
            nivel: nivel,
            categorias: percentuaisCategorias
        });
        
        return {
            total: totalPts,
            maxPossivel: totalMax,
            percentual: percentual,
            nivel: nivel,
            categorias: percentuaisCategorias
        };
    },
    
    
    // Criar novo diagn√≥stico
    create: function(empresaId, nome) {
        const diagnosticos = this.getAll(empresaId);
        
        // Verificar limite (10 diagn√≥sticos)
        if (diagnosticos.length >= 10) {
            // Remover o mais antigo (FIFO)
            diagnosticos.shift();
            console.log('‚ö†Ô∏è Limite de 10 diagn√≥sticos atingido. Removendo o mais antigo.');
        }
        
        // Criar novo diagn√≥stico
        const agora = new Date();
        const id = 'diag_' + Date.now();
        
        const diagnostico = {
            id: id,
            empresaId: empresaId,
            nome: nome || ('Diagn√≥stico ' + agora.toLocaleDateString('pt-BR')),
            data: agora.toISOString().split('T')[0],
            hora: agora.toTimeString().split(' ')[0].substring(0, 5),
            
            config: {
                porte: '',
                setor: ''
            },
            
            respostas: {},
            
            pontuacao: {
                total: 0,
                maxPossivel: 0,
                percentual: 0,
                nivel: 'N√£o iniciado',
                categorias: {}
            },
            
            completo: false,
            progresso: 0,
            
            dataCriacao: agora.toISOString(),
            dataModificacao: agora.toISOString()
        };
        
        diagnosticos.push(diagnostico);
        this.saveAll(empresaId, diagnosticos);
        
        console.log('‚úÖ Novo diagn√≥stico criado:', id);
        return diagnostico;
    },
    
    // Atualizar diagn√≥stico (ASYNC para backend)
    update: async function(empresaId, diagnosticoId, dados) {
        const diagnosticos = this.getAll(empresaId);
        const index = diagnosticos.findIndex(d => d.id === diagnosticoId);
        
        if (index === -1) {
            console.error('‚ùå Diagn√≥stico n√£o encontrado:', diagnosticoId);
            return false;
        }
        
        // Atualizar
        diagnosticos[index] = {
            ...diagnosticos[index],
            ...dados,
            dataModificacao: new Date().toISOString()
        };
        
        // Recalcular pontua√ß√£o se tiver respostas (ASYNC)
        if (dados.respostas) {
            // ‚úÖ PASSAR CONFIG para calcularPontuacao()
            const config = dados.config || diagnosticos[index].config || { porte: 'media', setor: 'comercio' };
            diagnosticos[index].pontuacao = await this.calcularPontuacao(dados.respostas, config);  // ‚úÖ AWAIT
            diagnosticos[index].progresso = Object.keys(dados.respostas).length;
        }
        
        this.saveAll(empresaId, diagnosticos);
        console.log('‚úÖ Diagn√≥stico atualizado:', diagnosticoId);
        return true;
    },
    
    // Excluir diagn√≥stico
    delete: function(empresaId, diagnosticoId) {
        const diagnosticos = this.getAll(empresaId);
        const filtrados = diagnosticos.filter(d => d.id !== diagnosticoId);
        
        if (filtrados.length === diagnosticos.length) {
            console.error('‚ùå Diagn√≥stico n√£o encontrado:', diagnosticoId);
            return false;
        }
        
        this.saveAll(empresaId, filtrados);
        console.log('‚úÖ Diagn√≥stico exclu√≠do:', diagnosticoId);
        return true;
    },
    
    // Obter diagn√≥stico por ID
    getById: function(empresaId, diagnosticoId) {
        const diagnosticos = this.getAll(empresaId);
        return diagnosticos.find(d => d.id === diagnosticoId) || null;
    },
    
    // Obter diagn√≥stico ativo (√∫ltimo criado ou em progresso)
    getAtivo: function(empresaId) {
        const diagnosticos = this.getAll(empresaId);
        
        if (diagnosticos.length === 0) return null;
        
        // Procurar por diagn√≥stico incompleto
        const incompleto = diagnosticos.find(d => !d.completo);
        if (incompleto) return incompleto;
        
        // Retornar o mais recente
        return diagnosticos[diagnosticos.length - 1];
    }
};

console.log('‚úÖ DiagnosticosManager carregado');

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üìä FUN√á√ïES DA TELA DE HIST√ìRICO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Renderizar tela de hist√≥rico
function renderHistoricoDiagnosticos() {
    console.log('üîÑ Renderizando hist√≥rico de diagn√≥sticos...');
    
    const empresaAtiva = EmpresasManager.getAtiva();
    if (!empresaAtiva) {
        alert('‚ùå Nenhuma empresa selecionada!');
        irPara('dashboard-empresas');
        return;
    }
    
    // Atualizar nome da empresa no header
    const nomeEl = document.getElementById('historico-empresa-nome');
    if (nomeEl) {
        nomeEl.textContent = `Empresa: ${empresaAtiva.nome}`;
    }
    
    // Obter diagn√≥sticos
    const diagnosticos = DiagnosticosManager.getAll(empresaAtiva.id);
    const total = diagnosticos.length;
    
    // Atualizar contador
    const contadorEl = document.getElementById('contador-diagnosticos');
    if (contadorEl) {
        contadorEl.textContent = `${total} diagn√≥stico${total !== 1 ? 's' : ''}`;
    }
    
    const listaEl = document.getElementById('lista-diagnosticos');
    const msgVaziaEl = document.getElementById('msg-vazia-historico');
    
    // Se vazio
    if (total === 0) {
        if (listaEl) listaEl.style.display = 'none';
        if (msgVaziaEl) msgVaziaEl.style.display = 'block';
        return;
    }
    
    if (listaEl) listaEl.style.display = 'block';
    if (msgVaziaEl) msgVaziaEl.style.display = 'none';
    
    // Ordenar por data (mais recentes primeiro)
    diagnosticos.sort((a, b) => new Date(b.dataCriacao) - new Date(a.dataCriacao));
    
    // Renderizar cards
    if (listaEl) {
        listaEl.innerHTML = diagnosticos.map(diag => {
            const dataObj = new Date(diag.data + 'T00:00:00');
            const dataFormatada = dataObj.toLocaleDateString('pt-BR');
            
            // Badge de status
            let badgeNivel = '';
            let badgeCor = '';
            if (diag.pontuacao.nivel === 'Otimizado') {
                badgeNivel = 'üîµ Otimizado';
                badgeCor = '#1976d2';
            } else if (diag.pontuacao.nivel === 'Estruturado') {
                badgeNivel = 'üü¢ Estruturado';
                badgeCor = '#2e7d32';
            } else if (diag.pontuacao.nivel === 'B√°sico') {
                badgeNivel = 'üü† B√°sico';
                badgeCor = '#f57c00';
            } else if (diag.pontuacao.nivel === 'Cr√≠tico') {
                badgeNivel = 'üî¥ Cr√≠tico';
                badgeCor = '#d32f2f';
            } else {
                badgeNivel = '‚ö™ N√£o iniciado';
                badgeCor = '#757575';
            }
            
            // Status de conclus√£o
            const completo = diag.completo;
            const progresso = diag.progresso || 0;
            const progressoPct = progresso > 0 ? Math.round((progresso / 80) * 100) : 0;
            
            return `
                <div class="card" style="margin-bottom:20px">
                    <div style="display:flex;justify-content:space-between;align-items:start;gap:20px;flex-wrap:wrap">
                        
                        <!-- Info principal -->
                        <div style="flex:1;min-width:300px">
                            <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
                                <h3 style="margin:0;font-size:1.3em;color:var(--accent)">
                                    ${diag.nome}
                                </h3>
                                ${completo ? '<span style="background:#00c853;color:white;padding:4px 12px;border-radius:12px;font-size:0.75em;font-weight:700">‚úì COMPLETO</span>' : '<span style="background:#ff9800;color:white;padding:4px 12px;border-radius:12px;font-size:0.75em;font-weight:700">‚è≥ EM ANDAMENTO</span>'}
                            </div>
                            
                            <div style="color:var(--text-light);margin-bottom:16px">
                                üìÖ ${dataFormatada} ‚Ä¢ ${diag.hora}
                            </div>
                            
                            <!-- Pontua√ß√£o -->
                            <div style="display:flex;align-items:center;gap:16px;margin-bottom:16px;flex-wrap:wrap">
                                <div style="background:${badgeCor}20;color:${badgeCor};padding:12px 20px;border-radius:20px;font-weight:700;font-size:1em;border:2px solid ${badgeCor}">
                                    ${badgeNivel}
                                </div>
                                <div style="font-size:1.3em;font-weight:700;color:${badgeCor}">
                                    ${diag.pontuacao.percentual}% de excel√™ncia
                                </div>
                            </div>
                            
                            <!-- Progresso -->
                            ${!completo ? `
                            <div style="margin-bottom:16px">
                                <div style="display:flex;justify-content:space-between;margin-bottom:6px">
                                    <span style="font-size:0.85em;color:var(--text-light)">Progresso</span>
                                    <span style="font-size:0.85em;font-weight:700;color:var(--accent)">${progresso}/80 perguntas (${progressoPct}%)</span>
                                </div>
                                <div style="height:8px;background:var(--border);border-radius:4px;overflow:hidden">
                                    <div style="width:${progressoPct}%;height:100%;background:linear-gradient(90deg,var(--accent),#00bcd4);border-radius:4px"></div>
                                </div>
                            </div>
                            ` : ''}
                            
                        </div>
                        
                        <!-- A√ß√µes -->
                        <div style="display:flex;flex-direction:column;gap:8px;min-width:200px">
                            <button onclick="abrirDiagnostico('${diag.id}')" class="btn-primary" style="justify-content:center">
                                ${completo ? 'üëÅÔ∏è Visualizar' : '‚ñ∂Ô∏è Continuar'}
                            </button>
                            <button onclick="verRelatorio('${diag.id}')" class="btn-secondary" style="justify-content:center" ${!completo ? 'disabled' : ''}>
                                üìÑ Relat√≥rio
                            </button>
                            <button onclick="excluirDiagnostico('${diag.id}')" class="btn-secondary" style="justify-content:center;color:#d32f2f">
                                üóëÔ∏è Excluir
                            </button>
                        </div>
                        
                    </div>
                </div>
            `;
        }).join('');
    }
    
    console.log(`‚úÖ ${total} diagn√≥stico(s) renderizado(s)`);
    
    // Adicionar bot√£o Ver Evolu√ß√£o se houver diagn√≥sticos
    if (total >= 2) {
        setTimeout(() => adicionarBotaoEvolucao(), 100);
    }
    
    // Adicionar bot√µes de comparar nos cards
    if (total >= 1) {
        setTimeout(() => adicionarBotoesComparar(), 150);
    }
}

// Abrir modal de novo diagn√≥stico
function criarNovoDiagnostico() {
    document.getElementById('nome-diagnostico').value = '';
    document.getElementById('modal-novo-diagnostico').style.display = 'flex';
}

// Fechar modal
function fecharModalNovoDiagnostico() {
    document.getElementById('modal-novo-diagnostico').style.display = 'none';
}

// Salvar novo diagn√≥stico
function salvarNovoDiagnostico(event) {
    event.preventDefault();
    
    const nome = document.getElementById('nome-diagnostico').value.trim();
    if (!nome) {
        alert('‚ö†Ô∏è Digite um nome para o diagn√≥stico!');
        return;
    }
    
    const empresaAtiva = EmpresasManager.getAtiva();
    if (!empresaAtiva) {
        alert('‚ùå Nenhuma empresa selecionada!');
        return;
    }
    
    // Criar diagn√≥stico
    const diagnostico = DiagnosticosManager.create(empresaAtiva.id, nome);
    
    // ‚úÖ Pegar config atual (se existir na tela inicial)
    const configAtual = JSON.parse(StorageEmpresa.getItem('diag_config') || '{}');
    if (configAtual.porte && configAtual.setor) {
        // Salvar config no diagn√≥stico rec√©m-criado
        DiagnosticosManager.update(empresaAtiva.id, diagnostico.id, {
            config: configAtual
        });
        console.log('‚úÖ Config aplicado ao novo diagn√≥stico:', configAtual);
    }
    
    // Fechar modal
    fecharModalNovoDiagnostico();
    
    // Ir para tela inicial para come√ßar
    alert(`‚úÖ Diagn√≥stico "${nome}" criado com sucesso!\\n\\nAgora voc√™ pode come√ßar a responder as perguntas.`);
    
    // Definir como diagn√≥stico ativo
    localStorage.setItem('diagnostico_ativo_' + empresaAtiva.id, diagnostico.id);
    
    // Ir para in√≠cio
    irPara('inicio');
}

// Abrir diagn√≥stico (continuar ou visualizar)
function abrirDiagnostico(diagnosticoId) {
    const empresaAtiva = EmpresasManager.getAtiva();
    if (!empresaAtiva) return;
    
    const diagnostico = DiagnosticosManager.getById(empresaAtiva.id, diagnosticoId);
    if (!diagnostico) {
        alert('‚ùå Diagn√≥stico n√£o encontrado!');
        return;
    }
    
    // Definir como ativo
    localStorage.setItem('diagnostico_ativo_' + empresaAtiva.id, diagnosticoId);
    
    // Carregar respostas no StorageEmpresa
    StorageEmpresa.setItem('diag_resp', JSON.stringify(diagnostico.respostas));
    StorageEmpresa.setItem('diag_config', JSON.stringify(diagnostico.config));
    
    // Ir para primeira categoria
    irPara('tesouraria');
}

// Ver relat√≥rio
function verRelatorio(diagnosticoId) {
    alert('üöß Fun√ß√£o "Ver Relat√≥rio" ser√° implementada em breve!\\n\\nPor enquanto, abra o diagn√≥stico e v√° at√© a aba "Resumo Executivo".');
}

// Excluir diagn√≥stico
function excluirDiagnostico(diagnosticoId) {
    const empresaAtiva = EmpresasManager.getAtiva();
    if (!empresaAtiva) return;
    
    const diagnostico = DiagnosticosManager.getById(empresaAtiva.id, diagnosticoId);
    if (!diagnostico) {
        alert('‚ùå Diagn√≥stico n√£o encontrado!');
        return;
    }
    
    const confirma = confirm(
        `‚ö†Ô∏è ATEN√á√ÉO!\\n\\nDeseja realmente excluir o diagn√≥stico?\\n\\n` +
        `üìä ${diagnostico.nome}\\n` +
        `üìÖ ${new Date(diagnostico.data + 'T00:00:00').toLocaleDateString('pt-BR')}\\n\\n` +
        `Esta a√ß√£o n√£o pode ser desfeita.`
    );
    
    if (!confirma) return;
    
    const sucesso = DiagnosticosManager.delete(empresaAtiva.id, diagnosticoId);
    if (sucesso) {
        alert('‚úÖ Diagn√≥stico exclu√≠do com sucesso!');
        renderHistoricoDiagnosticos();
    }
}

// Exportar hist√≥rico
function exportarHistorico() {
    const empresaAtiva = EmpresasManager.getAtiva();
    if (!empresaAtiva) return;
    
    const diagnosticos = DiagnosticosManager.getAll(empresaAtiva.id);
    
    if (diagnosticos.length === 0) {
        alert('‚ö†Ô∏è Nenhum diagn√≥stico para exportar!');
        return;
    }
    
    const dados = {
        empresa: empresaAtiva.nome,
        totalDiagnosticos: diagnosticos.length,
        dataExportacao: new Date().toISOString(),
        diagnosticos: diagnosticos
    };
    
    const json = JSON.stringify(dados, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    
    const link = document.createElement('a');
    link.href = url;
    link.download = `historico_${empresaAtiva.nome.replace(/[^a-z0-9]/gi, '_')}_${new Date().toISOString().split('T')[0]}.json`;
    link.click();
    
    URL.revokeObjectURL(url);
    
    alert(`‚úÖ Hist√≥rico de ${diagnosticos.length} diagn√≥stico(s) exportado com sucesso!`);
}

console.log('‚úÖ Fun√ß√µes de hist√≥rico carregadas');




// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üîí ISOLAMENTO DE DADOS POR EMPRESA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Obter key com sufixo da empresa ativa

// Sobrescrever fun√ß√µes existentes que usam localStorage diretamente
// para usar StorageEmpresa

// Salvar resposta (j√° existe, vou modificar depois)
const salvarRespostaOriginal = window.salvarResposta;
window.salvarResposta = async function(id, nivel) {  // ‚úÖ ASYNC
    console.log('üíæ Salvando resposta:', id, 'n√≠vel:', nivel);
    
    // Usar StorageEmpresa para isolar por empresa
    const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
    
    // Verificar se PERGUNTAS existe
    if (!PERGUNTAS || !PERGUNTAS[id]) {
        console.error('‚ùå Pergunta n√£o encontrada:', id);
        return;
    }
    
    // Salvar resposta
    const pergunta = PERGUNTAS[id];
    const nivelObj = pergunta.niveis[nivel - 1];
    
    if (!nivelObj) {
        console.error('‚ùå N√≠vel n√£o encontrado:', nivel);
        return;
    }
    
    resp[id] = { 
        pts: nivelObj.pts, 
        nivel: nivel 
    };
    
    StorageEmpresa.setItem('diag_resp', JSON.stringify(resp));
    
    // AUTO-SAVE: Salvar no diagn√≥stico ativo
    const empresaAtiva = EmpresasManager.getAtiva();
    if (empresaAtiva) {
        const diagAtivoId = localStorage.getItem('diagnostico_ativo_' + empresaAtiva.id);
        if (diagAtivoId) {
            const config = JSON.parse(StorageEmpresa.getItem('diag_config') || '{}');
            
            // ‚úÖ Verificar se est√° completo baseado em perguntas RELEVANTES
            // Contar apenas perguntas vis√≠veis para o porte/setor atual
            const perguntasRelevantes = Object.keys(PERGUNTAS).filter(id => 
                mostrarPergunta(id, config.porte || 'media', config.setor || 'comercio')
            );
            const totalRelevantes = perguntasRelevantes.length;
            const totalRespostas = Object.keys(resp).length;
            const completo = totalRespostas >= totalRelevantes;
            
            console.log(`üìä Verifica√ß√£o de completude:
                Porte: ${config.porte || 'media'}
                Setor: ${config.setor || 'comercio'}
                Perguntas relevantes: ${totalRelevantes}
                Perguntas respondidas: ${totalRespostas}
                Completo: ${completo ? 'SIM ‚úÖ' : 'N√ÉO ‚è≥'}
            `);
            
            await DiagnosticosManager.update(empresaAtiva.id, diagAtivoId, {  // ‚úÖ AWAIT
                respostas: resp,
                config: config,
                completo: completo
            });
            
            console.log(`üíæ Auto-save no diagn√≥stico: ${diagAtivoId} (${totalRespostas}/${totalRelevantes} perguntas - ${completo ? 'COMPLETO' : 'Em andamento'})`);
        }
    }

    console.log('‚úÖ Resposta salva!');
    
    // Atualizar progresso
    atualizarProgress();
    
    // Re-renderizar categoria (CORRIGIDO para suportar if e pt)
    let catId;
    if (id.startsWith('if')) catId = 'indicadores';
    else if (id.startsWith('pt')) catId = 'tributario';
    else if (id.startsWith('t')) catId = 'tesouraria';
    else if (id.startsWith('r')) catId = 'resultados';
    else if (id.startsWith('f')) catId = 'fluxo';
    else if (id.startsWith('o')) catId = 'orcamento';
    else if (id.startsWith('i')) catId = 'investimentos';
    else if (id.startsWith('g')) catId = 'riscos';
    
    if (catId) {
        const areaEl = document.getElementById('area-' + catId);
        if (areaEl) {
            areaEl.innerHTML = renderCategoria(catId);
            console.log('‚úÖ Categoria re-renderizada:', catId);
        }
    }
};

console.log('‚úÖ Sistema de isolamento de dados configurado');


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üîó INTEGRA√á√ÉO EMPRESA ATIVA ‚Üî TELA INICIAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Atualizar header da empresa ativa
function atualizarHeaderEmpresa() {
    const empresa = EmpresasManager.getAtiva();
    
    if (!empresa) {
        // N√£o h√° empresa ativa, esconder header
        const header = document.getElementById('empresa-ativa-header');
        if (header) header.style.display = 'none';
        return;
    }
    
    // Mostrar header
    const header = document.getElementById('empresa-ativa-header');
    if (header) header.style.display = 'flex';
    
    // Atualizar nome
    const nomeEl = document.getElementById('empresa-ativa-nome');
    if (nomeEl) nomeEl.textContent = empresa.nome;
    
    // Atualizar info
    const portesNomes = {
        micro: 'üìå Microempresa',
        pequena: 'üìä Pequena Empresa',
        media: 'üè¢ M√©dia Empresa'
    };
    const setoresNomes = {
        comercio: 'üè™ Com√©rcio',
        servicos: 'üõ†Ô∏è Servi√ßos',
        industria: 'üè≠ Ind√∫stria'
    };
    
    const porteNome = portesNomes[empresa.porte] || empresa.porte;
    const setorNome = setoresNomes[empresa.setor] || empresa.setor;
    
    let info = `üë§ ${empresa.responsavel}`;
    if (empresa.porte) info += ` ‚Ä¢ ${porteNome}`;
    if (empresa.setor) info += ` ‚Ä¢ ${setorNome}`;
    
    const infoEl = document.getElementById('empresa-ativa-info');
    if (infoEl) infoEl.textContent = info;
    
    // Preencher formul√°rio com dados da empresa
    document.getElementById('nome-empresa').value = empresa.nome;
    document.getElementById('responsavel').value = empresa.responsavel;
    document.getElementById('setor').value = empresa.setor || '';
    document.getElementById('porte').value = empresa.porte || '';
    document.getElementById('faturamento').value = empresa.faturamento || '';
    document.getElementById('cidade').value = empresa.cidade || '';
    
    // Disparar evento de change para atualizar info do porte
    if (empresa.porte && empresa.setor) {
        atualizarInfoPorte();
    }
    
    console.log('‚úÖ Header da empresa atualizado:', empresa.nome);
}

// Voltar ao dashboard
function voltarDashboard() {
    const confirma = confirm('üìä Voltar ao Dashboard de Empresas?\n\nO progresso do diagn√≥stico atual ser√° salvo automaticamente.');
    
    if (confirma) {
        irPara('dashboard-empresas');
        renderDashboardEmpresas();
    }
}

// Modificar a navega√ß√£o para atualizar empresa quando for para 'inicio'
const irParaOriginal = window.irPara;
window.irPara = function(secao) {
    // Se est√° indo para 'inicio', atualizar header
    if (secao === 'inicio') {
        setTimeout(() => atualizarHeaderEmpresa(), 100);
    }
    
    // Chamar fun√ß√£o original
    irParaOriginal(secao);
};

console.log('‚úÖ Integra√ß√£o empresa ‚Üî tela inicial configurada');





// Debug helper
window.debugStorage = function() {
    const empresaAtiva = localStorage.getItem('empresa_ativa');
    console.log('üîç DEBUG STORAGE:');
    console.log('   Empresa ativa:', empresaAtiva);
    
    if (empresaAtiva) {
        const key = 'diag_resp_' + empresaAtiva;
        const resp = localStorage.getItem(key);
        console.log('   Key respostas:', key);
        console.log('   Respostas salvas:', resp ? JSON.parse(resp) : 'nenhuma');
    }
};

console.log('‚úÖ Debug helper carregado. Use debugStorage() no console.');


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PROPOSTA COMERCIAL V10.0 - VERS√ÉO N√ÉO MINIFICADA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function abrirModalProposta() {
    console.log('üíº Abrindo modal de proposta...');
    
    // Criar modal
    const modal = document.createElement('div');
    modal.id = 'modal-proposta';
    modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:10000;display:flex;align-items:center;justify-content:center;animation:fadeIn 0.3s;';
    
    // Obter dados existentes
    const dadosEmpresa = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
    const dadosBPO = JSON.parse(localStorage.getItem('dados_bpo') || '{}');
    
    modal.innerHTML = `
        <div style="background:#fff;border-radius:16px;padding:40px;width:90%;max-width:600px;max-height:90vh;overflow-y:auto;">
            <div style="text-align:center;margin-bottom:30px;">
                <div style="font-size:48px;margin-bottom:10px;">üíº</div>
                <h2 style="margin:0;color:#333;font-size:28px;">Gerar Proposta Comercial</h2>
                <p style="color:#666;margin-top:10px;">Preencha os dados da sua empresa (BPO)</p>
            </div>
            
            <div style="background:#f5f5f5;padding:20px;border-radius:12px;margin-bottom:25px;">
                <h3 style="margin:0 0 15px 0;color:#42a5f5;font-size:16px;">üìä Dados do Cliente</h3>
                <p style="margin:0;color:#666;font-size:14px;"><strong>Empresa:</strong> ${dadosEmpresa.nome || 'N√£o informado'}</p>
                <p style="margin:5px 0 0 0;color:#666;font-size:14px;"><strong>Respons√°vel:</strong> ${dadosEmpresa.responsavel || 'N√£o informado'}</p>
            </div>
            
            <form id="form-proposta" style="display:flex;flex-direction:column;gap:20px;">
                <div>
                    <label style="display:block;margin-bottom:8px;color:#333;font-weight:600;font-size:14px;">üè¢ Nome da sua Empresa (BPO)</label>
                    <input type="text" id="nome-bpo" value="${dadosBPO.nome || ''}" required 
                           style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;"
                           placeholder="Ex: Consultoria XYZ">
                </div>
                
                <div>
                    <label style="display:block;margin-bottom:8px;color:#333;font-weight:600;font-size:14px;">üë§ Seu Nome (Consultor)</label>
                    <input type="text" id="nome-consultor" value="${dadosBPO.consultor || ''}" required 
                           style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;"
                           placeholder="Ex: Jo√£o Silva">
                </div>
                
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;">
                    <div>
                        <label style="display:block;margin-bottom:8px;color:#333;font-weight:600;font-size:14px;">üìß Email</label>
                        <input type="email" id="email-bpo" value="${dadosBPO.email || ''}" required 
                               style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;"
                               placeholder="contato@empresa.com">
                    </div>
                    <div>
                        <label style="display:block;margin-bottom:8px;color:#333;font-weight:600;font-size:14px;">üì± WhatsApp</label>
                        <input type="tel" id="whatsapp-bpo" value="${dadosBPO.whatsapp || ''}" required 
                               style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;"
                               placeholder="(51) 99999-9999">
                    </div>
                </div>
                
                <div>
                    <label style="display:block;margin-bottom:8px;color:#333;font-weight:600;font-size:14px;">üåê Website (opcional)</label>
                    <input type="url" id="website-bpo" value="${dadosBPO.website || ''}" 
                           style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;"
                           placeholder="https://www.empresa.com">
                </div>
                
                <div style="display:flex;gap:15px;margin-top:10px;">
                    <button type="button" onclick="fecharModalProposta()" 
                            style="flex:1;padding:14px;background:#e0e0e0;border:none;border-radius:8px;color:#333;font-weight:600;cursor:pointer;font-size:15px;">
                        Cancelar
                    </button>
                    <button type="submit" 
                            style="flex:2;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);border:none;border-radius:8px;color:#fff;font-weight:600;cursor:pointer;font-size:15px;">
                        üìÑ Gerar Proposta PDF
                    </button>
                </div>
            </form>
        </div>
        
        <style>
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
        </style>
    `;
    
    document.body.appendChild(modal);
    
    // Handler do formul√°rio
    document.getElementById('form-proposta').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Salvar dados do BPO
        const dadosBPO = {
            nome: document.getElementById('nome-bpo').value,
            consultor: document.getElementById('nome-consultor').value,
            email: document.getElementById('email-bpo').value,
            whatsapp: document.getElementById('whatsapp-bpo').value,
            website: document.getElementById('website-bpo').value
        };
        
        localStorage.setItem('dados_bpo', JSON.stringify(dadosBPO));
        
        // Fechar modal
        fecharModalProposta();
        
        // Gerar proposta
        await gerarPropostaComercialPDF(dadosBPO);
    });
}

function fecharModalProposta() {
    const modal = document.getElementById('modal-proposta');
    if (modal) {
        document.body.removeChild(modal);
    }
}

async function gerarPropostaComercialPDF(dadosBPO) {
    console.log('üíº Gerando Proposta Comercial PDF...');
    
    try {
        // Loading
        const loading = document.createElement('div');
        loading.id = 'proposta-loading';
        loading.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:40px 60px;border-radius:16px;z-index:9999;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.4);';
        loading.innerHTML = '<div style="font-size:64px;margin-bottom:15px;">üíº</div><div style="font-size:20px;font-weight:bold;margin-bottom:10px;">Gerando Proposta Comercial</div><div style="font-size:14px;opacity:0.9;">Criando documento profissional...</div>';
        document.body.appendChild(loading);
        
        await new Promise(resolve => setTimeout(resolve, 100));
        
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'a4');
        
        const C = {
            prim: [66,165,245],
            sec: [156,39,176],
            suc: [76,175,80],
            alert: [255,152,0],
            dang: [244,67,54],
            txt: [51,51,51],
            light: [117,117,117],
            gold: [255,193,7]
        };
        
        const dadosCliente = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
        const resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
        const scores = calcularScoresPorCategoria(resp);
        const scoreGeral = Math.round((
            scores.tesouraria + scores.resultados + scores.fluxo + scores.orcamento + 
            scores.investimentos + scores.riscos + scores.indicadores + scores.tributario
        ) / 8);
        
        const faturamento = parseFloat(dadosCliente.faturamento || '1000000');
        const perdasAnuais = faturamento * 0.16;
        
        let y = 20;
        
        // P√ÅGINA 1: CAPA
        doc.setFillColor(66,165,245);
        doc.rect(0,0,210,100,'F');
        doc.setFillColor(76,155,235);
        doc.rect(0,0,210,80,'F');
        doc.setFillColor(86,145,225);
        doc.rect(0,0,210,60,'F');
        
        doc.setTextColor(255,255,255);
        doc.setFontSize(36);
        doc.setFont('helvetica','bold');
        doc.text('PROPOSTA COMERCIAL', 105, 40, {align:'center'});
        
        doc.setFontSize(18);
        doc.setFont('helvetica','normal');
        doc.text('Consultoria em Gest√£o Financeira', 105, 55, {align:'center'});
        
        y = 120;
        doc.setFillColor(255,255,255);
        doc.roundedRect(30,y,150,70,5,5,'F');
        
        doc.setTextColor(...C.txt);
        doc.setFontSize(12);
        doc.setFont('helvetica','bold');
        doc.text('PREPARADO POR:', 40, y+15);
        doc.setFontSize(16);
        doc.setTextColor(...C.prim);
        doc.text(dadosBPO.nome, 40, y+25);
        
        doc.setFontSize(11);
        doc.setTextColor(...C.txt);
        doc.setFont('helvetica','normal');
        doc.text('Consultor: ' + dadosBPO.consultor, 40, y+35);
        doc.text('Email: ' + dadosBPO.email, 40, y+42);
        doc.text('WhatsApp: ' + dadosBPO.whatsapp, 40, y+49);
        
        doc.setFont('helvetica','bold');
        doc.text('PREPARADO PARA:', 40, y+60);
        doc.setFontSize(14);
        doc.setTextColor(...C.sec);
        doc.text(dadosCliente.nome || 'Cliente', 40, y+68);
        
        y = 250;
        doc.setTextColor(...C.light);
        doc.setFontSize(10);
        doc.setFont('helvetica','normal');
        const hoje = new Date().toLocaleDateString('pt-BR', {day:'2-digit',month:'long',year:'numeric'});
        doc.text('Proposta gerada em ' + hoje, 105, y, {align:'center'});
        doc.setFontSize(8);
        doc.text('Validade: 30 dias', 105, y+7, {align:'center'});
        
        console.log('‚úÖ Capa criada');
        
        // P√ÅGINA 2: DIAGN√ìSTICO
        doc.addPage();
        y = 20;
        doc.setFillColor(...C.dang);
        doc.rect(0,y-5,210,16,'F');
        doc.setTextColor(255,255,255);
        doc.setFontSize(16);
        doc.setFont('helvetica','bold');
        doc.text('DIAGN√ìSTICO ATUAL', 20, y+6);
        
        y += 30;
        doc.setTextColor(...C.txt);
        doc.setFontSize(11);
        doc.setFont('helvetica','normal');
        doc.text('Score Atual: ' + scoreGeral + '/100', 20, y);
        y += 8;
        doc.text('Perdas Estimadas: R$ ' + Math.round(perdasAnuais/1000) + 'k/ano', 20, y);
        y += 15;
        
        doc.setFontSize(13);
        doc.setFont('helvetica','bold');
        doc.text('Problemas Identificados:', 20, y);
        y += 10;
        
        doc.setFontSize(10);
        doc.setFont('helvetica','normal');
        const problemas = [
            'Controles financeiros insuficientes',
            'Falta de planejamento orcamentario',
            'Desperdicio por falta de indicadores',
            'Riscos nao mapeados',
            'Oportunidades nao aproveitadas'
        ];
        
        problemas.forEach(function(p) {
            doc.text('* ' + p, 25, y);
            y += 7;
        });
        
        console.log('‚úÖ Diagn√≥stico criado');
        
        // P√ÅGINA 3: INVESTIMENTO
        doc.addPage();
        y = 20;
        doc.setFillColor(...C.gold);
        doc.rect(0,y-5,210,16,'F');
        doc.setTextColor(255,255,255);
        doc.setFontSize(16);
        doc.setFont('helvetica','bold');
        doc.text('INVESTIMENTO', 20, y+6);
        
        y += 30;
        
        const pacotes = [
            {nome: 'DIY', valor: 'R$ 47/mes', desc: 'Sistema + Suporte'},
            {nome: 'LIGHT', valor: 'R$ 2.500/mes', desc: 'Sistema + Consultoria Basica'},
            {nome: 'FULL', valor: 'R$ 8.000/mes', desc: 'Sistema + Consultoria Completa'}
        ];
        
        pacotes.forEach(function(p) {
            doc.setFillColor(240,240,240);
            doc.roundedRect(20,y,170,25,3,3,'F');
            
            doc.setTextColor(...C.txt);
            doc.setFontSize(14);
            doc.setFont('helvetica','bold');
            doc.text(p.nome, 30, y+10);
            
            doc.setFontSize(16);
            doc.setTextColor(...C.prim);
            doc.text(p.valor, 30, y+18);
            
            doc.setFontSize(10);
            doc.setTextColor(...C.light);
            doc.setFont('helvetica','normal');
            doc.text(p.desc, 110, y+14);
            
            y += 30;
        });
        
        console.log('‚úÖ Investimento criado');
        
        // P√ÅGINA 4: ROI
        doc.addPage();
        y = 20;
        doc.setFillColor(...C.suc);
        doc.rect(0,y-5,210,16,'F');
        doc.setTextColor(255,255,255);
        doc.setFontSize(16);
        doc.setFont('helvetica','bold');
        doc.text('ROI PROJETADO', 20, y+6);
        
        y += 30;
        doc.setTextColor(...C.txt);
        doc.setFontSize(12);
        doc.setFont('helvetica','normal');
        doc.text('Perdas Atuais: R$ ' + Math.round(perdasAnuais/1000) + 'k/ano', 20, y);
        y += 10;
        doc.text('Economia Prevista: R$ ' + Math.round(perdasAnuais*0.7/1000) + 'k/ano (70%)', 20, y);
        y += 10;
        doc.text('Investimento LIGHT: R$ 30k/ano', 20, y);
        y += 10;
        
        const roi = Math.round((perdasAnuais*0.7 - 30000) / 30000 * 100);
        doc.setFont('helvetica','bold');
        doc.setFontSize(14);
        doc.setTextColor(...C.suc);
        doc.text('ROI: ' + roi + '%', 20, y);
        
        console.log('‚úÖ ROI criado');
        
        // P√ÅGINA 5: PR√ìXIMOS PASSOS
        doc.addPage();
        y = 20;
        doc.setFillColor(...C.prim);
        doc.rect(0,y-5,210,16,'F');
        doc.setTextColor(255,255,255);
        doc.setFontSize(16);
        doc.setFont('helvetica','bold');
        doc.text('PROXIMOS PASSOS', 20, y+6);
        
        y += 30;
        doc.setTextColor(...C.txt);
        doc.setFontSize(11);
        doc.setFont('helvetica','normal');
        
        const passos = [
            '1. Aprovacao da proposta',
            '2. Assinatura do contrato',
            '3. Kickoff em 7 dias',
            '4. Implementacao: 90 dias',
            '5. Acompanhamento mensal'
        ];
        
        passos.forEach(function(p) {
            doc.text(p, 20, y);
            y += 8;
        });
        
        y += 10;
        doc.setFillColor(...C.suc);
        doc.roundedRect(20,y,170,20,3,3,'F');
        doc.setTextColor(255,255,255);
        doc.setFontSize(12);
        doc.setFont('helvetica','bold');
        doc.text('Entre em contato para iniciarmos!', 105, y+12, {align:'center'});
        
        console.log('‚úÖ Pr√≥ximos passos criado');
        
        // Remover loading
        if (document.getElementById('proposta-loading')) {
            document.body.removeChild(document.getElementById('proposta-loading'));
        }
        
        // Salvar PDF
        const nomeCliente = dadosCliente.nome || 'Cliente';
        const nomeArquivo = 'Proposta_Comercial_' + nomeCliente.replace(/[^a-z0-9]/gi, '_') + '_' + new Date().toISOString().split('T')[0] + '.pdf';
        doc.save(nomeArquivo);
        
        console.log('‚úÖ Proposta gerada: ' + nomeArquivo);
        alert('‚úÖ Proposta Comercial gerada com sucesso!\n\nüìÑ Arquivo: ' + nomeArquivo + '\n\nEnvie para seu cliente e feche a venda! üí∞');
        
    } catch (erro) {
        console.error('‚ùå Erro ao gerar proposta:', erro);
        const loadingEl = document.getElementById('proposta-loading');
        if (loadingEl) {
            document.body.removeChild(loadingEl);
        }
        alert('‚ùå Erro ao gerar proposta:\n\n' + erro.message);
    }
}


// PROPOSTA COMERCIAL - JAVASCRIPT

console.log('üöÄ SPRINT 3: Sistema Completo Carregado!');

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CAT√ÅLOGO COMPLETO DE PRODUTOS (11 produtos)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const PRODUTOS_CATALOGO = {
    // N√çVEL 1: FUNDA√á√ÉO
    'tesouraria': {
        nivel: 1,
        nome: '1. Implanta√ß√£o de Tesouraria',
        icone: 'üí∞',
        categoria: 'tesouraria',
        descricao: 'Estrutura√ß√£o completa da tesouraria com separa√ß√£o PF/PJ, concilia√ß√£o banc√°ria, calend√°rio de pagamentos e controle de inadimpl√™ncia.',
        valorPadrao: 3500,
        valorMin: 2500,
        valorMax: 5000,
        prazoPadrao: 45,
        prazoMin: 30,
        prazoMax: 45,
        recorrente: false,
        preRequisitos: [],
        expertise: 'basica',
        entregaveis: [
            'Separa√ß√£o PF/PJ completa',
            'Concilia√ß√£o banc√°ria estruturada',
            'Calend√°rio de pagamentos/recebimentos',
            'Controle de inadimpl√™ncia',
            'Pol√≠tica de aprova√ß√£o de pagamentos',
            'Dashboards de tesouraria'
        ],
        roi: {
            retornoMensal: 12000,
            percentual: 343,
            paybackDias: 9,
            beneficios: [
                { descricao: 'Evita cheque especial e empr√©stimos emergenciais', valor: 6000 },
                { descricao: 'Reduz multas, juros e IOF por atrasos', valor: 3500 },
                { descricao: 'Recupera cr√©ditos com cobran√ßa estruturada', valor: 2500 }
            ]
        }
    },
    'fluxo': {
        nivel: 1,
        nome: '2. Estrutura√ß√£o de Fluxo de Caixa',
        icone: 'üíµ',
        categoria: 'fluxo',
        descricao: 'Proje√ß√£o de fluxo de caixa 12 meses, an√°lise de capital de giro, mapeamento de ciclo financeiro e identifica√ß√£o de gaps de caixa.',
        valorPadrao: 4500,
        valorMin: 3000,
        valorMax: 6000,
        prazoPadrao: 60,
        prazoMin: 30,
        prazoMax: 60,
        recorrente: false,
        preRequisitos: ['tesouraria'],
        expertise: 'basica',
        entregaveis: [
            'Proje√ß√£o de fluxo 12 meses',
            'An√°lise de capital de giro necess√°rio',
            'Mapeamento de ciclo financeiro',
            'Identifica√ß√£o de gaps de caixa',
            'Cen√°rios (otimista/realista/pessimista)',
            'Ferramentas de acompanhamento semanal'
        ],
        roi: {
            retornoMensal: 18000,
            percentual: 400,
            paybackDias: 8,
            beneficios: [
                { descricao: 'Evita cr√©dito caro em momentos de gap', valor: 8000 },
                { descricao: 'Aproveita descontos pagando √† vista', valor: 5500 },
                { descricao: 'Otimiza aplica√ß√µes em per√≠odos de sobra', valor: 4500 }
            ]
        }
    },
    'dre': {
        nivel: 1,
        nome: '3. Implementa√ß√£o de DRE Gerencial',
        icone: 'üìà',
        categoria: 'resultados',
        descricao: 'DRE gerencial mensal estruturada com classifica√ß√£o de custos/despesas, an√°lise de margens e lucratividade por produto.',
        valorPadrao: 5000,
        valorMin: 3500,
        valorMax: 7000,
        prazoPadrao: 60,
        prazoMin: 45,
        prazoMax: 60,
        recorrente: false,
        preRequisitos: ['tesouraria'],
        expertise: 'intermediaria',
        entregaveis: [
            'DRE gerencial mensal estruturada',
            'Classifica√ß√£o correta custos/despesas',
            'An√°lise de margens (bruta/operacional/l√≠quida)',
            'Comparativo m√™s a m√™s',
            'An√°lise vertical e horizontal',
            'Lucratividade por produto/servi√ßo'
        ],
        roi: {
            retornoMensal: 22000,
            percentual: 440,
            paybackDias: 7,
            beneficios: [
                { descricao: 'Identifica produtos/servi√ßos n√£o lucrativos', valor: 10000 },
                { descricao: 'Otimiza mix de produtos aumentando margem', valor: 8000 },
                { descricao: 'Reduz desperd√≠cios e custos ocultos', valor: 4000 }
            ]
        }
    },
    
    // N√çVEL 2: INTERMEDI√ÅRIOS
    'orcamento': {
        nivel: 2,
        nome: '4. Planejamento Or√ßament√°rio Anual',
        icone: 'üìä',
        categoria: 'orcamento',
        descricao: 'Or√ßamento anual completo por categoria, metas mensais, sistema Or√ßado vs Realizado e revis√µes trimestrais.',
        valorPadrao: 6000,
        valorMin: 4000,
        valorMax: 8000,
        prazoPadrao: 90,
        prazoMin: 60,
        prazoMax: 90,
        recorrente: false,
        preRequisitos: ['dre', 'fluxo'],
        expertise: 'intermediaria',
        entregaveis: [
            'Or√ßamento anual por categoria',
            'Metas por m√™s',
            'Sistema Or√ßado vs Realizado',
            'An√°lise de desvios mensal',
            'Revis√µes trimestrais',
            'Dashboards de acompanhamento'
        ],
        roi: {
            retornoMensal: 15000,
            percentual: 250,
            paybackDias: 12,
            beneficios: [
                { descricao: 'Controla despesas evitando estouros', valor: 7000 },
                { descricao: 'Planeja investimentos com seguran√ßa', valor: 5000 },
                { descricao: 'Antecipa problemas e oportunidades', valor: 3000 }
            ]
        }
    },
    'custos': {
        nivel: 2,
        nome: '5. Gest√£o de Custos e Despesas',
        icone: 'üíº',
        categoria: 'custos',
        descricao: 'Reclassifica√ß√£o completa de custos/despesas, identifica√ß√£o de fixos vs vari√°veis, break-even e plano de redu√ß√£o de desperd√≠cios.',
        valorPadrao: 5000,
        valorMin: 3500,
        valorMax: 7000,
        prazoPadrao: 60,
        prazoMin: 45,
        prazoMax: 60,
        recorrente: false,
        preRequisitos: ['dre'],
        expertise: 'intermediaria',
        entregaveis: [
            'Reclassifica√ß√£o completa custos/despesas',
            'Identifica√ß√£o custos fixos vs vari√°veis',
            'An√°lise de oportunidades de redu√ß√£o',
            'Ponto de equil√≠brio (break-even)',
            'Custeio por produto/servi√ßo',
            'Plano de redu√ß√£o de desperd√≠cios'
        ],
        roi: {
            retornoMensal: 25000,
            percentual: 500,
            paybackDias: 6,
            beneficios: [
                { descricao: 'Elimina desperd√≠cios e retrabalhos', valor: 12000 },
                { descricao: 'Renegocia contratos com fornecedores', valor: 8000 },
                { descricao: 'Otimiza estrutura operacional', valor: 5000 }
            ]
        }
    },
    'investimentos': {
        nivel: 2,
        nome: '6. Gest√£o de Investimentos',
        icone: 'üöÄ',
        categoria: 'investimentos',
        descricao: 'An√°lise de viabilidade de projetos (VPL/TIR), prioriza√ß√£o de investimentos, pol√≠tica de CAPEX e acompanhamento de ROI.',
        valorPadrao: 7500,
        valorMin: 5000,
        valorMax: 10000,
        prazoPadrao: 90,
        prazoMin: 60,
        prazoMax: 90,
        recorrente: false,
        preRequisitos: ['dre', 'fluxo', 'orcamento'],
        expertise: 'avancada',
        entregaveis: [
            'An√°lise de viabilidade de projetos (VPL/TIR)',
            'Prioriza√ß√£o de investimentos',
            'Pol√≠tica de aprova√ß√£o de CAPEX',
            'Acompanhamento de ROI',
            'Or√ßamento de investimentos',
            'Sistema de aprova√ß√£o de projetos'
        ],
        roi: {
            retornoMensal: 30000,
            percentual: 400,
            paybackDias: 8,
            beneficios: [
                { descricao: 'Evita investimentos ruins (sunk cost)', valor: 15000 },
                { descricao: 'Prioriza projetos de maior retorno', valor: 10000 },
                { descricao: 'Acelera payback dos investimentos', valor: 5000 }
            ]
        }
    },
    
    // N√çVEL 3: AVAN√áADOS
    'indicadores': {
        nivel: 3,
        nome: '7. Dashboard de Indicadores (KPIs)',
        icone: 'üìä',
        categoria: 'indicadores',
        descricao: '15-25 indicadores estrat√©gicos relevantes para o neg√≥cio, dashboard executivo visual, metas e benchmarks por indicador.',
        valorPadrao: 6500,
        valorMin: 4500,
        valorMax: 9000,
        prazoPadrao: 60,
        prazoMin: 60,
        prazoMax: 60,
        recorrente: false,
        preRequisitos: ['tesouraria', 'dre', 'fluxo'],
        expertise: 'intermediaria',
        entregaveis: [
            '15-25 indicadores relevantes para o neg√≥cio',
            'Dashboard executivo visual',
            'Metas e benchmarks por indicador',
            'Sistema de alertas autom√°ticos',
            'Reuni√£o mensal de an√°lise de KPIs',
            'Treinamento da equipe'
        ],
        roi: {
            retornoMensal: 12000,
            percentual: 185,
            paybackDias: 16,
            beneficios: [
                { descricao: 'Decis√µes baseadas em dados reais', valor: 6000 },
                { descricao: 'Identifica problemas antes virarem crises', valor: 4000 },
                { descricao: 'Aumenta produtividade da equipe', valor: 2000 }
            ]
        }
    },
    'riscos': {
        nivel: 3,
        nome: '8. Gest√£o de Riscos Financeiros',
        icone: 'üõ°Ô∏è',
        categoria: 'riscos',
        descricao: 'Mapeamento completo de riscos financeiros, matriz impacto x probabilidade, planos de conting√™ncia e controles internos.',
        valorPadrao: 7500,
        valorMin: 5000,
        valorMax: 10000,
        prazoPadrao: 90,
        prazoMin: 60,
        prazoMax: 90,
        recorrente: false,
        preRequisitos: ['tesouraria', 'dre', 'fluxo', 'orcamento', 'custos'],
        expertise: 'avancada',
        entregaveis: [
            'Mapeamento de riscos financeiros',
            'Matriz de impacto x probabilidade',
            'Planos de conting√™ncia',
            'Pol√≠tica de al√ßadas e aprova√ß√µes',
            'Controles internos',
            'Monitoramento cont√≠nuo'
        ],
        roi: {
            retornoMensal: 20000,
            percentual: 267,
            paybackDias: 11,
            beneficios: [
                { descricao: 'Evita preju√≠zos por fraudes/desvios', valor: 10000 },
                { descricao: 'Previne crises e situa√ß√µes emergenciais', valor: 7000 },
                { descricao: 'Reduz pr√™mios de seguros e garantias', valor: 3000 }
            ]
        }
    },
    'tributario': {
        nivel: 3,
        nome: '9. Planejamento Tribut√°rio',
        icone: 'üìú',
        categoria: 'tributario',
        descricao: 'An√°lise do regime tribut√°rio ideal, elis√£o fiscal (dentro da lei), calend√°rio de obriga√ß√µes e recupera√ß√£o de cr√©ditos.',
        valorPadrao: 10000,
        valorMin: 6000,
        valorMax: 15000,
        prazoPadrao: 120,
        prazoMin: 90,
        prazoMax: 120,
        recorrente: false,
        preRequisitos: ['dre', 'fluxo', 'custos'],
        expertise: 'avancada',
        entregaveis: [
            'An√°lise do regime tribut√°rio ideal',
            'Elis√£o fiscal (dentro da lei)',
            'Calend√°rio de obriga√ß√µes',
            'Provis√µes tribut√°rias',
            'Recupera√ß√£o de cr√©ditos',
            'Acompanhamento mensal'
        ],
        roi: {
            retornoMensal: 45000,
            percentual: 450,
            paybackDias: 7,
            beneficios: [
                { descricao: 'Escolha do regime tribut√°rio ideal', valor: 25000 },
                { descricao: 'Recupera√ß√£o de cr√©ditos tribut√°rios', valor: 15000 },
                { descricao: 'Evita multas e penalidades fiscais', valor: 5000 }
            ]
        }
    },
    
    // N√çVEL 4: ACOMPANHAMENTO
    'plano-acao': {
        nivel: 4,
        nome: '10. Plano de A√ß√£o PRO',
        icone: 'üéØ',
        categoria: 'plano-acao',
        descricao: 'Software de gest√£o estrat√©gica com importa√ß√£o autom√°tica das a√ß√µes, gest√£o de tarefas e dashboards de progresso.',
        valorPadrao: 47,
        valorMin: 47,
        valorMax: 497,
        prazoPadrao: 12,
        prazoMin: 6,
        prazoMax: 24,
        recorrente: true,
        preRequisitos: [],
        expertise: 'basica',
        entregaveis: [
            'Importa√ß√£o autom√°tica das a√ß√µes',
            'Gest√£o de tarefas por respons√°vel',
            'Timeline visual de execu√ß√£o',
            'Notifica√ß√µes de prazos',
            'Dashboards de progresso',
            'Relat√≥rios de acompanhamento'
        ],
        roi: {
            retornoMensal: 3500,
            percentual: 7447,
            paybackDias: 0.4,
            beneficios: [
                { descricao: 'Garante execu√ß√£o das a√ß√µes planejadas', valor: 2000 },
                { descricao: 'Aumenta produtividade da equipe em 30%', valor: 1000 },
                { descricao: 'Evita esquecimentos e retrabalhos', valor: 500 }
            ]
        }
    },
    'consultoria': {
        nivel: 4,
        nome: '11. Consultoria Mensal',
        icone: 'üë•',
        categoria: 'consultoria',
        descricao: 'Reuni√µes mensais de acompanhamento, an√°lise de KPIs, ajustes no plano e suporte via WhatsApp/Email.',
        valorPadrao: 2500,
        valorMin: 1500,
        valorMax: 5000,
        prazoPadrao: 12,
        prazoMin: 6,
        prazoMax: 24,
        recorrente: true,
        preRequisitos: [],
        expertise: 'intermediaria',
        entregaveis: [
            '1-2 reuni√µes mensais (1-2h cada)',
            'An√°lise de KPIs e resultados',
            'Ajustes no plano de a√ß√£o',
            'Suporte via WhatsApp/Email',
            'Relat√≥rios mensais de progresso',
            'Revis√£o trimestral de estrat√©gia'
        ],
        roi: {
            retornoMensal: 15000,
            percentual: 600,
            paybackDias: 5,
            beneficios: [
                { descricao: 'Ajustes r√°pidos evitam perdas', valor: 8000 },
                { descricao: 'Expertise externa identifica oportunidades', valor: 5000 },
                { descricao: 'Suporte cont√≠nuo acelera resultados', valor: 2000 }
            ]
        }
    }
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INTEGRA√á√ÉO COM DIAGN√ìSTICO REAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

let DIAGNOSTICO_DADOS = {
    empresa: {
        nome: 'Empresa Exemplo'
    },
    scores: {
        tesouraria: 35,
        resultados: 52,
        fluxo: 40,
        orcamento: 28,
        custos: 55,
        investimentos: 30,
        indicadores: 45,
        riscos: 58,
        tributario: 60
    },
    scoreGeral: 45,
    perdas: 127450,
    ganhos: 318625
};

// Tentar carregar dados reais do diagn√≥stico
function carregarDadosDiagnostico() {
    try {
        // Tentar buscar empresa ativa
        const empresaAtivaId = localStorage.getItem('empresa_ativa');
        
        if (empresaAtivaId) {
            console.log('‚úÖ Empresa ativa encontrada:', empresaAtivaId);
            
            // Buscar dados da empresa
            const empresasLista = localStorage.getItem('empresas_lista');
            if (empresasLista) {
                const empresas = JSON.parse(empresasLista);
                const empresa = empresas[empresaAtivaId];
                if (empresa) {
                    DIAGNOSTICO_DADOS.empresa.nome = empresa.nome;
                    console.log('‚úÖ Nome da empresa carregado:', empresa.nome);
                }
            }
            
            // Buscar respostas do diagn√≥stico
            const respostasKey = 'diag_resp_' + empresaAtivaId;
            const respostasStr = localStorage.getItem(respostasKey);
            
            if (respostasStr) {
                const respostas = JSON.parse(respostasStr);
                console.log('‚úÖ Respostas do diagn√≥stico encontradas');
                
                // Calcular scores por categoria
                const scores = calcularScoresPorCategoria(respostas);
                DIAGNOSTICO_DADOS.scores = scores;
                
                // Calcular score geral
                const scoreGeral = Math.round(Object.values(scores).reduce((a, b) => a + b, 0) / Object.keys(scores).length);
                DIAGNOSTICO_DADOS.scoreGeral = scoreGeral;
                
                // Calcular perdas e ganhos (estimativa baseada em scores)
                DIAGNOSTICO_DADOS.perdas = calcularPerdasEstimadas(scores);
                DIAGNOSTICO_DADOS.ganhos = calcularGanhosEstimados(scores);
                
                console.log('‚úÖ Dados do diagn√≥stico carregados:', DIAGNOSTICO_DADOS);
            }
        } else {
            console.log('‚ö†Ô∏è Nenhuma empresa ativa. Usando dados de exemplo.');
        }
    } catch (erro) {
        console.error('‚ùå Erro ao carregar dados do diagn√≥stico:', erro);
        console.log('‚ÑπÔ∏è Usando dados de exemplo.');
    }
    
    // Atualizar UI com dados carregados
    atualizarResumoDiagnostico();
}

// Calcular scores por categoria
function calcularScoresPorCategoria(respostas) {
    const CATEGORIAS_PERGUNTAS = {
        tesouraria: ['t1', 't2', 't3', 't4', 't5', 't9', 't10', 't11', 't13', 't14'],
        resultados: ['r1', 'r2', 'r3', 'r4', 'r5', 'r7', 'r9', 'r11', 'r13', 'r14'],
        fluxo: ['f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f9', 'f13', 'f15'],
        orcamento: ['o1', 'o2', 'o3', 'o4', 'o5', 'o6', 'o7', 'o9', 'o10', 'o14'],
        custos: ['c1', 'c2', 'c3', 'c4', 'c5', 'c6', 'c7', 'c8', 'c9', 'c10'],
        investimentos: ['i1', 'i2', 'i3', 'i4', 'i5', 'i6', 'i9', 'i11', 'i13', 'i14'],
        indicadores: ['if1', 'if2', 'if3', 'if4', 'if5', 'if6', 'if7', 'if8', 'if11', 'if14'],
        riscos: ['g1', 'g2', 'g3', 'g5', 'g6', 'g9', 'g10', 'g11', 'g12', 'g14'],
        tributario: ['pt1', 'pt2', 'pt3', 'pt4', 'pt5', 'pt6', 'pt8', 'pt10', 'pt12', 'pt14']
    };
    
    const scores = {};
    
    for (const categoria in CATEGORIAS_PERGUNTAS) {
        const perguntas = CATEGORIAS_PERGUNTAS[categoria];
        let soma = 0;
        let count = 0;
        
        perguntas.forEach(perguntaId => {
            if (respostas[perguntaId] && respostas[perguntaId].pts !== undefined) {
                soma += respostas[perguntaId].pts;
                count++;
            }
        });
        
        const max = count * 3; // Cada pergunta vale 0-3 pontos
        scores[categoria] = max > 0 ? Math.round((soma / max) * 100) : 0;
    }
    
    return scores;
}

// Calcular perdas estimadas
function calcularPerdasEstimadas(scores) {
    let perdas = 0;
    
    // Quanto pior o score, maior a perda
    for (const categoria in scores) {
        const score = scores[categoria];
        const fatorPerda = (100 - score) / 100; // 0 a 1
        
        // Estimativa de perda por categoria (valores base)
        const perdasBase = {
            tesouraria: 40000,
            resultados: 35000,
            fluxo: 45000,
            orcamento: 30000,
            custos: 38000,
            investimentos: 42000,
            indicadores: 28000,
            riscos: 35000,
            tributario: 50000
        };
        
        perdas += perdasBase[categoria] * fatorPerda;
    }
    
    return Math.round(perdas);
}

// Calcular ganhos estimados
function calcularGanhosEstimados(scores) {
    let ganhos = 0;
    
    // Quanto melhor implementar, maior o ganho potencial
    for (const categoria in scores) {
        const score = scores[categoria];
        const potencialMelhoria = (100 - score) / 100; // 0 a 1
        
        // Estimativa de ganho potencial por categoria
        const ganhosBase = {
            tesouraria: 55000,
            resultados: 65000,
            fluxo: 70000,
            orcamento: 48000,
            custos: 62000,
            investimentos: 85000,
            indicadores: 42000,
            riscos: 45000,
            tributario: 95000
        };
        
        ganhos += ganhosBase[categoria] * potencialMelhoria;
    }
    
    return Math.round(ganhos);
}

// Atualizar resumo do diagn√≥stico na UI
function atualizarResumoDiagnostico() {
    // Nome da empresa
    document.getElementById('empresa-nome').textContent = DIAGNOSTICO_DADOS.empresa.nome;
    
    // Totais
    document.getElementById('perdas-totais').textContent = 'R$ ' + DIAGNOSTICO_DADOS.perdas.toLocaleString('pt-BR') + '/ano';
    document.getElementById('ganhos-totais').textContent = 'R$ ' + DIAGNOSTICO_DADOS.ganhos.toLocaleString('pt-BR') + '/ano';
    document.getElementById('score-geral').textContent = DIAGNOSTICO_DADOS.scoreGeral + '/100';
    
    // Scores por categoria
    const scoresContainer = document.getElementById('scores-categorias');
    const nomesCategorias = {
        tesouraria: 'üí∞ Tesouraria',
        resultados: 'üìà Resultados',
        fluxo: 'üíµ Fluxo de Caixa',
        orcamento: 'üìä Or√ßamento',
        custos: 'üíº Custos',
        investimentos: 'üöÄ Investimentos',
        indicadores: 'üìà Indicadores',
        riscos: 'üõ°Ô∏è Riscos',
        tributario: '‚öñÔ∏è Compliance'
    };
    
    let html = '';
    let categoriasCriticas = [];
    
    for (const categoria in DIAGNOSTICO_DADOS.scores) {
        const score = DIAGNOSTICO_DADOS.scores[categoria];
        const nome = nomesCategorias[categoria] || categoria;
        
        let classe = '';
        let emoji = '';
        if (score < 40) {
            classe = 'critico';
            emoji = 'üî¥ CR√çTICO';
            categoriasCriticas.push(nome);
        } else if (score < 70) {
            classe = 'basico';
            emoji = 'üü† B√ÅSICO';
        } else {
            classe = 'organizado';
            emoji = 'üü¢ ORGANIZADO';
        }
        
        html += `
            <div class="score-categoria-item ${classe}">
                <span class="score-categoria-label">${nome}</span>
                <span class="score-categoria-valor">${score} ${emoji}</span>
            </div>
        `;
    }
    
    scoresContainer.innerHTML = html;
    
    // Mostrar categorias cr√≠ticas
    if (categoriasCriticas.length > 0) {
        document.getElementById('categorias-criticas').style.display = 'block';
        document.getElementById('lista-criticas').textContent = categoriasCriticas.join(', ');
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDERIZA√á√ÉO DOS PRODUTOS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function renderizarProdutos() {
    const container = document.getElementById('produtos-container');
    
    const niveis = {
        1: { titulo: 'üèóÔ∏è N√çVEL 1: Produtos Funda√ß√£o', classe: 'nivel-fundacao', subtitulo: 'Base essencial' },
        2: { titulo: 'üìà N√çVEL 2: Produtos Intermedi√°rios', classe: 'nivel-intermediario', subtitulo: 'Requerem N√≠vel 1' },
        3: { titulo: 'üöÄ N√çVEL 3: Produtos Avan√ßados', classe: 'nivel-avancado', subtitulo: 'Requerem N√≠veis 1 e 2' },
        4: { titulo: 'üìã N√çVEL 4: Produtos de Acompanhamento', classe: 'nivel-acompanhamento', subtitulo: 'Recorrentes' }
    };
    
    let html = '';
    
    for (let nivel = 1; nivel <= 4; nivel++) {
        const nivelInfo = niveis[nivel];
        const produtosNivel = Object.keys(PRODUTOS_CATALOGO).filter(id => PRODUTOS_CATALOGO[id].nivel === nivel);
        
        if (produtosNivel.length === 0) continue;
        
        html += `
            <div class="produtos-section">
                <h2 class="produtos-section-title">
                    ${nivelInfo.titulo}
                    <span class="nivel-badge ${nivelInfo.classe}">${nivelInfo.subtitulo}</span>
                </h2>
                <div class="produtos-grid">
        `;
        
        produtosNivel.forEach(produtoId => {
            const produto = PRODUTOS_CATALOGO[produtoId];
            const score = DIAGNOSTICO_DADOS.scores[produto.categoria] || 50;
            
            // Determinar se √© recomendado (score < 40)
            const recomendado = score < 40;
            
            // Determinar se est√° bloqueado (falta pr√©-requisitos)
            const bloqueado = false; // Ser√° calculado dinamicamente
            
            // Badge de score
            let scoreBadge = '';
            if (score < 40) {
                scoreBadge = `<span class="produto-score-badge score-critico">${score}/100 üî¥ CR√çTICO</span>`;
            } else if (score < 70) {
                scoreBadge = `<span class="produto-score-badge score-basico">${score}/100 üü† B√ÅSICO</span>`;
            } else {
                scoreBadge = `<span class="produto-score-badge score-organizado">${score}/100 üü¢ ORGANIZADO</span>`;
            }
            
            // Badge de expertise
            let expertiseBadge = '';
            let expertiseClasse = '';
            if (produto.expertise === 'basica') {
                expertiseBadge = 'üü¢ B√ÅSICA';
                expertiseClasse = 'expertise-basica';
            } else if (produto.expertise === 'intermediaria') {
                expertiseBadge = 'üü° INTERMEDI√ÅRIA';
                expertiseClasse = 'expertise-intermediaria';
            } else {
                expertiseBadge = 'üî¥ AVAN√áADA';
                expertiseClasse = 'expertise-avancada';
            }
            
            // Pr√©-requisitos
            let preRequisitosHtml = '';
            if (produto.preRequisitos.length > 0) {
                const nomesPreRequisitos = produto.preRequisitos.map(id => PRODUTOS_CATALOGO[id].nome).join(', ');
                preRequisitosHtml = `
                    <div class="produto-prerequisitos">
                        <strong>‚ö†Ô∏è Pr√©-requisitos:</strong> ${nomesPreRequisitos}
                    </div>
                `;
            }
            
            // Calcular impacto (perdas/ganhos)
            const impactoPerda = Math.round(DIAGNOSTICO_DADOS.perdas * 0.15); // 15% das perdas totais
            const impactoGanho = Math.round(DIAGNOSTICO_DADOS.ganhos * 0.12); // 12% dos ganhos totais
            
            let impactoHtml = '';
            if (score < 40) {
                impactoHtml = `
                    <div class="produto-impacto perdas">
                        <h4 style="color: #c62828;">üí∏ Perdas Identificadas</h4>
                        <div class="produto-impacto-valor" style="color: #d32f2f;">R$ ${impactoPerda.toLocaleString('pt-BR')}/ano</div>
                    </div>
                `;
            } else if (score < 70) {
                impactoHtml = `
                    <div class="produto-impacto">
                        <h4 style="color: #2e7d32;">üí∞ Ganho Potencial</h4>
                        <div class="produto-impacto-valor" style="color: #388e3c;">R$ ${impactoGanho.toLocaleString('pt-BR')}/ano</div>
                    </div>
                `;
            }
            
            html += `
                <div class="produto-card ${recomendado ? 'produto-recomendado' : ''}" 
                     id="card-${produtoId}" 
                     data-produto="${produtoId}">
                    <div class="produto-checkbox-container">
                        <input type="checkbox" 
                               class="produto-checkbox" 
                               id="check-${produtoId}" 
                               data-produto="${produtoId}" 
                               onchange="validarSelecao('${produtoId}')">
                        <div class="produto-header">
                            <h3 class="produto-titulo">${produto.icone} ${produto.nome}</h3>
                            <div class="produto-score">
                                <span>Score atual:</span>
                                ${scoreBadge}
                            </div>
                        </div>
                    </div>
                    
                    <p class="produto-descricao">${produto.descricao}</p>
                    
                    <div class="produto-campos-editaveis">
                        <div class="campo-editavel">
                            <label class="campo-editavel-label">üíµ ${produto.recorrente ? 'Investimento Mensal (R$)' : 'Investimento (R$)'}</label>
                            <input type="number" 
                                   class="campo-editavel-input" 
                                   id="valor-${produtoId}" 
                                   value="${produto.valorPadrao}" 
                                   min="0" 
                                   step="100" 
                                   onchange="atualizarSelecao()">
                            <span class="campo-editavel-sugestao">Sugest√£o: R$ ${produto.valorMin.toLocaleString('pt-BR')} - ${produto.valorMax.toLocaleString('pt-BR')}</span>
                        </div>
                        <div class="campo-editavel">
                            <label class="campo-editavel-label">‚è±Ô∏è Dura√ß√£o (${produto.recorrente ? 'meses' : 'dias'})</label>
                            <input type="number" 
                                   class="campo-editavel-input" 
                                   id="prazo-${produtoId}" 
                                   value="${produto.prazoPadrao}" 
                                   min="1" 
                                   step="1" 
                                   onchange="atualizarSelecao()">
                            <span class="campo-editavel-sugestao">Sugest√£o: ${produto.prazoMin}-${produto.prazoMax} ${produto.recorrente ? 'meses' : 'dias'}</span>
                        </div>
                    </div>
                    
                    ${produto.roi ? `
                        <div class="produto-roi-box">
                            <div class="produto-roi-header">
                                <span class="produto-roi-icon">üí∞</span>
                                <span class="produto-roi-title">RETORNO DO INVESTIMENTO</span>
                            </div>
                            <div class="produto-roi-grid">
                                <div class="produto-roi-item">
                                    <div class="produto-roi-label">Retorno Mensal</div>
                                    <div class="produto-roi-valor" style="color:#2e7d32;">R$ ${produto.roi.retornoMensal.toLocaleString('pt-BR')}</div>
                                </div>
                                <div class="produto-roi-item">
                                    <div class="produto-roi-label">ROI</div>
                                    <div class="produto-roi-valor" style="color:#1976d2;">${produto.roi.percentual}%</div>
                                </div>
                                <div class="produto-roi-item">
                                    <div class="produto-roi-label">Payback</div>
                                    <div class="produto-roi-valor" style="color:#f57c00;">${produto.roi.paybackDias < 1 ? '<1 dia' : produto.roi.paybackDias + ' dias'}</div>
                                </div>
                            </div>
                            <div class="produto-roi-beneficios">
                                <div class="produto-roi-beneficios-title">üéØ Como vai gerar retorno:</div>
                                ${produto.roi.beneficios.map(b => `
                                    <div class="produto-roi-beneficio">
                                        <span class="produto-roi-beneficio-texto">‚Ä¢ ${b.descricao}</span>
                                        <span class="produto-roi-beneficio-valor">R$ ${b.valor.toLocaleString('pt-BR')}/m√™s</span>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="produto-roi-destaque">
                                üí° A cada R$ 1 investido, retorna <strong>R$ ${(produto.roi.percentual / 100).toFixed(1)}</strong>!
                            </div>
                        </div>
                    ` : ''}
                    
                    ${preRequisitosHtml}
                    ${impactoHtml}
                    
                    <div class="produto-entregaveis">
                        <h4>üì¶ Entreg√°veis:</h4>
                        <ul>
                            ${produto.entregaveis.map(e => `<li>${e}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div class="produto-expertise">
                        <span>üéì Expertise:</span>
                        <span class="expertise-badge ${expertiseClasse}">${expertiseBadge}</span>
                    </div>
                </div>
            `;
        });
        
        html += `
                </div>
            </div>
        `;
    }
    
    container.innerHTML = html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// VALIDA√á√ÉO DE PR√â-REQUISITOS E BLOQUEIO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

let produtoBloqueadoAtual = null;

function validarSelecao(produtoId) {
    const checkbox = document.getElementById('check-' + produtoId);
    const produto = PRODUTOS_CATALOGO[produtoId];
    
    if (!checkbox.checked) {
        // Desmarcou, libera normalmente
        atualizarSelecao();
        return;
    }
    
    // Verificar pr√©-requisitos
    const preRequisitosAtendidos = produto.preRequisitos.every(preReqId => {
        const preReqCheckbox = document.getElementById('check-' + preReqId);
        return preReqCheckbox && preReqCheckbox.checked;
    });
    
    if (!preRequisitosAtendidos) {
        // Bloquear e mostrar alerta
        checkbox.checked = false;
        produtoBloqueadoAtual = produtoId;
        mostrarAlertaBloqueio(produtoId);
        return;
    }
    
    // Pr√©-requisitos OK, atualizar normalmente
    atualizarSelecao();
}

function mostrarAlertaBloqueio(produtoId) {
    const produto = PRODUTOS_CATALOGO[produtoId];
    const preRequisitosNomes = produto.preRequisitos.map(id => PRODUTOS_CATALOGO[id].nome).join(', ');
    
    const mensagem = `
        O produto <strong>"${produto.nome}"</strong> requer os seguintes produtos:
        <br><br>
        <strong style="color: #667eea;">${preRequisitosNomes}</strong>
        <br><br>
        Deseja marcar automaticamente os pr√©-requisitos?
    `;
    
    document.getElementById('alerta-mensagem').innerHTML = mensagem;
    document.getElementById('alerta-overlay').classList.add('show');
    document.getElementById('alerta-bloqueio').classList.add('show');
}

function fecharAlertaBloqueio() {
    document.getElementById('alerta-overlay').classList.remove('show');
    document.getElementById('alerta-bloqueio').classList.remove('show');
    produtoBloqueadoAtual = null;
}

function marcarPreRequisitos() {
    if (!produtoBloqueadoAtual) return;
    
    const produto = PRODUTOS_CATALOGO[produtoBloqueadoAtual];
    
    // Marcar todos os pr√©-requisitos
    produto.preRequisitos.forEach(preReqId => {
        const checkbox = document.getElementById('check-' + preReqId);
        if (checkbox) checkbox.checked = true;
    });
    
    // Marcar o produto original
    const checkbox = document.getElementById('check-' + produtoBloqueadoAtual);
    if (checkbox) checkbox.checked = true;
    
    fecharAlertaBloqueio();
    atualizarSelecao();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ATUALIZA√á√ÉO DO PREVIEW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function atualizarSelecao() {
    const produtosSelecionados = [];
    let totalOnetime = 0;
    let totalRecorrente = 0;
    
    // Percorrer todos os produtos
    for (const produtoId in PRODUTOS_CATALOGO) {
        const checkbox = document.getElementById('check-' + produtoId);
        const card = document.getElementById('card-' + produtoId);
        
        if (checkbox && checkbox.checked) {
            const produto = PRODUTOS_CATALOGO[produtoId];
            const valor = parseFloat(document.getElementById('valor-' + produtoId).value) || 0;
            const prazo = parseInt(document.getElementById('prazo-' + produtoId).value) || 0;
            
            card.classList.add('selecionado');
            
            produtosSelecionados.push({
                id: produtoId,
                nome: produto.nome,
                valor: valor,
                prazo: prazo,
                recorrente: produto.recorrente
            });
            
            if (produto.recorrente) {
                totalRecorrente += valor;
            } else {
                totalOnetime += valor;
            }
        } else if (card) {
            card.classList.remove('selecionado');
        }
    }
    
    // Atualizar contador
    const contador = document.getElementById('contador-produtos');
    let textoContador = produtosSelecionados.length + ' produto' + (produtosSelecionados.length !== 1 ? 's' : '') + ' selecionado' + (produtosSelecionados.length !== 1 ? 's' : '');
    
    // Adicionar badge de pacote se houver
    if (pacoteAtualSelecionado) {
        var pacoteDef = PACOTES_DISPONIVEIS[pacoteAtualSelecionado.nome];
        var descontoPercent = Math.round(pacoteAtualSelecionado.desconto * 100);
        textoContador += '<br><small style="color:#667eea;font-weight:600;">üéÅ ' + (pacoteDef.nome || 'Pacote') + ' (' + descontoPercent + '% OFF)</small>';
    }
    contador.innerHTML = textoContador;
    
    // Atualizar lista de produtos no preview
    const listaEl = document.getElementById('preview-produtos-lista');
    if (produtosSelecionados.length === 0) {
        listaEl.innerHTML = `
            <div style="text-align: center; padding: 40px 20px; color: #999;">
                <div style="font-size: 3em; margin-bottom: 12px;">üõí</div>
                <p>Nenhum produto selecionado</p>
                <p style="font-size: 0.85em; margin-top: 8px;">Marque os checkboxes acima</p>
            </div>
        `;
    } else {
        let html = '';
        produtosSelecionados.forEach(p => {
            html += `
                <div class="preview-produto-item">
                    <div class="preview-produto-nome">${p.nome}</div>
                    <div class="preview-produto-valor">
                        <span>üíµ Valor:</span>
                        <strong>R$ ${p.valor.toLocaleString('pt-BR')}</strong>
                    </div>
                    <div class="preview-produto-valor">
                        <span>‚è±Ô∏è Prazo:</span>
                        <strong>${p.prazo} ${p.recorrente ? 'meses' : 'dias'}</strong>
                    </div>
                    ${p.recorrente ? '<div style="font-size: 0.75em; color: #666; margin-top: 4px;">üîÑ Recorrente</div>' : ''}
                </div>
            `;
        });
        listaEl.innerHTML = html;
    }
    
    // Calcular totais
    let total12Meses = totalOnetime + (totalRecorrente * 12);
    let totalGeral = total12Meses;
    
    // APLICAR DESCONTO DO PACOTE SE HOUVER
    let descontoAplicado = 0;
    if (pacoteAtualSelecionado) {
        descontoAplicado = totalGeral * pacoteAtualSelecionado.desconto;
        totalGeral = totalGeral - descontoAplicado;
        console.log('üí∞ Desconto de pacote aplicado: R$', descontoAplicado.toFixed(2));
    }
    
    // Atualizar displays
    document.getElementById('total-onetime').textContent = 'R$ ' + totalOnetime.toLocaleString('pt-BR');
    document.getElementById('total-recorrente').textContent = 'R$ ' + totalRecorrente.toLocaleString('pt-BR') + '/m√™s';
    
    // Mostrar desconto no total de 12 meses se houver pacote
    if (pacoteAtualSelecionado && descontoAplicado > 0) {
        document.getElementById('total-12meses').innerHTML = '<span style="text-decoration:line-through;opacity:0.6;">R$ ' + total12Meses.toLocaleString('pt-BR') + '</span><br><span style="color:#00b894;font-weight:700;">R$ ' + totalGeral.toLocaleString('pt-BR') + '</span><br><small style="color:#667eea;">üí∞ Economia: R$ ' + descontoAplicado.toLocaleString('pt-BR') + '</small>';
    } else {
        document.getElementById('total-12meses').textContent = 'R$ ' + total12Meses.toLocaleString('pt-BR');
    }
    
    document.getElementById('total-geral').textContent = 'R$ ' + totalGeral.toLocaleString('pt-BR');
    
    // Calcular ROI
    if (totalGeral > 0) {
        const economiaAnual = DIAGNOSTICO_DADOS.perdas * 0.7;
        const ganhosAnual = DIAGNOSTICO_DADOS.ganhos * 0.5;
        const retornoTotal = economiaAnual + ganhosAnual;
        const roi = Math.round(((retornoTotal - totalGeral) / totalGeral) * 100);
        
        document.getElementById('roi-value').textContent = roi + '%';
    } else {
        document.getElementById('roi-value').textContent = '0%';
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ïES DE A√á√ÉO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function gerarPDFProposta() {
    console.log('üéØ Gerando PDF PROPOSTA COMERCIAL PREMIUM...');
    
    // VALIDAR SE TEM PRODUTOS SELECIONADOS
    let temProdutos = false;
    for (const produtoId in PRODUTOS_CATALOGO) {
        const checkbox = document.getElementById('check-' + produtoId);
        if (checkbox && checkbox.checked) {
            temProdutos = true;
            break;
        }
    }
    
    if (!temProdutos) {
        alert('NENHUM PRODUTO SELECIONADO!\n\n' +
              'Para gerar o PDF da proposta:\n\n' +
              '1. Role a pagina para baixo\n' +
              '2. Escolha um PACOTE PRONTO ou\n' +
              '3. Marque PRODUTOS INDIVIDUAIS\n' +
              '4. Depois clique novamente neste botao!\n\n' +
              'Dica: Pacotes ja vem com desconto!');
        return;
    }
    
    try {
        // Loading
        const loading = document.createElement('div');
        loading.id = 'pdf-loading-proposta';
        loading.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#1e3c72 0%,#2a5298 100%);z-index:10000;display:flex;align-items:center;justify-content:center;';
        loading.innerHTML = '<div style="text-align:center;color:white;padding:60px;"><div style="font-size:80px;margin-bottom:30px;">&#128200;</div><div style="font-size:38px;font-weight:900;margin-bottom:20px;">PROPOSTA COMERCIAL PREMIUM</div><div style="font-size:20px;opacity:0.9;margin-bottom:40px;">Gerando documento profissional...</div><div style="width:400px;height:6px;background:rgba(255,255,255,0.2);border-radius:10px;overflow:hidden;margin:0 auto;"><div id="progress-bar-proposta" style="width:0%;height:100%;background:white;transition:width 0.3s;"></div></div><div id="progress-text-proposta" style="margin-top:15px;font-size:14px;opacity:0.7;">Preparando...</div></div>';
        document.body.appendChild(loading);
        
        const updateProgress = (percent, text) => {
            const bar = document.getElementById('progress-bar-proposta');
            const txt = document.getElementById('progress-text-proposta');
            if (bar) bar.style.width = percent + '%';
            if (txt) txt.textContent = text || ('Gerando... ' + percent + '%');
        };
        
        await new Promise(r => setTimeout(r, 300));
        updateProgress(5, 'Carregando dados...');
        
        // Setup PDF
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'a4');
        const W = 210, H = 297;
        const M = 20;
        
        // Cores PROFISSIONAIS
        const C = {
            primary: [30, 60, 114],
            secondary: [42, 82, 152],
            accent: [52, 152, 219],
            success: [39, 174, 96],
            danger: [231, 76, 60],
            warning: [243, 156, 18],
            dark: [44, 62, 80],
            medium: [127, 140, 141],
            light: [236, 240, 241],
            white: [255, 255, 255],
            text: [33, 33, 33]
        };
        
        // Dados
        const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
        const resp = JSON.parse(localStorage.getItem('diag_resp') || '{}');
        const scores = calcularScoresPorCategoria(resp);
        const scoreGeral = Math.round((scores.tesouraria + scores.resultados + scores.fluxo + scores.orcamento + scores.investimentos + scores.riscos + scores.indicadores + scores.tributario) / 8);
        
        const faturamento = parseFloat(dados.faturamento) || 1000000;
        const nomeEmpresa = dados.nomeEmpresa || 'Sua Empresa';
        
        // Produtos selecionados
        const produtosSelecionados = [];
        let totalInvestimento = 0;
        
        for (const produtoId in PRODUTOS_CATALOGO) {
            const checkbox = document.getElementById('check-' + produtoId);
            if (checkbox && checkbox.checked) {
                const produto = PRODUTOS_CATALOGO[produtoId];
                const valorEl = document.getElementById('valor-' + produtoId);
                const prazoEl = document.getElementById('prazo-' + produtoId);
                const valor = valorEl ? parseFloat(valorEl.value) || 0 : 0;
                const prazo = prazoEl ? parseInt(prazoEl.value) || 0 : 0;
                
                produtosSelecionados.push({
                    id: produtoId,
                    nome: produto.nome,
                    descricao: produto.descricao || '',
                    valor: valor,
                    prazo: prazo,
                    recorrente: produto.recorrente || false
                });
                
                totalInvestimento += valor;
            }
        }
        
        // Desconto do pacote
        let descontoAplicado = 0;
        let nomePacote = '';
        let percentualDesconto = 0;
        if (typeof pacoteAtualSelecionado !== 'undefined' && pacoteAtualSelecionado) {
            const pacoteDef = PACOTES_DISPONIVEIS[pacoteAtualSelecionado.nome];
            if (pacoteDef) {
                nomePacote = pacoteDef.nome;
                percentualDesconto = Math.round(pacoteAtualSelecionado.desconto * 100);
                descontoAplicado = totalInvestimento * pacoteAtualSelecionado.desconto;
            }
        }
        
        const totalFinal = totalInvestimento - descontoAplicado;
        
        updateProgress(10, 'Dados carregados...');
        
        // Fun√ß√µes auxiliares
        const addLine = (y, color = C.light) => {
            doc.setDrawColor(...color);
            doc.setLineWidth(0.5);
            doc.line(M, y, W - M, y);
        };
        
        const addBox = (x, y, w, h, bgColor, borderColor = null) => {
            doc.setFillColor(...bgColor);
            if (borderColor) {
                doc.setDrawColor(...borderColor);
                doc.setLineWidth(1);
                doc.roundedRect(x, y, w, h, 3, 3, 'FD');
            } else {
                doc.roundedRect(x, y, w, h, 3, 3, 'F');
            }
        };
        
        let pageNum = 1;
        
        // CAPA
        doc.setFillColor(...C.primary);
        doc.rect(0, 0, W, H, 'F');
        doc.setFillColor(...C.accent);
        doc.rect(0, 0, W, 12, 'F');
        
        addBox(M, 30, 60, 20, C.white);
        doc.setTextColor(...C.primary);
        doc.setFontSize(16);
        doc.setFont('helvetica', 'bold');
        doc.text('SUA LOGO', M + 30, 43, {align: 'center'});
        
        let y = 90;
        doc.setTextColor(...C.white);
        doc.setFontSize(48);
        doc.text('PROPOSTA', 105, y, {align: 'center'});
        y += 18;
        doc.text('COMERCIAL', 105, y, {align: 'center'});
        
        y += 25;
        doc.setFontSize(20);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(220, 220, 220);
        doc.text('Diagnostico Financeiro 360', 105, y, {align: 'center'});
        
        y = 145;
        addBox(40, y, 130, 35, C.white);
        doc.setTextColor(...C.dark);
        doc.setFontSize(12);
        doc.text('PREPARADO PARA:', 105, y + 10, {align: 'center'});
        doc.setFontSize(22);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.primary);
        doc.text(nomeEmpresa, 105, y + 25, {align: 'center'});
        
        y = 195;
        addBox(70, y, 70, 50, C.accent);
        doc.setTextColor(...C.white);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'normal');
        doc.text('Score Atual', 105, y + 15, {align: 'center'});
        doc.setFontSize(36);
        doc.setFont('helvetica', 'bold');
        doc.text(scoreGeral + '/100', 105, y + 35, {align: 'center'});
        
        y = 270;
        doc.setTextColor(...C.white);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        const dataHoje = new Date().toLocaleDateString('pt-BR', {day: '2-digit', month: 'long', year: 'numeric'});
        doc.text(dataHoje, 105, y, {align: 'center'});
        y += 6;
        doc.setFontSize(10);
        doc.setTextColor(200, 200, 200);
        doc.text('Validade: 30 dias | Documento Confidencial', 105, y, {align: 'center'});
        
        updateProgress(30, 'Capa criada...');
        
        // SUMARIO EXECUTIVO
        doc.addPage();
        pageNum++;
        
        addBox(0, 0, W, 50, C.primary);
        doc.setTextColor(...C.white);
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.text('SUMARIO EXECUTIVO', M, 32);
        
        y = 65;
        doc.setTextColor(...C.text);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        const intro = 'Este documento apresenta uma analise personalizada da situacao financeira de ' + nomeEmpresa + ', identificando oportunidades e propondo solucoes estrategicas.';
        const introLines = doc.splitTextToSize(intro, W - 2*M);
        doc.text(introLines, M, y);
        y += introLines.length * 6 + 10;
        
        // Situa√ß√£o Atual
        addBox(M, y, W - 2*M, 35, [255, 245, 245], C.danger);
        doc.setTextColor(...C.danger);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('SITUACAO ATUAL', M + 5, y + 10);
        doc.setTextColor(...C.text);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        doc.text('Score Geral: ' + scoreGeral + '/100', M + 5, y + 20);
        const classificacao = scoreGeral >= 70 ? 'BOM' : scoreGeral >= 50 ? 'INTERMEDIARIO' : 'BASICO';
        doc.text('Classificacao: ' + classificacao, M + 5, y + 27);
        
        y += 45;
        
        // Oportunidade
        const economiaPotencial = faturamento * 0.12;
        addBox(M, y, W - 2*M, 35, [245, 255, 245], C.success);
        doc.setTextColor(...C.success);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('OPORTUNIDADE IDENTIFICADA', M + 5, y + 10);
        doc.setTextColor(...C.text);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        doc.text('Economia anual: R$ ' + economiaPotencial.toLocaleString('pt-BR', {minimumFractionDigits: 2}), M + 5, y + 20);
        doc.text('Ganhos com gestao: R$ ' + (faturamento * 0.08).toLocaleString('pt-BR', {minimumFractionDigits: 2}), M + 5, y + 27);
        
        y += 45;
        
        // Solu√ß√£o
        addBox(M, y, W - 2*M, 45, [245, 250, 255], C.primary);
        doc.setTextColor(...C.primary);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('SOLUCAO PROPOSTA', M + 5, y + 10);
        doc.setTextColor(...C.text);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        if (nomePacote) {
            doc.text('Pacote: ' + nomePacote + ' (' + percentualDesconto + '% desconto)', M + 5, y + 20);
        }
        doc.text('Produtos/Servicos: ' + produtosSelecionados.length, M + 5, y + 27);
        doc.text('Investimento: R$ ' + totalFinal.toLocaleString('pt-BR', {minimumFractionDigits: 2}), M + 5, y + 34);
        const roi = totalFinal > 0 ? Math.round(((economiaPotencial - totalFinal) / totalFinal) * 100) : 0;
        doc.setTextColor(...C.success);
        doc.setFont('helvetica', 'bold');
        doc.text('ROI Estimado: ' + roi + '%', M + 5, y + 41);
        
        doc.setTextColor(...C.medium);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        doc.text('Pagina ' + pageNum, W - M, H - 10, {align: 'right'});
        
        updateProgress(50, 'Sumario criado...');
        
        // PRODUTOS
        for (let i = 0; i < produtosSelecionados.length; i++) {
            const prod = produtosSelecionados[i];
            
            doc.addPage();
            pageNum++;
            
            addBox(0, 0, W, 50, C.secondary);
            doc.setTextColor(...C.white);
            doc.setFontSize(22);
            doc.setFont('helvetica', 'bold');
            doc.text(prod.nome, M, 32);
            
            y = 65;
            doc.setTextColor(...C.text);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            const descLines = doc.splitTextToSize(prod.descricao, W - 2*M);
            doc.text(descLines, M, y);
            y += descLines.length * 6 + 12;
            
            addBox(M, y, W - 2*M, 8, C.success);
            doc.setTextColor(...C.white);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text('BENEFICIOS PARA SUA EMPRESA', M + 3, y + 6);
            
            y += 14;
            const beneficios = [
                'Controle total e visibilidade em tempo real',
                'Decisoes baseadas em dados confiaveis',
                'Reducao de custos e desperdicios',
                'Aumento de eficiencia operacional',
                'Mitigacao de riscos financeiros'
            ];
            
            beneficios.forEach(benef => {
                doc.setTextColor(...C.text);
                doc.setFontSize(10);
                doc.setFont('helvetica', 'normal');
                doc.setFillColor(...C.success);
                doc.circle(M + 3, y, 1.5, 'F');
                const benefLines = doc.splitTextToSize(benef, W - 2*M - 8);
                doc.text(benefLines, M + 8, y + 1);
                y += benefLines.length * 5 + 2;
            });
            
            y += 8;
            
            // Retorno
            addBox(M, y, W - 2*M, 55, [240, 255, 240], C.success);
            doc.setTextColor(...C.success);
            doc.setFontSize(13);
            doc.setFont('helvetica', 'bold');
            doc.text('RETORNO ESPERADO', M + 5, y + 10);
            
            const economiaAnual = faturamento * 0.04;
            const roiProduto = prod.valor > 0 ? Math.round((economiaAnual / prod.valor) * 100) : 0;
            const payback = prod.valor > 0 ? ((prod.valor / economiaAnual) * 12).toFixed(1) : 0;
            
            doc.setTextColor(...C.text);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            doc.text('Economia anual:', M + 10, y + 22);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(...C.success);
            doc.text('R$ ' + economiaAnual.toLocaleString('pt-BR', {minimumFractionDigits: 2}), M + 70, y + 22);
            
            doc.setTextColor(...C.text);
            doc.setFont('helvetica', 'normal');
            doc.text('Economia de tempo:', M + 10, y + 30);
            doc.setFont('helvetica', 'bold');
            doc.text('10-15 horas/mes', M + 70, y + 30);
            
            doc.setFont('helvetica', 'normal');
            doc.text('ROI projetado:', M + 10, y + 38);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(...C.success);
            doc.text(roiProduto + '%', M + 70, y + 38);
            
            doc.setTextColor(...C.text);
            doc.setFont('helvetica', 'normal');
            doc.text('Payback:', M + 10, y + 46);
            doc.setFont('helvetica', 'bold');
            doc.text(payback + ' meses', M + 70, y + 46);
            
            y += 65;
            
            const boxW = (W - 2*M - 10) / 2;
            addBox(M, y, boxW, 30, [245, 250, 255], C.primary);
            doc.setTextColor(...C.primary);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('INVESTIMENTO', M + 5, y + 10);
            doc.setFontSize(20);
            doc.text('R$ ' + prod.valor.toLocaleString('pt-BR'), M + 5, y + 23);
            
            addBox(M + boxW + 10, y, boxW, 30, [245, 250, 255], C.primary);
            doc.setFontSize(11);
            doc.text('PRAZO', M + boxW + 15, y + 10);
            doc.setFontSize(20);
            doc.text(prod.prazo + ' ' + (prod.recorrente ? 'meses' : 'dias'), M + boxW + 15, y + 23);
            
            doc.setTextColor(...C.medium);
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.text('Pagina ' + pageNum, W - M, H - 10, {align: 'right'});
            
            updateProgress(50 + (i / produtosSelecionados.length) * 35, 'Produto ' + (i+1) + '...');
        }
        
        updateProgress(85, 'Produtos detalhados...');
        
        // INVESTIMENTO TOTAL
        doc.addPage();
        pageNum++;
        
        addBox(0, 0, W, 50, C.primary);
        doc.setTextColor(...C.white);
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.text('INVESTIMENTO TOTAL', M, 32);
        
        y = 70;
        
        if (nomePacote && descontoAplicado > 0) {
            addBox(M, y, W - 2*M, 45, [255, 250, 235], C.warning);
            doc.setTextColor(...C.warning);
            doc.setFontSize(13);
            doc.setFont('helvetica', 'bold');
            doc.text('PACOTE SELECIONADO', M + 5, y + 10);
            doc.setTextColor(...C.text);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.text(nomePacote + ' - Desconto ' + percentualDesconto + '%', M + 5, y + 20);
            doc.setFontSize(11);
            doc.text('Valor original:', M + 10, y + 30);
            doc.text('R$ ' + totalInvestimento.toLocaleString('pt-BR', {minimumFractionDigits: 2}), M + 50, y + 30);
            doc.text('Desconto:', M + 10, y + 37);
            doc.setTextColor(...C.success);
            doc.setFont('helvetica', 'bold');
            doc.text('- R$ ' + descontoAplicado.toLocaleString('pt-BR', {minimumFractionDigits: 2}), M + 50, y + 37);
            y += 55;
        } else {
            y += 10;
        }
        
        addBox(M, y, W - 2*M, 60, C.success);
        doc.setTextColor(...C.white);
        doc.setFontSize(16);
        doc.setFont('helvetica', 'bold');
        doc.text('INVESTIMENTO TOTAL', 105, y + 20, {align: 'center'});
        doc.setFontSize(36);
        doc.text('R$ ' + totalFinal.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2}), 105, y + 45, {align: 'center'});
        
        y += 70;
        
        const economiaConsolidada = faturamento * 0.15;
        const roiConsolidado = totalFinal > 0 ? Math.round(((economiaConsolidada - totalFinal) / totalFinal) * 100) : 0;
        const paybackConsolidado = totalFinal > 0 ? ((totalFinal / economiaConsolidada) * 12).toFixed(1) : 0;
        
        addBox(M, y, W - 2*M, 50, [240, 255, 240], C.success);
        doc.setTextColor(...C.success);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('RETORNO CONSOLIDADO', M + 5, y + 12);
        doc.setTextColor(...C.text);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        doc.text('Economia total ano 1:', M + 10, y + 24);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.success);
        doc.text('R$ ' + economiaConsolidada.toLocaleString('pt-BR', {minimumFractionDigits: 2}), M + 65, y + 24);
        doc.setTextColor(...C.text);
        doc.setFont('helvetica', 'normal');
        doc.text('ROI estimado:', M + 10, y + 32);
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(16);
        doc.setTextColor(...C.success);
        doc.text(roiConsolidado + '%', M + 65, y + 32);
        doc.setTextColor(...C.text);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        doc.text('Payback:', M + 10, y + 40);
        doc.setFont('helvetica', 'bold');
        doc.text(paybackConsolidado + ' meses', M + 65, y + 40);
        
        y += 60;
        
        doc.setTextColor(...C.dark);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('PROXIMOS PASSOS', M, y);
        y += 10;
        
        const passos = [
            {num: '1', texto: 'Aprovacao desta proposta'},
            {num: '2', texto: 'Assinatura do contrato'},
            {num: '3', texto: 'Reuniao de kick-off'},
            {num: '4', texto: 'Inicio da implementacao'}
        ];
        
        passos.forEach(passo => {
            doc.setFillColor(...C.primary);
            doc.circle(M + 4, y + 3, 3.5, 'F');
            doc.setTextColor(...C.white);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text(passo.num, M + 4, y + 5, {align: 'center'});
            doc.setTextColor(...C.text);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            doc.text(passo.texto, M + 12, y + 5);
            y += 10;
        });
        
        y = H - 30;
        addLine(y, C.light);
        y += 8;
        doc.setTextColor(...C.medium);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'italic');
        doc.text('Documento confidencial destinado a ' + nomeEmpresa + '.', 105, y, {align: 'center'});
        y += 5;
        doc.text('Reproducao nao autorizada e proibida.', 105, y, {align: 'center'});
        doc.setFont('helvetica', 'normal');
        doc.text('Pagina ' + pageNum, W - M, H - 10, {align: 'right'});
        
        updateProgress(95, 'Finalizando...');
        
        const nomeArquivo = 'Proposta_Comercial_' + nomeEmpresa.replace(/[^a-zA-Z0-9]/g, '_') + '_' + new Date().toISOString().split('T')[0] + '.pdf';
        doc.save(nomeArquivo);
        
        updateProgress(100, 'Concluido!');
        
        setTimeout(() => {
            loading.remove();
            alert('PROPOSTA GERADA COM SUCESSO!\n\n' + nomeArquivo);
        }, 800);
        
    } catch (error) {
        console.error('Erro ao gerar PDF:', error);
        alert('ERRO AO GERAR PDF!\n\n' + error.message);
        const loading = document.getElementById('pdf-loading-proposta');
        if (loading) loading.remove();
    }
}

function salvarRascunho() {
    const dadosRascunho = {
        data: new Date().toISOString(),
        produtos: []
    };
    
    for (const produtoId in PRODUTOS_CATALOGO) {
        const checkbox = document.getElementById('check-' + produtoId);
        if (checkbox && checkbox.checked) {
            dadosRascunho.produtos.push({
                id: produtoId,
                valor: parseFloat(document.getElementById('valor-' + produtoId).value),
                prazo: parseInt(document.getElementById('prazo-' + produtoId).value)
            });
        }
    }
    
    localStorage.setItem('proposta_rascunho', JSON.stringify(dadosRascunho));
    alert('üíæ Rascunho salvo com sucesso!\n\n‚úÖ ' + dadosRascunho.produtos.length + ' produtos salvos');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INICIALIZA√á√ÉO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

window.addEventListener('DOMContentLoaded', () => {
    console.log('üöÄ Inicializando SPRINT 3...');
    
    // 1. Carregar dados do diagn√≥stico
    carregarDadosDiagnostico();
    
    // 2. Renderizar produtos
    renderizarProdutos();
    
    // 3. Atualizar preview inicial
    atualizarSelecao();
    
    console.log('‚úÖ SPRINT 3 inicializada com sucesso!');
    console.log('üìä Total de produtos:', Object.keys(PRODUTOS_CATALOGO).length);
    console.log('üéØ Sistema de bloqueio ativo');
    console.log('üí° Recomenda√ß√µes autom√°ticas ativas');
});

</script>


<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SPRINT 5 - SISTEMA DE PACOTES E COMBOS (VERS√ÉO FINAL CORRIGIDA)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Defini√ß√£o dos pacotes
var PACOTES_DISPONIVEIS = {
    fundacao: {
        nome: 'Funda√ß√£o Financeira',
        emoji: 'üèóÔ∏è',
        produtos: ['tesouraria', 'fluxo', 'dre'],
        desconto: 0.10,
        descricao: 'Base essencial para estrutura√ß√£o financeira'
    },
    crescimento: {
        nome: 'Crescimento Estruturado',
        emoji: 'üöÄ',
        produtos: ['tesouraria', 'fluxo', 'dre', 'orcamento', 'custos', 'investimentos'],
        desconto: 0.15,
        descricao: 'Para empresas em expans√£o acelerada',
        popular: true
    },
    excelencia: {
        nome: 'Excel√™ncia Operacional',
        emoji: '‚≠ê',
        produtos: ['tesouraria', 'fluxo', 'dre', 'orcamento', 'custos', 'investimentos', 'indicadores', 'riscos', 'tributario'],
        desconto: 0.20,
        descricao: 'Gest√£o financeira de classe mundial'
    },
    premium: {
        nome: 'Premium Completo',
        emoji: 'üëë',
        produtos: ['tesouraria', 'fluxo', 'dre', 'orcamento', 'custos', 'investimentos', 'indicadores', 'riscos', 'tributario', 'plano-acao', 'consultoria'],
        desconto: 0.25,
        descricao: 'Transforma√ß√£o financeira total + acompanhamento',
        premium: true
    }
};

// Vari√°vel para rastrear pacote selecionado
var pacoteAtualSelecionado = null;

// Fun√ß√£o para selecionar pacote (COM TOGGLE!)
function selecionarPacote(nomePacote) {
    console.log('üéÅ A√ß√£o no pacote: ' + nomePacote);
    
    var pacote = PACOTES_DISPONIVEIS[nomePacote];
    if (!pacote) {
        console.error('Pacote n√£o encontrado:', nomePacote);
        return;
    }
    
    // TOGGLE: Se j√° est√° selecionado, DESMARCAR
    if (pacoteAtualSelecionado && pacoteAtualSelecionado.nome === nomePacote) {
        console.log('üîÑ Desmarcando pacote: ' + nomePacote);
        desmarcarPacote();
        return;
    }
    
    // Desmarcar todos os produtos primeiro
    if (typeof PRODUTOS_CATALOGO !== 'undefined') {
        Object.keys(PRODUTOS_CATALOGO).forEach(function(id) {
            var checkbox = document.getElementById('check-' + id);
            if (checkbox) checkbox.checked = false;
        });
    }
    
    // Remover classe de produtos em pacote
    var produtosEmPacote = document.querySelectorAll('.produto-em-pacote');
    produtosEmPacote.forEach(function(el) {
        el.classList.remove('produto-em-pacote');
    });
    
    // Marcar produtos do pacote
    var produtosMarcados = 0;
    pacote.produtos.forEach(function(produtoId) {
        var checkbox = document.getElementById('check-' + produtoId);
        if (checkbox) {
            if (!checkbox.disabled) {
                checkbox.checked = true;
                produtosMarcados++;
                
                var card = document.getElementById('card-' + produtoId);
                if (card) card.classList.add('produto-em-pacote');
                
                // Validar sele√ß√£o para cada produto
                if (typeof validarSelecao === 'function') {
                    validarSelecao(produtoId);
                }
            }
        } else {
            console.warn('Checkbox n√£o encontrado para produto:', produtoId);
        }
    });
    
    console.log('‚úÖ Produtos marcados:', produtosMarcados + '/' + pacote.produtos.length);
    
    // Guardar pacote selecionado
    pacoteAtualSelecionado = {
        nome: nomePacote,
        desconto: pacote.desconto
    };
    
    // Anima√ß√£o visual
    var pacoteCard = document.querySelector('[data-pacote="' + nomePacote + '"]');
    if (pacoteCard) {
        pacoteCard.classList.add('selecionado');
        setTimeout(function() {
            pacoteCard.classList.remove('selecionado');
        }, 600);
    }
    
    // Atualizar preview
    if (typeof atualizarSelecao === 'function') {
        atualizarSelecao();
    }
    
    // Feedback visual
    mostrarNotificacaoPacote(pacote.nome, pacote.emoji, produtosMarcados);
    
    // Scroll suave para o preview
    setTimeout(function() {
        var preview = document.querySelector('.proposta-preview');
        if (preview) {
            preview.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }, 300);
}

// Fun√ß√£o para desmarcar pacote
function desmarcarPacote() {
    console.log('‚ùå Desmarcando pacote atual');
    
    // Desmarcar todos os produtos
    if (typeof PRODUTOS_CATALOGO !== 'undefined') {
        Object.keys(PRODUTOS_CATALOGO).forEach(function(id) {
            var checkbox = document.getElementById('check-' + id);
            if (checkbox) checkbox.checked = false;
        });
    }
    
    // Remover classe de produtos em pacote
    var produtosEmPacote = document.querySelectorAll('.produto-em-pacote');
    produtosEmPacote.forEach(function(el) {
        el.classList.remove('produto-em-pacote');
    });
    
    // Limpar pacote selecionado
    pacoteAtualSelecionado = null;
    
    // Atualizar preview
    if (typeof atualizarSelecao === 'function') {
        atualizarSelecao();
    }
    
    // Feedback visual
    var notificacao = document.createElement('div');
    notificacao.style.cssText = 'position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; padding: 20px 30px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.3); z-index: 10000; font-size: 1.1em; font-weight: 600; animation: slideIn 0.4s ease;';
    notificacao.innerHTML = '‚ùå Pacote desmarcado!<br><small style="font-size:0.85em;opacity:0.9;">Produtos removidos</small>';
    document.body.appendChild(notificacao);
    setTimeout(function() {
        notificacao.style.animation = 'slideOut 0.4s ease';
        setTimeout(function() {
            notificacao.remove();
        }, 400);
    }, 2500);
}

// Fun√ß√£o para mostrar notifica√ß√£o
function mostrarNotificacaoPacote(nomePacote, emoji, qtdProdutos) {
    var notificacao = document.createElement('div');
    notificacao.style.cssText = 'position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 30px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.3); z-index: 10000; font-size: 1.1em; font-weight: 600; animation: slideIn 0.4s ease;';
    notificacao.innerHTML = emoji + ' Pacote "' + nomePacote + '" selecionado!<br><small style="font-size:0.85em;opacity:0.9;">' + qtdProdutos + ' produtos adicionados</small>';
    document.body.appendChild(notificacao);
    setTimeout(function() {
        notificacao.style.animation = 'slideOut 0.4s ease';
        setTimeout(function() {
            notificacao.remove();
        }, 400);
    }, 3000);
}

// Calcular valores dos pacotes
function calcularValoresPacotes() {
    Object.keys(PACOTES_DISPONIVEIS).forEach(function(nomePacote) {
        var pacote = PACOTES_DISPONIVEIS[nomePacote];
        var totalOriginal = 0;
        
        if (typeof PRODUTOS_CATALOGO !== 'undefined') {
            pacote.produtos.forEach(function(produtoId) {
                var produto = PRODUTOS_CATALOGO[produtoId];
                if (produto) totalOriginal += produto.valorPadrao;
            });
        }
        
        var totalComDesconto = totalOriginal * (1 - pacote.desconto);
        var economia = totalOriginal - totalComDesconto;
        var economiaPercent = (pacote.desconto * 100).toFixed(0);
        
        var valorOriginalEl = document.querySelector('.valor-original-' + nomePacote);
        var valorDescontoEl = document.querySelector('.valor-desconto-' + nomePacote);
        var economiaEl = document.querySelector('.economia-' + nomePacote);
        var inputValorEl = document.getElementById('valor-pacote-' + nomePacote);
        
        if (valorOriginalEl) valorOriginalEl.textContent = totalOriginal.toLocaleString('pt-BR');
        if (valorDescontoEl) valorDescontoEl.textContent = totalComDesconto.toLocaleString('pt-BR');
        if (economiaEl) economiaEl.textContent = economiaPercent + '% (R$ ' + economia.toLocaleString('pt-BR') + ')';
        if (inputValorEl) inputValorEl.value = totalComDesconto.toFixed(2);
    });
}

// Adicionar anima√ß√µes CSS
var style = document.createElement('style');
style.textContent = '@keyframes slideIn { from { transform: translateX(400px); opacity: 0; } to { transform: translateX(0); opacity: 1; } } @keyframes slideOut { from { transform: translateX(0); opacity: 1; } to { transform: translateX(400px); opacity: 0; } }';
document.head.appendChild(style);

// Inicializar quando DOM estiver pronto
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(calcularValoresPacotes, 1500);
    });
} else {
    setTimeout(calcularValoresPacotes, 1500);
}

console.log('‚úÖ Sistema de Pacotes carregado (IDs corrigidos)!');



// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INICIALIZAR TOUR GUIADO AUTOMATICAMENTE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
        if (typeof introJs !== 'undefined') {
            console.log('‚úÖ Intro.js dispon√≠vel');
            iniciarTourGuiado();
        } else {
            console.error('‚ùå Intro.js n√£o carregou');
        }
    }, 1500);
});


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SPRINT 9: HIST√ìRICO E TEMPLATES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SPRINT 9: HIST√ìRICO E TEMPLATES - JAVASCRIPT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// GERENCIADOR DE PROPOSTAS SALVAS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const PropostasManager = {
    
    // Pegar todas as propostas
    getAll: function() {
        const propostas = localStorage.getItem('propostas_salvas');
        return propostas ? JSON.parse(propostas) : [];
    },
    
    // Salvar todas as propostas
    saveAll: function(propostas) {
        localStorage.setItem('propostas_salvas', JSON.stringify(propostas));
    },
    
    // Adicionar nova proposta
    add: function(proposta) {
        const propostas = this.getAll();
        proposta.id = 'prop_' + Date.now();
        proposta.dataCriacao = new Date().toISOString();
        proposta.dataAtualizacao = new Date().toISOString();
        propostas.push(proposta);
        this.saveAll(propostas);
        return proposta.id;
    },
    
    // Pegar proposta por ID
    getById: function(id) {
        const propostas = this.getAll();
        return propostas.find(p => p.id === id);
    },
    
    // Atualizar proposta
    update: function(id, dados) {
        const propostas = this.getAll();
        const index = propostas.findIndex(p => p.id === id);
        if (index !== -1) {
            propostas[index] = {
                ...propostas[index],
                ...dados,
                dataAtualizacao: new Date().toISOString()
            };
            this.saveAll(propostas);
            return true;
        }
        return false;
    },
    
    // Deletar proposta
    delete: function(id) {
        const propostas = this.getAll();
        const filtered = propostas.filter(p => p.id !== id);
        this.saveAll(filtered);
    },
    
    // Duplicar proposta
    duplicate: function(id) {
        const original = this.getById(id);
        if (!original) return null;
        
        const duplicada = {
            ...original,
            nome: original.nome + ' (C√≥pia)',
            tipo: 'proposta'
        };
        delete duplicada.id;
        delete duplicada.dataCriacao;
        delete duplicada.dataAtualizacao;
        
        return this.add(duplicada);
    }
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ïES DE INTERFACE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Abrir modal de salvar proposta
function abrirModalSalvar() {
    // Verificar se tem produtos selecionados
    let temProdutos = false;
    for (const produtoId in PRODUTOS_CATALOGO) {
        const checkbox = document.getElementById('check-' + produtoId);
        if (checkbox && checkbox.checked) {
            temProdutos = true;
            break;
        }
    }
    
    if (!temProdutos) {
        alert('Selecione pelo menos um produto antes de salvar a proposta!');
        return;
    }
    
    // Preencher resumo
    const produtosSelecionados = [];
    let totalInvestimento = 0;
    
    for (const produtoId in PRODUTOS_CATALOGO) {
        const checkbox = document.getElementById('check-' + produtoId);
        if (checkbox && checkbox.checked) {
            const produto = PRODUTOS_CATALOGO[produtoId];
            const valorEl = document.getElementById('valor-' + produtoId);
            const valor = valorEl ? parseFloat(valorEl.value) || 0 : 0;
            
            produtosSelecionados.push(produto.nome);
            totalInvestimento += valor;
        }
    }
    
    // Desconto do pacote
    let descontoAplicado = 0;
    if (typeof pacoteAtualSelecionado !== 'undefined' && pacoteAtualSelecionado) {
        const pacoteDef = PACOTES_DISPONIVEIS[pacoteAtualSelecionado.nome];
        if (pacoteDef) {
            descontoAplicado = totalInvestimento * pacoteAtualSelecionado.desconto;
        }
    }
    
    const totalFinal = totalInvestimento - descontoAplicado;
    
    // Atualizar resumo no modal
    document.getElementById('resumo-produtos').innerHTML = 
        produtosSelecionados.length + ' produto(s): ' + produtosSelecionados.slice(0, 3).join(', ') +
        (produtosSelecionados.length > 3 ? '...' : '');
    
    document.getElementById('resumo-valor').textContent = 
        'Valor total: R$ ' + totalFinal.toLocaleString('pt-BR', {minimumFractionDigits: 2});
    
    // Sugerir nome baseado na empresa
    let nomeEmpresa = 'Cliente';
    
    // Tentar pegar da empresa ativa
    const empresaAtivaId = localStorage.getItem('empresa_ativa');
    if (empresaAtivaId) {
        const dadosKey = 'diag_dados_' + empresaAtivaId;
        const dadosEmpresa = JSON.parse(localStorage.getItem(dadosKey) || '{}');
        nomeEmpresa = dadosEmpresa.nomeEmpresa || nomeEmpresa;
    }
    
    // Fallback: tentar DIAGNOSTICO_DADOS
    if (nomeEmpresa === 'Cliente' && typeof DIAGNOSTICO_DADOS !== 'undefined') {
        nomeEmpresa = DIAGNOSTICO_DADOS.empresa.nome || nomeEmpresa;
    }
    
    // √öltimo fallback: localStorage global
    if (nomeEmpresa === 'Cliente') {
        const dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
        nomeEmpresa = dados.nomeEmpresa || 'Cliente';
    }
    
    const dataHoje = new Date().toLocaleDateString('pt-BR');
    document.getElementById('nome-proposta').value = 
        'Proposta ' + nomeEmpresa + ' - ' + dataHoje;
    
    // Mostrar modal
    document.getElementById('modal-salvar-proposta').classList.add('show');
}

// Fechar modal
function fecharModalSalvar() {
    document.getElementById('modal-salvar-proposta').classList.remove('show');
    document.getElementById('nome-proposta').value = '';
    document.getElementById('obs-proposta').value = '';
    document.getElementById('tipo-proposta').value = 'proposta';
}

// Salvar proposta agora
function salvarPropostaAgora() {
    console.log('üíæ salvarPropostaAgora() chamada!');
    
    const nome = document.getElementById('nome-proposta').value.trim();
    
    if (!nome) {
        alert('Por favor, digite um nome para a proposta!');
        return;
    }
    
    console.log('üìù Nome da proposta:', nome);
    
    // CORRE√á√ÉO: Usar dados da empresa ativa
    const empresaAtivaId = localStorage.getItem('empresa_ativa');
    console.log('üè¢ Empresa ativa ID:', empresaAtivaId);
    
    let dados, resp, scores, scoreGeral;
    
    if (empresaAtivaId) {
        // Buscar dados da empresa ativa
        const respostasKey = 'diag_resp_' + empresaAtivaId;
        const dadosKey = 'diag_dados_' + empresaAtivaId;
        
        resp = JSON.parse(localStorage.getItem(respostasKey) || '{}');
        dados = JSON.parse(localStorage.getItem(dadosKey) || '{}');
        
        console.log('‚úÖ Dados carregados da empresa ativa:', empresaAtivaId);
    } else {
        // Fallback: tentar dados globais (compatibilidade)
        dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
        resp = JSON.parse(localStorage.getItem('diag_resp') || '{}');
        
        console.log('‚ö†Ô∏è Usando dados globais (sem empresa ativa)');
    }
    
    // Usar DIAGNOSTICO_DADOS se dispon√≠vel (mais confi√°vel)
    if (typeof DIAGNOSTICO_DADOS !== 'undefined' && DIAGNOSTICO_DADOS.scoreGeral) {
        scoreGeral = DIAGNOSTICO_DADOS.scoreGeral;
        scores = DIAGNOSTICO_DADOS.scores;
        console.log('‚úÖ Usando DIAGNOSTICO_DADOS:', scoreGeral);
    } else {
        // Calcular scores manualmente
        scores = calcularScoresPorCategoria(resp);
        scoreGeral = Math.round((
            scores.tesouraria + scores.resultados + scores.fluxo + scores.orcamento + 
            scores.investimentos + scores.riscos + scores.indicadores + scores.tributario
        ) / 8);
        console.log('üìä Scores calculados manualmente:', scoreGeral);
    }
    
    console.log('üè¢ Empresa:', dados.nomeEmpresa || DIAGNOSTICO_DADOS.empresa.nome || 'Sem nome');
    console.log('üìä Score geral:', scoreGeral);
    
    // Produtos selecionados
    const produtos = [];
    let totalInvestimento = 0;
    
    for (const produtoId in PRODUTOS_CATALOGO) {
        const checkbox = document.getElementById('check-' + produtoId);
        if (checkbox && checkbox.checked) {
            const produto = PRODUTOS_CATALOGO[produtoId];
            const valorEl = document.getElementById('valor-' + produtoId);
            const prazoEl = document.getElementById('prazo-' + produtoId);
            const valor = valorEl ? parseFloat(valorEl.value) || 0 : 0;
            const prazo = prazoEl ? parseInt(prazoEl.value) || 0 : 0;
            
            produtos.push({
                id: produtoId,
                nome: produto.nome,
                valor: valor,
                prazo: prazo,
                recorrente: produto.recorrente || false
            });
            
            totalInvestimento += valor;
        }
    }
    
    console.log('üì¶ Produtos selecionados:', produtos.length);
    console.log('üí∞ Total investimento:', totalInvestimento);
    
    // Pacote selecionado
    let pacoteInfo = null;
    let descontoAplicado = 0;
    
    if (typeof pacoteAtualSelecionado !== 'undefined' && pacoteAtualSelecionado) {
        const pacoteDef = PACOTES_DISPONIVEIS[pacoteAtualSelecionado.nome];
        if (pacoteDef) {
            pacoteInfo = {
                nome: pacoteDef.nome,
                desconto: pacoteAtualSelecionado.desconto,
                percentual: Math.round(pacoteAtualSelecionado.desconto * 100)
            };
            descontoAplicado = totalInvestimento * pacoteAtualSelecionado.desconto;
        }
    }
    
    const totalFinal = totalInvestimento - descontoAplicado;
    
    // Criar objeto da proposta
    const proposta = {
        nome: nome,
        tipo: document.getElementById('tipo-proposta').value,
        observacoes: document.getElementById('obs-proposta').value.trim(),
        empresa: dados.nomeEmpresa || (typeof DIAGNOSTICO_DADOS !== 'undefined' ? DIAGNOSTICO_DADOS.empresa.nome : 'Sem nome'),
        scoreGeral: scoreGeral,
        produtos: produtos,
        pacote: pacoteInfo,
        valores: {
            subtotal: totalInvestimento,
            desconto: descontoAplicado,
            total: totalFinal
        },
        diagnostico: {
            scores: scores,
            faturamento: parseFloat(dados.faturamento) || 0
        }
    };
    
    console.log('üìÑ Objeto da proposta criado:', proposta);
    
    // Salvar
    console.log('üíæ Salvando no localStorage...');
    const id = PropostasManager.add(proposta);
    console.log('‚úÖ Proposta salva com ID:', id);
    
    // Verificar se foi salvo
    const propostas = PropostasManager.getAll();
    console.log('üìä Total de propostas salvas:', propostas.length);
    console.log('üìã Propostas:', propostas);
    
    // Feedback
    fecharModalSalvar();
    
    const mensagem = proposta.tipo === 'template' 
        ? 'Template salvo com sucesso!'
        : 'Proposta salva com sucesso!';
    
    alert('‚úÖ ' + mensagem + '\n\nVoc√™ pode acess√°-la na aba "Hist√≥rico de Propostas".');
    
    // Atualizar lista se estiver na aba de hist√≥rico
    const historicoSection = document.getElementById('historico-propostas');
    if (historicoSection && historicoSection.classList.contains('active')) {
        console.log('üîÑ Atualizando lista de propostas...');
        renderizarPropostas();
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDERIZA√á√ÉO E A√á√ïES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

let filtroAtual = 'todas';
let ordenacaoAtual = 'desc'; // desc = mais recente primeiro

// Renderizar todas as propostas
function renderizarPropostas() {
    console.log('üìã renderizarPropostas() chamada!');
    
    const grid = document.getElementById('propostas-grid');
    const emptyState = document.getElementById('empty-state');
    
    if (!grid) {
        console.error('‚ùå Elemento propostas-grid n√£o encontrado!');
        return;
    }
    if (!emptyState) {
        console.error('‚ùå Elemento empty-state n√£o encontrado!');
        return;
    }
    
    let propostas = PropostasManager.getAll();
    console.log('üìä Propostas carregadas do localStorage:', propostas.length);
    console.log('üìÑ Propostas:', propostas);
    
    // Aplicar filtro
    if (filtroAtual === 'propostas') {
        propostas = propostas.filter(p => p.tipo === 'proposta');
        console.log('üîç Filtro aplicado (propostas):', propostas.length);
    } else if (filtroAtual === 'templates') {
        propostas = propostas.filter(p => p.tipo === 'template');
        console.log('üîç Filtro aplicado (templates):', propostas.length);
    }
    
    // Aplicar busca
    const buscaEl = document.getElementById('busca-proposta');
    const termoBusca = buscaEl ? buscaEl.value.toLowerCase() : '';
    if (termoBusca) {
        propostas = propostas.filter(p => 
            p.nome.toLowerCase().includes(termoBusca) ||
            p.empresa.toLowerCase().includes(termoBusca)
        );
        console.log('üîç Busca aplicada:', propostas.length);
    }
    
    // Ordenar
    propostas.sort((a, b) => {
        const dataA = new Date(a.dataCriacao);
        const dataB = new Date(b.dataCriacao);
        return ordenacaoAtual === 'desc' ? dataB - dataA : dataA - dataB;
    });
    
    // Se n√£o tem propostas, mostrar empty state
    if (propostas.length === 0) {
        console.log('‚ö†Ô∏è Nenhuma proposta encontrada - mostrando empty state');
        grid.innerHTML = '';
        emptyState.style.display = 'block';
        return;
    }
    
    console.log('‚úÖ Renderizando', propostas.length, 'proposta(s)...');
    emptyState.style.display = 'none';
    
    // Renderizar cards
    grid.innerHTML = propostas.map(p => criarCardProposta(p)).join('');
    console.log('üéâ Cards renderizados com sucesso!');
}

// Criar card de proposta
function criarCardProposta(proposta) {
    const data = new Date(proposta.dataCriacao);
    const dataFormatada = data.toLocaleDateString('pt-BR', {
        day: '2-digit',
        month: 'short',
        year: 'numeric'
    });
    
    const badgeClass = proposta.tipo === 'template' ? 'template' : 'proposta';
    const badgeTexto = proposta.tipo === 'template' ? 'Template' : 'Proposta';
    
    const produtosResumidos = proposta.produtos.slice(0, 3).map(p => 
        '<span class="produto-tag">' + p.nome + '</span>'
    ).join('');
    
    const maisProtudos = proposta.produtos.length > 3 
        ? '<span class="produto-tag">+' + (proposta.produtos.length - 3) + '</span>'
        : '';
    
    return `
        <div class="proposta-card ${badgeClass}">
            <div class="proposta-card-header">
                <div class="proposta-card-title">
                    <h3>${proposta.nome}</h3>
                    <p class="proposta-card-subtitle">${proposta.empresa} ‚Ä¢ ${dataFormatada}</p>
                </div>
                <span class="proposta-badge ${badgeClass}">${badgeTexto}</span>
            </div>
            
            <div class="proposta-card-body">
                <div class="proposta-info">
                    <div class="proposta-info-item">
                        <div class="proposta-info-label">Produtos</div>
                        <div class="proposta-info-value">${proposta.produtos.length} item(ns)</div>
                    </div>
                    <div class="proposta-info-item">
                        <div class="proposta-info-label">Valor Total</div>
                        <div class="proposta-info-value valor">R$ ${proposta.valores.total.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</div>
                    </div>
                </div>
                
                ${proposta.pacote ? `
                    <div style="background: #fff3cd; padding: 8px 12px; border-radius: 8px; margin-bottom: 12px;">
                        <div style="font-size: 0.75em; color: #856404; font-weight: 600;">
                            üì¶ ${proposta.pacote.nome} (${proposta.pacote.percentual}% OFF)
                        </div>
                    </div>
                ` : ''}
                
                <div class="proposta-produtos">
                    <div class="proposta-produtos-label">Produtos inclusos:</div>
                    <div class="proposta-produtos-tags">
                        ${produtosResumidos}
                        ${maisProtudos}
                    </div>
                </div>
            </div>
            
            <div class="proposta-card-footer">
                <button class="proposta-btn proposta-btn-primary" onclick="carregarProposta('${proposta.id}')">
                    üìÇ Carregar
                </button>
                <button class="proposta-btn proposta-btn-secondary" onclick="duplicarProposta('${proposta.id}')">
                    üìã Duplicar
                </button>
                <button class="proposta-btn proposta-btn-danger" onclick="deletarProposta('${proposta.id}', '${proposta.nome}')">
                    üóëÔ∏è
                </button>
            </div>
        </div>
    `;
}

// Buscar propostas
function buscarPropostas() {
    renderizarPropostas();
}

// Filtrar por tipo
function filtrarPor(tipo) {
    filtroAtual = tipo;
    
    // Atualizar bot√µes
    document.querySelectorAll('.filter-btn[data-filter]').forEach(btn => {
        btn.classList.remove('active');
    });
    document.querySelector('[data-filter="' + tipo + '"]').classList.add('active');
    
    renderizarPropostas();
}

// Ordenar propostas
function ordenarPropostas() {
    ordenacaoAtual = ordenacaoAtual === 'desc' ? 'asc' : 'desc';
    renderizarPropostas();
}

// Carregar proposta
function carregarProposta(id) {
    const proposta = PropostasManager.getById(id);
    if (!proposta) {
        alert('Proposta n√£o encontrada!');
        return;
    }
    
    const confirma = confirm(
        'Deseja carregar esta proposta?\n\n' +
        'üìã ' + proposta.nome + '\n' +
        'üè¢ ' + proposta.empresa + '\n' +
        'üí∞ R$ ' + proposta.valores.total.toLocaleString('pt-BR', {minimumFractionDigits: 2}) + '\n\n' +
        'A configura√ß√£o atual ser√° substitu√≠da!'
    );
    
    if (!confirma) return;
    
    // Ir para aba de proposta comercial
    irPara('proposta-comercial');
    
    // Aguardar um pouco para garantir que a aba carregou
    setTimeout(() => {
        // Desmarcar todos os produtos
        for (const produtoId in PRODUTOS_CATALOGO) {
            const checkbox = document.getElementById('check-' + produtoId);
            if (checkbox) checkbox.checked = false;
        }
        
        // Resetar pacote
        if (typeof pacoteAtualSelecionado !== 'undefined') {
            pacoteAtualSelecionado = null;
        }
        
        // Marcar produtos da proposta
        proposta.produtos.forEach(produto => {
            const checkbox = document.getElementById('check-' + produto.id);
            const valorEl = document.getElementById('valor-' + produto.id);
            const prazoEl = document.getElementById('prazo-' + produto.id);
            
            if (checkbox) checkbox.checked = true;
            if (valorEl) valorEl.value = produto.valor;
            if (prazoEl) prazoEl.value = produto.prazo;
            
            // Validar sele√ß√£o
            if (typeof validarSelecao === 'function') {
                validarSelecao(produto.id);
            }
        });
        
        // Atualizar sele√ß√£o
        if (typeof atualizarSelecao === 'function') {
            atualizarSelecao();
        }
        
        alert('‚úÖ Proposta carregada com sucesso!\n\n' + proposta.nome);
    }, 300);
}

// Duplicar proposta
function duplicarProposta(id) {
    const proposta = PropostasManager.getById(id);
    if (!proposta) return;
    
    const confirma = confirm(
        'Duplicar esta proposta?\n\n' +
        'üìã ' + proposta.nome + '\n\n' +
        'Uma c√≥pia ser√° criada.'
    );
    
    if (!confirma) return;
    
    const novoId = PropostasManager.duplicate(id);
    
    if (novoId) {
        renderizarPropostas();
        alert('‚úÖ Proposta duplicada com sucesso!');
    } else {
        alert('‚ùå Erro ao duplicar proposta!');
    }
}

// Deletar proposta
function deletarProposta(id, nome) {
    const confirma = confirm(
        '‚ö†Ô∏è ATEN√á√ÉO!\n\n' +
        'Deletar a proposta:\n\n' +
        'üìã ' + nome + '\n\n' +
        'Esta a√ß√£o n√£o pode ser desfeita!'
    );
    
    if (!confirma) return;
    
    PropostasManager.delete(id);
    renderizarPropostas();
    
    alert('üóëÔ∏è Proposta deletada!');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TEMPLATES PR√â-DEFINIDOS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const TEMPLATES_PREDEFINIDOS = [
    {
        nome: 'üöÄ Startup B√°sico',
        descricao: 'Pacote essencial para startups em fase inicial',
        produtos: ['tesouraria', 'fluxo', 'dre'],
        valores: {
            tesouraria: 3500,
            fluxo: 4500,
            dre: 5000
        }
    },
    {
        nome: 'üìà PME Crescimento',
        descricao: 'Solu√ß√£o completa para empresas em expans√£o',
        produtos: ['tesouraria', 'fluxo', 'dre', 'orcamento', 'custos', 'investimentos'],
        valores: {
            tesouraria: 4000,
            fluxo: 5000,
            dre: 5500,
            orcamento: 6000,
            custos: 5500,
            investimentos: 7000
        }
    },
    {
        nome: '‚≠ê Empresa Consolidada',
        descricao: 'Gest√£o premium para empresas estabelecidas',
        produtos: ['tesouraria', 'fluxo', 'dre', 'orcamento', 'custos', 'investimentos', 'indicadores', 'riscos', 'tributario'],
        valores: {
            tesouraria: 5000,
            fluxo: 6000,
            dre: 6500,
            orcamento: 7000,
            custos: 6000,
            investimentos: 8000,
            indicadores: 7500,
            riscos: 8000,
            tributario: 8000
        }
    }
];

// Renderizar templates pr√©-definidos
function renderizarTemplatesPredefinidos() {
    const container = document.getElementById('templates-predefinidos');
    
    container.innerHTML = TEMPLATES_PREDEFINIDOS.map(template => {
        const totalValor = template.produtos.reduce((sum, prodId) => {
            return sum + (template.valores[prodId] || 0);
        }, 0);
        
        const produtosNomes = template.produtos.map(prodId => {
            const produto = PRODUTOS_CATALOGO[prodId];
            return produto ? produto.nome : prodId;
        });
        
        return `
            <div class="proposta-card template">
                <div class="proposta-card-header">
                    <div class="proposta-card-title">
                        <h3>${template.nome}</h3>
                        <p class="proposta-card-subtitle">${template.descricao}</p>
                    </div>
                    <span class="proposta-badge template">Template</span>
                </div>
                
                <div class="proposta-card-body">
                    <div class="proposta-info">
                        <div class="proposta-info-item">
                            <div class="proposta-info-label">Produtos</div>
                            <div class="proposta-info-value">${template.produtos.length} item(ns)</div>
                        </div>
                        <div class="proposta-info-item">
                            <div class="proposta-info-label">Valor Total</div>
                            <div class="proposta-info-value valor">R$ ${totalValor.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</div>
                        </div>
                    </div>
                    
                    <div class="proposta-produtos">
                        <div class="proposta-produtos-label">Produtos inclusos:</div>
                        <div class="proposta-produtos-tags">
                            ${produtosNomes.slice(0, 3).map(nome => 
                                '<span class="produto-tag">' + nome + '</span>'
                            ).join('')}
                            ${produtosNomes.length > 3 ? '<span class="produto-tag">+' + (produtosNomes.length - 3) + '</span>' : ''}
                        </div>
                    </div>
                </div>
                
                <div class="proposta-card-footer">
                    <button class="proposta-btn proposta-btn-primary" onclick="aplicarTemplatePredefinido(${TEMPLATES_PREDEFINIDOS.indexOf(template)})">
                        ‚ö° Aplicar Template
                    </button>
                </div>
            </div>
        `;
    }).join('');
}

// Aplicar template pr√©-definido
function aplicarTemplatePredefinido(index) {
    const template = TEMPLATES_PREDEFINIDOS[index];
    if (!template) return;
    
    const confirma = confirm(
        'Aplicar este template?\n\n' +
        template.nome + '\n' +
        template.descricao + '\n\n' +
        'Os produtos e valores ser√£o configurados automaticamente.'
    );
    
    if (!confirma) return;
    
    // Ir para aba de proposta comercial
    irPara('proposta-comercial');
    
    setTimeout(() => {
        // Desmarcar todos
        for (const produtoId in PRODUTOS_CATALOGO) {
            const checkbox = document.getElementById('check-' + produtoId);
            if (checkbox) checkbox.checked = false;
        }
        
        // Aplicar template
        template.produtos.forEach(prodId => {
            const checkbox = document.getElementById('check-' + prodId);
            const valorEl = document.getElementById('valor-' + prodId);
            
            if (checkbox) checkbox.checked = true;
            if (valorEl && template.valores[prodId]) {
                valorEl.value = template.valores[prodId];
            }
            
            if (typeof validarSelecao === 'function') {
                validarSelecao(prodId);
            }
        });
        
        if (typeof atualizarSelecao === 'function') {
            atualizarSelecao();
        }
        
        alert('‚úÖ Template aplicado com sucesso!\n\n' + template.nome);
    }, 300);
}

// Inicializar hist√≥rico quando a aba for aberta
function inicializarHistorico() {
    console.log('üéØ inicializarHistorico() chamada!');
    
    // Verificar se as fun√ß√µes existem
    if (typeof renderizarPropostas !== 'function') {
        console.error('‚ùå renderizarPropostas n√£o est√° definida!');
        return;
    }
    if (typeof renderizarTemplatesPredefinidos !== 'function') {
        console.error('‚ùå renderizarTemplatesPredefinidos n√£o est√° definida!');
        return;
    }
    
    console.log('‚úÖ Renderizando propostas...');
    renderizarPropostas();
    
    console.log('‚úÖ Renderizando templates pr√©-definidos...');
    renderizarTemplatesPredefinidos();
    
    console.log('üéâ Hist√≥rico inicializado com sucesso!');
}





// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PDF RELAT√ìRIO EXECUTIVO PREMIUM
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PDF RELAT√ìRIO EXECUTIVO PREMIUM - BIG 4 CONSULTORIA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function gerarPDFRelatorioExecutivoPremium() {
    console.log('üöÄ Iniciando gera√ß√£o do PDF Relat√≥rio Executivo Premium...');
    
    // Atualizar progresso
    const updateProgress = (percent, message) => {
        console.log(`[${percent}%] ${message}`);
    };
    
    try {
        updateProgress(0, 'Iniciando...');
        
        // Verificar jsPDF
        if (typeof window.jspdf === 'undefined') {
            alert('‚ùå Biblioteca jsPDF n√£o carregada! Recarregue a p√°gina.');
            return;
        }
        
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'a4');
        
        updateProgress(5, 'Carregando dados...');
        
        // Coletar dados
        const empresaAtivaId = localStorage.getItem('empresa_ativa');
        let dados, resp;
        
        if (empresaAtivaId) {
            const respostasKey = 'diag_resp_' + empresaAtivaId;
            const dadosKey = 'diag_dados_' + empresaAtivaId;
            resp = JSON.parse(localStorage.getItem(respostasKey) || '{}');
            dados = JSON.parse(localStorage.getItem(dadosKey) || '{}');
        } else {
            dados = JSON.parse(StorageEmpresa.getItem('diag_dados') || '{}');
            resp = JSON.parse(StorageEmpresa.getItem('diag_resp') || '{}');
        }
        
        const nomeEmpresa = dados.nomeEmpresa || dados.nome || 'Empresa';
        const dataRelatorio = new Date().toLocaleDateString('pt-BR');
        
        // Calcular scores
        const scores = calcularScoresPorCategoria(resp);
        const scoreGeral = Math.round((
            scores.tesouraria + scores.resultados + scores.fluxo + scores.orcamento + 
            scores.investimentos + scores.riscos + scores.indicadores + scores.tributario
        ) / 8);
        
        updateProgress(10, 'Dados carregados...');
        
        // Paleta de cores
        const C = {
            primary: [15, 32, 39],        // Azul escuro
            secondary: [32, 58, 67],      // Azul m√©dio
            accent: [52, 152, 219],       // Azul claro
            success: [39, 174, 96],       // Verde
            warning: [243, 156, 18],      // Laranja
            danger: [231, 76, 60],        // Vermelho
            dark: [44, 62, 80],           // Cinza escuro
            medium: [127, 140, 141],      // Cinza m√©dio
            light: [236, 240, 241],       // Cinza claro
            white: [255, 255, 255],
            text: [33, 33, 33]
        };
        
        // Constantes de layout
        const W = 210; // Largura A4
        const H = 297; // Altura A4
        const M = 20;  // Margem
        
        // Helpers visuais
        const addLine = (y, color = C.light) => {
            doc.setDrawColor(...color);
            doc.setLineWidth(0.5);
            doc.line(M, y, W - M, y);
        };
        
        const addBox = (x, y, w, h, bgColor, borderColor = null) => {
            doc.setFillColor(...bgColor);
            if (borderColor) {
                doc.setDrawColor(...borderColor);
                doc.setLineWidth(1);
                doc.roundedRect(x, y, w, h, 3, 3, 'FD');
            } else {
                doc.roundedRect(x, y, w, h, 3, 3, 'F');
            }
        };
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 1: CAPA
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        updateProgress(15, 'Criando capa...');
        
        // Background prim√°rio
        doc.setFillColor(...C.primary);
        doc.rect(0, 0, W, H, 'F');
        
        // Faixa de destaque superior
        doc.setFillColor(...C.accent);
        doc.rect(0, 0, W, 15, 'F');
        
        // Box do logo (placeholder)
        addBox(W/2 - 30, 30, 60, 20, C.white, C.accent);
        doc.setFontSize(10);
        doc.setTextColor(...C.medium);
        doc.setFont('helvetica', 'italic');
        doc.text('Logo da Consultoria', W/2, 42, { align: 'center' });
        
        // T√≠tulo principal
        doc.setFontSize(48);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.white);
        doc.text('RELAT√ìRIO', W/2, 90, { align: 'center' });
        doc.text('EXECUTIVO', W/2, 110, { align: 'center' });
        
        // Subt√≠tulo
        doc.setFontSize(18);
        doc.setFont('helvetica', 'normal');
        doc.text('Diagn√≥stico Financeiro 360¬∞', W/2, 125, { align: 'center' });
        
        // Box da empresa
        addBox(M + 10, 145, W - 2*M - 20, 30, C.white);
        doc.setFontSize(22);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.primary);
        doc.text(nomeEmpresa, W/2, 165, { align: 'center' });
        
        // Box do score
        const scoreColor = scoreGeral >= 70 ? C.success : 
                          scoreGeral >= 50 ? C.accent : 
                          scoreGeral >= 30 ? C.warning : C.danger;
        
        addBox(W/2 - 35, 185, 70, 35, scoreColor);
        doc.setFontSize(14);
        doc.setTextColor(...C.white);
        doc.setFont('helvetica', 'bold');
        doc.text('SCORE GERAL', W/2, 197, { align: 'center' });
        doc.setFontSize(36);
        doc.text(scoreGeral.toString(), W/2, 215, { align: 'center' });
        
        // Rodap√© da capa
        doc.setFontSize(11);
        doc.setTextColor(...C.light);
        doc.setFont('helvetica', 'normal');
        doc.text('Data: ' + dataRelatorio, W/2, 260, { align: 'center' });
        doc.setFontSize(9);
        doc.setFont('helvetica', 'italic');
        doc.text('Documento Confidencial', W/2, 270, { align: 'center' });
        
        console.log('‚úÖ Capa criada');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 2: SUM√ÅRIO EXECUTIVO
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage();
        updateProgress(25, 'Criando sum√°rio executivo...');
        
        // Header
        doc.setFillColor(...C.primary);
        doc.rect(0, 0, W, 40, 'F');
        doc.setFontSize(28);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.white);
        doc.text('SUM√ÅRIO EXECUTIVO', W/2, 25, { align: 'center' });
        
        let y = 55;
        
        // Introdu√ß√£o
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        const intro = 'Este relat√≥rio apresenta uma an√°lise abrangente da gest√£o financeira de ' + nomeEmpresa + 
                     ', baseada em diagn√≥stico de 80 perguntas distribu√≠das em 8 categorias fundamentais. ' +
                     'A metodologia aplicada identifica gaps, riscos e oportunidades de melhoria.';
        const introLines = doc.splitTextToSize(intro, W - 2*M);
        doc.text(introLines, M, y);
        y += introLines.length * 6 + 10;
        
        // Box Situa√ß√£o Atual
        addBox(M, y, W - 2*M, 35, [254, 235, 235], C.danger);
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.danger);
        doc.text('SITUA√á√ÉO ATUAL', M + 5, y + 8);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        const catCriticas = Object.entries(scores).filter(([k,v]) => v < 50).length;
        doc.text(`Score Geral: ${scoreGeral}/100`, M + 5, y + 18);
        doc.text(`Categorias Cr√≠ticas: ${catCriticas}`, M + 5, y + 26);
        y += 45;
        
        // Box Oportunidade
        addBox(M, y, W - 2*M, 35, [232, 245, 233], C.success);
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.success);
        doc.text('OPORTUNIDADES IDENTIFICADAS', M + 5, y + 8);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        const faturamento = parseFloat(dados.faturamento) || 1000000;
        const economiaPotencial = Math.round(faturamento * 0.12);
        doc.text(`Economia Potencial: R$ ${economiaPotencial.toLocaleString('pt-BR')}/ano`, M + 5, y + 18);
        doc.text(`Ganhos em Efici√™ncia: 15-25%`, M + 5, y + 26);
        y += 45;
        
        // Box Solu√ß√£o
        addBox(M, y, W - 2*M, 35, [227, 242, 253], C.accent);
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.accent);
        doc.text('SOLU√á√ÉO PROPOSTA', M + 5, y + 8);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        doc.text('Plano de a√ß√£o estruturado em 3 fases', M + 5, y + 18);
        doc.text('Implementa√ß√£o gradual com quick wins', M + 5, y + 26);
        
        console.log('‚úÖ Sum√°rio executivo criado');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA 3: VIS√ÉO GERAL - SCORES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage();
        updateProgress(35, 'Criando vis√£o geral...');
        
        // Header
        doc.setFillColor(...C.secondary);
        doc.rect(0, 0, W, 35, 'F');
        doc.setFontSize(24);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.white);
        doc.text('VIS√ÉO GERAL - DIAGN√ìSTICO', W/2, 22, { align: 'center' });
        
        y = 50;
        
        // Score geral grande
        const scoreBoxW = 80;
        addBox(W/2 - scoreBoxW/2, y, scoreBoxW, 50, scoreColor);
        doc.setFontSize(16);
        doc.setTextColor(...C.white);
        doc.setFont('helvetica', 'bold');
        doc.text('SCORE GERAL', W/2, y + 15, { align: 'center' });
        doc.setFontSize(48);
        doc.text(scoreGeral.toString(), W/2, y + 40, { align: 'center' });
        
        y += 60;
        
        // Classifica√ß√£o
        const classificacao = scoreGeral >= 70 ? 'PROFISSIONAL' :
                            scoreGeral >= 50 ? 'ORGANIZADO' :
                            scoreGeral >= 30 ? 'B√ÅSICO' : 'CR√çTICO';
        
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...scoreColor);
        doc.text('Classifica√ß√£o: ' + classificacao, W/2, y, { align: 'center' });
        
        y += 15;
        
        // Scores por categoria
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.primary);
        doc.text('SCORES POR CATEGORIA:', M, y);
        
        y += 10;
        
        const categorias = [
            { nome: 'Tesouraria', key: 'tesouraria', icon: '' },
            { nome: 'Resultados & DRE', key: 'resultados', icon: '' },
            { nome: 'Fluxo de Caixa', key: 'fluxo', icon: '' },
            { nome: 'Or√ßamento', key: 'orcamento', icon: '' },
            { nome: 'Investimentos', key: 'investimentos', icon: '' },
            { nome: 'Riscos Financeiros', key: 'riscos', icon: '' },
            { nome: 'Indicadores', key: 'indicadores', icon: '' },
            { nome: 'Planejamento Tribut√°rio', key: 'tributario', icon: '' }
        ];
        
        categorias.forEach(cat => {
            const score = scores[cat.key] || 0;
            const catColor = score >= 70 ? C.success :
                           score >= 50 ? C.accent :
                           score >= 30 ? C.warning : C.danger;
            
            // Barra de progresso
            const barW = 100;
            const barH = 6;
            const barX = W - M - barW - 25;
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(...C.text);
            doc.text(cat.nome, M, y + 5);
            
            // Background da barra
            doc.setFillColor(...C.light);
            doc.roundedRect(barX, y, barW, barH, 2, 2, 'F');
            
            // Progresso
            const progW = (score / 100) * barW;
            doc.setFillColor(...catColor);
            doc.roundedRect(barX, y, progW, barH, 2, 2, 'F');
            
            // Valor
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(...catColor);
            doc.text(score.toString(), W - M - 15, y + 5, { align: 'right' });
            
            y += 12;
        });
        
        console.log('‚úÖ Vis√£o geral criada');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINAS 4-11: DIAGN√ìSTICO POR CATEGORIA
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        const catDetalhes = [
            { 
                nome: 'TESOURARIA', 
                key: 'tesouraria',
                problemas: [
                    'Controle de saldos banc√°rios insuficiente',
                    'Concilia√ß√£o banc√°ria n√£o realizada regularmente',
                    'Previs√µes de caixa desatualizadas'
                ],
                recomendacoes: [
                    'Implementar controle di√°rio de saldos',
                    'Automatizar concilia√ß√£o banc√°ria',
                    'Criar fluxo de caixa projetado'
                ]
            },
            { 
                nome: 'RESULTADOS & DRE', 
                key: 'resultados',
                problemas: [
                    'DRE n√£o elaborada mensalmente',
                    'Falta an√°lise de margem de contribui√ß√£o',
                    'Indicadores de lucratividade n√£o monitorados'
                ],
                recomendacoes: [
                    'Estruturar DRE gerencial mensal',
                    'Calcular margem por produto/servi√ßo',
                    'Acompanhar EBITDA e margem l√≠quida'
                ]
            },
            { 
                nome: 'FLUXO DE CAIXA', 
                key: 'fluxo',
                problemas: [
                    'Fluxo de caixa n√£o estruturado',
                    'Falta proje√ß√£o de entradas e sa√≠das',
                    'Gest√£o de capital de giro deficiente'
                ],
                recomendacoes: [
                    'Implementar fluxo de caixa projetado',
                    'Monitorar ciclo financeiro',
                    'Otimizar capital de giro'
                ]
            },
            { 
                nome: 'OR√áAMENTO', 
                key: 'orcamento',
                problemas: [
                    'Or√ßamento anual n√£o elaborado',
                    'Falta acompanhamento or√ßado x realizado',
                    'Aus√™ncia de revis√µes peri√≥dicas'
                ],
                recomendacoes: [
                    'Elaborar or√ßamento anual detalhado',
                    'Implementar an√°lise de varia√ß√µes',
                    'Revisar or√ßamento trimestralmente'
                ]
            },
            { 
                nome: 'INVESTIMENTOS', 
                key: 'investimentos',
                problemas: [
                    'An√°lise de viabilidade n√£o realizada',
                    'Falta crit√©rios de prioriza√ß√£o',
                    'ROI n√£o calculado'
                ],
                recomendacoes: [
                    'Implementar an√°lise de viabilidade',
                    'Calcular TIR e VPL',
                    'Priorizar investimentos estrat√©gicos'
                ]
            },
            { 
                nome: 'GEST√ÉO DE RISCOS', 
                key: 'riscos',
                problemas: [
                    'Riscos financeiros n√£o mapeados',
                    'Aus√™ncia de planos de conting√™ncia',
                    'Exposi√ß√£o cambial n√£o gerenciada'
                ],
                recomendacoes: [
                    'Mapear riscos financeiros',
                    'Criar planos de conting√™ncia',
                    'Implementar hedge quando aplic√°vel'
                ]
            },
            { 
                nome: 'INDICADORES FINANCEIROS', 
                key: 'indicadores',
                problemas: [
                    'KPIs financeiros n√£o definidos',
                    'Falta acompanhamento de indicadores',
                    'Benchmarking n√£o realizado'
                ],
                recomendacoes: [
                    'Definir KPIs estrat√©gicos',
                    'Implementar dashboard gerencial',
                    'Comparar com mercado'
                ]
            },
            { 
                nome: 'PLANEJAMENTO TRIBUT√ÅRIO', 
                key: 'tributario',
                problemas: [
                    'Regime tribut√°rio n√£o otimizado',
                    'Falta planejamento fiscal',
                    'Riscos tribut√°rios n√£o mapeados'
                ],
                recomendacoes: [
                    'Revisar regime tribut√°rio',
                    'Implementar planejamento fiscal',
                    'Mapear conting√™ncias tribut√°rias'
                ]
            }
        ];
        
        let progressBase = 45;
        const progressPerCat = 35 / catDetalhes.length;
        
        catDetalhes.forEach((cat, idx) => {
            doc.addPage();
            updateProgress(progressBase + (idx * progressPerCat), `Criando categoria ${idx + 1}/${catDetalhes.length}...`);
            
            const score = scores[cat.key] || 0;
            const catColor = score >= 70 ? C.success :
                           score >= 50 ? C.accent :
                           score >= 30 ? C.warning : C.danger;
            
            const classificacaoCat = score >= 70 ? 'EXCELENTE' :
                                   score >= 50 ? 'BOM' :
                                   score >= 30 ? 'ATEN√á√ÉO' : 'CR√çTICO';
            
            // Header
            doc.setFillColor(...catColor);
            doc.rect(0, 0, W, 40, 'F');
            doc.setFontSize(22);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(...C.white);
            doc.text(cat.nome, W/2, 25, { align: 'center' });
            
            y = 55;
            
            // Score e classifica√ß√£o
            addBox(M, y, W - 2*M, 25, catColor);
            doc.setFontSize(14);
            doc.setTextColor(...C.white);
            doc.setFont('helvetica', 'bold');
            doc.text('SCORE:', M + 10, y + 10);
            doc.setFontSize(20);
            doc.text(score.toString(), M + 35, y + 10);
            doc.setFontSize(14);
            doc.text('CLASSIFICA√á√ÉO:', W/2 + 5, y + 10);
            doc.text(classificacaoCat, W/2 + 50, y + 10);
            
            y += 35;
            
            // Principais Problemas
            doc.setFontSize(13);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(...C.danger);
            doc.text('PRINCIPAIS PROBLEMAS IDENTIFICADOS:', M, y);
            
            y += 10;
            
            cat.problemas.forEach((problema, pIdx) => {
                doc.setFillColor(...C.danger);
                doc.circle(M + 3, y - 2, 2, 'F');
                
                doc.setFontSize(10);
                doc.setFont('helvetica', 'normal');
                doc.setTextColor(...C.text);
                const problemaLines = doc.splitTextToSize(problema, W - 2*M - 10);
                doc.text(problemaLines, M + 8, y);
                y += problemaLines.length * 5 + 5;
            });
            
            y += 5;
            
            // Impacto Estimado
            const impacto = Math.round(faturamento * 0.03);
            addBox(M, y, W - 2*M, 20, [254, 235, 235], C.danger);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(...C.danger);
            doc.text('IMPACTO ESTIMADO:', M + 5, y + 8);
            doc.setFont('helvetica', 'normal');
            doc.text(`R$ ${impacto.toLocaleString('pt-BR')}/ano em perdas potenciais`, M + 5, y + 15);
            
            y += 30;
            
            // Recomenda√ß√µes
            doc.setFontSize(13);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(...C.success);
            doc.text('RECOMENDA√á√ïES:', M, y);
            
            y += 10;
            
            cat.recomendacoes.forEach((rec, rIdx) => {
                doc.setFillColor(...C.success);
                doc.circle(M + 3, y - 2, 2, 'F');
                
                doc.setFontSize(10);
                doc.setFont('helvetica', 'normal');
                doc.setTextColor(...C.text);
                const recLines = doc.splitTextToSize(rec, W - 2*M - 10);
                doc.text(recLines, M + 8, y);
                y += recLines.length * 5 + 5;
            });
            
            y += 5;
            
            // A√ß√µes Priorit√°rias
            if (y < 250) {
                addBox(M, y, W - 2*M, 25, [232, 245, 233], C.success);
                doc.setFontSize(11);
                doc.setFont('helvetica', 'bold');
                doc.setTextColor(...C.success);
                doc.text('A√á√ïES PRIORIT√ÅRIAS:', M + 5, y + 10);
                doc.setFontSize(9);
                doc.setFont('helvetica', 'normal');
                doc.setTextColor(...C.text);
                doc.text('1. Implementar controles b√°sicos (0-30 dias)', M + 5, y + 16);
                doc.text('2. Estruturar processos (30-60 dias)', M + 5, y + 21);
            }
        });
        
        console.log('‚úÖ Categorias criadas');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA: AN√ÅLISE SWOT
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage();
        updateProgress(85, 'Criando an√°lise SWOT...');
        
        // Header
        doc.setFillColor(...C.primary);
        doc.rect(0, 0, W, 35, 'F');
        doc.setFontSize(24);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.white);
        doc.text('AN√ÅLISE SWOT', W/2, 22, { align: 'center' });
        
        y = 50;
        
        // Matriz SWOT 2x2
        const boxW = (W - 2*M - 5) / 2;
        const boxH = 55;
        
        // For√ßas (verde)
        addBox(M, y, boxW, boxH, [232, 245, 233], C.success);
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.success);
        doc.text('FOR√áAS', M + 5, y + 8);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        const forcas = [
            'Equipe comprometida',
            'Produtos/servi√ßos de qualidade',
            'Base de clientes estabelecida'
        ];
        forcas.forEach((f, i) => {
            doc.text(`‚Ä¢ ${f}`, M + 5, y + 18 + i*8);
        });
        
        // Oportunidades (azul)
        addBox(M + boxW + 5, y, boxW, boxH, [227, 242, 253], C.accent);
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.accent);
        doc.text('OPORTUNIDADES', M + boxW + 10, y + 8);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        const oportunidades = [
            'Otimiza√ß√£o de processos financeiros',
            'Redu√ß√£o de custos operacionais',
            'Melhoria na tomada de decis√µes'
        ];
        oportunidades.forEach((o, i) => {
            doc.text(`‚Ä¢ ${o}`, M + boxW + 10, y + 18 + i*8);
        });
        
        y += boxH + 5;
        
        // Fraquezas (vermelho)
        addBox(M, y, boxW, boxH, [254, 235, 235], C.danger);
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.danger);
        doc.text('FRAQUEZAS', M + 5, y + 8);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        const fraquezas = [
            'Controles financeiros b√°sicos',
            'Processos n√£o estruturados',
            'Falta de indicadores de performance'
        ];
        fraquezas.forEach((f, i) => {
            doc.text(`‚Ä¢ ${f}`, M + 5, y + 18 + i*8);
        });
        
        // Amea√ßas (laranja)
        addBox(M + boxW + 5, y, boxW, boxH, [255, 243, 224], C.warning);
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.warning);
        doc.text('AMEA√áAS', M + boxW + 10, y + 8);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        const ameacas = [
            'Risco de decis√µes sem dados',
            'Perda de oportunidades financeiras',
            'Compliance e riscos regulat√≥rios'
        ];
        ameacas.forEach((a, i) => {
            doc.text(`‚Ä¢ ${a}`, M + boxW + 10, y + 18 + i*8);
        });
        
        console.log('‚úÖ SWOT criada');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA: PLANO DE A√á√ÉO
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage();
        updateProgress(90, 'Criando plano de a√ß√£o...');
        
        // Header
        doc.setFillColor(...C.secondary);
        doc.rect(0, 0, W, 35, 'F');
        doc.setFontSize(24);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.white);
        doc.text('PLANO DE A√á√ÉO', W/2, 22, { align: 'center' });
        
        y = 50;
        
        const fases = [
            {
                titulo: 'FASE 1: FUNDA√á√ÉO (0-30 dias)',
                cor: C.danger,
                acoes: [
                    'Estruturar controles b√°sicos de tesouraria',
                    'Implementar fluxo de caixa semanal',
                    'Definir KPIs financeiros priorit√°rios'
                ]
            },
            {
                titulo: 'FASE 2: ESTRUTURA√á√ÉO (30-90 dias)',
                cor: C.warning,
                acoes: [
                    'Implementar DRE gerencial mensal',
                    'Criar or√ßamento anual',
                    'Estruturar an√°lise de custos'
                ]
            },
            {
                titulo: 'FASE 3: OTIMIZA√á√ÉO (90+ dias)',
                cor: C.success,
                acoes: [
                    'Automatizar processos financeiros',
                    'Implementar sistema de gest√£o integrado',
                    'Desenvolver planejamento estrat√©gico'
                ]
            }
        ];
        
        fases.forEach((fase, idx) => {
            // Box da fase
            addBox(M, y, W - 2*M, 50, [240, 240, 240], fase.cor);
            
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(...fase.cor);
            doc.text(fase.titulo, M + 5, y + 10);
            
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(...C.text);
            
            fase.acoes.forEach((acao, aIdx) => {
                // C√≠rculo numerado
                doc.setFillColor(...fase.cor);
                doc.circle(M + 5, y + 19 + aIdx*10, 2.5, 'F');
                doc.setFontSize(7);
                doc.setTextColor(...C.white);
                doc.setFont('helvetica', 'bold');
                doc.text((aIdx + 1).toString(), M + 5, y + 20.5 + aIdx*10, { align: 'center' });
                
                doc.setFontSize(9);
                doc.setFont('helvetica', 'normal');
                doc.setTextColor(...C.text);
                const acaoLines = doc.splitTextToSize(acao, W - 2*M - 20);
                doc.text(acaoLines, M + 10, y + 20 + aIdx*10);
            });
            
            y += 60;
        });
        
        console.log('‚úÖ Plano de a√ß√£o criado');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // P√ÅGINA FINAL: CONCLUS√ÉO E PR√ìXIMOS PASSOS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        doc.addPage();
        updateProgress(95, 'Finalizando...');
        
        // Header
        doc.setFillColor(...C.primary);
        doc.rect(0, 0, W, 35, 'F');
        doc.setFontSize(24);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.white);
        doc.text('CONCLUS√ÉO E PR√ìXIMOS PASSOS', W/2, 22, { align: 'center' });
        
        y = 50;
        
        // Conclus√£o
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.primary);
        doc.text('CONCLUS√ÉO:', M, y);
        
        y += 10;
        
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        const conclusao = `O diagn√≥stico financeiro de ${nomeEmpresa} identificou oportunidades significativas de melhoria. ` +
                         `Com score geral de ${scoreGeral}/100, a empresa possui uma base s√≥lida, mas requer ` +
                         `estrutura√ß√£o de processos e controles financeiros para alcan√ßar excel√™ncia operacional.`;
        const conclusaoLines = doc.splitTextToSize(conclusao, W - 2*M);
        doc.text(conclusaoLines, M, y);
        y += conclusaoLines.length * 6 + 15;
        
        // ROI esperado
        addBox(M, y, W - 2*M, 45, [232, 245, 233], C.success);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.success);
        doc.text('RETORNO ESPERADO:', M + 5, y + 12);
        
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(...C.text);
        doc.text(`Economia estimada Ano 1: R$ ${economiaPotencial.toLocaleString('pt-BR')}`, M + 5, y + 22);
        doc.text('Ganhos em efici√™ncia: 15-25%', M + 5, y + 30);
        doc.text('Payback: 6-12 meses', M + 5, y + 38);
        
        y += 55;
        
        // Pr√≥ximos passos
        doc.setFontSize(13);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(...C.primary);
        doc.text('PR√ìXIMOS PASSOS:', M, y);
        
        y += 10;
        
        const passos = [
            'Valida√ß√£o do diagn√≥stico com equipe diretiva',
            'Prioriza√ß√£o de a√ß√µes por impacto x esfor√ßo',
            'Defini√ß√£o de respons√°veis e prazos',
            'In√≠cio da implementa√ß√£o da Fase 1'
        ];
        
        passos.forEach((passo, idx) => {
            doc.setFillColor(...C.accent);
            doc.circle(M + 5, y - 2, 3, 'F');
            doc.setFontSize(8);
            doc.setTextColor(...C.white);
            doc.setFont('helvetica', 'bold');
            doc.text((idx + 1).toString(), M + 5, y, { align: 'center' });
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(...C.text);
            doc.text(passo, M + 12, y);
            y += 10;
        });
        
        // Rodap√© confidencial
        y = 270;
        addLine(y - 5);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'italic');
        doc.setTextColor(...C.medium);
        doc.text('Este documento √© confidencial e destinado exclusivamente a ' + nomeEmpresa, W/2, y, { align: 'center' });
        doc.text('Data: ' + dataRelatorio, W/2, y + 7, { align: 'center' });
        
        console.log('‚úÖ Conclus√£o criada');
        
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // FINALIZAR E SALVAR
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        
        updateProgress(100, 'Salvando PDF...');
        
        const nomeArquivo = `Relatorio_Executivo_${nomeEmpresa.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.pdf`;
        doc.save(nomeArquivo);
        
        console.log('‚úÖ PDF gerado com sucesso!');
        alert('‚úÖ PDF Relat√≥rio Executivo Premium gerado com sucesso!\n\n' + 
              'Arquivo: ' + nomeArquivo + '\n\n' +
              'Total de p√°ginas: ' + doc.getNumberOfPages());
        
    } catch (erro) {
        console.error('‚ùå Erro ao gerar PDF:', erro);
        alert('‚ùå Erro ao gerar PDF: ' + erro.message);
    }
}

console.log('‚úÖ Fun√ß√£o gerarPDFRelatorioExecutivoPremium() definida!');



</script>

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CENTRAL DE AJUDA - JAVASCRIPT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// BASE DE DADOS DE ARTIGOS
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADICIONAR CONTE√öDO FASE 2 AO SISTEMA
</script>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SISTEMA DE SUPORTE MULTICANAL - JAVASCRIPT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// MENU AJUDA EXPANDIDO (BOT√ÉO FLUTUANTE)
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function toggleMenuAjuda() {
    const menu = document.getElementById('menu-ajuda');
    menu.classList.toggle('ativo');
}

// Fechar menu ao clicar fora
document.addEventListener('click', function(event) {
    const menu = document.getElementById('menu-ajuda');
    const botao = document.querySelector('.btn-ajuda-principal');
    
    if (menu && botao) {
        const isClickInsideMenu = menu.contains(event.target);
        const isClickOnButton = botao.contains(event.target);
        
        if (!isClickInsideMenu && !isClickOnButton && menu.classList.contains('ativo')) {
            menu.classList.remove('ativo');
        }
    }
});

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// MODAL DE FEEDBACK
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function abrirModalFeedback() {
    const modal = document.getElementById('modal-feedback-overlay');
    if (modal) {
        modal.classList.add('ativo');
        
        // Fechar menu flutuante se estiver aberto
        const menuAjuda = document.getElementById('menu-ajuda');
        if (menuAjuda) {
            menuAjuda.classList.remove('ativo');
        }
        
        // Focar no primeiro campo
        setTimeout(() => {
            const primeiroInput = document.getElementById('feedback-nome');
            if (primeiroInput) {
                primeiroInput.focus();
            }
        }, 300);
    }
}

function fecharModalFeedback(event) {
    // Se event for passado, verificar se clicou no overlay
    if (event && event.target !== event.currentTarget) {
        return;
    }
    
    const modal = document.getElementById('modal-feedback-overlay');
    if (modal) {
        modal.classList.remove('ativo');
        
        // Limpar formul√°rio
        const form = document.getElementById('form-feedback');
        if (form) {
            form.reset();
        }
    }
}

// Fechar modal com tecla ESC
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        const modal = document.getElementById('modal-feedback-overlay');
        if (modal && modal.classList.contains('ativo')) {
            fecharModalFeedback();
        }
    }
});

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// ENVIO DE FEEDBACK
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function enviarFeedback(event) {
    event.preventDefault();
    
    const form = event.target;
    const nome = form.nome.value;
    const email = form.email.value;
    const categoria = form.categoria.value;
    const mensagem = form.mensagem.value;
    
    // Valida√ß√£o b√°sica
    if (!nome || !email || !categoria || !mensagem) {
        alert('‚ö†Ô∏è Por favor, preencha todos os campos obrigat√≥rios.');
        return;
    }
    
    // Exibir loading
    const btnEnviar = form.querySelector('.btn-feedback-enviar');
    const textoOriginal = btnEnviar.textContent;
    btnEnviar.textContent = 'Enviando... ‚è≥';
    btnEnviar.disabled = true;
    
    // Simular envio (aqui voc√™ integraria com backend)
    setTimeout(() => {
        // Sucesso
        alert(`‚úÖ Feedback enviado com sucesso!\n\nObrigado, ${nome}! Sua mensagem foi recebida e responderemos em breve.`);
        
        // Resetar bot√£o
        btnEnviar.textContent = textoOriginal;
        btnEnviar.disabled = false;
        
        // Fechar modal
        fecharModalFeedback();
        
        // Log para analytics (simulado)
        console.log('üìä Feedback enviado:', {
            nome: nome,
            email: email,
            categoria: categoria,
            mensagem: mensagem,
            timestamp: new Date().toISOString()
        });
        
        // Aqui voc√™ pode adicionar integra√ß√£o com:
        // - Email API (SendGrid, Mailgun, etc)
        // - Google Forms
        // - Sistema pr√≥prio de tickets
        // - Slack/Discord webhook
        
    }, 1500);
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// ANALYTICS (RASTREAMENTO DE CLIQUES)
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function rastrearCliqueSuporte(canal) {
    console.log(`üìä Analytics: Clique em canal de suporte - ${canal}`);
    
    // Aqui voc√™ pode integrar com:
    // - Google Analytics
    // - Mixpanel
    // - Amplitude
    // - Sistema pr√≥prio
    
    // Exemplo com Google Analytics:
    // if (typeof gtag !== 'undefined') {
    //     gtag('event', 'click_suporte', {
    //         'canal': canal,
    //         'timestamp': new Date().toISOString()
    //     });
    // }
}

// Adicionar rastreamento aos links de suporte
document.addEventListener('DOMContentLoaded', function() {
    // Footer
    const linksFooter = document.querySelectorAll('.footer-canal');
    linksFooter.forEach(link => {
        link.addEventListener('click', function() {
            const canal = this.classList.contains('whatsapp') ? 'whatsapp' :
                         this.classList.contains('email') ? 'email' :
                         this.classList.contains('ajuda') ? 'central_ajuda' :
                         this.classList.contains('feedback') ? 'feedback' : 'outro';
            rastrearCliqueSuporte(canal + '_footer');
        });
    });
    
    // Menu flutuante
    const linksMenu = document.querySelectorAll('.menu-ajuda-item');
    linksMenu.forEach(link => {
        link.addEventListener('click', function() {
            const canal = this.classList.contains('whatsapp') ? 'whatsapp' :
                         this.classList.contains('email') ? 'email' :
                         this.classList.contains('ajuda') ? 'central_ajuda' :
                         this.classList.contains('feedback') ? 'feedback' : 'outro';
            rastrearCliqueSuporte(canal + '_menu_flutuante');
        });
    });
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // FUN√á√ÉO PARA ABRIR CENTRAL DE AJUDA
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    
    function abrirCentralAjuda() {
        // Fechar menu de ajuda se estiver aberto
        const menu = document.getElementById('menu-ajuda');
        if (menu) {
            menu.classList.remove('ativo');
        }
        
        // Navegar para a se√ß√£o de ajuda
        irPara('ajuda');
        
        // Analytics
        console.log('üìä Analytics: Navegou para Central de Ajuda');
        rastrearCliqueSuporte('central_ajuda', 'navegacao');
    }
    
    // Tornar fun√ß√£o global
    window.abrirCentralAjuda = abrirCentralAjuda;
    
    console.log('‚úÖ Sistema de Suporte Multicanal carregado com sucesso!');
});

</script>

<script>
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// AJUSTES DE LAYOUT (COMPENSAR FOOTER)
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

// Adicionar padding-bottom ao .main para n√£o sobrepor com footer
window.addEventListener('DOMContentLoaded', function() {
    const main = document.querySelector('.main');
    if (main) {
        main.style.paddingBottom = '80px'; // Altura do footer + margem
    }
});
</script>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SISTEMA DE SUPORTE MULTICANAL
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<!-- FOOTER FIXO COM 4 CANAIS -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SE√á√ÉO: CENTRAL DE AJUDA
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<footer class="footer-suporte">
    <a href="https://wa.me/5551999999999?text=Ol√°!%20Preciso%20de%20ajuda%20com%20o%20Gestor%20Financeiro%20360¬∞" 
       target="_blank" 
       class="footer-canal whatsapp">
        <span class="footer-canal-icon">üì±</span>
        <div class="footer-canal-text">
            <span class="footer-canal-title">WhatsApp</span>
            <span class="footer-canal-subtitle">Resposta em at√© 2h √∫teis</span>
        </div>
    </button>
    
    <a href="/cdn-cgi/l/email-protection#d1a2a4a1bea3a5b491b6b4a2a5bea3b7b8bfb0bfb2b4b8a3beffb2bebcffb3a3eea2a4b3bbb4b2a5ec82a4a1bea3a5b4f4e3e1fcf4e3e196b4a2a5bea3f4e3e1e2e7e11361" class="footer-canal email">
        <span class="footer-canal-icon">üìß</span>
        <div class="footer-canal-text">
            <span class="footer-canal-title">Email</span>
            <span class="footer-canal-subtitle">Resposta em at√© 24h</span>
        </div>
    </button>
    
    <a href="#" 
       onclick="event.preventDefault(); abrirCentralAjuda();" 
       class="footer-canal ajuda">
        <span class="footer-canal-icon">‚ùì</span>
        <div class="footer-canal-text">
            <span class="footer-canal-title">Central de Ajuda</span>
            <span class="footer-canal-subtitle">Artigos e tutoriais</span>
        </div>
    </button>
    
    <a href="#" 
       onclick="event.preventDefault(); abrirModalFeedback();" 
       class="footer-canal feedback">
        <span class="footer-canal-icon">üí°</span>
        <div class="footer-canal-text">
            <span class="footer-canal-title">Sugest√µes</span>
            <span class="footer-canal-subtitle">Ajude-nos a melhorar</span>
        </div>
    </button>
</footer>

<!-- BOT√ÉO FLUTUANTE "PRECISA DE AJUDA?" -->
<div class="btn-ajuda-flutuante">
    <button class="btn-ajuda-principal" onclick="toggleMenuAjuda()">
        <span class="btn-ajuda-icon">üí¨</span>
        <span>Precisa de ajuda?</span>
    </button>
    
    <div class="menu-ajuda-expandido" id="menu-ajuda">
        <a href="https://wa.me/5551999999999?text=Ol√°!%20Preciso%20de%20ajuda%20com%20o%20Gestor%20Financeiro%20360¬∞" 
           target="_blank" 
           class="menu-ajuda-item whatsapp">
            <span class="menu-ajuda-icon">üì±</span>
            <span>WhatsApp</span>
        </button>
        
        <a href="/cdn-cgi/l/email-protection#c4b7b1b4abb6b0a184a3a1b7b0abb6a2adaaa5aaa7a1adb6abeaa7aba9eaa6b6fbb7b1a6aea1a7b0f997b1b4abb6b0a1e1f6f4e9e1f6f483a1b7b0abb6e1f6f4f7f2f40674" class="menu-ajuda-item email">
            <span class="menu-ajuda-icon">üìß</span>
            <span>Email</span>
        </button>
        
        <a href="#" 
           onclick="event.preventDefault(); abrirCentralAjuda();" 
           class="menu-ajuda-item ajuda">
            <span class="menu-ajuda-icon">‚ùì</span>
            <span>Central de Ajuda</span>
        </button>
        
        <a href="#" 
           onclick="event.preventDefault(); abrirModalFeedback();" 
           class="menu-ajuda-item feedback">
            <span class="menu-ajuda-icon">üí°</span>
            <span>Sugest√µes</span>
        </button>
    </div>
</div>

<!-- MODAL DE FEEDBACK/SUGEST√ïES -->
<div class="modal-feedback-overlay" id="modal-feedback-overlay" onclick="fecharModalFeedback(event)">
    <div class="modal-feedback" onclick="event.stopPropagation()">
        <div class="modal-feedback-header">
            <h2 class="modal-feedback-title">
                <span>üí°</span>
                <span>Envie seu Feedback</span>
            </h2>
            <button class="modal-feedback-close" onclick="fecharModalFeedback()">√ó</button>
        </div>
        
        <form class="modal-feedback-body" id="form-feedback" onsubmit="enviarFeedback(event)">
            <div class="form-group-feedback">
                <label for="feedback-nome">Nome *</label>
                <input type="text" 
                       id="feedback-nome" 
                       name="nome" 
                       placeholder="Seu nome completo" 
                       required>
            </div>
            
            <div class="form-group-feedback">
                <label for="feedback-email">Email *</label>
                <input type="email" 
                       id="feedback-email" 
                       name="email" 
                       placeholder="seu@email.com" 
                       required>
            </div>
            
            <div class="form-group-feedback">
                <label for="feedback-categoria">Categoria *</label>
                <select id="feedback-categoria" name="categoria" required>
                    <option value="">Selecione...</option>
                    <option value="bug">üêõ Bug / Erro</option>
                    <option value="melhoria">‚ú® Sugest√£o de Melhoria</option>
                    <option value="elogio">üíö Elogio</option>
                    <option value="duvida">‚ùì D√∫vida</option>
                    <option value="outro">üìù Outro</option>
                </select>
            </div>
            
            <div class="form-group-feedback">
                <label for="feedback-mensagem">Mensagem *</label>
                <textarea id="feedback-mensagem" 
                          name="mensagem" 
                          placeholder="Descreva sua sugest√£o, bug ou feedback..." 
                          required></textarea>
            </div>
            
            <div class="modal-feedback-actions">
                <button type="button" class="btn-feedback btn-feedback-cancelar" onclick="fecharModalFeedback()">
                    Cancelar
                </button>
                <button type="submit" class="btn-feedback btn-feedback-enviar">
                    üì§ Enviar Feedback
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// CENTRAL DE AJUDA - JavaScript Completo

const ARTIGOS_AJUDA = {
    comecando: [
        {
            id: 'c1',
            titulo: 'O que √© o Gestor Financeiro 360¬∞?',
            descricao: 'Entenda o prop√≥sito e alcance da ferramenta',
            categoria: 'Come√ßando',
            icone: 'üìö',
            conteudo: `
                <h3>üéØ Vis√£o Geral</h3>
                <p>O <strong>Gestor Financeiro 360¬∞</strong> √© uma plataforma de diagn√≥stico empresarial desenvolvida para identificar oportunidades de melhoria na gest√£o financeira de PMEs (Pequenas e M√©dias Empresas).</p>
                
                <div class="destaque">
                    <h4>üí° Prop√≥sito Principal</h4>
                    <p>Avaliar a <strong>maturidade financeira</strong> da empresa em 8 dimens√µes cr√≠ticas, gerando insights acion√°veis para crescimento sustent√°vel.</p>
                </div>
                
                <h3>üìä Estrutura do Diagn√≥stico</h3>
                <p>A ferramenta est√° organizada em <strong>8 categorias estrat√©gicas</strong>, cada uma com <strong>10 perguntas</strong> espec√≠ficas:</p>
                <ul>
                    <li><strong>Tesouraria:</strong> Gest√£o de caixa e liquidez</li>
                    <li><strong>Resultados & DRE:</strong> An√°lise de rentabilidade</li>
                    <li><strong>Fluxo de Caixa:</strong> Proje√ß√µes e controle</li>
                    <li><strong>Or√ßamento/Planejamento/Precifica√ß√£o:</strong> Estrat√©gia financeira</li>
                    <li><strong>Investimentos & Sustentabilidade:</strong> Crescimento de longo prazo</li>
                    <li><strong>Riscos Financeiros:</strong> Gest√£o de exposi√ß√µes</li>
                    <li><strong>Indicadores Financeiros:</strong> KPIs e m√©tricas</li>
                    <li><strong>Planejamento Tribut√°rio:</strong> Otimiza√ß√£o fiscal</li>
                </ul>
                
                <h3>üéÅ Deliverables</h3>
                <p>Ao concluir o diagn√≥stico, voc√™ recebe:</p>
                <ul>
                    <li>üìä <strong>Score consolidado</strong> (0-100%) por categoria</li>
                    <li>üìà <strong>Relat√≥rio executivo</strong> em PDF profissional</li>
                    <li>üéØ <strong>Recomenda√ß√µes priorizadas</strong> de melhoria</li>
                    <li>üíº <strong>Proposta comercial personalizada</strong> com ROI estimado</li>
                    <li>üìã <strong>Plano de a√ß√£o estruturado</strong> para implementa√ß√£o</li>
                </ul>
                
                <h3>üèÜ Diferenciais</h3>
                <ul>
                    <li>‚úÖ Metodologia validada por especialistas Big 4</li>
                    <li>‚úÖ Interface intuitiva e profissional</li>
                    <li>‚úÖ Resultados instant√¢neos e acion√°veis</li>
                    <li>‚úÖ Integra√ß√£o com sistema de plano de a√ß√£o</li>
                    <li>‚úÖ Base de conhecimento com +100 recursos</li>
                </ul>
            `
        },
        {
            id: 'c2',
            titulo: 'Como Funciona o Diagn√≥stico?',
            descricao: 'Passo a passo completo do processo',
            categoria: 'Come√ßando',
            icone: 'üéØ',
            conteudo: `
                <h3>üöÄ Processo em 5 Etapas</h3>
                
                <h4>1Ô∏è‚É£ Dados da Empresa</h4>
                <p>Comece fornecendo informa√ß√µes b√°sicas:</p>
                <ul>
                    <li>Nome da empresa e CNPJ</li>
                    <li>Segmento de atua√ß√£o</li>
                    <li>Faturamento anual estimado</li>
                    <li>N√∫mero de colaboradores</li>
                </ul>
                <p><em>‚è±Ô∏è Tempo: 2-3 minutos</em></p>
                
                <h4>2Ô∏è‚É£ Question√°rio Diagn√≥stico</h4>
                <p>Responda √†s <strong>80 perguntas</strong> distribu√≠das nas 8 categorias. Cada pergunta oferece 5 op√ß√µes de resposta que representam diferentes n√≠veis de maturidade:</p>
                <ul>
                    <li>üî¥ <strong>N√≠vel 1:</strong> Inexistente/N√£o aplicado</li>
                    <li>üü† <strong>N√≠vel 2:</strong> Iniciante/Informal</li>
                    <li>üü° <strong>N√≠vel 3:</strong> Desenvolvimento/Parcial</li>
                    <li>üü¢ <strong>N√≠vel 4:</strong> Avan√ßado/Estruturado</li>
                    <li>üîµ <strong>N√≠vel 5:</strong> Otimizado/Classe mundial</li>
                </ul>
                <p><em>‚è±Ô∏è Tempo: 20-40 minutos (pode pausar e retomar)</em></p>
                
                <h4>3Ô∏è‚É£ Calculadora de Perdas</h4>
                <p>Estime o impacto financeiro de gaps identificados:</p>
                <ul>
                    <li>üí∏ Perdas por falta de controle de caixa</li>
                    <li>üìâ Perdas por precifica√ß√£o inadequada</li>
                    <li>üè¶ Perdas por gest√£o ineficiente de capital de giro</li>
                    <li>üí∞ Perdas por planejamento tribut√°rio sub√≥timo</li>
                </ul>
                <p><em>‚è±Ô∏è Tempo: 5-10 minutos</em></p>
                
                <h4>4Ô∏è‚É£ Relat√≥rio Executivo</h4>
                <p>Receba instantaneamente:</p>
                <ul>
                    <li>üìä Dashboard visual com scores por categoria</li>
                    <li>üìà Gr√°fico radar comparativo</li>
                    <li>üéØ Top 5 prioridades de melhoria</li>
                    <li>üí° Recomenda√ß√µes estrat√©gicas detalhadas</li>
                    <li>üìÑ Documento PDF profissional (15-20 p√°ginas)</li>
                </ul>
                
                <h4>5Ô∏è‚É£ Proposta Comercial</h4>
                <p>Gere automaticamente uma proposta de servi√ßos:</p>
                <ul>
                    <li>üéÅ Pacotes personalizados baseados nos gaps</li>
                    <li>üíµ Precifica√ß√£o com descritivos detalhados</li>
                    <li>üìä ROI estimado por servi√ßo</li>
                    <li>‚è∞ Cronograma de implementa√ß√£o</li>
                    <li>üìã Termos e condi√ß√µes</li>
                </ul>
                
                <div class="destaque">
                    <h4>üí° Dica Profissional</h4>
                    <p>Para melhores resultados, tenha em m√£os: √∫ltima DRE, balancete recente, fluxo de caixa dos √∫ltimos 3 meses e planilhas de controle existentes.</p>
                </div>
                
                <h3>üîÑ Flexibilidade</h3>
                <ul>
                    <li>‚úÖ Salve o progresso a qualquer momento</li>
                    <li>‚úÖ Revise e ajuste respostas antes de finalizar</li>
                    <li>‚úÖ Exporte relat√≥rios em m√∫ltiplos formatos</li>
                    <li>‚úÖ Compartilhe resultados com stakeholders</li>
                </ul>
            `
        },
        {
            id: 'c3',
            titulo: 'Quanto Tempo Leva o Diagn√≥stico?',
            descricao: 'Estimativas e fatores que impactam a dura√ß√£o',
            categoria: 'Come√ßando',
            icone: '‚è±Ô∏è',
            conteudo: `
                <h3>‚è∞ Tempo Total Estimado</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>Etapa</th>
                            <th>Tempo M√≠nimo</th>
                            <th>Tempo M√©dio</th>
                            <th>Tempo M√°ximo</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Dados da Empresa</td>
                            <td>2 min</td>
                            <td>3 min</td>
                            <td>5 min</td>
                        </tr>
                        <tr>
                            <td>Question√°rio (80 perguntas)</td>
                            <td>20 min</td>
                            <td>35 min</td>
                            <td>60 min</td>
                        </tr>
                        <tr>
                            <td>Calculadora de Perdas</td>
                            <td>5 min</td>
                            <td>8 min</td>
                            <td>15 min</td>
                        </tr>
                        <tr>
                            <td>Revis√£o de Respostas</td>
                            <td>3 min</td>
                            <td>5 min</td>
                            <td>10 min</td>
                        </tr>
                        <tr>
                            <td><strong>TOTAL</strong></td>
                            <td><strong>30 min</strong></td>
                            <td><strong>51 min</strong></td>
                            <td><strong>90 min</strong></td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>üìä Fatores que Influenciam o Tempo</h3>
                
                <h4>‚ö° Reduzem o Tempo:</h4>
                <ul>
                    <li>‚úÖ Empresa j√° possui controles financeiros estruturados</li>
                    <li>‚úÖ Gestor conhece bem a opera√ß√£o financeira</li>
                    <li>‚úÖ Documenta√ß√£o financeira dispon√≠vel e organizada</li>
                    <li>‚úÖ Experi√™ncia pr√©via com diagn√≥sticos similares</li>
                    <li>‚úÖ Foco e ambiente sem distra√ß√µes</li>
                </ul>
                
                <h4>üêå Aumentam o Tempo:</h4>
                <ul>
                    <li>‚ö†Ô∏è Controles financeiros inexistentes ou desorganizados</li>
                    <li>‚ö†Ô∏è Necessidade de consultar m√∫ltiplas pessoas/√°reas</li>
                    <li>‚ö†Ô∏è Dificuldade em localizar informa√ß√µes financeiras</li>
                    <li>‚ö†Ô∏è Primeira experi√™ncia com diagn√≥sticos estruturados</li>
                    <li>‚ö†Ô∏è Interrup√ß√µes frequentes durante o processo</li>
                </ul>
                
                <div class="destaque">
                    <h4>üí° Recomenda√ß√£o de Preenchimento</h4>
                    <p><strong>Modo Ideal:</strong> Reserve 1 hora ininterrupta em ambiente tranquilo, com acesso a documentos financeiros. Complete de uma vez para melhores insights.</p>
                    <p><strong>Modo Flex√≠vel:</strong> Se necess√°rio, fa√ßa em m√∫ltiplas sess√µes. O sistema salva automaticamente seu progresso a cada categoria conclu√≠da.</p>
                </div>
                
                <h3>üéØ Tempo por Categoria</h3>
                <p>Cada uma das 8 categorias cont√©m 10 perguntas. Tempo m√©dio:</p>
                <ul>
                    <li>üìä <strong>Tesouraria:</strong> 4-5 minutos</li>
                    <li>üìà <strong>Resultados & DRE:</strong> 4-6 minutos</li>
                    <li>üí∞ <strong>Fluxo de Caixa:</strong> 4-5 minutos</li>
                    <li>üéØ <strong>Or√ßamento/Planejamento:</strong> 5-7 minutos</li>
                    <li>üå± <strong>Investimentos:</strong> 4-6 minutos</li>
                    <li>‚ö†Ô∏è <strong>Riscos Financeiros:</strong> 3-5 minutos</li>
                    <li>üìä <strong>Indicadores:</strong> 4-5 minutos</li>
                    <li>üèõÔ∏è <strong>Tribut√°rio:</strong> 4-6 minutos</li>
                </ul>
                
                <h3>‚ú® Recursos de Produtividade</h3>
                <ul>
                    <li>üíæ <strong>Salvamento autom√°tico:</strong> Progresso salvo a cada resposta</li>
                    <li>üîÑ <strong>Retomar de onde parou:</strong> Continue em qualquer dispositivo</li>
                    <li>‚èÆÔ∏è <strong>Navega√ß√£o livre:</strong> Volte e ajuste respostas anteriores</li>
                    <li>üì± <strong>Multi-dispositivo:</strong> Inicie no desktop, finalize no mobile</li>
                    <li>‚è∏Ô∏è <strong>Pausas ilimitadas:</strong> Sem prazo de expira√ß√£o</li>
                </ul>
            `
        },
        {
            id: 'c4',
            titulo: 'Como Interpretar os Resultados?',
            descricao: 'Guia completo de leitura e an√°lise do diagn√≥stico',
            categoria: 'Come√ßando',
            icone: 'üìä',
            conteudo: `
                <h3>üéØ Sistema de Pontua√ß√£o</h3>
                <p>Cada categoria √© avaliada em uma escala de <strong>0 a 100%</strong>, representando o n√≠vel de maturidade da gest√£o financeira:</p>
                
                <h4>üî¥ Cr√≠tico (0-30%)</h4>
                <ul>
                    <li><strong>Significado:</strong> Controles inexistentes ou extremamente prec√°rios</li>
                    <li><strong>Risco:</strong> ALTO - Amea√ßa imediata √† continuidade do neg√≥cio</li>
                    <li><strong>A√ß√£o:</strong> Interven√ß√£o urgente necess√°ria</li>
                    <li><strong>Prioridade:</strong> M√ÅXIMA - Implementar controles b√°sicos imediatamente</li>
                    <li><strong>Analogia:</strong> Empresa navegando √†s cegas em mar agitado</li>
                </ul>
                
                <h4>üü† Aten√ß√£o (30-60%)</h4>
                <ul>
                    <li><strong>Significado:</strong> Controles b√°sicos existem mas s√£o informais/incompletos</li>
                    <li><strong>Risco:</strong> M√âDIO - Vulnerabilidades significativas</li>
                    <li><strong>A√ß√£o:</strong> Estrutura√ß√£o e profissionaliza√ß√£o necess√°rias</li>
                    <li><strong>Prioridade:</strong> ALTA - Implementar processos estruturados</li>
                    <li><strong>Analogia:</strong> Empresa com b√∫ssola, mas sem mapa definido</li>
                </ul>
                
                <h4>üü° Em Desenvolvimento (60-75%)</h4>
                <ul>
                    <li><strong>Significado:</strong> Controles estruturados mas com gaps de otimiza√ß√£o</li>
                    <li><strong>Risco:</strong> BAIXO - Gest√£o funcional com pontos de melhoria</li>
                    <li><strong>A√ß√£o:</strong> Refinamento e automa√ß√£o recomendados</li>
                    <li><strong>Prioridade:</strong> M√âDIA - Evoluir para melhores pr√°ticas</li>
                    <li><strong>Analogia:</strong> Empresa com navega√ß√£o funcional, buscando efici√™ncia</li>
                </ul>
                
                <h4>üü¢ Bom (75-90%)</h4>
                <ul>
                    <li><strong>Significado:</strong> Gest√£o profissional e controles robustos</li>
                    <li><strong>Risco:</strong> MUITO BAIXO - Processos bem estabelecidos</li>
                    <li><strong>A√ß√£o:</strong> Manuten√ß√£o e aprimoramento cont√≠nuo</li>
                    <li><strong>Prioridade:</strong> BAIXA - Foco em inova√ß√£o e otimiza√ß√£o</li>
                    <li><strong>Analogia:</strong> Empresa com sistemas GPS e piloto autom√°tico</li>
                </ul>
                
                <h4>üîµ Excelente (90-100%)</h4>
                <ul>
                    <li><strong>Significado:</strong> Gest√£o de classe mundial com melhores pr√°ticas</li>
                    <li><strong>Risco:</strong> M√çNIMO - Controles de excel√™ncia</li>
                    <li><strong>A√ß√£o:</strong> Manter padr√£o e buscar inova√ß√£o disruptiva</li>
                    <li><strong>Prioridade:</strong> BENCHMARK - Servir de refer√™ncia para mercado</li>
                    <li><strong>Analogia:</strong> Empresa com intelig√™ncia artificial preditiva</li>
                </ul>
                
                <h3>üìà Interpretando o Gr√°fico Radar</h3>
                <p>O gr√°fico radar mostra visualmente o equil√≠brio entre as 8 categorias:</p>
                <ul>
                    <li>üîµ <strong>Formato regular/circular:</strong> Gest√£o equilibrada e madura</li>
                    <li>‚ö†Ô∏è <strong>Pontas e vales:</strong> Desequil√≠brios que requerem aten√ß√£o</li>
                    <li>üéØ <strong>√Åreas c√¥ncavas:</strong> Gaps cr√≠ticos para priorizar</li>
                    <li>‚ú® <strong>√Årea total:</strong> Quanto maior, melhor a maturidade geral</li>
                </ul>
                
                <div class="destaque">
                    <h4>‚ö†Ô∏è Padr√µes de Alerta</h4>
                    <p><strong>Desbalanceamento Cr√≠tico:</strong> Diferen√ßa >40% entre categorias indica vulnerabilidade estrutural</p>
                    <p><strong>Efeito Domin√≥:</strong> Categorias interconectadas (ex: Tesouraria + Fluxo de Caixa) abaixo de 50% multiplicam riscos</p>
                </div>
                
                <h3>üéØ Score Geral vs. Scores por Categoria</h3>
                <p><strong>Score Geral:</strong> M√©dia ponderada das 8 categorias (todas com peso igual)</p>
                <p><strong>Interpreta√ß√£o:</strong> Score geral alto n√£o elimina risco se categorias cr√≠ticas estiverem baixas</p>
                
                <h4>üí° Exemplo Pr√°tico:</h4>
                <ul>
                    <li>Score Geral: 75% (Bom) ‚úÖ</li>
                    <li>Mas: Tesouraria 35% (Cr√≠tico) üî¥</li>
                    <li>E: Fluxo de Caixa 40% (Aten√ß√£o) üü†</li>
                    <li><strong>Conclus√£o:</strong> Risco elevado de crise de liquidez apesar do score geral positivo!</li>
                </ul>
                
                <h3>üìä Usando os Resultados</h3>
                <ol>
                    <li><strong>Identifique prioridades:</strong> Comece pelas categorias cr√≠ticas (<30%)</li>
                    <li><strong>Analise interdepend√™ncias:</strong> Categorias relacionadas devem ser tratadas juntas</li>
                    <li><strong>Estime ROI:</strong> Use a calculadora de perdas para quantificar ganhos potenciais</li>
                    <li><strong>Planeje a√ß√µes:</strong> Utilize o plano de a√ß√£o para implementa√ß√£o estruturada</li>
                    <li><strong>Monitore evolu√ß√£o:</strong> Refa√ßa o diagn√≥stico trimestralmente para acompanhar progresso</li>
                </ol>
                
                <h3>üèÜ Benchmarks de Mercado</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Porte</th>
                            <th>Score M√©dio</th>
                            <th>Top 25%</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Microempresa</td>
                            <td>45-55%</td>
                            <td>>70%</td>
                        </tr>
                        <tr>
                            <td>Pequena Empresa</td>
                            <td>55-65%</td>
                            <td>>75%</td>
                        </tr>
                        <tr>
                            <td>M√©dia Empresa</td>
                            <td>65-75%</td>
                            <td>>85%</td>
                        </tr>
                    </tbody>
                </table>
            `
        }
    ],
    categorias: [
        {
            id: 'cat1',
            titulo: 'üí∞ Tesouraria',
            descricao: 'Gest√£o de caixa, bancos e liquidez imediata',
            categoria: 'Categorias',
            icone: 'üí∞',
            conteudo: `
                <h3>üéØ O que √© Tesouraria?</h3>
                <p>A <strong>Tesouraria</strong> √© a √°rea respons√°vel pela gest√£o do dispon√≠vel financeiro da empresa, garantindo liquidez para honrar compromissos e otimizando recursos ociosos.</p>
                
                <div class="destaque">
                    <h4>üí° Objetivo Principal</h4>
                    <p>Garantir que a empresa tenha <strong>caixa suficiente</strong> para opera√ß√µes di√°rias enquanto <strong>maximiza o retorno</strong> de recursos excedentes.</p>
                </div>
                
                <h3>üìä O que Avaliamos (15 Perguntas)</h3>
                <ul>
                    <li>üè¶ Estrutura de contas banc√°rias e segmenta√ß√£o</li>
                    <li>üí≥ Controle de meios de pagamento (cart√µes, boletos, Pix)</li>
                    <li>üìÖ Concilia√ß√£o banc√°ria e frequ√™ncia</li>
                    <li>üíµ Gest√£o de numer√°rio e pequenas despesas</li>
                    <li>üîÑ Gest√£o de receb√≠veis e baixas</li>
                    <li>üìä Previs√£o de entrada e sa√≠da de recursos</li>
                    <li>‚ö° Gest√£o de liquidez e reservas de emerg√™ncia</li>
                    <li>üìà Aplica√ß√µes financeiras de curto prazo</li>
                    <li>üéØ Pol√≠ticas de cr√©dito e cobran√ßa</li>
                    <li>üí∞ Gest√£o de adiantamentos e suprimentos</li>
                    <li>üèõÔ∏è Relacionamento banc√°rio e taxas</li>
                    <li>üìã Controles antifraude</li>
                    <li>üîê Segrega√ß√£o de fun√ß√µes e al√ßadas</li>
                    <li>üì± N√≠vel de automa√ß√£o e sistemas</li>
                    <li>üìä Indicadores de performance (DSO, DPO, etc)</li>
                </ul>
                
                <h3>‚ö†Ô∏è Sinais de Alerta</h3>
                <ul>
                    <li>üî¥ Desconhecimento do saldo real de caixa</li>
                    <li>üî¥ Concilia√ß√£o banc√°ria atrasada ou inexistente</li>
                    <li>üî¥ Surpresas com cheques devolvidos ou d√©bitos</li>
                    <li>üî¥ Caixa frequentemente zerado ou negativo</li>
                    <li>üî¥ Depend√™ncia de "jeitinhos" para pagar contas</li>
                </ul>
                
                <h3>‚úÖ Melhores Pr√°ticas</h3>
                <ul>
                    <li>‚úÖ Concilia√ß√£o banc√°ria di√°ria automatizada</li>
                    <li>‚úÖ Estrutura de contas segregadas por finalidade</li>
                    <li>‚úÖ Previs√£o de caixa rolling para 90 dias</li>
                    <li>‚úÖ Pol√≠tica clara de cr√©dito e cobran√ßa</li>
                    <li>‚úÖ Aplica√ß√£o autom√°tica de recursos ociosos</li>
                    <li>‚úÖ Indicadores em tempo real via dashboard</li>
                </ul>
                
                <h3>üìà Impacto de Melhorias</h3>
                <p>Empresas com tesouraria estruturada apresentam:</p>
                <ul>
                    <li>üí∞ Redu√ß√£o de 30-50% em taxas banc√°rias</li>
                    <li>üìâ Diminui√ß√£o de 40-60% em juros de empr√©stimos emergenciais</li>
                    <li>‚ö° Aumento de 15-25% no retorno de aplica√ß√µes</li>
                    <li>üéØ Redu√ß√£o de 70-90% em surpresas de caixa</li>
                </ul>
            `
        },
        {
            id: 'cat2',
            titulo: 'üìä Resultados & DRE',
            descricao: 'An√°lise de rentabilidade e demonstrativo de resultados',
            categoria: 'Categorias',
            icone: 'üìä',
            conteudo: `
                <h3>üéØ O que √© Gest√£o de Resultados?</h3>
                <p>√Årea focada na <strong>an√°lise de rentabilidade</strong> atrav√©s da Demonstra√ß√£o do Resultado do Exerc√≠cio (DRE), identificando drivers de lucro e oportunidades de melhoria.</p>
                
                <div class="destaque">
                    <h4>üí° Por que √© Cr√≠tico?</h4>
                    <p>Faturamento alto n√£o garante lucro. Muitas empresas "quebram faturando", ignorando margens e estrutura de custos.</p>
                </div>
                
                <h3>üìä O que Avaliamos</h3>
                <ul>
                    <li>üìà Elabora√ß√£o mensal da DRE gerencial</li>
                    <li>üí∞ Classifica√ß√£o correta de receitas e dedu√ß√µes</li>
                    <li>üè≠ Segrega√ß√£o de custos vari√°veis vs. fixos</li>
                    <li>üíº Controle de despesas operacionais</li>
                    <li>üìä An√°lise vertical e horizontal</li>
                    <li>üéØ C√°lculo e acompanhamento de margens</li>
                    <li>üìâ An√°lise de ponto de equil√≠brio</li>
                    <li>üí° Custeio por produto/servi√ßo/cliente</li>
                    <li>üìà An√°lise de mix de vendas</li>
                    <li>üîç Controle de gastos n√£o operacionais</li>
                    <li>üí∏ Gest√£o de despesas financeiras</li>
                    <li>üéÅ An√°lise de bonifica√ß√µes e descontos</li>
                    <li>üìä Comparativo or√ßado vs. realizado</li>
                    <li>üìÖ Proje√ß√µes de resultados futuros</li>
                    <li>üèÜ Benchmarking setorial</li>
                </ul>
                
                <h3>‚ö†Ô∏è Armadilhas Comuns</h3>
                <ul>
                    <li>üî¥ Confundir faturamento com lucro</li>
                    <li>üî¥ Ignorar custos ocultos ou indiretos</li>
                    <li>üî¥ N√£o separar regime de caixa vs. compet√™ncia</li>
                    <li>üî¥ DRE apenas anual (para imposto de renda)</li>
                    <li>üî¥ Decis√µes baseadas em "achismo" sem n√∫meros</li>
                </ul>
                
                <h3>‚úÖ Estrutura Ideal de DRE Gerencial</h3>
                <ul>
                    <li>‚úÖ <strong>Receita Bruta</strong> - Faturamento total</li>
                    <li>‚úÖ <strong>(-) Dedu√ß√µes</strong> - Impostos, devolu√ß√µes, descontos</li>
                    <li>‚úÖ <strong>= Receita L√≠quida</strong> - Base real de an√°lise</li>
                    <li>‚úÖ <strong>(-) CPV/CMV</strong> - Custos vari√°veis diretos</li>
                    <li>‚úÖ <strong>= Lucro Bruto</strong> - Primeira margem cr√≠tica</li>
                    <li>‚úÖ <strong>(-) Despesas Operacionais</strong> - Comercial, administrativa</li>
                    <li>‚úÖ <strong>= EBITDA</strong> - Resultado operacional puro</li>
                    <li>‚úÖ <strong>(-) Deprecia√ß√£o</strong> - Desgaste de ativos</li>
                    <li>‚úÖ <strong>= EBIT</strong> - Resultado antes de juros e impostos</li>
                    <li>‚úÖ <strong>(+/-) Resultado Financeiro</strong> - Juros l√≠quidos</li>
                    <li>‚úÖ <strong>= Lucro L√≠quido</strong> - Bottom line</li>
                </ul>
                
                <h3>üìà Margens de Refer√™ncia (PMEs)</h3>
                <table>
                    <thead><tr><th>Indicador</th><th>M√≠nimo</th><th>Adequado</th><th>Excelente</th></tr></thead>
                    <tbody>
                        <tr><td>Margem Bruta</td><td>30%</td><td>40-50%</td><td>>60%</td></tr>
                        <tr><td>Margem EBITDA</td><td>10%</td><td>15-20%</td><td>>25%</td></tr>
                        <tr><td>Margem L√≠quida</td><td>5%</td><td>10-15%</td><td>>20%</td></tr>
                    </tbody>
                </table>
            `
        },
        {
            id: 'cat3',
            titulo: 'üíß Fluxo de Caixa',
            descricao: 'Proje√ß√µes e controle de entradas e sa√≠das',
            categoria: 'Categorias',
            icone: 'üíß',
            conteudo: `
                <h3>üéØ O que √© Fluxo de Caixa?</h3>
                <p>Ferramenta que registra e projeta <strong>todas as movimenta√ß√µes financeiras</strong> (entradas e sa√≠das) permitindo antever necessidades de capital e tomar decis√µes proativas.</p>
                
                <div class="destaque">
                    <h4>‚ö†Ô∏è Alerta Cr√≠tico</h4>
                    <p>90% das fal√™ncias de PMEs decorrem de <strong>falta de liquidez</strong>, n√£o de falta de lucratividade. Fluxo de caixa previne crises!</p>
                </div>
                
                <h3>üìä O que Avaliamos</h3>
                <ul>
                    <li>üìÖ Elabora√ß√£o de fluxo de caixa projetado</li>
                    <li>‚è∞ Horizonte de proje√ß√£o (di√°rio, semanal, mensal)</li>
                    <li>üéØ Acur√°cia das previs√µes vs. realizado</li>
                    <li>üí∞ Controle de contas a pagar e receber</li>
                    <li>üìä An√°lise de sazonalidade</li>
                    <li>üîÑ Gest√£o do ciclo operacional</li>
                    <li>üí≥ Previs√£o de recebimentos (cart√µes, boletos, etc)</li>
                    <li>üìà Cen√°rios (pessimista, realista, otimista)</li>
                    <li>‚ö° Identifica√ß√£o de gaps de caixa</li>
                    <li>üè¶ Planejamento de capta√ß√µes</li>
                    <li>üí∏ Prioriza√ß√£o de pagamentos</li>
                    <li>üìä An√°lise de sensibilidade</li>
                    <li>üéØ Capital de giro necess√°rio</li>
                    <li>üì± N√≠vel de automa√ß√£o</li>
                    <li>üîç Integra√ß√£o com DRE</li>
                </ul>
                
                <h3>üî¥ Sinais de Crise Iminente</h3>
                <ul>
                    <li>üî¥ Desconhecimento de compromissos dos pr√≥ximos 30 dias</li>
                    <li>üî¥ Pagamentos atrasados recorrentes</li>
                    <li>üî¥ Uso de limite de cheque especial toda semana</li>
                    <li>üî¥ "Malabares" frequentes para cobrir despesas</li>
                    <li>üî¥ Surpresas com vencimentos</li>
                </ul>
                
                <h3>‚úÖ Estrutura de Fluxo de Caixa Profissional</h3>
                
                <h4>üìä Fluxo Realizado (Hist√≥rico)</h4>
                <ul>
                    <li>Registro di√°rio de todas movimenta√ß√µes</li>
                    <li>Categoriza√ß√£o por natureza (operacional, investimento, financiamento)</li>
                    <li>Concilia√ß√£o com extratos banc√°rios</li>
                    <li>An√°lise de desvios vs. projetado</li>
                </ul>
                
                <h4>üîÆ Fluxo Projetado (Futuro)</h4>
                <ul>
                    <li><strong>Curto Prazo:</strong> Di√°rio para pr√≥ximos 30 dias</li>
                    <li><strong>M√©dio Prazo:</strong> Semanal para 90 dias</li>
                    <li><strong>Longo Prazo:</strong> Mensal para 12 meses</li>
                </ul>
                
                <h3>üéØ Indicadores Chave</h3>
                <ul>
                    <li>üí∞ <strong>Saldo M√≠nimo de Caixa:</strong> Reserva de seguran√ßa (15-30 dias de despesas)</li>
                    <li>üìä <strong>Ciclo de Caixa:</strong> PMR + PME - PMP (quanto menor, melhor)</li>
                    <li>‚ö° <strong>Liquidez Imediata:</strong> Dispon√≠vel / Passivo Circulante</li>
                    <li>üîÑ <strong>Capital de Giro:</strong> Ativo Circulante - Passivo Circulante</li>
                </ul>
                
                <h3>üìà Impacto de Gest√£o Profissional</h3>
                <ul>
                    <li>‚úÖ Redu√ß√£o de 60-80% em juros de emerg√™ncia</li>
                    <li>‚úÖ Elimina√ß√£o de atrasos e multas</li>
                    <li>‚úÖ Negocia√ß√£o estrat√©gica com fornecedores</li>
                    <li>‚úÖ Aproveitamento de descontos por antecipa√ß√£o</li>
                    <li>‚úÖ Decis√µes de investimento com seguran√ßa</li>
                </ul>
            `
        },
        {
            id: 'cat4',
            titulo: 'üéØ Or√ßamento, Planejamento & Precifica√ß√£o',
            descricao: 'Estrat√©gia financeira e forma√ß√£o de pre√ßos',
            categoria: 'Categorias',
            icone: 'üéØ',
            conteudo: `
                <h3>üéØ Pilares da Gest√£o Estrat√©gica</h3>
                <p>Esta categoria integra tr√™s dimens√µes cr√≠ticas: <strong>Or√ßamento</strong> (onde queremos chegar), <strong>Planejamento</strong> (como chegar) e <strong>Precifica√ß√£o</strong> (quanto cobrar para ser sustent√°vel).</p>
                
                <h3>üìä O que Avaliamos</h3>
                <h4>üí∞ Or√ßamento</h4>
                <ul>
                    <li>Elabora√ß√£o de or√ßamento anual</li>
                    <li>Desdobramento mensal e por centro de custo</li>
                    <li>Participa√ß√£o das √°reas no processo</li>
                    <li>Acompanhamento Budget x Real</li>
                    <li>An√°lise de varia√ß√µes e ajustes</li>
                </ul>
                
                <h4>üó∫Ô∏è Planejamento</h4>
                <ul>
                    <li>Planejamento estrat√©gico formalizado</li>
                    <li>Metas financeiras SMART</li>
                    <li>Planos de a√ß√£o por objetivo</li>
                    <li>Cen√°rios e simula√ß√µes</li>
                    <li>Revis√µes peri√≥dicas</li>
                </ul>
                
                <h4>üíµ Precifica√ß√£o</h4>
                <ul>
                    <li>Metodologia de forma√ß√£o de pre√ßos</li>
                    <li>C√°lculo de markup e margem</li>
                    <li>An√°lise de elasticidade</li>
                    <li>Pol√≠tica de descontos</li>
                    <li>Precifica√ß√£o por segmento/canal</li>
                </ul>
                
                <h3>üìà M√©todos de Precifica√ß√£o</h3>
                <table>
                    <thead><tr><th>M√©todo</th><th>Quando Usar</th><th>Vantagem</th></tr></thead>
                    <tbody>
                        <tr><td>Markup</td><td>Produtos padronizados</td><td>Simples e r√°pido</td></tr>
                        <tr><td>Margem de Contribui√ß√£o</td><td>Mix variado</td><td>Otimiza rentabilidade</td></tr>
                        <tr><td>Valor Percebido</td><td>Servi√ßos diferenciados</td><td>Maximiza margem</td></tr>
                        <tr><td>Pre√ßo de Mercado</td><td>Commodities</td><td>Competitivo</td></tr>
                    </tbody>
                </table>
                
                <div class="destaque">
                    <h4>‚ö†Ô∏è Erro Fatal</h4>
                    <p>Precificar apenas cobrindo custos vari√°veis e ignorando fixos leva √† <strong>morte lenta por volume</strong>. Sempre considere TODOS os custos + margem desejada.</p>
                </div>
                
                <h3>‚úÖ Checklist de Precifica√ß√£o Saud√°vel</h3>
                <ul>
                    <li>‚úÖ Cobre 100% dos custos (vari√°veis + fixos rateados)</li>
                    <li>‚úÖ Inclua margem de lucro m√≠nima (10-15%)</li>
                    <li>‚úÖ Considere impostos na base de c√°lculo</li>
                    <li>‚úÖ Teste sensibilidade: -10% volume ‚Üí lucro?</li>
                    <li>‚úÖ Compare com concorrentes similares</li>
                    <li>‚úÖ Valide se mercado aceita o pre√ßo</li>
                </ul>
            `
        },
        {
            id: 'cat5',
            titulo: 'üå± Investimentos & Sustentabilidade',
            descricao: 'Crescimento de longo prazo e perenidade',
            categoria: 'Categorias',
            icone: 'üå±',
            conteudo: `
                <h3>üéØ Vis√£o de Longo Prazo</h3>
                <p>Avalia capacidade da empresa de <strong>crescer de forma sustent√°vel</strong>, equilibrando investimentos em ativos, inova√ß√£o e gera√ß√£o de caixa.</p>
                
                <h3>üìä O que Avaliamos</h3>
                <h4>üíº Investimentos</h4>
                <ul>
                    <li>An√°lise de viabilidade (VPL, TIR, Payback)</li>
                    <li>Crit√©rios de aprova√ß√£o de projetos</li>
                    <li>Fontes de financiamento de investimentos</li>
                    <li>Controle de CAPEX vs. or√ßado</li>
                    <li>Gest√£o de ativos imobilizados</li>
                </ul>
                
                <h4>üåç Sustentabilidade</h4>
                <ul>
                    <li>Gera√ß√£o de caixa operacional consistente</li>
                    <li>Autofinanciamento do crescimento</li>
                    <li>Estrutura de capital saud√°vel</li>
                    <li>Reservas e provis√µes adequadas</li>
                    <li>Distribui√ß√£o de resultados planejada</li>
                </ul>
                
                <h3>üìà Indicadores de Sustentabilidade</h3>
                <ul>
                    <li>üìä <strong>ROI:</strong> Retorno sobre Investimento >15%</li>
                    <li>üí∞ <strong>ROE:</strong> Retorno sobre Patrim√¥nio >20%</li>
                    <li>üè≠ <strong>ROIC:</strong> Retorno sobre Capital Investido >12%</li>
                    <li>üí∏ <strong>Free Cash Flow:</strong> Positivo e crescente</li>
                    <li>üéØ <strong>Payback:</strong> <3 anos para investimentos</li>
                </ul>
                
                <div class="destaque">
                    <h4>‚ö†Ô∏è Armadilha do Crescimento</h4>
                    <p>Crescer sem estrutura financeira gera <strong>"crescimento destrutivo"</strong>: mais volume, menos margem, caixa negativo = crise!</p>
                </div>
                
                <h3>‚úÖ Princ√≠pios de Crescimento Saud√°vel</h3>
                <ul>
                    <li>‚úÖ Crescimento m√°ximo = Capacidade de autofinanciamento</li>
                    <li>‚úÖ Investir apenas com retorno superior ao custo de capital</li>
                    <li>‚úÖ Manter reservas de 6-12 meses de despesas fixas</li>
                    <li>‚úÖ Endividamento m√°ximo de 40% do patrim√¥nio</li>
                    <li>‚úÖ Reinvestir 30-50% do lucro no neg√≥cio</li>
                </ul>
            `
        },
        {
            id: 'cat6',
            titulo: '‚ö†Ô∏è Riscos Financeiros',
            descricao: 'Identifica√ß√£o e mitiga√ß√£o de exposi√ß√µes',
            categoria: 'Categorias',
            icone: '‚ö†Ô∏è',
            conteudo: `
                <h3>üéØ Gest√£o Proativa de Riscos</h3>
                <p>Identifica, mensura e mitiga <strong>exposi√ß√µes financeiras</strong> que podem comprometer a continuidade ou rentabilidade do neg√≥cio.</p>
                
                <h3>üìä Principais Riscos Avaliados</h3>
                <h4>üí∏ Risco de Liquidez</h4>
                <ul>
                    <li>Capacidade de honrar compromissos de curto prazo</li>
                    <li>Depend√™ncia de cr√©dito banc√°rio</li>
                    <li>Concentra√ß√£o de vencimentos</li>
                    <li>Reservas de emerg√™ncia</li>
                </ul>
                
                <h4>üí∞ Risco de Cr√©dito</h4>
                <ul>
                    <li>Inadimpl√™ncia de clientes</li>
                    <li>Concentra√ß√£o de receb√≠veis</li>
                    <li>Pol√≠tica de cr√©dito e garantias</li>
                    <li>Provis√£o para devedores duvidosos</li>
                </ul>
                
                <h4>üí± Risco Cambial</h4>
                <ul>
                    <li>Exposi√ß√£o a varia√ß√£o de moedas</li>
                    <li>Hedge de opera√ß√µes internacionais</li>
                    <li>Descasamento de receitas/despesas em moeda</li>
                </ul>
                
                <h4>üìà Risco de Taxa de Juros</h4>
                <ul>
                    <li>D√≠vidas com taxas flutuantes</li>
                    <li>Impacto de alta de juros no neg√≥cio</li>
                    <li>Estrat√©gias de prote√ß√£o</li>
                </ul>
                
                <h4>üè¢ Risco Operacional</h4>
                <ul>
                    <li>Depend√™ncia de poucos clientes/fornecedores</li>
                    <li>Fraudes e controles internos</li>
                    <li>Continuidade de neg√≥cios</li>
                    <li>Seguros adequados</li>
                </ul>
                
                <h3>üéØ Matriz de Riscos</h3>
                <table>
                    <thead><tr><th>Risco</th><th>Probabilidade</th><th>Impacto</th><th>A√ß√£o</th></tr></thead>
                    <tbody>
                        <tr><td>Inadimpl√™ncia >10%</td><td>M√©dia</td><td>Alto</td><td>Pol√≠tica de cr√©dito</td></tr>
                        <tr><td>Ruptura de caixa</td><td>Baixa</td><td>Cr√≠tico</td><td>Reserva emerg√™ncia</td></tr>
                        <tr><td>Concentra√ß√£o cliente</td><td>Alta</td><td>Alto</td><td>Diversifica√ß√£o</td></tr>
                        <tr><td>Fraude interna</td><td>Baixa</td><td>M√©dio</td><td>Controles internos</td></tr>
                    </tbody>
                </table>
                
                <div class="destaque">
                    <h4>üö® Sinais de Alerta</h4>
                    <p><strong>Zona de Perigo:</strong> >50% do faturamento com 1-3 clientes + <15 dias de reserva de caixa + d√≠vida >60% PL = Risco CR√çTICO!</p>
                </div>
                
                <h3>‚úÖ Boas Pr√°ticas de Mitiga√ß√£o</h3>
                <ul>
                    <li>‚úÖ Diversifica√ß√£o: Nenhum cliente >15% faturamento</li>
                    <li>‚úÖ Liquidez: Reserva 3-6 meses de despesas fixas</li>
                    <li>‚úÖ Seguros: Cobertura para riscos cr√≠ticos</li>
                    <li>‚úÖ Controles: Segrega√ß√£o fun√ß√µes + auditoria</li>
                    <li>‚úÖ Monitoramento: Dashboard com alertas</li>
                </ul>
            `
        },
        {
            id: 'cat7',
            titulo: 'üìä Indicadores Financeiros',
            descricao: 'KPIs e m√©tricas de performance',
            categoria: 'Categorias',
            icone: 'üìä',
            conteudo: `
                <h3>üéØ Performance Baseada em Dados</h3>
                <p>Define, acompanha e analisa <strong>indicadores-chave</strong> que revelam a sa√∫de financeira e direcionam decis√µes estrat√©gicas.</p>
                
                <h3>üìä Indicadores Essenciais (15 KPIs)</h3>
                
                <h4>üí∞ Liquidez</h4>
                <ul>
                    <li><strong>Liquidez Corrente:</strong> AC / PC (ideal >1,5)</li>
                    <li><strong>Liquidez Seca:</strong> (AC - Estoques) / PC (>1,0)</li>
                    <li><strong>Liquidez Imediata:</strong> Dispon√≠vel / PC (>0,3)</li>
                </ul>
                
                <h4>üìà Rentabilidade</h4>
                <ul>
                    <li><strong>Margem Bruta:</strong> (Receita - CPV) / Receita (>40%)</li>
                    <li><strong>Margem Operacional:</strong> EBIT / Receita (>15%)</li>
                    <li><strong>Margem L√≠quida:</strong> Lucro L√≠quido / Receita (>10%)</li>
                    <li><strong>ROE:</strong> Lucro L√≠quido / Patrim√¥nio L√≠quido (>20%)</li>
                    <li><strong>ROA:</strong> Lucro L√≠quido / Ativo Total (>10%)</li>
                </ul>
                
                <h4>‚ö° Efici√™ncia Operacional</h4>
                <ul>
                    <li><strong>Giro de Estoque:</strong> CMV / Estoque M√©dio (>6x/ano)</li>
                    <li><strong>Giro de Ativos:</strong> Receita / Ativo Total (>1,5)</li>
                    <li><strong>Prazo M√©dio Recebimento:</strong> (Contas a Receber / Receita) √ó 360 (<45 dias)</li>
                    <li><strong>Prazo M√©dio Pagamento:</strong> (Contas a Pagar / Compras) √ó 360 (30-60 dias)</li>
                </ul>
                
                <h4>üè¶ Estrutura de Capital</h4>
                <ul>
                    <li><strong>Endividamento Geral:</strong> Passivo Total / Ativo Total (<60%)</li>
                    <li><strong>Endividamento Financeiro:</strong> D√≠vidas Banc√°rias / Patrim√¥nio (<40%)</li>
                    <li><strong>Cobertura de Juros:</strong> EBIT / Despesas Financeiras (>3x)</li>
                </ul>
                
                <h3>üìä Dashboard Ideal</h3>
                <p>Um dashboard executivo deve apresentar:</p>
                <ul>
                    <li>üéØ <strong>5-7 KPIs principais</strong> com sem√°foro (verde/amarelo/vermelho)</li>
                    <li>üìà <strong>Tend√™ncia:</strong> √öltimos 6-12 meses</li>
                    <li>üéØ <strong>Meta vs. Real:</strong> Compara√ß√£o visual</li>
                    <li>üîç <strong>Drill-down:</strong> Capacidade de detalhar</li>
                    <li>‚è∞ <strong>Atualiza√ß√£o:</strong> Mensal m√≠nimo, semanal ideal</li>
                </ul>
                
                <div class="destaque">
                    <h4>‚ö†Ô∏è Perigo dos "Indicadores Vaidade"</h4>
                    <p>Faturamento e n√∫mero de clientes s√£o importantes, mas <strong>n√£o garantem sa√∫de</strong>. Foque em: margem, caixa, inadimpl√™ncia e ROI.</p>
                </div>
                
                <h3>‚úÖ Implementa√ß√£o de KPIs</h3>
                <ol>
                    <li>Escolha 5-7 indicadores cr√≠ticos para seu neg√≥cio</li>
                    <li>Defina metas SMART para cada um</li>
                    <li>Estabele√ßa respons√°vel por cada KPI</li>
                    <li>Crie rotina de apura√ß√£o (semanal/mensal)</li>
                    <li>Revise estrat√©gia baseado nos n√∫meros</li>
                </ol>
            `
        },
        {
            id: 'cat8',
            titulo: 'üèõÔ∏è Planejamento Tribut√°rio',
            descricao: 'Otimiza√ß√£o fiscal dentro da legalidade',
            categoria: 'Categorias',
            icone: 'üèõÔ∏è',
            conteudo: `
                <h3>üéØ Elis√£o Fiscal Inteligente</h3>
                <p><strong>Planejamento Tribut√°rio</strong> √© a organiza√ß√£o l√≠cita dos neg√≥cios para minimizar a carga tribut√°ria, aproveitando benef√≠cios legais e escolhendo o melhor regime.</p>
                
                <div class="destaque">
                    <h4>‚öñÔ∏è Elis√£o vs. Evas√£o</h4>
                    <p><strong>Elis√£o:</strong> Redu√ß√£o legal de tributos (permitido) ‚úÖ<br>
                    <strong>Evas√£o:</strong> Sonega√ß√£o fiscal (crime) ‚ùå</p>
                </div>
                
                <h3>üìä O que Avaliamos</h3>
                <ul>
                    <li>üè¢ Adequa√ß√£o do regime tribut√°rio (Simples/Lucro Real/Presumido)</li>
                    <li>üìã Revis√£o peri√≥dica de enquadramento</li>
                    <li>üí∞ Aproveitamento de incentivos fiscais</li>
                    <li>üéØ Segrega√ß√£o de atividades (MEI, filiais)</li>
                    <li>üìä Controle de SPED e obriga√ß√µes acess√≥rias</li>
                    <li>üí≥ Planejamento de pr√≥-labore e distribui√ß√£o de lucros</li>
                    <li>üè≠ Recupera√ß√£o de cr√©ditos tribut√°rios</li>
                    <li>üìà Proje√ß√£o de tributos futuros</li>
                    <li>‚öñÔ∏è Compliance e auditoria preventiva</li>
                    <li>üîç Revis√£o de auto de infra√ß√µes</li>
                </ul>
                
                <h3>üè¢ Comparativo de Regimes</h3>
                <table>
                    <thead>
                        <tr><th>Regime</th><th>Limite Faturamento</th><th>Al√≠quota Aprox.</th><th>Ideal Para</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>Simples Nacional</td><td>R$ 4,8 MM/ano</td><td>4-19%</td><td>Com√©rcio, baixa margem</td></tr>
                        <tr><td>Lucro Presumido</td><td>R$ 78 MM/ano</td><td>11-16%</td><td>Servi√ßos, alta margem</td></tr>
                        <tr><td>Lucro Real</td><td>Ilimitado</td><td>9-34%</td><td>Ind√∫stria, importa√ß√£o</td></tr>
                    </tbody>
                </table>
                
                <h3>üí∞ Oportunidades de Otimiza√ß√£o</h3>
                <ul>
                    <li>üíº <strong>Pr√≥-labore estrat√©gico:</strong> Otimizar INSS vs. IR</li>
                    <li>üéÅ <strong>Distribui√ß√£o de lucros:</strong> Isenta de IR (se contabilidade regular)</li>
                    <li>üè≠ <strong>Cr√©ditos de PIS/COFINS:</strong> Recuperar valores pagos indevidamente</li>
                    <li>üåç <strong>Incentivos regionais:</strong> SUDENE, SUDAM, Zona Franca</li>
                    <li>üìö <strong>Lei do Bem:</strong> Incentivo P&D (redu√ß√£o 34% IR)</li>
                    <li>üíª <strong>Lei de Inform√°tica:</strong> Produtos tech (isen√ß√µes)</li>
                </ul>
                
                <h3>‚ö†Ô∏è Riscos de N√£o Planejar</h3>
                <ul>
                    <li>üî¥ Pagar 30-50% mais impostos do que necess√°rio</li>
                    <li>üî¥ Multas por erro de enquadramento</li>
                    <li>üî¥ Perda de competitividade vs. concorrentes</li>
                    <li>üî¥ Surpresas com passivos tribut√°rios</li>
                    <li>üî¥ Restri√ß√µes para obter cr√©dito</li>
                </ul>
                
                <h3>‚úÖ Checklist de Planejamento</h3>
                <ol>
                    <li>Simule carga tribut√°ria nos 3 regimes anualmente</li>
                    <li>Revise enquadramento ap√≥s mudan√ßas no neg√≥cio</li>
                    <li>Aproveite todos os cr√©ditos dispon√≠veis</li>
                    <li>Mantenha contabilidade rigorosamente em dia</li>
                    <li>Consulte especialista para estrat√©gias avan√ßadas</li>
                    <li>Documente todas as decis√µes (defensabilidade)</li>
                </ol>
                
                <div class="destaque">
                    <h4>üí° ROI do Planejamento Tribut√°rio</h4>
                    <p>Empresas com planejamento profissional economizam em m√©dia <strong>20-40% em tributos</strong>. O investimento em consultoria se paga em 2-3 meses!</p>
                </div>
            `
        }
    ],
    calculadora: [
        {
            id: 'calc1',
            titulo: 'Perdas por Gest√£o de Caixa Deficiente',
            descricao: 'Impacto financeiro de controles inadequados',
            categoria: 'Calculadora',
            icone: 'üí∏',
            conteudo: `
                <h3>üí∞ O que s√£o Perdas de Caixa?</h3>
                <p>Recursos desperdi√ßados por <strong>falta de controle</strong>, planejamento inadequado ou decis√µes financeiras sub√≥timas relacionadas √† tesouraria.</p>
                
                <h3>üìä Principais Fontes de Perdas</h3>
                
                <h4>üè¶ Taxas Banc√°rias Desnecess√°rias</h4>
                <ul>
                    <li><strong>Cheque especial n√£o planejado:</strong> R$ 100k √ó 12% ao m√™s = R$ 12k/m√™s</li>
                    <li><strong>Multas por insufici√™ncia:</strong> R$ 500-1.000/ocorr√™ncia</li>
                    <li><strong>Tarifas mal negociadas:</strong> R$ 2-5k/m√™s</li>
                    <li><strong>IMPACTO ANUAL:</strong> R$ 150k-200k em empresa de R$ 5 MM faturamento</li>
                </ul>
                
                <h4>‚ö° Descasamento de Prazos</h4>
                <ul>
                    <li><strong>Recebe em 60 dias, paga em 30:</strong> Gap de 30 dias</li>
                    <li><strong>Capital de giro necess√°rio:</strong> R$ 300k adicionais</li>
                    <li><strong>Custo de financiamento:</strong> R$ 300k √ó 2% m√™s = R$ 6k/m√™s</li>
                    <li><strong>IMPACTO ANUAL:</strong> R$ 72k</li>
                </ul>
                
                <h4>üí≥ Gest√£o Ineficiente de Receb√≠veis</h4>
                <ul>
                    <li><strong>Taxas de antecipa√ß√£o:</strong> 3-5% ao m√™s sobre R$ 200k = R$ 6-10k/m√™s</li>
                    <li><strong>Inadimpl√™ncia n√£o provisionada:</strong> 5% √ó R$ 100k = R$ 5k perda</li>
                    <li><strong>IMPACTO ANUAL:</strong> R$ 70-120k</li>
                </ul>
                
                <h3>üßÆ F√≥rmula de C√°lculo</h3>
                <p><strong>Perda Total Anual =</strong></p>
                <ul>
                    <li>+ Juros e tarifas banc√°rias evit√°veis</li>
                    <li>+ Custo de oportunidade (recursos mal aplicados)</li>
                    <li>+ Multas e penalidades</li>
                    <li>+ Perdas com inadimpl√™ncia</li>
                    <li>+ Descontos excessivos para antecipar caixa</li>
                </ul>
                
                <div class="destaque">
                    <h4>üí° Exemplo Real</h4>
                    <p>Empresa faturamento R$ 5 MM/ano com gest√£o deficiente perde em m√©dia <strong>R$ 300-500k/ano</strong> (6-10% do faturamento) com inefici√™ncias de caixa!</p>
                </div>
                
                <h3>‚úÖ Como a Calculadora Ajuda</h3>
                <p>Voc√™ informa:</p>
                <ul>
                    <li>Faturamento m√©dio mensal</li>
                    <li>Dias de uso de limite/cheque especial</li>
                    <li>Percentual de receb√≠veis antecipados</li>
                    <li>Taxa de inadimpl√™ncia</li>
                    <li>Descasamento m√©dio de prazos</li>
                </ul>
                <p><strong>Resultado:</strong> Estimativa de perdas anuais + ROI de melhorias</p>
            `
        },
        {
            id: 'calc2',
            titulo: 'Perdas por Precifica√ß√£o Inadequada',
            descricao: 'Impacto de pre√ßos abaixo do ponto de equil√≠brio',
            categoria: 'Calculadora',
            icone: 'üíµ',
            conteudo: `
                <h3>üéØ O Problema da Precifica√ß√£o Emocional</h3>
                <p>Muitas PMEs precificam por <strong>"feeling"</strong> ou copiando concorrentes, ignorando custos reais. Resultado: vendem muito, lucram pouco (ou t√™m preju√≠zo).</p>
                
                <h3>üìä Perdas T√≠picas</h3>
                
                <h4>‚ùå Erro 1: N√£o Incluir Todos os Custos</h4>
                <ul>
                    <li><strong>Cen√°rio:</strong> Produto vendido por R$ 100</li>
                    <li>Custo vari√°vel considerado: R$ 60</li>
                    <li>Margem aparente: 40% ‚úÖ (parece bom)</li>
                    <li><strong>MAS:</strong> Custos fixos rateados R$ 35 (esquecidos!)</li>
                    <li><strong>Margem real:</strong> 5% ‚ö†Ô∏è (insuficiente)</li>
                    <li><strong>Perda:</strong> R$ 30 por unidade que poderia cobrar</li>
                </ul>
                
                <h4>‚ùå Erro 2: Descontos Destrutivos</h4>
                <ul>
                    <li><strong>Produto:</strong> Margem 20% (R$ 20 lucro em R$ 100 venda)</li>
                    <li><strong>Desconto "pequeno":</strong> 10% (parece pouco)</li>
                    <li><strong>Impacto:</strong> Margem cai para 11% (perda 45% do lucro!)</li>
                    <li><strong>Para compensar:</strong> Precisa vender 50% a mais!</li>
                </ul>
                
                <h4>‚ùå Erro 3: Ignorar Ponto de Equil√≠brio</h4>
                <ul>
                    <li>Custos fixos: R$ 100k/m√™s</li>
                    <li>Margem contribui√ß√£o: 30%</li>
                    <li><strong>Ponto equil√≠brio:</strong> R$ 333k vendas/m√™s</li>
                    <li>Se vender apenas R$ 300k: <strong>Preju√≠zo R$ 10k!</strong></li>
                </ul>
                
                <h3>üßÆ Como Calcular Pre√ßo Correto</h3>
                <h4>M√©todo Mark-up Completo:</h4>
                <ul>
                    <li>1. <strong>Custo Total:</strong> R$ 60 vari√°vel + R$ 35 fixo rateado = R$ 95</li>
                    <li>2. <strong>Margem desejada:</strong> 15% = R$ 14,25</li>
                    <li>3. <strong>Impostos:</strong> 15% sobre pre√ßo = considerar no c√°lculo</li>
                    <li>4. <strong>Pre√ßo m√≠nimo:</strong> R$ 95 / (1 - 0,15 impostos - 0,15 margem) = R$ 135</li>
                </ul>
                
                <div class="destaque">
                    <h4>üí∏ Impacto Real</h4>
                    <p>Empresa que vende R$ 500k/m√™s com margem de 5% (por pre√ßo baixo) versus 15% (pre√ßo correto):</p>
                    <p><strong>Perda mensal:</strong> R$ 50k<br>
                    <strong>Perda anual:</strong> R$ 600k!!!</p>
                </div>
                
                <h3>‚úÖ Como a Calculadora Ajuda</h3>
                <p>Voc√™ informa:</p>
                <ul>
                    <li>Margem bruta atual (%)</li>
                    <li>Margem bruta ideal (%)</li>
                    <li>Faturamento mensal</li>
                    <li>% de produtos abaixo do ponto equil√≠brio</li>
                </ul>
                <p><strong>Resultado:</strong> Perda anual por precifica√ß√£o + potencial de melhoria</p>
            `
        },
        {
            id: 'calc3',
            titulo: 'Perdas por Capital de Giro Ineficiente',
            descricao: 'Custo de recursos mal dimensionados',
            categoria: 'Calculadora',
            icone: 'üîÑ',
            conteudo: `
                <h3>‚öôÔ∏è O que √© Capital de Giro?</h3>
                <p>Recursos necess√°rios para <strong>financiar opera√ß√£o do dia a dia</strong> (estoques + contas a receber - fornecedores). Gest√£o ruim = custo alto.</p>
                
                <h3>üìä Fontes de Perdas</h3>
                
                <h4>üì¶ Estoque Excessivo ou Inadequado</h4>
                <ul>
                    <li><strong>Cen√°rio:</strong> R$ 500k parados em estoque</li>
                    <li><strong>Giro ideal:</strong> 6x/ano (60 dias)</li>
                    <li><strong>Giro atual:</strong> 3x/ano (120 dias)</li>
                    <li><strong>Excesso:</strong> R$ 250k desnecess√°rios</li>
                    <li><strong>Custo oportunidade:</strong> R$ 250k √ó 12% ano = R$ 30k</li>
                    <li><strong>+ Perdas:</strong> Obsolesc√™ncia, deteriora√ß√£o = R$ 10-20k</li>
                    <li><strong>TOTAL:</strong> R$ 40-50k/ano</li>
                </ul>
                
                <h4>üí≥ Prazo de Recebimento Longo</h4>
                <ul>
                    <li><strong>Recebe em:</strong> 60 dias (mercado: 30 dias)</li>
                    <li><strong>Faturamento:</strong> R$ 300k/m√™s</li>
                    <li><strong>Extra financiado:</strong> R$ 300k por 30 dias</li>
                    <li><strong>Custo:</strong> R$ 300k √ó 2% m√™s = R$ 6k/m√™s</li>
                    <li><strong>ANUAL:</strong> R$ 72k</li>
                </ul>
                
                <h4>üè≠ Ciclo Operacional Longo</h4>
                <p><strong>Ciclo = PME + PMR - PMP</strong></p>
                <ul>
                    <li>Prazo M√©dio Estoque: 60 dias</li>
                    <li>Prazo M√©dio Recebimento: 45 dias</li>
                    <li>Prazo M√©dio Pagamento: 30 dias</li>
                    <li><strong>Ciclo:</strong> 75 dias</li>
                    <li><strong>Ideal:</strong> <45 dias</li>
                    <li><strong>Excesso:</strong> 30 dias de capital travado</li>
                </ul>
                
                <h3>üßÆ Impacto Financeiro</h3>
                <p><strong>NCG (Necessidade de Capital de Giro) =</strong></p>
                <ul>
                    <li>Estoques</li>
                    <li>+ Contas a receber</li>
                    <li>- Fornecedores a pagar</li>
                </ul>
                
                <div class="destaque">
                    <h4>üí∞ Exemplo Pr√°tico</h4>
                    <p><strong>Empresa A (mal gerida):</strong><br>
                    NCG = R$ 800k, Custo financiamento 18% ao ano = R$ 144k/ano</p>
                    <p><strong>Empresa B (bem gerida - mesmo porte):</strong><br>
                    NCG = R$ 400k, Custo financiamento 18% ao ano = R$ 72k/ano</p>
                    <p><strong>ECONOMIA:</strong> R$ 72k/ano apenas otimizando ciclo!</p>
                </div>
                
                <h3>‚úÖ Estrat√©gias de Redu√ß√£o</h3>
                <ul>
                    <li>‚ö° <strong>Reduzir PMR:</strong> Desconto para pagamento antecipado</li>
                    <li>üì¶ <strong>Otimizar estoque:</strong> Just-in-time, lotes menores</li>
                    <li>ü§ù <strong>Negociar PMPf:</strong> Estender prazo com fornecedores</li>
                    <li>üí≥ <strong>Mix pagamentos:</strong> Incentivar Pix/cart√£o de d√©bito</li>
                </ul>
                
                <h3>‚úÖ Como a Calculadora Ajuda</h3>
                <p>Voc√™ informa:</p>
                <ul>
                    <li>Prazo m√©dio de recebimento</li>
                    <li>Prazo m√©dio de estoque</li>
                    <li>Prazo m√©dio de pagamento</li>
                    <li>Faturamento mensal</li>
                </ul>
                <p><strong>Resultado:</strong> NCG atual, NCG ideal, custo do excesso, economia potencial</p>
            `
        },
        {
            id: 'calc4',
            titulo: 'Perdas por Planejamento Tribut√°rio Ausente',
            descricao: 'Tributos pagos em excesso por falta de estrat√©gia',
            categoria: 'Calculadora',
            icone: 'üèõÔ∏è',
            conteudo: `
                <h3>üí∞ O Custo de N√£o Planejar</h3>
                <p>Empresas sem planejamento tribut√°rio profissional pagam em m√©dia <strong>20-40% mais impostos</strong> do que precisariam, legalmente.</p>
                
                <h3>üìä Principais Perdas</h3>
                
                <h4>üè¢ Regime Tribut√°rio Inadequado</h4>
                <p><strong>Exemplo Real:</strong></p>
                <ul>
                    <li><strong>Empresa:</strong> Prestadora de servi√ßos, R$ 3 MM/ano</li>
                    <li><strong>Simples Nacional (atual):</strong> 16% = R$ 480k/ano</li>
                    <li><strong>Lucro Presumido (ideal):</strong> 13% = R$ 390k/ano</li>
                    <li><strong>PERDA ANUAL:</strong> R$ 90k!!!</li>
                </ul>
                
                <h4>üíº Pr√≥-labore x Distribui√ß√£o de Lucros</h4>
                <ul>
                    <li><strong>Erro comum:</strong> Tudo como pr√≥-labore</li>
                    <li>Pr√≥-labore R$ 20k/m√™s √ó 12 = R$ 240k/ano</li>
                    <li>INSS (11%) + IR (27,5%) = R$ 92k impostos</li>
                    <li><strong>Alternativa:</strong> Pr√≥-labore R$ 8k + Lucros R$ 12k</li>
                    <li>INSS (R$ 880) + IR (R$ 0 sobre lucros) = R$ 10,5k impostos</li>
                    <li><strong>ECONOMIA:</strong> R$ 81,5k/ano por s√≥cio!</li>
                </ul>
                
                <h4>üéÅ Incentivos N√£o Aproveitados</h4>
                <ul>
                    <li>Lei do Bem (P&D): Redu√ß√£o de 34% no IR sobre investimento</li>
                    <li>SUDENE/SUDAM: Redu√ß√£o de 75% no IR para regi√µes eleg√≠veis</li>
                    <li>Cr√©ditos de PIS/COFINS: Recupera√ß√£o de 9,25% sobre insumos</li>
                    <li><strong>Perda:</strong> R$ 50-200k/ano n√£o aproveitados</li>
                </ul>
                
                <h4>‚ö†Ô∏è Riscos de Autua√ß√£o</h4>
                <ul>
                    <li>Enquadramento incorreto: Multa 75% + juros</li>
                    <li>Obriga√ß√µes acess√≥rias em atraso: R$ 500-5.000/m√™s</li>
                    <li>Falta de documenta√ß√£o: Glosas e multas</li>
                </ul>
                
                <h3>üßÆ Simula√ß√£o Comparativa</h3>
                <table>
                    <thead>
                        <tr><th>Cen√°rio</th><th>Carga Anual</th><th>Economia vs. Pior</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>Sem planejamento</td><td>R$ 700k</td><td>-</td></tr>
                        <tr><td>Planejamento b√°sico</td><td>R$ 550k</td><td>R$ 150k (21%)</td></tr>
                        <tr><td>Planejamento avan√ßado</td><td>R$ 450k</td><td>R$ 250k (36%)</td></tr>
                    </tbody>
                </table>
                
                <div class="destaque">
                    <h4>üí° ROI do Planejamento</h4>
                    <p><strong>Investimento:</strong> R$ 3-8k/m√™s em contabilidade consultiva<br>
                    <strong>Economia t√≠pica:</strong> R$ 150-300k/ano<br>
                    <strong>ROI:</strong> 300-800% ao ano!</p>
                </div>
                
                <h3>‚úÖ Como a Calculadora Ajuda</h3>
                <p>Voc√™ informa:</p>
                <ul>
                    <li>Faturamento anual</li>
                    <li>Regime tribut√°rio atual</li>
                    <li>Tipo de atividade</li>
                    <li>Margem de lucro</li>
                    <li>Pr√≥-labore dos s√≥cios</li>
                </ul>
                <p><strong>Resultado:</strong> Carga tribut√°ria nos 3 regimes, economia potencial, recomenda√ß√£o</p>
            `
        }
    ],
// PLANO DE A√á√ÉO (4 artigos)
    plano: [
        {id:'plano1',titulo:'Como Usar o Plano de A√ß√£o',descricao:'Guia completo do sistema',categoria:'Plano',icone:'üéØ',
        conteudo:`<h3>Sistema integrado para implementar melhorias do diagn√≥stico</h3><ul><li>Prioriza√ß√£o autom√°tica baseada em criticidade</li><li>Templates de a√ß√µes por categoria</li><li>Acompanhamento de progresso</li><li>Integra√ß√£o com relat√≥rios</li></ul>`},
        {id:'plano2',titulo:'Priorizando A√ß√µes',descricao:'Metodologia de sele√ß√£o',categoria:'Plano',icone:'üéØ',
        conteudo:`<h3>Matriz de Prioriza√ß√£o: Impacto x Esfor√ßo</h3><table><tr><th>Tipo</th><th>Fazer</th></tr><tr><td>Quick Wins</td><td>Alto impacto, baixo esfor√ßo - IMEDIATO</td></tr><tr><td>Projetos</td><td>Alto impacto, alto esfor√ßo - PLANEJAR</td></tr><tr><td>Fill-ins</td><td>Baixo impacto, baixo esfor√ßo - QUANDO POSS√çVEL</td></tr></table>`},
        {id:'plano3',titulo:'Monitorando Progresso',descricao:'KPIs e acompanhamento',categoria:'Plano',icone:'üìä',
        conteudo:`<h3>Dashboard de Evolu√ß√£o</h3><ul><li>% de a√ß√µes conclu√≠das por categoria</li><li>Prazo m√©dio de implementa√ß√£o</li><li>Resultados financeiros alcan√ßados</li><li>Compara√ß√£o diagn√≥stico inicial vs atual</li></ul>`},
        {id:'plano4',titulo:'Integrando com Diagn√≥stico',descricao:'Ciclo completo de melhoria',categoria:'Plano',icone:'üîÑ',
        conteudo:`<h3>Metodologia PDCA Financeiro</h3><ol><li><strong>PLAN:</strong> Diagn√≥stico + Plano de A√ß√£o</li><li><strong>DO:</strong> Executar melhorias priorizadas</li><li><strong>CHECK:</strong> Novo diagn√≥stico trimestral</li><li><strong>ACT:</strong> Ajustar estrat√©gia baseado em resultados</li></ol>`}
    ],
    
// FAQ (10 perguntas)
    faq: [
        {pergunta:'O diagn√≥stico √© gratuito?',resposta:'Sim! O diagn√≥stico completo √© 100% gratuito. Voc√™ recebe relat√≥rio executivo, calculadora de perdas e proposta comercial sem custo.'},
        {pergunta:'Preciso ter conhecimento t√©cnico?',resposta:'N√£o! As perguntas s√£o em linguagem clara. Se tiver d√∫vida, consulte nossa Central de Ajuda com +100 recursos explicativos.'},
        {pergunta:'Quanto tempo leva para ver resultados?',resposta:'Resultados imediatos: relat√≥rio na hora. Implementa√ß√£o: melhorias r√°pidas (Quick Wins) em 7-15 dias, projetos estruturais em 60-90 dias.'},
        {pergunta:'Posso pausar e continuar depois?',resposta:'Sim! O sistema salva automaticamente. Continue de qualquer dispositivo quando quiser.'},
        {pergunta:'Os dados s√£o seguros?',resposta:'Total seguran√ßa: criptografia SSL, armazenamento em nuvem confi√°vel, sem compartilhamento com terceiros. Conformidade LGPD.'},
        {pergunta:'Como funciona a proposta comercial?',resposta:'Gerada automaticamente baseada nos gaps identificados. Pacotes personalizados com ROI estimado, sem compromisso de contrata√ß√£o.'},
        {pergunta:'Preciso de contador para preencher?',resposta:'N√£o √© obrigat√≥rio, mas ter DRE e balancete em m√£os ajuda na precis√£o. Para d√∫vidas, consulte seu contador.'},
        {pergunta:'Qual a diferen√ßa entre os scores?',resposta:'0-30%=Cr√≠tico (a√ß√£o urgente), 30-60%=Aten√ß√£o (estruturar), 60-75%=Desenvolvimento, 75-90%=Bom, 90-100%=Excelente (classe mundial).'},
        {pergunta:'Posso refazer o diagn√≥stico?',resposta:'Sim! Recomendamos diagn√≥stico trimestral para acompanhar evolu√ß√£o. Seus dados anteriores ficam salvos para compara√ß√£o.'},
        {pergunta:'O que √© a Calculadora de Perdas?',resposta:'Ferramenta que estima impacto financeiro (R$) de gaps identificados: perdas por caixa, precifica√ß√£o, capital de giro e tributa√ß√£o.'},
        {pergunta:'Como interpretar o gr√°fico radar?',resposta:'Mostra equil√≠brio entre 8 categorias. Formato circular = gest√£o equilibrada. Pontas e vales = desequil√≠brios para corrigir.'},
        {pergunta:'Qual o melhor regime tribut√°rio?',resposta:'Depende de faturamento, margem e atividade. Nossa calculadora simula os 3 regimes e recomenda o ideal para seu caso.'},
        {pergunta:'Preciso implementar tudo de uma vez?',resposta:'N√£o! Use a matriz de prioriza√ß√£o: comece com Quick Wins (r√°pidos e impactantes), depois projetos maiores conforme capacidade.'},
        {pergunta:'Como acessar meus relat√≥rios antigos?',resposta:'No Dashboard, se√ß√£o "Hist√≥rico de Diagn√≥sticos". Todos os relat√≥rios ficam salvos e dispon√≠veis para download.'},
        {pergunta:'Posso compartilhar resultados com s√≥cios?',resposta:'Sim! Exporte PDF e compartilhe por e-mail. Ou envie link direto do relat√≥rio online (acesso controlado por voc√™).'}
    ],
    
// GLOSS√ÅRIO (50 termos)
    glossario: [
        {termo:'Ativo Circulante',definicao:'Bens e direitos que ser√£o convertidos em dinheiro em at√© 12 meses.',exemplo:'Caixa, estoque, contas a receber.'},
        {termo:'Passivo Circulante',definicao:'Obriga√ß√µes que vencem em at√© 12 meses.',exemplo:'Fornecedores, sal√°rios a pagar, empr√©stimos de curto prazo.'},
        {termo:'Capital de Giro',definicao:'Recursos para financiar opera√ß√£o do dia a dia. C√°lculo: Ativo Circulante - Passivo Circulante.',exemplo:'Empresa com AC R$ 500k e PC R$ 300k tem CG de R$ 200k.'},
        {termo:'DRE',definicao:'Demonstra√ß√£o do Resultado do Exerc√≠cio. Relat√≥rio que mostra se empresa teve lucro ou preju√≠zo.',exemplo:'Receita R$ 1MM - Custos R$ 600k - Despesas R$ 300k = Lucro R$ 100k.'},
        {termo:'EBITDA',definicao:'Lucro antes de juros, impostos, deprecia√ß√£o e amortiza√ß√£o. Mede resultado operacional puro.',exemplo:'EBITDA de R$ 200k significa que opera√ß√£o gera R$ 200k antes de financiamentos e impostos.'},
        {termo:'Margem Bruta',definicao:'(Receita - Custo Vari√°vel) / Receita. Indica rentabilidade antes de despesas operacionais.',exemplo:'Vendeu R$ 100, custo R$ 60 ‚Üí Margem bruta = 40%.'},
        {termo:'Margem L√≠quida',definicao:'Lucro L√≠quido / Receita. Mostra quanto sobra de cada R$ 1 vendido.',exemplo:'Lucro R$ 10k em receita R$ 100k = Margem l√≠quida 10%.'},
        {termo:'Fluxo de Caixa',definicao:'Movimenta√ß√£o de entradas e sa√≠das de dinheiro. Diferente de lucro (regime compet√™ncia).',exemplo:'Vendeu R$ 100k (a prazo) mas recebeu R$ 80k = Fluxo R$ 80k.'},
        {termo:'Liquidez Corrente',definicao:'Ativo Circulante / Passivo Circulante. Mede capacidade de pagar d√≠vidas de curto prazo.',exemplo:'AC R$ 300k / PC R$ 200k = Liquidez 1,5 (para cada R$ 1 de d√≠vida, tem R$ 1,50).'},
        {termo:'ROI',definicao:'Return on Investment. Retorno sobre investimento em %.',exemplo:'Investiu R$ 100k, retorno R$ 130k = ROI 30%.'},
        {termo:'ROE',definicao:'Return on Equity. Lucro / Patrim√¥nio L√≠quido. Retorno sobre capital dos s√≥cios.',exemplo:'Lucro R$ 50k, PL R$ 200k = ROE 25% ao ano.'},
        {termo:'Ponto de Equil√≠brio',definicao:'Faturamento m√≠nimo para cobrir todos os custos (nem lucro, nem preju√≠zo).',exemplo:'Custos fixos R$ 100k, margem contribui√ß√£o 40% ‚Üí PE = R$ 250k vendas.'},
        {termo:'Mark-up',definicao:'Percentual adicionado ao custo para formar pre√ßo de venda.',exemplo:'Custo R$ 60, markup 66% ‚Üí Pre√ßo R$ 100.'},
        {termo:'Ciclo Operacional',definicao:'Tempo entre compra de insumos e recebimento da venda. Quanto menor, melhor.',exemplo:'Compra mat√©ria-prima ‚Üí 30 dias estoque ‚Üí 15 dias produ√ß√£o ‚Üí 45 dias recebimento = 90 dias.'},
        {termo:'PMR',definicao:'Prazo M√©dio de Recebimento. Quantos dias em m√©dia a empresa leva para receber vendas.',exemplo:'Contas a Receber R$ 150k, vendas mensais R$ 300k ‚Üí PMR = 15 dias.'},
        {termo:'PMP',definicao:'Prazo M√©dio de Pagamento. Quantos dias em m√©dia a empresa leva para pagar fornecedores.',exemplo:'Fornecedores R$ 100k, compras mensais R$ 200k ‚Üí PMP = 15 dias.'},
        {termo:'Custo Fixo',definicao:'Despesas que n√£o variam com volume de produ√ß√£o/vendas.',exemplo:'Aluguel, sal√°rios administrativos, seguros.'},
        {termo:'Custo Vari√°vel',definicao:'Custos que variam proporcionalmente ao volume produzido/vendido.',exemplo:'Mat√©ria-prima, comiss√µes, embalagens.'},
        {termo:'Margem de Contribui√ß√£o',definicao:'Receita - Custos Vari√°veis. Quanto sobra para cobrir fixos e gerar lucro.',exemplo:'Venda R$ 100, custo vari√°vel R$ 60 ‚Üí MC = R$ 40 (40%).'},
        {termo:'Deprecia√ß√£o',definicao:'Perda de valor de ativos ao longo do tempo por uso ou obsolesc√™ncia.',exemplo:'M√°quina R$ 100k, vida √∫til 10 anos ‚Üí Deprecia√ß√£o R$ 10k/ano.'},
        {termo:'Provis√£o',definicao:'Reserva cont√°bil para despesas futuras conhecidas.',exemplo:'Provis√£o 13¬∫ sal√°rio, f√©rias, inadimpl√™ncia.'},
        {termo:'Inadimpl√™ncia',definicao:'Percentual de vendas n√£o pagas pelos clientes.',exemplo:'Vendeu R$ 100k, R$ 5k n√£o foi pago = Inadimpl√™ncia 5%.'},
        {termo:'Alavancagem',definicao:'Uso de capital de terceiros (d√≠vida) para financiar crescimento.',exemplo:'Empresa com 50% capital pr√≥prio, 50% d√≠vida = Alavancagem 1:1.'},
        {termo:'Endividamento',definicao:'Passivo Total / Ativo Total. Percentual de ativos financiados por terceiros.',exemplo:'Ativo R$ 1MM, passivo R$ 600k = Endividamento 60%.'},
        {termo:'Valuation',definicao:'Valor de mercado de uma empresa.',exemplo:'Empresa lucro R$ 100k/ano, m√∫ltiplo 10x = Valuation R$ 1MM.'},
        {termo:'Break-even',definicao:'Mesmo que ponto de equil√≠brio. Vendas que igualam custos totais.',exemplo:'Vendeu exatamente o suficiente para n√£o ter lucro nem preju√≠zo.'},
        {termo:'Burn Rate',definicao:'Taxa de queima de caixa. Quanto empresa gasta por m√™s al√©m do que fatura.',exemplo:'Receita R$ 50k, despesas R$ 80k = Burn rate R$ 30k/m√™s.'},
        {termo:'Runway',definicao:'Quantos meses empresa sobrevive com caixa atual mantendo burn rate.',exemplo:'Caixa R$ 300k, burn R$ 30k/m√™s = Runway 10 meses.'},
        {termo:'Patrim√¥nio L√≠quido',definicao:'Ativo Total - Passivo Total. Capital dos s√≥cios na empresa.',exemplo:'Ativo R$ 1MM, passivo R$ 600k = PL R$ 400k.'},
        {termo:'CAPEX',definicao:'Capital Expenditure. Investimentos em ativos permanentes.',exemplo:'Compra de m√°quinas, ve√≠culos, im√≥veis.'},
        {termo:'OPEX',definicao:'Operational Expenditure. Despesas operacionais do dia a dia.',exemplo:'Sal√°rios, aluguel, energia, marketing.'},
        {termo:'Budget',definicao:'Or√ßamento. Planejamento financeiro do que se espera faturar e gastar.',exemplo:'Budget 2025: Receita R$ 12MM, Despesas R$ 10MM, Lucro R$ 2MM.'},
        {termo:'Forecast',definicao:'Proje√ß√£o. Atualiza√ß√£o do budget baseado em tend√™ncias reais.',exemplo:'Budget era R$ 1MM, mas tend√™ncia indica R$ 1,2MM ‚Üí Forecast R$ 1,2MM.'},
        {termo:'Variance',definicao:'Varia√ß√£o entre or√ßado e realizado.',exemplo:'Or√ßou vender R$ 100k, vendeu R$ 90k = Variance -10%.'},
        {termo:'Working Capital',definicao:'Ingl√™s para Capital de Giro. Recursos para operar.',exemplo:'Working capital negativo = empresa precisa de caixa urgente.'},
        {termo:'Free Cash Flow',definicao:'Caixa gerado pela opera√ß√£o ap√≥s investimentos obrigat√≥rios.',exemplo:'EBITDA R$ 200k - CAPEX R$ 50k = FCF R$ 150k dispon√≠vel.'},
        {termo:'TIR',definicao:'Taxa Interna de Retorno. Rentabilidade de um investimento.',exemplo:'Investiu R$ 100k, retornos futuros equivalem a 25% ao ano = TIR 25%.'},
        {termo:'VPL',definicao:'Valor Presente L√≠quido. Valor de fluxos futuros trazidos a valor presente.',exemplo:'VPL positivo = investimento vale a pena, negativo = evitar.'},
        {termo:'Payback',definicao:'Tempo para recuperar investimento inicial.',exemplo:'Investiu R$ 100k, retorno R$ 2k/m√™s = Payback 50 meses.'},
        {termo:'Markup',definicao:'√çndice aplicado sobre custo para formar pre√ßo.',exemplo:'Custo R$ 70, markup 1,5x = Pre√ßo R$ 105.'},
        {termo:'Regime de Compet√™ncia',definicao:'Registra receitas/despesas quando ocorrem, n√£o quando s√£o pagas.',exemplo:'Vendeu em dez, recebe em jan = Contabiliza em dez.'},
        {termo:'Regime de Caixa',definicao:'Registra apenas quando dinheiro entra/sai efetivamente.',exemplo:'Vendeu em dez, recebe em jan = Contabiliza em jan.'},
        {termo:'Concilia√ß√£o Banc√°ria',definicao:'Comparar extrato banc√°rio com controles internos para identificar diverg√™ncias.',exemplo:'Saldo sistema R$ 100k, banco R$ 98k ‚Üí Conciliar para achar diferen√ßa.'},
        {termo:'Aging',definicao:'Relat√≥rio de contas a receber por idade (vencidas h√° quanto tempo).',exemplo:'30 dias: R$ 50k, 60 dias: R$ 30k, >90 dias: R$ 10k.'},
        {termo:'Desconto Comercial',definicao:'Redu√ß√£o de pre√ßo por negocia√ß√£o, volume ou antecipa√ß√£o.',exemplo:'Pre√ßo R$ 100, desconto 10% por pagamento √† vista = R$ 90.'},
        {termo:'Desconto Financeiro',definicao:'Redu√ß√£o de juros por pagamento antecipado.',exemplo:'D√≠vida R$ 110k com juros, paga antes = R$ 100k (desconto R$ 10k).'},
        {termo:'Spread',definicao:'Diferen√ßa entre taxa que banco paga para captar e cobra para emprestar.',exemplo:'Banco capta a 10%, empresta a 18% = Spread 8%.'},
        {termo:'Hedge',definicao:'Prote√ß√£o contra risco financeiro (c√¢mbio, juros, commodities).',exemplo:'Exportador vende d√≥lar futuro para garantir pre√ßo e evitar perda cambial.'},
        {termo:'Default',definicao:'Inadimpl√™ncia, calote. N√£o pagamento de d√≠vida.',exemplo:'Empresa entrou em default = n√£o pagou empr√©stimo.'},
        {termo:'Covenant',definicao:'Cl√°usula restritiva em contrato de financiamento.',exemplo:'Covenant: manter endividamento <60% ou banco pode cobrar d√≠vida antecipadamente.'}
    ]
};

let categoriaAtual = 'todas';

function mostrarCategoriaAjuda(cat, botaoClicado) {
    console.log('üîç mostrarCategoriaAjuda chamada com:', cat);
    categoriaAtual = cat;
    document.querySelectorAll('.ajuda-nav-item').forEach(b => b.classList.remove('ativo'));
    if (botaoClicado) {
        botaoClicado.classList.add('ativo');
    }
    console.log('üìä Categoria atual setada para:', categoriaAtual);
    renderizarConteudoAjuda();
}

function renderizarConteudoAjuda() {
    console.log('üé® renderizarConteudoAjuda iniciada, categoria:', categoriaAtual);
    const container = document.getElementById('ajuda-conteudo');
    console.log('üì¶ Container encontrado:', container ? 'SIM' : 'N√ÉO');
    if (!container) return;
    
    if (categoriaAtual === 'todas') {
        console.log('üìö Renderizando TODAS as categorias...');
        const todos = [...ARTIGOS_AJUDA.comecando, ...ARTIGOS_AJUDA.categorias, 
                       ...ARTIGOS_AJUDA.calculadora, ...ARTIGOS_AJUDA.plano];
        console.log('üìä Total de artigos:', todos.length);
        container.innerHTML = todos.map(a => criarCardArtigo(a)).join('');
    } else if (categoriaAtual === 'glossario') {
        console.log('üìñ Renderizando GLOSS√ÅRIO...');
        container.innerHTML = '<div class="glossario-container">' + 
            ARTIGOS_AJUDA.glossario.map(g => `
                <div class="glossario-item">
                    <div class="glossario-termo">${g.termo}</div>
                    <div class="glossario-definicao">${g.definicao}</div>
                    <div class="glossario-exemplo">Exemplo: ${g.exemplo}</div>
                </div>
            `).join('') + '</div>';
    } else if (categoriaAtual === 'faq') {
        console.log('‚ùì Renderizando FAQ...');
        container.innerHTML = '<div class="faq-container">' +
            ARTIGOS_AJUDA.faq.map((f, i) => `
                <div class="faq-item" id="faq-${i}">
                    <div class="faq-pergunta" onclick="toggleFAQ(${i})">
                        <span>${f.pergunta}</span>
                        <span class="faq-icone">‚ñº</span>
                    </div>
                    <div class="faq-resposta">
                        <div class="faq-resposta-conteudo">${f.resposta}</div>
                    </div>
                </div>
            `).join('') + '</div>';
    } else {
        console.log('üìÇ Renderizando categoria espec√≠fica:', categoriaAtual);
        const artigos = ARTIGOS_AJUDA[categoriaAtual] || [];
        console.log('üìä Artigos encontrados:', artigos.length);
        container.innerHTML = artigos.map(a => criarCardArtigo(a)).join('');
    }
    console.log('‚úÖ Renderiza√ß√£o completa!');
}

function criarCardArtigo(artigo) {
    return `
        <div class="ajuda-card" onclick="abrirArtigoModal('${artigo.id}')">
            <div class="ajuda-card-icone">${artigo.icone}</div>
            <div class="ajuda-card-titulo">${artigo.titulo}</div>
            <div class="ajuda-card-descricao">${artigo.descricao}</div>
            <div class="ajuda-card-categoria">${artigo.categoria}</div>
            <div class="ajuda-card-footer">Leia mais ‚Üí</div>
        </div>
    `;
}

function abrirArtigoModal(id) {
    let artigo = null;
    for (const cat in ARTIGOS_AJUDA) {
        if (Array.isArray(ARTIGOS_AJUDA[cat])) {
            artigo = ARTIGOS_AJUDA[cat].find(a => a.id === id);
            if (artigo) break;
        }
    }
    if (!artigo) return;
    
    document.getElementById('modal-titulo').innerHTML = `${artigo.icone} ${artigo.titulo}`;
    document.getElementById('modal-conteudo').innerHTML = artigo.conteudo;
    document.getElementById('ajuda-modal-overlay').classList.add('ativo');
}

function fecharArtigoModal() {
    document.getElementById('ajuda-modal-overlay').classList.remove('ativo');
}

function toggleFAQ(i) {
    document.getElementById(`faq-${i}`).classList.toggle('aberto');
}

let buscaTimeout;
function buscarAjuda(termo) {
    clearTimeout(buscaTimeout);
    const container = document.getElementById('ajuda-busca-resultados');
    if (!termo || termo.length < 2) {
        container.style.display = 'none';
        return;
    }
    buscaTimeout = setTimeout(() => {
        const resultados = [];
        for (const cat in ARTIGOS_AJUDA) {
            if (Array.isArray(ARTIGOS_AJUDA[cat])) {
                ARTIGOS_AJUDA[cat].forEach(item => {
                    const titulo = item.titulo || item.pergunta || item.termo || '';
                    if (titulo.toLowerCase().includes(termo.toLowerCase())) {
                        resultados.push({...item, tipo: cat});
                    }
                });
            }
        }
        if (resultados.length > 0) {
            container.innerHTML = resultados.slice(0,10).map(r => `
                <div class="ajuda-busca-resultado-item" onclick="abrirArtigoModal('${r.id}')">
                    <div class="ajuda-busca-resultado-titulo">${r.titulo||r.pergunta||r.termo}</div>
                    <div class="ajuda-busca-resultado-categoria">${r.tipo}</div>
                </div>
            `).join('');
            container.style.display = 'block';
        } else {
            container.innerHTML = '<div style="padding:16px">Nenhum resultado encontrado</div>';
            container.style.display = 'block';
        }
    }, 300);
}

document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ DOMContentLoaded disparado!');
    
    // Verificar se ARTIGOS_AJUDA existe
    console.log('üìö ARTIGOS_AJUDA existe?', typeof ARTIGOS_AJUDA !== 'undefined' ? 'SIM' : 'N√ÉO');
    if (typeof ARTIGOS_AJUDA !== 'undefined') {
        console.log('üìä Come√ßando:', ARTIGOS_AJUDA.comecando?.length || 0, 'artigos');
        console.log('üìä Categorias:', ARTIGOS_AJUDA.categorias?.length || 0, 'artigos');
        console.log('üìä Calculadora:', ARTIGOS_AJUDA.calculadora?.length || 0, 'artigos');
        console.log('üìä Plano:', ARTIGOS_AJUDA.plano?.length || 0, 'artigos');
        console.log('üìä FAQ:', ARTIGOS_AJUDA.faq?.length || 0, 'perguntas');
        console.log('üìä Gloss√°rio:', ARTIGOS_AJUDA.glossario?.length || 0, 'termos');
    }
    
    // Configurar cliques nos bot√µes de categoria
    const botoes = document.querySelectorAll('.ajuda-nav-item');
    console.log('üîò Bot√µes encontrados:', botoes.length);
    
    botoes.forEach((botao, index) => {
        const categoria = botao.getAttribute('data-categoria');
        console.log(`üîò Bot√£o ${index + 1}:`, categoria);
        botao.addEventListener('click', function() {
            console.log('üëÜ CLIQUE no bot√£o:', categoria);
            mostrarCategoriaAjuda(categoria, this);
        });
    });
    
    console.log('üé® Renderizando conte√∫do inicial...');
    renderizarConteudoAjuda();
    console.log('‚úÖ Central de Ajuda carregada!');
});


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üöÄ DASHBOARD DE EVOLU√á√ÉO TEMPORAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üöÄ SPRINT 1: DASHBOARD DE EVOLU√á√ÉO TEMPORAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Adicionar bot√£o "Ver Evolu√ß√£o" na interface de hist√≥rico
function adicionarBotaoEvolucao() {
    const barraAcoes = document.querySelector('#historico-diagnosticos .btn-secondary').parentElement;
    
    const btnEvolucao = document.createElement('button');
    btnEvolucao.onclick = () => mostrarDashboardEvolucao();
    btnEvolucao.className = 'btn-primary';
    btnEvolucao.style.cssText = 'display:flex;align-items:center;gap:8px';
    btnEvolucao.innerHTML = '<span>üìà</span><span>Ver Evolu√ß√£o</span>';
    
    barraAcoes.insertBefore(btnEvolucao, barraAcoes.firstChild);
}

// Mostrar dashboard de evolu√ß√£o
function mostrarDashboardEvolucao() {
    const empresaAtiva = EmpresasManager.getAtiva();
    if (!empresaAtiva) {
        alert('‚ùå Nenhuma empresa selecionada!');
        return;
    }
    
    // Obter todos os diagn√≥sticos completos
    const diagnosticos = DiagnosticosManager.getAll(empresaAtiva.id)
        .filter(d => d.completo)
        .sort((a, b) => new Date(a.dataCriacao) - new Date(b.dataCriacao));
    
    if (diagnosticos.length < 2) {
        alert('üìä √â necess√°rio ter pelo menos 2 diagn√≥sticos completos para visualizar a evolu√ß√£o!');
        return;
    }
    
    // Criar modal de evolu√ß√£o
    criarModalEvolucao(diagnosticos, empresaAtiva);
}

// Criar modal com dashboard de evolu√ß√£o
function criarModalEvolucao(diagnosticos, empresa) {
    // Remover modal existente se houver
    const modalExistente = document.getElementById('modal-evolucao');
    if (modalExistente) modalExistente.remove();
    
    // Criar modal
    const modal = document.createElement('div');
    modal.id = 'modal-evolucao';
    modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:10000;overflow-y:auto;padding:20px';
    
    // Calcular dados de evolu√ß√£o
    const dadosEvolucao = calcularDadosEvolucao(diagnosticos);
    
    modal.innerHTML = `
        <div style="max-width:1400px;margin:0 auto;background:var(--card-bg);border-radius:20px;padding:32px">
            
            <!-- Header -->
            <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:32px">
                <div>
                    <h2 style="margin:0 0 8px 0;font-size:2em;color:var(--accent)">
                        üìà Dashboard de Evolu√ß√£o
                    </h2>
                    <p style="margin:0;color:var(--text-light);font-size:1.1em">
                        ${empresa.nome} ‚Ä¢ ${diagnosticos.length} diagn√≥sticos
                    </p>
                </div>
                <button onclick="fecharModalEvolucao()" class="btn-secondary" style="padding:12px 20px">
                    ‚úï Fechar
                </button>
            </div>
            
            <!-- Cards de resumo -->
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:32px">
                
                <!-- Score Inicial -->
                <div class="card" style="text-align:center;padding:20px">
                    <div style="font-size:0.9em;color:var(--text-light);margin-bottom:8px">
                        Score Inicial
                    </div>
                    <div style="font-size:2.5em;font-weight:700;color:#d32f2f">
                        ${dadosEvolucao.scoreInicial}%
                    </div>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:4px">
                        ${new Date(diagnosticos[0].dataCriacao).toLocaleDateString('pt-BR')}
                    </div>
                </div>
                
                <!-- Score Atual -->
                <div class="card" style="text-align:center;padding:20px">
                    <div style="font-size:0.9em;color:var(--text-light);margin-bottom:8px">
                        Score Atual
                    </div>
                    <div style="font-size:2.5em;font-weight:700;color:#2e7d32">
                        ${dadosEvolucao.scoreAtual}%
                    </div>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:4px">
                        ${new Date(diagnosticos[diagnosticos.length-1].dataCriacao).toLocaleDateString('pt-BR')}
                    </div>
                </div>
                
                <!-- Evolu√ß√£o -->
                <div class="card" style="text-align:center;padding:20px">
                    <div style="font-size:0.9em;color:var(--text-light);margin-bottom:8px">
                        Evolu√ß√£o Total
                    </div>
                    <div style="font-size:2.5em;font-weight:700;color:${dadosEvolucao.evolucao >= 0 ? '#00c853' : '#d32f2f'}">
                        ${dadosEvolucao.evolucao >= 0 ? '+' : ''}${dadosEvolucao.evolucao}%
                    </div>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:4px">
                        ${dadosEvolucao.meses} ${dadosEvolucao.meses === 1 ? 'm√™s' : 'meses'}
                    </div>
                </div>
                
                <!-- Impacto Financeiro -->
                <div class="card" style="text-align:center;padding:20px">
                    <div style="font-size:0.9em;color:var(--text-light);margin-bottom:8px">
                        Impacto Financeiro
                    </div>
                    <div style="font-size:1.8em;font-weight:700;color:#1976d2">
                        R$ ${dadosEvolucao.impactoFinanceiro.toLocaleString('pt-BR')}
                    </div>
                    <div style="font-size:0.85em;color:var(--text-light);margin-top:4px">
                        Perdas evitadas/ano
                    </div>
                </div>
                
            </div>
            
            <!-- Gr√°fico de Evolu√ß√£o Temporal -->
            <div class="card" style="padding:24px;margin-bottom:32px">
                <h3 style="margin:0 0 20px 0;font-size:1.3em">
                    üìä Evolu√ß√£o do Score ao Longo do Tempo
                </h3>
                <canvas id="grafico-evolucao-temporal" style="max-height:400px"></canvas>
            </div>
            
            <!-- Evolu√ß√£o Por Categoria -->
            <div class="card" style="padding:24px">
                <h3 style="margin:0 0 20px 0;font-size:1.3em">
                    üéØ Evolu√ß√£o Por Categoria
                </h3>
                <div id="evolucao-categorias"></div>
            </div>
            
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Renderizar gr√°fico ap√≥s modal estar no DOM
    setTimeout(() => {
        renderizarGraficoEvolucao(diagnosticos);
        renderizarEvolucaoCategorias(diagnosticos);
    }, 100);
}

// Calcular dados de evolu√ß√£o
function calcularDadosEvolucao(diagnosticos) {
    const primeiro = diagnosticos[0];
    const ultimo = diagnosticos[diagnosticos.length - 1];
    
    const scoreInicial = primeiro.pontuacao.percentual;
    const scoreAtual = ultimo.pontuacao.percentual;
    const evolucao = scoreAtual - scoreInicial;
    
    // Calcular diferen√ßa em meses
    const dataInicial = new Date(primeiro.dataCriacao);
    const dataAtual = new Date(ultimo.dataCriacao);
    const diffMs = dataAtual - dataInicial;
    const meses = Math.round(diffMs / (1000 * 60 * 60 * 24 * 30));
    
    // Estimar impacto financeiro (simplificado)
    const faturamento = primeiro.empresa?.faturamento || 2000000;
    const perdasInicial = calcularPerdasEstimadas(scoreInicial, faturamento);
    const perdasAtual = calcularPerdasEstimadas(scoreAtual, faturamento);
    const impactoFinanceiro = perdasInicial - perdasAtual;
    
    return {
        scoreInicial,
        scoreAtual,
        evolucao,
        meses: meses || 1,
        impactoFinanceiro
    };
}

// Calcular perdas estimadas
function calcularPerdasEstimadas(score, faturamento) {
    // Quanto menor o score, maior a perda (0-10% do faturamento)
    const fatorPerda = (100 - score) / 100;
    return Math.round(faturamento * 0.10 * fatorPerda);
}

// Renderizar gr√°fico de evolu√ß√£o temporal
function renderizarGraficoEvolucao(diagnosticos) {
    const ctx = document.getElementById('grafico-evolucao-temporal');
    if (!ctx) return;
    
    // Preparar dados
    const labels = diagnosticos.map((d, idx) => {
        const data = new Date(d.dataCriacao);
        return `${data.toLocaleDateString('pt-BR', {month: 'short', year: '2-digit'})}`;
    });
    
    const data = diagnosticos.map(d => d.pontuacao.percentual);
    
    // Criar gr√°fico
    new Chart(ctx, {
        type: 'line',
        data: {
            labels,
            datasets: [{
                label: 'Score Geral (%)',
                data,
                borderColor: '#1976d2',
                backgroundColor: 'rgba(25, 118, 210, 0.1)',
                borderWidth: 3,
                fill: true,
                tension: 0.4,
                pointRadius: 6,
                pointHoverRadius: 8,
                pointBackgroundColor: '#1976d2',
                pointBorderColor: '#fff',
                pointBorderWidth: 2
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: (context) => `Score: ${context.parsed.y}%`
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        callback: (value) => value + '%'
                    }
                }
            }
        }
    });
}

// Renderizar evolu√ß√£o por categoria
function renderizarEvolucaoCategorias(diagnosticos) {
    const container = document.getElementById('evolucao-categorias');
    if (!container) return;
    
    const categorias = ['tesouraria', 'fluxo', 'resultados', 'orcamento', 'investimentos', 'riscos', 'indicadores', 'tributario'];
    const nomesCategorias = {
        tesouraria: 'üí∞ Tesouraria',
        fluxo: 'üíµ Fluxo de Caixa',
        resultados: 'üìà Resultados & DRE',
        orcamento: 'üìä Or√ßamento',
        investimentos: 'üöÄ Investimentos',
        riscos: 'üõ°Ô∏è Riscos Financeiros',
        indicadores: 'üìä Indicadores',
        tributario: 'üìú Planejamento Tribut√°rio'
    };
    
    const primeiro = diagnosticos[0];
    const ultimo = diagnosticos[diagnosticos.length - 1];
    
    let html = '<div style="display:grid;gap:16px">';
    
    categorias.forEach(cat => {
        const scoreInicial = primeiro.pontuacao?.categorias?.[cat] || 0;
        const scoreAtual = ultimo.pontuacao?.categorias?.[cat] || 0;
        const evolucao = scoreAtual - scoreInicial;
        const corEvolucao = evolucao > 0 ? '#00c853' : (evolucao < 0 ? '#d32f2f' : '#757575');
        
        html += `
            <div style="display:flex;align-items:center;gap:16px;padding:16px;background:var(--bg);border-radius:12px">
                <div style="flex:1">
                    <strong>${nomesCategorias[cat]}</strong>
                </div>
                <div style="display:flex;align-items:center;gap:16px">
                    <div style="text-align:center;min-width:60px">
                        <div style="font-size:0.8em;color:var(--text-light)">Inicial</div>
                        <div style="font-weight:700;color:#d32f2f">${scoreInicial}%</div>
                    </div>
                    <div style="font-size:1.5em;color:var(--text-light)">‚Üí</div>
                    <div style="text-align:center;min-width:60px">
                        <div style="font-size:0.8em;color:var(--text-light)">Atual</div>
                        <div style="font-weight:700;color:#2e7d32">${scoreAtual}%</div>
                    </div>
                    <div style="text-align:center;min-width:80px;background:${corEvolucao}20;color:${corEvolucao};padding:8px 12px;border-radius:8px;font-weight:700">
                        ${evolucao >= 0 ? '+' : ''}${evolucao}pts
                    </div>
                </div>
            </div>
        `;
    });
    
    html += '</div>';
    container.innerHTML = html;
}

// Fechar modal de evolu√ß√£o
function fecharModalEvolucao() {
    const modal = document.getElementById('modal-evolucao');
    if (modal) modal.remove();
}

console.log('‚úÖ Dashboard de Evolu√ß√£o carregado!');

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚öñÔ∏è COMPARA√á√ÉO "ANTES VS DEPOIS"
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Array para armazenar diagn√≥sticos selecionados para compara√ß√£o
let diagnosticosParaComparar = [];

// Adicionar bot√£o "Comparar" nos cards de diagn√≥stico
function adicionarBotoesComparar() {
    const cards = document.querySelectorAll('#lista-diagnosticos .card');
    
    cards.forEach((card, index) => {
        const acoesDiv = card.querySelector('[onclick*="abrirDiagnostico"]').parentElement;
        
        // Verificar se j√° existe bot√£o de comparar
        if (acoesDiv.querySelector('[onclick*="selecionarParaComparacao"]')) return;
        
        // Obter ID do diagn√≥stico
        const btnAbrir = acoesDiv.querySelector('[onclick*="abrirDiagnostico"]');
        const match = btnAbrir.getAttribute('onclick').match(/'([^']+)'/);
        const diagnosticoId = match ? match[1] : null;
        
        if (!diagnosticoId) return;
        
        // Criar bot√£o comparar
        const btnComparar = document.createElement('button');
        btnComparar.onclick = () => selecionarParaComparacao(diagnosticoId);
        btnComparar.className = 'btn-secondary';
        btnComparar.style.cssText = 'justify-content:center';
        btnComparar.innerHTML = '‚öñÔ∏è Comparar';
        btnComparar.id = `btn-comparar-${diagnosticoId}`;
        
        // Inserir antes do bot√£o excluir
        const btnExcluir = acoesDiv.querySelector('[onclick*="excluirDiagnostico"]');
        acoesDiv.insertBefore(btnComparar, btnExcluir);
    });
}

// Selecionar diagn√≥stico para compara√ß√£o
function selecionarParaComparacao(diagnosticoId) {
    const btn = document.getElementById(`btn-comparar-${diagnosticoId}`);
    
    // Se j√° est√° selecionado, remover
    const index = diagnosticosParaComparar.indexOf(diagnosticoId);
    if (index > -1) {
        diagnosticosParaComparar.splice(index, 1);
        btn.style.background = '';
        btn.style.color = '';
        btn.innerHTML = '‚öñÔ∏è Comparar';
    } else {
        // Limitar a 2 diagn√≥sticos
        if (diagnosticosParaComparar.length >= 2) {
            // Remover primeiro selecionado
            const primeiroId = diagnosticosParaComparar.shift();
            const btnPrimeiro = document.getElementById(`btn-comparar-${primeiroId}`);
            if (btnPrimeiro) {
                btnPrimeiro.style.background = '';
                btnPrimeiro.style.color = '';
                btnPrimeiro.innerHTML = '‚öñÔ∏è Comparar';
            }
        }
        
        diagnosticosParaComparar.push(diagnosticoId);
        btn.style.background = 'linear-gradient(135deg, #1976d2, #00bcd4)';
        btn.style.color = 'white';
        btn.innerHTML = `‚úì Selecionado (${diagnosticosParaComparar.length}/2)`;
    }
    
    // Se 2 selecionados, mostrar bot√£o de comparar
    if (diagnosticosParaComparar.length === 2) {
        mostrarBotaoCompararAgora();
    } else {
        esconderBotaoCompararAgora();
    }
}

// Mostrar bot√£o flutuante "Comparar Agora"
function mostrarBotaoCompararAgora() {
    let btnFlutante = document.getElementById('btn-comparar-flutuante');
    
    if (!btnFlutante) {
        btnFlutante = document.createElement('button');
        btnFlutante.id = 'btn-comparar-flutuante';
        btnFlutante.onclick = () => compararDiagnosticos();
        btnFlutante.innerHTML = '‚öñÔ∏è Comparar Agora (2 selecionados)';
        btnFlutante.style.cssText = `
            position:fixed;
            bottom:30px;
            right:30px;
            background:linear-gradient(135deg, #00c853, #00e676);
            color:white;
            border:none;
            border-radius:50px;
            padding:16px 32px;
            font-size:1.1em;
            font-weight:700;
            cursor:pointer;
            box-shadow:0 8px 24px rgba(0,200,83,0.4);
            z-index:9999;
            transition:all 0.3s ease;
            animation:pulseComparar 2s infinite;
        `;
        
        // Adicionar anima√ß√£o
        if (!document.getElementById('style-pulse-comparar')) {
            const style = document.createElement('style');
            style.id = 'style-pulse-comparar';
            style.textContent = `
                @keyframes pulseComparar {
                    0%, 100% { transform:scale(1); box-shadow:0 8px 24px rgba(0,200,83,0.4); }
                    50% { transform:scale(1.05); box-shadow:0 12px 32px rgba(0,200,83,0.6); }
                }
            `;
            document.head.appendChild(style);
        }
        
        document.body.appendChild(btnFlutante);
    }
    
    btnFlutante.style.display = 'block';
}

// Esconder bot√£o flutuante
function esconderBotaoCompararAgora() {
    const btnFlutante = document.getElementById('btn-comparar-flutuante');
    if (btnFlutante) {
        btnFlutante.style.display = 'none';
    }
}

// Comparar diagn√≥sticos selecionados
function compararDiagnosticos() {
    if (diagnosticosParaComparar.length !== 2) {
        alert('‚ö†Ô∏è Selecione exatamente 2 diagn√≥sticos para comparar!');
        return;
    }
    
    const empresaAtiva = EmpresasManager.getAtiva();
    if (!empresaAtiva) return;
    
    const diagnosticos = DiagnosticosManager.getAll(empresaAtiva.id);
    const diag1 = diagnosticos.find(d => d.id === diagnosticosParaComparar[0]);
    const diag2 = diagnosticos.find(d => d.id === diagnosticosParaComparar[1]);
    
    if (!diag1 || !diag2) {
        alert('‚ùå Erro ao carregar diagn√≥sticos!');
        return;
    }
    
    // Garantir que diag1 √© o mais antigo
    let diagnosticoAntigo = diag1;
    let diagnosticoNovo = diag2;
    
    if (new Date(diag1.dataCriacao) > new Date(diag2.dataCriacao)) {
        diagnosticoAntigo = diag2;
        diagnosticoNovo = diag1;
    }
    
    criarModalComparacao(diagnosticoAntigo, diagnosticoNovo, empresaAtiva);
}

// Criar modal de compara√ß√£o
function criarModalComparacao(diagAntigo, diagNovo, empresa) {
    // Remover modal existente
    const modalExistente = document.getElementById('modal-comparacao');
    if (modalExistente) modalExistente.remove();
    
    // Calcular evolu√ß√£o
    const scoreAntigo = diagAntigo.pontuacao.percentual;
    const scoreNovo = diagNovo.pontuacao.percentual;
    const evolucao = scoreNovo - scoreAntigo;
    const corEvolucao = evolucao > 0 ? '#00c853' : (evolucao < 0 ? '#d32f2f' : '#757575');
    
    // Calcular diferen√ßa em tempo
    const dataAntiga = new Date(diagAntigo.dataCriacao);
    const dataNova = new Date(diagNovo.dataCriacao);
    const diffMs = dataNova - dataAntiga;
    const diffDias = Math.round(diffMs / (1000 * 60 * 60 * 24));
    const diffMeses = Math.round(diffDias / 30);
    
    // Criar modal
    const modal = document.createElement('div');
    modal.id = 'modal-comparacao';
    modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:10000;overflow-y:auto;padding:20px';
    
    modal.innerHTML = `
        <div style="max-width:1400px;margin:0 auto;background:var(--card-bg);border-radius:20px;padding:32px">
            
            <!-- Header -->
            <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:32px">
                <div>
                    <h2 style="margin:0 0 8px 0;font-size:2em;color:var(--accent)">
                        ‚öñÔ∏è Compara√ß√£o: Antes vs Depois
                    </h2>
                    <p style="margin:0;color:var(--text-light);font-size:1.1em">
                        ${empresa.nome} ‚Ä¢ Evolu√ß√£o de ${diffMeses} ${diffMeses === 1 ? 'm√™s' : 'meses'}
                    </p>
                </div>
                <button onclick="fecharModalComparacao()" class="btn-secondary" style="padding:12px 20px">
                    ‚úï Fechar
                </button>
            </div>
            
            <!-- Card de Evolu√ß√£o -->
            <div class="card" style="padding:24px;margin-bottom:32px;background:linear-gradient(135deg, rgba(0,200,83,0.1), transparent)">
                <div style="display:grid;grid-template-columns:1fr auto 1fr;gap:24px;align-items:center">
                    
                    <!-- ANTES -->
                    <div style="text-align:center">
                        <div style="font-size:0.9em;color:var(--text-light);margin-bottom:8px">
                            ANTES
                        </div>
                        <div style="font-size:3em;font-weight:700;color:#d32f2f">
                            ${scoreAntigo}%
                        </div>
                        <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                            ${diagAntigo.nome}<br>
                            ${dataAntiga.toLocaleDateString('pt-BR')}
                        </div>
                    </div>
                    
                    <!-- SETA -->
                    <div style="text-align:center;padding:0 20px">
                        <div style="font-size:3em">‚Üí</div>
                        <div style="font-size:1.5em;font-weight:700;color:${corEvolucao};margin-top:8px">
                            ${evolucao >= 0 ? '+' : ''}${evolucao}%
                        </div>
                    </div>
                    
                    <!-- DEPOIS -->
                    <div style="text-align:center">
                        <div style="font-size:0.9em;color:var(--text-light);margin-bottom:8px">
                            DEPOIS
                        </div>
                        <div style="font-size:3em;font-weight:700;color:#2e7d32">
                            ${scoreNovo}%
                        </div>
                        <div style="font-size:0.85em;color:var(--text-light);margin-top:8px">
                            ${diagNovo.nome}<br>
                            ${dataNova.toLocaleDateString('pt-BR')}
                        </div>
                    </div>
                    
                </div>
            </div>
            
            <!-- Compara√ß√£o Por Categoria -->
            <div class="card" style="padding:24px">
                <h3 style="margin:0 0 20px 0;font-size:1.3em">
                    üìä Evolu√ß√£o Por Categoria
                </h3>
                <div id="comparacao-categorias"></div>
            </div>
            
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Renderizar compara√ß√£o de categorias
    setTimeout(() => renderizarComparacaoCategorias(diagAntigo, diagNovo), 100);
}

// Renderizar compara√ß√£o de categorias
function renderizarComparacaoCategorias(diagAntigo, diagNovo) {
    const container = document.getElementById('comparacao-categorias');
    if (!container) return;
    
    const categorias = ['tesouraria', 'fluxo', 'resultados', 'orcamento', 'investimentos', 'riscos', 'indicadores', 'tributario'];
    const nomesCategorias = {
        tesouraria: 'üí∞ Tesouraria',
        fluxo: 'üíµ Fluxo de Caixa',
        resultados: 'üìà Resultados & DRE',
        orcamento: 'üìä Or√ßamento',
        investimentos: 'üöÄ Investimentos',
        riscos: 'üõ°Ô∏è Riscos Financeiros',
        indicadores: 'üìä Indicadores',
        tributario: 'üìú Planejamento Tribut√°rio'
    };
    
    let html = '<div style="display:grid;gap:16px">';
    
    categorias.forEach(cat => {
        const scoreAntigo = diagAntigo.pontuacao?.categorias?.[cat] || 0;
        const scoreNovo = diagNovo.pontuacao?.categorias?.[cat] || 0;
        const evolucao = scoreNovo - scoreAntigo;
        const corEvolucao = evolucao > 0 ? '#00c853' : (evolucao < 0 ? '#d32f2f' : '#757575');
        
        // Calcular porcentagem de evolu√ß√£o
        const pctEvolucao = scoreAntigo > 0 ? Math.round((evolucao / scoreAntigo) * 100) : 0;
        
        html += `
            <div style="display:flex;align-items:center;gap:16px;padding:16px;background:var(--bg);border-radius:12px">
                <div style="flex:1">
                    <strong>${nomesCategorias[cat]}</strong>
                </div>
                <div style="display:flex;align-items:center;gap:16px">
                    <div style="text-align:center;min-width:70px">
                        <div style="font-size:0.8em;color:var(--text-light)">Antes</div>
                        <div style="font-weight:700;font-size:1.3em;color:#d32f2f">${scoreAntigo}%</div>
                    </div>
                    <div style="font-size:2em;color:var(--text-light)">‚Üí</div>
                    <div style="text-align:center;min-width:70px">
                        <div style="font-size:0.8em;color:var(--text-light)">Depois</div>
                        <div style="font-weight:700;font-size:1.3em;color:#2e7d32">${scoreNovo}%</div>
                    </div>
                    <div style="text-align:center;min-width:90px;background:${corEvolucao}20;color:${corEvolucao};padding:10px 16px;border-radius:12px;font-weight:700">
                        <div style="font-size:1.2em">${evolucao >= 0 ? '+' : ''}${evolucao}pts</div>
                        ${pctEvolucao !== 0 ? `<div style="font-size:0.8em;margin-top:2px">(${pctEvolucao >= 0 ? '+' : ''}${pctEvolucao}%)</div>` : ''}
                    </div>
                </div>
            </div>
        `;
    });
    
    html += '</div>';
    container.innerHTML = html;
}

// Fechar modal de compara√ß√£o
function fecharModalComparacao() {
    const modal = document.getElementById('modal-comparacao');
    if (modal) modal.remove();
    
    // Limpar sele√ß√µes
    diagnosticosParaComparar = [];
    
    // Resetar bot√µes
    document.querySelectorAll('[id^="btn-comparar-"]').forEach(btn => {
        btn.style.background = '';
        btn.style.color = '';
        btn.innerHTML = '‚öñÔ∏è Comparar';
    });
    
    esconderBotaoCompararAgora();
}

console.log('‚úÖ Compara√ß√£o Antes vs Depois carregada!');



document.addEventListener('keydown', e => {
    if (e.key === 'Escape') fecharArtigoModal();
});
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FUN√á√ÉO PARA BAIXAR E-BOOK EM PDF
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function baixarEbook() {
    console.log('üîç Iniciando gera√ß√£o do e-book PDF...');
    
    try {
        // Pegar o conte√∫do completo do e-book
        const conteudo = document.getElementById('ebook-conteudo-completo');
        
        if (!conteudo) {
            console.error('‚ùå Conte√∫do do e-book n√£o encontrado!');
            alert('Erro: Conte√∫do do e-book n√£o dispon√≠vel');
            return;
        }
        
        console.log('‚úÖ Conte√∫do do e-book encontrado');
        
        // Mostrar loading
        const btnDownload = event.target;
        const textoOriginal = btnDownload.innerHTML;
        btnDownload.innerHTML = '‚è≥ Gerando PDF...';
        btnDownload.disabled = true;
        
        // Configura√ß√µes do PDF
        const opcoes = {
            margin: [10, 10, 10, 10],
            filename: 'Ebook_Gestor_360_Completo.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: {
                scale: 2,
                useCORS: true,
                logging: false
            },
            jsPDF: {
                unit: 'mm',
                format: 'a4',
                orientation: 'portrait',
                compress: true
            },
            pagebreak: {
                mode: ['avoid-all', 'css', 'legacy']
            }
        };
        
        console.log('üìÑ Gerando PDF...');
        
        // Gerar e baixar PDF
        await html2pdf()
            .set(opcoes)
            .from(conteudo)
            .save();
        
        console.log('‚úÖ PDF gerado e download iniciado!');
        
        // Restaurar bot√£o
        btnDownload.innerHTML = textoOriginal;
        btnDownload.disabled = false;
        
        // Mostrar mensagem de sucesso
        setTimeout(() => {
            alert('‚úÖ E-book baixado com sucesso!\n\nüìñ Total: ~25-30 p√°ginas profissionais\n\nüí° Aproveite o conte√∫do!');
        }, 500);
        
    } catch (erro) {
        console.error('‚ùå Erro ao gerar PDF:', erro);
        alert('Erro ao gerar o e-book. Por favor, tente novamente.');
        
        // Restaurar bot√£o em caso de erro
        if (btnDownload) {
            btnDownload.innerHTML = textoOriginal;
            btnDownload.disabled = false;
        }
    }
}
</script>
</body>
</html>
